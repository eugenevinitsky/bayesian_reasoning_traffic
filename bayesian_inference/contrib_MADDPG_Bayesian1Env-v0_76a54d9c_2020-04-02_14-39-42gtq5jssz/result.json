{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {}, "off_policy_estimator": {}, "info": {"num_target_updates": 1, "num_steps_trained": 0, "num_steps_sampled": 100, "sample_time_ms": 1595.065, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 235.791, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 100, "episodes_total": 0, "training_iteration": 1, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-39-52", "timestamp": 1585863592, "time_this_iter_s": 2.046480417251587, "time_total_s": 2.046480417251587, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 2.046480417251587, "timesteps_since_restore": 100, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 7.0, "ram_util_percent": 72.3}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 0.001387897999357628, "episode_reward_min": 0.001387897999357628, "episode_reward_mean": 0.001387897999357628, "episode_len_mean": 101.0, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": 0.001387897999357628, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 0.001387897999357628, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 0.001387897999357628, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.8220018431350096, "avg_speed_min": 3.8220018431350096, "avg_speed_max": 3.8220018431350096, "avg_rl_veh_arrival_mean": 102.0, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 102.0}, "sampler_perf": {"mean_env_wait_ms": 9.616486468718419, "mean_processing_ms": 5.889900881259596, "mean_inference_ms": 0.803418420440522}, "off_policy_estimator": {}, "info": {"num_target_updates": 2, "num_steps_trained": 0, "num_steps_sampled": 200, "sample_time_ms": 1659.602, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 120.315, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 200, "episodes_total": 1, "training_iteration": 2, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-39-54", "timestamp": 1585863594, "time_this_iter_s": 1.7321078777313232, "time_total_s": 3.77858829498291, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 3.77858829498291, "timesteps_since_restore": 200, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 18.366666666666664, "ram_util_percent": 72.3}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 0.001387897999357628, "episode_reward_min": 0.001387897999357628, "episode_reward_mean": 0.001387897999357628, "episode_len_mean": 101.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": 0.001387897999357628, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 0.001387897999357628, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 0.001387897999357628, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.8220018431350096, "avg_speed_min": 3.8220018431350096, "avg_speed_max": 3.8220018431350096, "avg_rl_veh_arrival_mean": 102.0, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 102.0}, "sampler_perf": {"mean_env_wait_ms": 9.616486468718419, "mean_processing_ms": 5.889900881259596, "mean_inference_ms": 0.803418420440522}, "off_policy_estimator": {}, "info": {"num_target_updates": 3, "num_steps_trained": 0, "num_steps_sampled": 300, "sample_time_ms": 1329.415, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 82.003, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 300, "episodes_total": 1, "training_iteration": 3, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-39-54", "timestamp": 1585863594, "time_this_iter_s": 0.6766724586486816, "time_total_s": 4.455260753631592, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 4.455260753631592, "timesteps_since_restore": 300, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 13.1, "ram_util_percent": 72.3}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 0.001387897999357628, "episode_reward_min": 0.001387897999357628, "episode_reward_mean": 0.001387897999357628, "episode_len_mean": 101.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": 0.001387897999357628, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 0.001387897999357628, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 0.001387897999357628, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.8220018431350096, "avg_speed_min": 3.8220018431350096, "avg_speed_max": 3.8220018431350096, "avg_rl_veh_arrival_mean": 102.0, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 102.0}, "sampler_perf": {"mean_env_wait_ms": 9.616486468718419, "mean_processing_ms": 5.889900881259596, "mean_inference_ms": 0.803418420440522}, "off_policy_estimator": {}, "info": {"num_target_updates": 4, "num_steps_trained": 0, "num_steps_sampled": 400, "sample_time_ms": 1212.608, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 62.603, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 400, "episodes_total": 1, "training_iteration": 4, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-39-55", "timestamp": 1585863595, "time_this_iter_s": 0.8694331645965576, "time_total_s": 5.324693918228149, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 5.324693918228149, "timesteps_since_restore": 400, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 27.6, "ram_util_percent": 72.4}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 0.001387897999357628, "episode_reward_min": 0.001387897999357628, "episode_reward_mean": 0.001387897999357628, "episode_len_mean": 101.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": 0.001387897999357628, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 0.001387897999357628, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 0.001387897999357628, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.8220018431350096, "avg_speed_min": 3.8220018431350096, "avg_speed_max": 3.8220018431350096, "avg_rl_veh_arrival_mean": 102.0, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 102.0}, "sampler_perf": {"mean_env_wait_ms": 9.616486468718419, "mean_processing_ms": 5.889900881259596, "mean_inference_ms": 0.803418420440522}, "off_policy_estimator": {}, "info": {"num_target_updates": 5, "num_steps_trained": 0, "num_steps_sampled": 500, "sample_time_ms": 1092.013, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 50.902, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 500, "episodes_total": 1, "training_iteration": 5, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-39-56", "timestamp": 1585863596, "time_this_iter_s": 0.6162362098693848, "time_total_s": 5.940930128097534, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 5.940930128097534, "timesteps_since_restore": 500, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 19.8, "ram_util_percent": 72.4}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 0.001387897999357628, "episode_reward_min": 0.001387897999357628, "episode_reward_mean": 0.001387897999357628, "episode_len_mean": 101.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": 0.001387897999357628, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 0.001387897999357628, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 0.001387897999357628, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.8220018431350096, "avg_speed_min": 3.8220018431350096, "avg_speed_max": 3.8220018431350096, "avg_rl_veh_arrival_mean": 102.0, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 102.0}, "sampler_perf": {"mean_env_wait_ms": 9.616486468718419, "mean_processing_ms": 5.889900881259596, "mean_inference_ms": 0.803418420440522}, "off_policy_estimator": {}, "info": {"num_target_updates": 6, "num_steps_trained": 0, "num_steps_sampled": 600, "sample_time_ms": 1004.82, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 43.191, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 600, "episodes_total": 1, "training_iteration": 6, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-39-57", "timestamp": 1585863597, "time_this_iter_s": 0.5759384632110596, "time_total_s": 6.516868591308594, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 6.516868591308594, "timesteps_since_restore": 600, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 16.2, "ram_util_percent": 72.4}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.06638848458254, "episode_reward_min": 0.001387897999357628, "episode_reward_mean": 12.533888191290949, "episode_len_mean": 300.5, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": 0.001387897999357628, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.06638848458254, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 12.533888191290949, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.055618654836544, "avg_speed_min": 3.8220018431350096, "avg_speed_max": 6.289235466538078, "avg_rl_veh_arrival_mean": 134.0, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 166.0}, "sampler_perf": {"mean_env_wait_ms": 8.123246278444093, "mean_processing_ms": 4.7228631233412806, "mean_inference_ms": 0.7860739709415521}, "off_policy_estimator": {}, "info": {"num_target_updates": 7, "num_steps_trained": 0, "num_steps_sampled": 700, "sample_time_ms": 1122.095, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 37.88, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 700, "episodes_total": 2, "training_iteration": 7, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-39-58", "timestamp": 1585863598, "time_this_iter_s": 1.834989070892334, "time_total_s": 8.351857662200928, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 8.351857662200928, "timesteps_since_restore": 700, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 9.633333333333333, "ram_util_percent": 72.4}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.06638848458254, "episode_reward_min": 0.001387897999357628, "episode_reward_mean": 12.533888191290949, "episode_len_mean": 300.5, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": 0.001387897999357628, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.06638848458254, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 12.533888191290949, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.055618654836544, "avg_speed_min": 3.8220018431350096, "avg_speed_max": 6.289235466538078, "avg_rl_veh_arrival_mean": 134.0, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 166.0}, "sampler_perf": {"mean_env_wait_ms": 8.123246278444093, "mean_processing_ms": 4.7228631233412806, "mean_inference_ms": 0.7860739709415521}, "off_policy_estimator": {}, "info": {"num_target_updates": 8, "num_steps_trained": 0, "num_steps_sampled": 800, "sample_time_ms": 1068.635, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 33.864, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 800, "episodes_total": 2, "training_iteration": 8, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-39-59", "timestamp": 1585863599, "time_this_iter_s": 0.7029283046722412, "time_total_s": 9.054785966873169, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 9.054785966873169, "timesteps_since_restore": 800, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 14.0, "ram_util_percent": 72.4}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.06638848458254, "episode_reward_min": 0.001387897999357628, "episode_reward_mean": 12.533888191290949, "episode_len_mean": 300.5, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": 0.001387897999357628, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.06638848458254, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 12.533888191290949, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.055618654836544, "avg_speed_min": 3.8220018431350096, "avg_speed_max": 6.289235466538078, "avg_rl_veh_arrival_mean": 134.0, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 166.0}, "sampler_perf": {"mean_env_wait_ms": 8.123246278444093, "mean_processing_ms": 4.7228631233412806, "mean_inference_ms": 0.7860739709415521}, "off_policy_estimator": {}, "info": {"num_target_updates": 9, "num_steps_trained": 0, "num_steps_sampled": 900, "sample_time_ms": 1028.22, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 30.584, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 900, "episodes_total": 2, "training_iteration": 9, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-00", "timestamp": 1585863600, "time_this_iter_s": 0.711836576461792, "time_total_s": 9.766622543334961, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 9.766622543334961, "timesteps_since_restore": 900, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 24.7, "ram_util_percent": 72.4}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.06638848458254, "episode_reward_min": 0.001387897999357628, "episode_reward_mean": 12.533888191290949, "episode_len_mean": 300.5, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": 0.001387897999357628, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.06638848458254, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 12.533888191290949, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.055618654836544, "avg_speed_min": 3.8220018431350096, "avg_speed_max": 6.289235466538078, "avg_rl_veh_arrival_mean": 134.0, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 166.0}, "sampler_perf": {"mean_env_wait_ms": 8.123246278444093, "mean_processing_ms": 4.7228631233412806, "mean_inference_ms": 0.7860739709415521}, "off_policy_estimator": {}, "info": {"num_target_updates": 10, "num_steps_trained": 0, "num_steps_sampled": 1000, "sample_time_ms": 992.718, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 27.987, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 1000, "episodes_total": 2, "training_iteration": 10, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-01", "timestamp": 1585863601, "time_this_iter_s": 0.6804726123809814, "time_total_s": 10.447095155715942, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 10.447095155715942, "timesteps_since_restore": 1000, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 31.1, "ram_util_percent": 72.5}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.06638848458254, "episode_reward_min": 0.001387897999357628, "episode_reward_mean": 12.533888191290949, "episode_len_mean": 300.5, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": 0.001387897999357628, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.06638848458254, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 12.533888191290949, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.055618654836544, "avg_speed_min": 3.8220018431350096, "avg_speed_max": 6.289235466538078, "avg_rl_veh_arrival_mean": 134.0, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 166.0}, "sampler_perf": {"mean_env_wait_ms": 8.123246278444093, "mean_processing_ms": 4.7228631233412806, "mean_inference_ms": 0.7860739709415521}, "off_policy_estimator": {}, "info": {"num_target_updates": 11, "num_steps_trained": 0, "num_steps_sampled": 1100, "sample_time_ms": 906.628, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.946, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 1100, "episodes_total": 2, "training_iteration": 11, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-01", "timestamp": 1585863601, "time_this_iter_s": 0.7418596744537354, "time_total_s": 11.188954830169678, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 11.188954830169678, "timesteps_since_restore": 1100, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 31.7, "ram_util_percent": 72.5}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": 0.001387897999357628, "episode_reward_mean": 16.71332739914151, "episode_len_mean": 367.0, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": 0.001387897999357628, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 16.71332739914151, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.440335131491512, "avg_speed_min": 3.8220018431350096, "avg_speed_max": 6.289235466538078, "avg_rl_veh_arrival_mean": 147.33333333333334, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 174.0}, "sampler_perf": {"mean_env_wait_ms": 7.446685579099619, "mean_processing_ms": 4.191811740687457, "mean_inference_ms": 0.7818493449935916}, "off_policy_estimator": {}, "info": {"num_target_updates": 12, "num_steps_trained": 0, "num_steps_sampled": 1200, "sample_time_ms": 901.995, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.897, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 1200, "episodes_total": 3, "training_iteration": 12, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-03", "timestamp": 1585863603, "time_this_iter_s": 1.6851181983947754, "time_total_s": 12.874073028564453, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 12.874073028564453, "timesteps_since_restore": 1200, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 5.0, "ram_util_percent": 72.5}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": 0.001387897999357628, "episode_reward_mean": 16.71332739914151, "episode_len_mean": 367.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": 0.001387897999357628, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 16.71332739914151, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.440335131491512, "avg_speed_min": 3.8220018431350096, "avg_speed_max": 6.289235466538078, "avg_rl_veh_arrival_mean": 147.33333333333334, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 174.0}, "sampler_perf": {"mean_env_wait_ms": 7.446685579099619, "mean_processing_ms": 4.191811740687457, "mean_inference_ms": 0.7818493449935917}, "off_policy_estimator": {}, "info": {"num_target_updates": 13, "num_steps_trained": 0, "num_steps_sampled": 1300, "sample_time_ms": 898.598, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.799, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 1300, "episodes_total": 3, "training_iteration": 13, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-04", "timestamp": 1585863604, "time_this_iter_s": 0.6422016620635986, "time_total_s": 13.516274690628052, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 13.516274690628052, "timesteps_since_restore": 1300, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 10.5, "ram_util_percent": 72.5}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": 0.001387897999357628, "episode_reward_mean": 16.71332739914151, "episode_len_mean": 367.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": 0.001387897999357628, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 16.71332739914151, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.440335131491512, "avg_speed_min": 3.8220018431350096, "avg_speed_max": 6.289235466538078, "avg_rl_veh_arrival_mean": 147.33333333333334, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 174.0}, "sampler_perf": {"mean_env_wait_ms": 7.446685579099619, "mean_processing_ms": 4.191811740687457, "mean_inference_ms": 0.7818493449935917}, "off_policy_estimator": {}, "info": {"num_target_updates": 14, "num_steps_trained": 0, "num_steps_sampled": 1400, "sample_time_ms": 866.002, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.852, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 1400, "episodes_total": 3, "training_iteration": 14, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-04", "timestamp": 1585863604, "time_this_iter_s": 0.5436408519744873, "time_total_s": 14.059915542602539, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 14.059915542602539, "timesteps_since_restore": 1400, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 9.5, "ram_util_percent": 72.5}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": 0.001387897999357628, "episode_reward_mean": 16.71332739914151, "episode_len_mean": 367.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": 0.001387897999357628, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 16.71332739914151, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.440335131491512, "avg_speed_min": 3.8220018431350096, "avg_speed_max": 6.289235466538078, "avg_rl_veh_arrival_mean": 147.33333333333334, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 174.0}, "sampler_perf": {"mean_env_wait_ms": 7.446685579099619, "mean_processing_ms": 4.191811740687457, "mean_inference_ms": 0.7818493449935917}, "off_policy_estimator": {}, "info": {"num_target_updates": 15, "num_steps_trained": 0, "num_steps_sampled": 1500, "sample_time_ms": 859.276, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.878, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 1500, "episodes_total": 3, "training_iteration": 15, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-05", "timestamp": 1585863605, "time_this_iter_s": 0.5489728450775146, "time_total_s": 14.608888387680054, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 14.608888387680054, "timesteps_since_restore": 1500, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 9.7, "ram_util_percent": 72.5}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": 0.001387897999357628, "episode_reward_mean": 16.71332739914151, "episode_len_mean": 367.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": 0.001387897999357628, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 16.71332739914151, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.440335131491512, "avg_speed_min": 3.8220018431350096, "avg_speed_max": 6.289235466538078, "avg_rl_veh_arrival_mean": 147.33333333333334, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 174.0}, "sampler_perf": {"mean_env_wait_ms": 7.446685579099619, "mean_processing_ms": 4.191811740687457, "mean_inference_ms": 0.7818493449935917}, "off_policy_estimator": {}, "info": {"num_target_updates": 16, "num_steps_trained": 0, "num_steps_sampled": 1600, "sample_time_ms": 860.117, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.827, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 1600, "episodes_total": 3, "training_iteration": 16, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-05", "timestamp": 1585863605, "time_this_iter_s": 0.5834579467773438, "time_total_s": 15.192346334457397, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 15.192346334457397, "timesteps_since_restore": 1600, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 12.1, "ram_util_percent": 72.6}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": 0.001387897999357628, "episode_reward_mean": 18.80275782789895, "episode_len_mean": 400.25, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": 0.001387897999357628, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 18.80275782789895, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.408904695580592, "avg_speed_min": 3.8220018431350096, "avg_speed_max": 6.289235466538078, "avg_rl_veh_arrival_mean": 156.75, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 185.0}, "sampler_perf": {"mean_env_wait_ms": 7.004120497625366, "mean_processing_ms": 3.877094296181107, "mean_inference_ms": 0.7673708885342468}, "off_policy_estimator": {}, "info": {"num_target_updates": 17, "num_steps_trained": 0, "num_steps_sampled": 1700, "sample_time_ms": 848.367, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.662, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 1700, "episodes_total": 4, "training_iteration": 17, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-07", "timestamp": 1585863607, "time_this_iter_s": 1.7157692909240723, "time_total_s": 16.90811562538147, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 16.90811562538147, "timesteps_since_restore": 1700, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 6.2, "ram_util_percent": 72.6}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 14.44666417661968, "episode_len_mean": 349.2, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 14.44666417661968, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.2, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.080768866412969, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.289235466538078, "avg_rl_veh_arrival_mean": 225.4, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.732377924014105, "mean_processing_ms": 3.7838886626193426, "mean_inference_ms": 0.757574709846226}, "off_policy_estimator": {}, "info": {"num_target_updates": 18, "num_steps_trained": 0, "num_steps_sampled": 1800, "sample_time_ms": 954.566, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.641, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 1800, "episodes_total": 5, "training_iteration": 18, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-09", "timestamp": 1585863609, "time_this_iter_s": 1.764955997467041, "time_total_s": 18.67307162284851, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 18.67307162284851, "timesteps_since_restore": 1800, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 8.2, "ram_util_percent": 72.6}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 14.44666417661968, "episode_len_mean": 349.2, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 14.44666417661968, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.2, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.080768866412969, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.289235466538078, "avg_rl_veh_arrival_mean": 225.4, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.732377924014105, "mean_processing_ms": 3.7838886626193426, "mean_inference_ms": 0.757574709846226}, "off_policy_estimator": {}, "info": {"num_target_updates": 19, "num_steps_trained": 0, "num_steps_sampled": 1900, "sample_time_ms": 946.075, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.817, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 1900, "episodes_total": 5, "training_iteration": 19, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-10", "timestamp": 1585863610, "time_this_iter_s": 0.6284267902374268, "time_total_s": 19.301498413085938, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 19.301498413085938, "timesteps_since_restore": 1900, "iterations_since_restore": 19, "perf": {}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 14.44666417661968, "episode_len_mean": 349.2, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 14.44666417661968, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.2, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.080768866412969, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.289235466538078, "avg_rl_veh_arrival_mean": 225.4, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.732377924014105, "mean_processing_ms": 3.7838886626193426, "mean_inference_ms": 0.757574709846226}, "off_policy_estimator": {}, "info": {"num_target_updates": 20, "num_steps_trained": 0, "num_steps_sampled": 2000, "sample_time_ms": 938.021, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.83, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 2000, "episodes_total": 5, "training_iteration": 20, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-10", "timestamp": 1585863610, "time_this_iter_s": 0.5995993614196777, "time_total_s": 19.901097774505615, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 19.901097774505615, "timesteps_since_restore": 2000, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 9.3, "ram_util_percent": 72.6}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 14.44666417661968, "episode_len_mean": 349.2, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 14.44666417661968, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.2, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.080768866412969, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.289235466538078, "avg_rl_veh_arrival_mean": 225.4, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.732377924014105, "mean_processing_ms": 3.7838886626193426, "mean_inference_ms": 0.757574709846226}, "off_policy_estimator": {}, "info": {"num_target_updates": 21, "num_steps_trained": 0, "num_steps_sampled": 2100, "sample_time_ms": 920.45, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.719, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 2100, "episodes_total": 5, "training_iteration": 21, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-11", "timestamp": 1585863611, "time_this_iter_s": 0.566901683807373, "time_total_s": 20.46799945831299, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 20.46799945831299, "timesteps_since_restore": 2100, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 10.0, "ram_util_percent": 72.6}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 14.44666417661968, "episode_len_mean": 349.2, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 14.44666417661968, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.2, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.080768866412969, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.289235466538078, "avg_rl_veh_arrival_mean": 225.4, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.732377924014105, "mean_processing_ms": 3.7838886626193426, "mean_inference_ms": 0.757574709846226}, "off_policy_estimator": {}, "info": {"num_target_updates": 22, "num_steps_trained": 0, "num_steps_sampled": 2200, "sample_time_ms": 805.922, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 6.059, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 2200, "episodes_total": 5, "training_iteration": 22, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-11", "timestamp": 1585863611, "time_this_iter_s": 0.5525481700897217, "time_total_s": 21.02054762840271, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 21.02054762840271, "timesteps_since_restore": 2200, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 13.4, "ram_util_percent": 72.6}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 16.21750342580658, "episode_len_mean": 374.3333333333333, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 16.21750342580658, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.16666666666666666, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.19756099900136, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.289235466538078, "avg_rl_veh_arrival_mean": 225.83333333333334, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.510422542419287, "mean_processing_ms": 3.687387174828542, "mean_inference_ms": 0.7458634572869429}, "off_policy_estimator": {}, "info": {"num_target_updates": 23, "num_steps_trained": 0, "num_steps_sampled": 2300, "sample_time_ms": 902.869, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 6.071, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 2300, "episodes_total": 6, "training_iteration": 23, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-13", "timestamp": 1585863613, "time_this_iter_s": 1.6130094528198242, "time_total_s": 22.633557081222534, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 22.633557081222534, "timesteps_since_restore": 2300, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 5.3999999999999995, "ram_util_percent": 72.6}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 16.21750342580658, "episode_len_mean": 374.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 16.21750342580658, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.16666666666666666, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.197560999001359, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.289235466538078, "avg_rl_veh_arrival_mean": 225.83333333333334, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.510422542419287, "mean_processing_ms": 3.687387174828542, "mean_inference_ms": 0.745863457286943}, "off_policy_estimator": {}, "info": {"num_target_updates": 24, "num_steps_trained": 0, "num_steps_sampled": 2400, "sample_time_ms": 909.488, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 6.048, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 2400, "episodes_total": 6, "training_iteration": 24, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-14", "timestamp": 1585863614, "time_this_iter_s": 0.6093175411224365, "time_total_s": 23.24287462234497, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 23.24287462234497, "timesteps_since_restore": 2400, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 6.9, "ram_util_percent": 72.6}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 16.21750342580658, "episode_len_mean": 374.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 16.21750342580658, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.16666666666666666, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.197560999001359, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.289235466538078, "avg_rl_veh_arrival_mean": 225.83333333333334, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.510422542419287, "mean_processing_ms": 3.687387174828542, "mean_inference_ms": 0.745863457286943}, "off_policy_estimator": {}, "info": {"num_target_updates": 25, "num_steps_trained": 0, "num_steps_sampled": 2500, "sample_time_ms": 911.602, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 6.053, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 2500, "episodes_total": 6, "training_iteration": 25, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-14", "timestamp": 1585863614, "time_this_iter_s": 0.5703377723693848, "time_total_s": 23.813212394714355, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 23.813212394714355, "timesteps_since_restore": 2500, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 9.3, "ram_util_percent": 72.6}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 16.21750342580658, "episode_len_mean": 374.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 16.21750342580658, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.16666666666666666, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.197560999001359, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.289235466538078, "avg_rl_veh_arrival_mean": 225.83333333333334, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.510422542419287, "mean_processing_ms": 3.687387174828542, "mean_inference_ms": 0.745863457286943}, "off_policy_estimator": {}, "info": {"num_target_updates": 26, "num_steps_trained": 0, "num_steps_sampled": 2600, "sample_time_ms": 909.222, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 6.108, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 2600, "episodes_total": 6, "training_iteration": 26, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-15", "timestamp": 1585863615, "time_this_iter_s": 0.5607309341430664, "time_total_s": 24.373943328857422, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 24.373943328857422, "timesteps_since_restore": 2600, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 8.8, "ram_util_percent": 72.6}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 16.21750342580658, "episode_len_mean": 374.3333333333333, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 16.21750342580658, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.16666666666666666, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.197560999001359, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.289235466538078, "avg_rl_veh_arrival_mean": 225.83333333333334, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.510422542419287, "mean_processing_ms": 3.687387174828542, "mean_inference_ms": 0.745863457286943}, "off_policy_estimator": {}, "info": {"num_target_updates": 27, "num_steps_trained": 0, "num_steps_sampled": 2700, "sample_time_ms": 793.438, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 6.127, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 2700, "episodes_total": 6, "training_iteration": 27, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-15", "timestamp": 1585863615, "time_this_iter_s": 0.5572311878204346, "time_total_s": 24.931174516677856, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 24.931174516677856, "timesteps_since_restore": 2700, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 9.2, "ram_util_percent": 72.6}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 17.481534307219285, "episode_len_mean": 392.2857142857143, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 17.481534307219285, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.14285714285714285, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.391962810637309, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 218.57142857142858, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.3281065609999745, "mean_processing_ms": 3.5993054292762214, "mean_inference_ms": 0.734701620296576}, "off_policy_estimator": {}, "info": {"num_target_updates": 28, "num_steps_trained": 0, "num_steps_sampled": 2800, "sample_time_ms": 778.414, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.978, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 2800, "episodes_total": 7, "training_iteration": 28, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-17", "timestamp": 1585863617, "time_this_iter_s": 1.6162207126617432, "time_total_s": 26.5473952293396, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 26.5473952293396, "timesteps_since_restore": 2800, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 7.35, "ram_util_percent": 72.6}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 17.481534307219285, "episode_len_mean": 392.2857142857143, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 17.481534307219285, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.14285714285714285, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.391962810637309, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 218.57142857142858, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.328106560999973, "mean_processing_ms": 3.599305429276221, "mean_inference_ms": 0.734701620296576}, "off_policy_estimator": {}, "info": {"num_target_updates": 29, "num_steps_trained": 0, "num_steps_sampled": 2900, "sample_time_ms": 785.998, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.925, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 2900, "episodes_total": 7, "training_iteration": 29, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-18", "timestamp": 1585863618, "time_this_iter_s": 0.704268217086792, "time_total_s": 27.25166344642639, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 27.25166344642639, "timesteps_since_restore": 2900, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 12.6, "ram_util_percent": 72.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 17.481534307219285, "episode_len_mean": 392.2857142857143, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 17.481534307219285, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.14285714285714285, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.391962810637309, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 218.57142857142858, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.328106560999973, "mean_processing_ms": 3.599305429276221, "mean_inference_ms": 0.734701620296576}, "off_policy_estimator": {}, "info": {"num_target_updates": 30, "num_steps_trained": 0, "num_steps_sampled": 3000, "sample_time_ms": 785.65, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.93, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 3000, "episodes_total": 7, "training_iteration": 30, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-18", "timestamp": 1585863618, "time_this_iter_s": 0.5962779521942139, "time_total_s": 27.847941398620605, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 27.847941398620605, "timesteps_since_restore": 3000, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 13.0, "ram_util_percent": 72.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 17.481534307219285, "episode_len_mean": 392.2857142857143, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 17.481534307219285, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.14285714285714285, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.391962810637309, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 218.57142857142858, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.328106560999973, "mean_processing_ms": 3.599305429276221, "mean_inference_ms": 0.734701620296576}, "off_policy_estimator": {}, "info": {"num_target_updates": 31, "num_steps_trained": 0, "num_steps_sampled": 3100, "sample_time_ms": 785.226, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 6.006, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 3100, "episodes_total": 7, "training_iteration": 31, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-27", "timestamp": 1585863627, "time_this_iter_s": 0.5621302127838135, "time_total_s": 28.41007161140442, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 28.41007161140442, "timesteps_since_restore": 3100, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 3.4153846153846152, "ram_util_percent": 72.70000000000002}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 17.481534307219285, "episode_len_mean": 392.2857142857143, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 17.481534307219285, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.14285714285714285, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.391962810637309, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 218.57142857142858, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.328106560999973, "mean_processing_ms": 3.599305429276221, "mean_inference_ms": 0.734701620296576}, "off_policy_estimator": {}, "info": {"num_target_updates": 32, "num_steps_trained": 0, "num_steps_sampled": 3200, "sample_time_ms": 788.404, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.734, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 3200, "episodes_total": 7, "training_iteration": 32, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-28", "timestamp": 1585863628, "time_this_iter_s": 0.5719633102416992, "time_total_s": 28.982034921646118, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 28.982034921646118, "timesteps_since_restore": 3200, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 9.1, "ram_util_percent": 72.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 18.430190424935596, "episode_len_mean": 405.75, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 18.430190424935596, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.125, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.521255772380012, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 216.0, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.181875179957684, "mean_processing_ms": 3.52207494163436, "mean_inference_ms": 0.7250811039884388}, "off_policy_estimator": {}, "info": {"num_target_updates": 33, "num_steps_trained": 0, "num_steps_sampled": 3300, "sample_time_ms": 792.468, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.718, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 3300, "episodes_total": 8, "training_iteration": 33, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-30", "timestamp": 1585863630, "time_this_iter_s": 1.652327060699463, "time_total_s": 30.63436198234558, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 30.63436198234558, "timesteps_since_restore": 3300, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 5.9, "ram_util_percent": 72.65}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 18.430190424935596, "episode_len_mean": 405.75, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 18.430190424935596, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.125, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.521255772380012, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 216.0, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.181875179957684, "mean_processing_ms": 3.5220749416343597, "mean_inference_ms": 0.7250811039884388}, "off_policy_estimator": {}, "info": {"num_target_updates": 34, "num_steps_trained": 0, "num_steps_sampled": 3400, "sample_time_ms": 794.125, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.701, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 3400, "episodes_total": 8, "training_iteration": 34, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-30", "timestamp": 1585863630, "time_this_iter_s": 0.625648021697998, "time_total_s": 31.26001000404358, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 31.26001000404358, "timesteps_since_restore": 3400, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 10.2, "ram_util_percent": 72.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 18.430190424935596, "episode_len_mean": 405.75, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 18.430190424935596, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.125, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.521255772380012, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 216.0, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.181875179957684, "mean_processing_ms": 3.5220749416343597, "mean_inference_ms": 0.7250811039884388}, "off_policy_estimator": {}, "info": {"num_target_updates": 35, "num_steps_trained": 0, "num_steps_sampled": 3500, "sample_time_ms": 806.753, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.692, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 3500, "episodes_total": 8, "training_iteration": 35, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-31", "timestamp": 1585863631, "time_this_iter_s": 0.6963083744049072, "time_total_s": 31.956318378448486, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 31.956318378448486, "timesteps_since_restore": 3500, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 13.8, "ram_util_percent": 72.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 18.430190424935596, "episode_len_mean": 405.75, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 18.430190424935596, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.125, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.521255772380012, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 216.0, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.181875179957684, "mean_processing_ms": 3.5220749416343597, "mean_inference_ms": 0.7250811039884388}, "off_policy_estimator": {}, "info": {"num_target_updates": 36, "num_steps_trained": 0, "num_steps_sampled": 3600, "sample_time_ms": 805.044, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.635, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 3600, "episodes_total": 8, "training_iteration": 36, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-31", "timestamp": 1585863631, "time_this_iter_s": 0.5426144599914551, "time_total_s": 32.49893283843994, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 32.49893283843994, "timesteps_since_restore": 3600, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 13.2, "ram_util_percent": 72.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 18.430190424935596, "episode_len_mean": 405.75, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 18.430190424935596, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.125, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.521255772380012, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 216.0, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.181875179957684, "mean_processing_ms": 3.5220749416343597, "mean_inference_ms": 0.7250811039884388}, "off_policy_estimator": {}, "info": {"num_target_updates": 37, "num_steps_trained": 0, "num_steps_sampled": 3700, "sample_time_ms": 804.369, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.646, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 3700, "episodes_total": 8, "training_iteration": 37, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-32", "timestamp": 1585863632, "time_this_iter_s": 0.5508735179901123, "time_total_s": 33.049806356430054, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 33.049806356430054, "timesteps_since_restore": 3700, "iterations_since_restore": 37, "perf": {}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 19.16809997429287, "episode_len_mean": 416.22222222222223, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 19.16809997429287, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.1111111111111111, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.59104198274465, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 213.55555555555554, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.062603080962961, "mean_processing_ms": 3.4567035410211053, "mean_inference_ms": 0.7167305687364983}, "off_policy_estimator": {}, "info": {"num_target_updates": 38, "num_steps_trained": 0, "num_steps_sampled": 3800, "sample_time_ms": 817.477, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.713, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 3800, "episodes_total": 9, "training_iteration": 38, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-34", "timestamp": 1585863634, "time_this_iter_s": 1.7449777126312256, "time_total_s": 34.79478406906128, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 34.79478406906128, "timesteps_since_restore": 3800, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 5.233333333333333, "ram_util_percent": 72.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 19.16809997429287, "episode_len_mean": 416.22222222222223, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 19.16809997429287, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.1111111111111111, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.59104198274465, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 213.55555555555554, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.062603080962961, "mean_processing_ms": 3.4567035410211044, "mean_inference_ms": 0.7167305687364981}, "off_policy_estimator": {}, "info": {"num_target_updates": 39, "num_steps_trained": 0, "num_steps_sampled": 3900, "sample_time_ms": 809.419, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.681, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 3900, "episodes_total": 9, "training_iteration": 39, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-34", "timestamp": 1585863634, "time_this_iter_s": 0.6230185031890869, "time_total_s": 35.417802572250366, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 35.417802572250366, "timesteps_since_restore": 3900, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 9.4, "ram_util_percent": 72.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 19.16809997429287, "episode_len_mean": 416.22222222222223, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 19.16809997429287, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.1111111111111111, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.59104198274465, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 213.55555555555554, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.062603080962961, "mean_processing_ms": 3.4567035410211044, "mean_inference_ms": 0.7167305687364981}, "off_policy_estimator": {}, "info": {"num_target_updates": 40, "num_steps_trained": 0, "num_steps_sampled": 4000, "sample_time_ms": 802.999, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.657, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 4000, "episodes_total": 9, "training_iteration": 40, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-35", "timestamp": 1585863635, "time_this_iter_s": 0.5320122241973877, "time_total_s": 35.949814796447754, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 35.949814796447754, "timesteps_since_restore": 4000, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 9.7, "ram_util_percent": 72.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 19.16809997429287, "episode_len_mean": 416.22222222222223, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 19.16809997429287, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.1111111111111111, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.59104198274465, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 213.55555555555554, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.062603080962961, "mean_processing_ms": 3.4567035410211044, "mean_inference_ms": 0.7167305687364981}, "off_policy_estimator": {}, "info": {"num_target_updates": 41, "num_steps_trained": 0, "num_steps_sampled": 4100, "sample_time_ms": 806.7, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.577, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 4100, "episodes_total": 9, "training_iteration": 41, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-36", "timestamp": 1585863636, "time_this_iter_s": 0.5977416038513184, "time_total_s": 36.54755640029907, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 36.54755640029907, "timesteps_since_restore": 4100, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 14.9, "ram_util_percent": 72.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 19.16809997429287, "episode_len_mean": 416.22222222222223, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 19.16809997429287, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.1111111111111111, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.59104198274465, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 213.55555555555554, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.062603080962961, "mean_processing_ms": 3.4567035410211044, "mean_inference_ms": 0.7167305687364981}, "off_policy_estimator": {}, "info": {"num_target_updates": 42, "num_steps_trained": 0, "num_steps_sampled": 4200, "sample_time_ms": 800.355, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.818, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 4200, "episodes_total": 9, "training_iteration": 42, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-36", "timestamp": 1585863636, "time_this_iter_s": 0.5104880332946777, "time_total_s": 37.05804443359375, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 37.05804443359375, "timesteps_since_restore": 4200, "iterations_since_restore": 42, "perf": {}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 19.757919534018086, "episode_len_mean": 424.6, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 19.757919534018086, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.661790575795367, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 208.5, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.256777940643596, "mean_processing_ms": 3.3989171410325625, "mean_inference_ms": 0.709464885773241}, "off_policy_estimator": {}, "info": {"num_target_updates": 43, "num_steps_trained": 0, "num_steps_sampled": 4300, "sample_time_ms": 2079.444, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.828, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 4300, "episodes_total": 10, "training_iteration": 43, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-51", "timestamp": 1585863651, "time_this_iter_s": 14.443294525146484, "time_total_s": 51.501338958740234, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 51.501338958740234, "timesteps_since_restore": 4300, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 4.066666666666667, "ram_util_percent": 72.70000000000002}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 19.757919534018086, "episode_len_mean": 424.6, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 19.757919534018086, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.661790575795366, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 208.5, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.256777940643596, "mean_processing_ms": 3.3989171410325625, "mean_inference_ms": 0.7094648857732408}, "off_policy_estimator": {}, "info": {"num_target_updates": 44, "num_steps_trained": 0, "num_steps_sampled": 4400, "sample_time_ms": 2081.601, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.881, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 4400, "episodes_total": 10, "training_iteration": 44, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-51", "timestamp": 1585863651, "time_this_iter_s": 0.6481144428253174, "time_total_s": 52.14945340156555, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 52.14945340156555, "timesteps_since_restore": 4400, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 9.6, "ram_util_percent": 72.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 19.757919534018086, "episode_len_mean": 424.6, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 19.757919534018086, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.661790575795366, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 208.5, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.256777940643596, "mean_processing_ms": 3.3989171410325625, "mean_inference_ms": 0.7094648857732408}, "off_policy_estimator": {}, "info": {"num_target_updates": 45, "num_steps_trained": 0, "num_steps_sampled": 4500, "sample_time_ms": 2077.259, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.931, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 4500, "episodes_total": 10, "training_iteration": 45, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-52", "timestamp": 1585863652, "time_this_iter_s": 0.6545124053955078, "time_total_s": 52.80396580696106, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 52.80396580696106, "timesteps_since_restore": 4500, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 12.4, "ram_util_percent": 72.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 19.757919534018086, "episode_len_mean": 424.6, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 19.757919534018086, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.661790575795366, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 208.5, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.256777940643596, "mean_processing_ms": 3.3989171410325625, "mean_inference_ms": 0.7094648857732408}, "off_policy_estimator": {}, "info": {"num_target_updates": 46, "num_steps_trained": 0, "num_steps_sampled": 4600, "sample_time_ms": 2074.38, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.609, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 4600, "episodes_total": 10, "training_iteration": 46, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-53", "timestamp": 1585863653, "time_this_iter_s": 0.521038293838501, "time_total_s": 53.32500410079956, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 53.32500410079956, "timesteps_since_restore": 4600, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 14.2, "ram_util_percent": 72.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 19.757919534018086, "episode_len_mean": 424.6, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 19.757919534018086, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.661790575795366, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 208.5, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.256777940643596, "mean_processing_ms": 3.3989171410325625, "mean_inference_ms": 0.7094648857732408}, "off_policy_estimator": {}, "info": {"num_target_updates": 47, "num_steps_trained": 0, "num_steps_sampled": 4700, "sample_time_ms": 2071.226, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.57, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 4700, "episodes_total": 10, "training_iteration": 47, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-53", "timestamp": 1585863653, "time_this_iter_s": 0.5187969207763672, "time_total_s": 53.84380102157593, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 53.84380102157593, "timesteps_since_restore": 4700, "iterations_since_restore": 47, "perf": {}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 20.240433283263204, "episode_len_mean": 431.45454545454544, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 20.240433283263204, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.09090909090909091, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.7200554779527994, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 204.8181818181818, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.3827590708798825, "mean_processing_ms": 3.3477548933974175, "mean_inference_ms": 0.7029048626487507}, "off_policy_estimator": {}, "info": {"num_target_updates": 48, "num_steps_trained": 0, "num_steps_sampled": 4800, "sample_time_ms": 2062.048, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.541, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 4800, "episodes_total": 11, "training_iteration": 48, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-55", "timestamp": 1585863655, "time_this_iter_s": 1.6527948379516602, "time_total_s": 55.49659585952759, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 55.49659585952759, "timesteps_since_restore": 4800, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 5.5, "ram_util_percent": 72.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 20.240433283263204, "episode_len_mean": 431.45454545454544, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 20.240433283263204, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.09090909090909091, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.720055477952799, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 204.8181818181818, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.382759070879884, "mean_processing_ms": 3.3477548933974175, "mean_inference_ms": 0.7029048626487506}, "off_policy_estimator": {}, "info": {"num_target_updates": 49, "num_steps_trained": 0, "num_steps_sampled": 4900, "sample_time_ms": 2060.207, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.616, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 4900, "episodes_total": 11, "training_iteration": 49, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-55", "timestamp": 1585863655, "time_this_iter_s": 0.6053173542022705, "time_total_s": 56.10191321372986, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 56.10191321372986, "timesteps_since_restore": 4900, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 9.6, "ram_util_percent": 72.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 20.240433283263204, "episode_len_mean": 431.45454545454544, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 20.240433283263204, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.09090909090909091, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.720055477952799, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 204.8181818181818, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.382759070879884, "mean_processing_ms": 3.3477548933974175, "mean_inference_ms": 0.7029048626487506}, "off_policy_estimator": {}, "info": {"num_target_updates": 50, "num_steps_trained": 0, "num_steps_sampled": 5000, "sample_time_ms": 2067.549, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.569, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 5000, "episodes_total": 11, "training_iteration": 50, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-56", "timestamp": 1585863656, "time_this_iter_s": 0.6047766208648682, "time_total_s": 56.70668983459473, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 56.70668983459473, "timesteps_since_restore": 5000, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 14.8, "ram_util_percent": 72.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 20.240433283263204, "episode_len_mean": 431.45454545454544, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 20.240433283263204, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.09090909090909091, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.720055477952799, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 204.8181818181818, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.382759070879884, "mean_processing_ms": 3.3477548933974175, "mean_inference_ms": 0.7029048626487506}, "off_policy_estimator": {}, "info": {"num_target_updates": 51, "num_steps_trained": 0, "num_steps_sampled": 5100, "sample_time_ms": 2059.186, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.558, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 5100, "episodes_total": 11, "training_iteration": 51, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-57", "timestamp": 1585863657, "time_this_iter_s": 0.5139751434326172, "time_total_s": 57.220664978027344, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 57.220664978027344, "timesteps_since_restore": 5100, "iterations_since_restore": 51, "perf": {}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 20.240433283263204, "episode_len_mean": 431.45454545454544, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 20.240433283263204, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.09090909090909091, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.720055477952799, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 204.8181818181818, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.382759070879884, "mean_processing_ms": 3.3477548933974175, "mean_inference_ms": 0.7029048626487506}, "off_policy_estimator": {}, "info": {"num_target_updates": 52, "num_steps_trained": 0, "num_steps_sampled": 5200, "sample_time_ms": 2058.126, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.235, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 5200, "episodes_total": 11, "training_iteration": 52, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-57", "timestamp": 1585863657, "time_this_iter_s": 0.49647068977355957, "time_total_s": 57.7171356678009, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 57.7171356678009, "timesteps_since_restore": 5200, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 8.9, "ram_util_percent": 72.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 20.64252484415555, "episode_len_mean": 437.1666666666667, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 20.64252484415555, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.08333333333333333, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.756738710023645, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 203.83333333333334, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.462942814963175, "mean_processing_ms": 3.302178479963, "mean_inference_ms": 0.6970392244463467}, "off_policy_estimator": {}, "info": {"num_target_updates": 53, "num_steps_trained": 0, "num_steps_sampled": 5300, "sample_time_ms": 784.391, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.214, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 5300, "episodes_total": 12, "training_iteration": 53, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-40-59", "timestamp": 1585863659, "time_this_iter_s": 1.705824613571167, "time_total_s": 59.42296028137207, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 59.42296028137207, "timesteps_since_restore": 5300, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 7.5, "ram_util_percent": 72.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 20.64252484415555, "episode_len_mean": 437.1666666666667, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 20.64252484415555, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.08333333333333333, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.756738710023645, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 203.83333333333334, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.462942814963175, "mean_processing_ms": 3.302178479962999, "mean_inference_ms": 0.6970392244463466}, "off_policy_estimator": {}, "info": {"num_target_updates": 54, "num_steps_trained": 0, "num_steps_sampled": 5400, "sample_time_ms": 786.817, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.167, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 5400, "episodes_total": 12, "training_iteration": 54, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-03", "timestamp": 1585863663, "time_this_iter_s": 0.6719403266906738, "time_total_s": 60.094900608062744, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 60.094900608062744, "timesteps_since_restore": 5400, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 3.4499999999999997, "ram_util_percent": 72.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 20.64252484415555, "episode_len_mean": 437.1666666666667, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 20.64252484415555, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.08333333333333333, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.756738710023645, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 203.83333333333334, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.462942814963175, "mean_processing_ms": 3.302178479962999, "mean_inference_ms": 0.6970392244463466}, "off_policy_estimator": {}, "info": {"num_target_updates": 55, "num_steps_trained": 0, "num_steps_sampled": 5500, "sample_time_ms": 775.026, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.153, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 5500, "episodes_total": 12, "training_iteration": 55, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-04", "timestamp": 1585863664, "time_this_iter_s": 0.5354049205780029, "time_total_s": 60.63030552864075, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 60.63030552864075, "timesteps_since_restore": 5500, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 9.1, "ram_util_percent": 72.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 20.64252484415555, "episode_len_mean": 437.1666666666667, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 20.64252484415555, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.08333333333333333, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.756738710023645, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 203.83333333333334, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.462942814963175, "mean_processing_ms": 3.302178479962999, "mean_inference_ms": 0.6970392244463466}, "off_policy_estimator": {}, "info": {"num_target_updates": 56, "num_steps_trained": 0, "num_steps_sampled": 5600, "sample_time_ms": 781.54, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.542, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 5600, "episodes_total": 12, "training_iteration": 56, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-05", "timestamp": 1585863665, "time_this_iter_s": 0.5799679756164551, "time_total_s": 61.2102735042572, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 61.2102735042572, "timesteps_since_restore": 5600, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 9.4, "ram_util_percent": 72.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07220581484263, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 20.64252484415555, "episode_len_mean": 437.1666666666667, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07220581484263, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 20.64252484415555, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.08333333333333333, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.756738710023645, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 203.83333333333334, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.462942814963175, "mean_processing_ms": 3.302178479962999, "mean_inference_ms": 0.6970392244463466}, "off_policy_estimator": {}, "info": {"num_target_updates": 57, "num_steps_trained": 0, "num_steps_sampled": 5700, "sample_time_ms": 784.7, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.602, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 5700, "episodes_total": 12, "training_iteration": 57, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-05", "timestamp": 1585863665, "time_this_iter_s": 0.5506975650787354, "time_total_s": 61.76097106933594, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 61.76097106933594, "timesteps_since_restore": 5700, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 10.8, "ram_util_percent": 72.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07326995659898, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 20.98335139126658, "episode_len_mean": 442.0, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07326995659898, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 20.98335139126658, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07692307692307693, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.804545222586929, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 200.07692307692307, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.512259082757547, "mean_processing_ms": 3.2625293918458165, "mean_inference_ms": 0.6917705189060214}, "off_policy_estimator": {}, "info": {"num_target_updates": 58, "num_steps_trained": 0, "num_steps_sampled": 5800, "sample_time_ms": 791.44, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.633, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 5800, "episodes_total": 13, "training_iteration": 58, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-07", "timestamp": 1585863667, "time_this_iter_s": 1.7207391262054443, "time_total_s": 63.48171019554138, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 63.48171019554138, "timesteps_since_restore": 5800, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 7.85, "ram_util_percent": 72.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07326995659898, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 20.983351391266584, "episode_len_mean": 442.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07326995659898, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 20.983351391266584, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07692307692307693, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.804545222586929, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 200.07692307692307, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.512259082757547, "mean_processing_ms": 3.2625293918458165, "mean_inference_ms": 0.6917705189060214}, "off_policy_estimator": {}, "info": {"num_target_updates": 59, "num_steps_trained": 0, "num_steps_sampled": 5900, "sample_time_ms": 802.732, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.566, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 5900, "episodes_total": 13, "training_iteration": 59, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-08", "timestamp": 1585863668, "time_this_iter_s": 0.717418909072876, "time_total_s": 64.19912910461426, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 64.19912910461426, "timesteps_since_restore": 5900, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 12.9, "ram_util_percent": 72.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07326995659898, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 20.983351391266584, "episode_len_mean": 442.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07326995659898, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 20.983351391266584, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07692307692307693, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.804545222586929, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 200.07692307692307, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.512259082757547, "mean_processing_ms": 3.2625293918458165, "mean_inference_ms": 0.6917705189060214}, "off_policy_estimator": {}, "info": {"num_target_updates": 60, "num_steps_trained": 0, "num_steps_sampled": 6000, "sample_time_ms": 801.623, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.58, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 6000, "episodes_total": 13, "training_iteration": 60, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-08", "timestamp": 1585863668, "time_this_iter_s": 0.5937249660491943, "time_total_s": 64.79285407066345, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 64.79285407066345, "timesteps_since_restore": 6000, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 9.8, "ram_util_percent": 72.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07326995659898, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 20.983351391266584, "episode_len_mean": 442.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07326995659898, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 20.983351391266584, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07692307692307693, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.804545222586929, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 200.07692307692307, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.512259082757547, "mean_processing_ms": 3.2625293918458165, "mean_inference_ms": 0.6917705189060214}, "off_policy_estimator": {}, "info": {"num_target_updates": 61, "num_steps_trained": 0, "num_steps_sampled": 6100, "sample_time_ms": 810.62, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.636, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 6100, "episodes_total": 13, "training_iteration": 61, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-09", "timestamp": 1585863669, "time_this_iter_s": 0.6046605110168457, "time_total_s": 65.3975145816803, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 65.3975145816803, "timesteps_since_restore": 6100, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 9.2, "ram_util_percent": 72.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07326995659898, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 20.983351391266584, "episode_len_mean": 442.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07326995659898, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 20.983351391266584, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07692307692307693, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.804545222586929, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 200.07692307692307, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.512259082757547, "mean_processing_ms": 3.2625293918458165, "mean_inference_ms": 0.6917705189060214}, "off_policy_estimator": {}, "info": {"num_target_updates": 62, "num_steps_trained": 0, "num_steps_sampled": 6200, "sample_time_ms": 819.373, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.692, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 6200, "episodes_total": 13, "training_iteration": 62, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-09", "timestamp": 1585863669, "time_this_iter_s": 0.5850162506103516, "time_total_s": 65.98253083229065, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 65.98253083229065, "timesteps_since_restore": 6200, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 14.4, "ram_util_percent": 72.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.073414516496946, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 21.275498757354466, "episode_len_mean": 446.14285714285717, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.073414516496946, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.275498757354466, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07142857142857142, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.780637910884446, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 199.21428571428572, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.542069703580588, "mean_processing_ms": 3.2268676018366675, "mean_inference_ms": 0.6872146619182822}, "off_policy_estimator": {}, "info": {"num_target_updates": 63, "num_steps_trained": 0, "num_steps_sampled": 6300, "sample_time_ms": 819.135, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.759, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 6300, "episodes_total": 14, "training_iteration": 63, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-11", "timestamp": 1585863671, "time_this_iter_s": 1.7045619487762451, "time_total_s": 67.6870927810669, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 67.6870927810669, "timesteps_since_restore": 6300, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 5.949999999999999, "ram_util_percent": 72.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.073414516496946, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 21.275498757354466, "episode_len_mean": 446.14285714285717, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.073414516496946, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.275498757354466, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07142857142857142, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.780637910884446, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 199.21428571428572, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.542069703580588, "mean_processing_ms": 3.2268676018366675, "mean_inference_ms": 0.6872146619182822}, "off_policy_estimator": {}, "info": {"num_target_updates": 64, "num_steps_trained": 0, "num_steps_sampled": 6400, "sample_time_ms": 823.634, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.838, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 6400, "episodes_total": 14, "training_iteration": 64, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-12", "timestamp": 1585863672, "time_this_iter_s": 0.717740535736084, "time_total_s": 68.40483331680298, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 68.40483331680298, "timesteps_since_restore": 6400, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 8.8, "ram_util_percent": 72.8}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.073414516496946, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 21.275498757354466, "episode_len_mean": 446.14285714285717, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.073414516496946, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.275498757354466, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07142857142857142, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.780637910884446, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 199.21428571428572, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.542069703580588, "mean_processing_ms": 3.2268676018366675, "mean_inference_ms": 0.6872146619182822}, "off_policy_estimator": {}, "info": {"num_target_updates": 65, "num_steps_trained": 0, "num_steps_sampled": 6500, "sample_time_ms": 829.49, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.888, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 6500, "episodes_total": 14, "training_iteration": 65, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-12", "timestamp": 1585863672, "time_this_iter_s": 0.5943846702575684, "time_total_s": 68.99921798706055, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 68.99921798706055, "timesteps_since_restore": 6500, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 10.1, "ram_util_percent": 72.8}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.073414516496946, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 21.275498757354466, "episode_len_mean": 446.14285714285717, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.073414516496946, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.275498757354466, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07142857142857142, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.780637910884446, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 199.21428571428572, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.542069703580588, "mean_processing_ms": 3.2268676018366675, "mean_inference_ms": 0.6872146619182822}, "off_policy_estimator": {}, "info": {"num_target_updates": 66, "num_steps_trained": 0, "num_steps_sampled": 6600, "sample_time_ms": 824.41, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.85, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 6600, "episodes_total": 14, "training_iteration": 66, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-13", "timestamp": 1585863673, "time_this_iter_s": 0.5284974575042725, "time_total_s": 69.52771544456482, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 69.52771544456482, "timesteps_since_restore": 6600, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 10.3, "ram_util_percent": 72.8}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.073414516496946, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 21.275498757354466, "episode_len_mean": 446.14285714285717, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.073414516496946, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.275498757354466, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07142857142857142, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.780637910884446, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 199.21428571428572, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.542069703580588, "mean_processing_ms": 3.2268676018366675, "mean_inference_ms": 0.6872146619182822}, "off_policy_estimator": {}, "info": {"num_target_updates": 67, "num_steps_trained": 0, "num_steps_sampled": 6700, "sample_time_ms": 819.852, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.792, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 6700, "episodes_total": 14, "training_iteration": 67, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-14", "timestamp": 1585863674, "time_this_iter_s": 0.5046286582946777, "time_total_s": 70.0323441028595, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 70.0323441028595, "timesteps_since_restore": 6700, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 10.1, "ram_util_percent": 72.8}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.073414516496946, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 21.52858976186137, "episode_len_mean": 449.73333333333335, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.073414516496946, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.52858976186137, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06666666666666667, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.8125743972489055, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 199.6, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.5566326149481595, "mean_processing_ms": 3.1945114778109907, "mean_inference_ms": 0.6830527651667675}, "off_policy_estimator": {}, "info": {"num_target_updates": 68, "num_steps_trained": 0, "num_steps_sampled": 6800, "sample_time_ms": 814.12, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.799, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 6800, "episodes_total": 15, "training_iteration": 68, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-15", "timestamp": 1585863675, "time_this_iter_s": 1.6637647151947021, "time_total_s": 71.6961088180542, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 71.6961088180542, "timesteps_since_restore": 6800, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 4.4, "ram_util_percent": 72.8}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.073414516496946, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 21.528589761861372, "episode_len_mean": 449.73333333333335, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.073414516496946, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.528589761861372, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06666666666666667, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.8125743972489055, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 199.6, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.5566326149481595, "mean_processing_ms": 3.19451147781099, "mean_inference_ms": 0.6830527651667675}, "off_policy_estimator": {}, "info": {"num_target_updates": 69, "num_steps_trained": 0, "num_steps_sampled": 6900, "sample_time_ms": 816.679, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.837, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 6900, "episodes_total": 15, "training_iteration": 69, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-16", "timestamp": 1585863676, "time_this_iter_s": 0.7434635162353516, "time_total_s": 72.43957233428955, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 72.43957233428955, "timesteps_since_restore": 6900, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 12.0, "ram_util_percent": 72.8}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.073414516496946, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 21.528589761861372, "episode_len_mean": 449.73333333333335, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.073414516496946, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.528589761861372, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06666666666666667, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.8125743972489055, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 199.6, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.5566326149481595, "mean_processing_ms": 3.19451147781099, "mean_inference_ms": 0.6830527651667675}, "off_policy_estimator": {}, "info": {"num_target_updates": 70, "num_steps_trained": 0, "num_steps_sampled": 7000, "sample_time_ms": 815.466, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.832, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 7000, "episodes_total": 15, "training_iteration": 70, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-17", "timestamp": 1585863677, "time_this_iter_s": 0.5814106464385986, "time_total_s": 73.02098298072815, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 73.02098298072815, "timesteps_since_restore": 7000, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 13.9, "ram_util_percent": 72.8}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.073414516496946, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 21.528589761861372, "episode_len_mean": 449.73333333333335, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.073414516496946, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.528589761861372, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06666666666666667, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.8125743972489055, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 199.6, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.5566326149481595, "mean_processing_ms": 3.19451147781099, "mean_inference_ms": 0.6830527651667675}, "off_policy_estimator": {}, "info": {"num_target_updates": 71, "num_steps_trained": 0, "num_steps_sampled": 7100, "sample_time_ms": 805.144, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.786, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 7100, "episodes_total": 15, "training_iteration": 71, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-17", "timestamp": 1585863677, "time_this_iter_s": 0.5006046295166016, "time_total_s": 73.52158761024475, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 73.52158761024475, "timesteps_since_restore": 7100, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 10.4, "ram_util_percent": 72.8}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.073414516496946, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 21.528589761861372, "episode_len_mean": 449.73333333333335, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.073414516496946, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.528589761861372, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06666666666666667, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.8125743972489055, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 199.6, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.5566326149481595, "mean_processing_ms": 3.19451147781099, "mean_inference_ms": 0.6830527651667675}, "off_policy_estimator": {}, "info": {"num_target_updates": 72, "num_steps_trained": 0, "num_steps_sampled": 7200, "sample_time_ms": 803.171, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.745, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 7200, "episodes_total": 15, "training_iteration": 72, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-18", "timestamp": 1585863678, "time_this_iter_s": 0.5647938251495361, "time_total_s": 74.08638143539429, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 74.08638143539429, "timesteps_since_restore": 7200, "iterations_since_restore": 72, "perf": {}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.073414516496946, "episode_reward_min": -2.9777104284973994, "episode_reward_mean": 21.750105851670963, "episode_len_mean": 452.875, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.9777104284973994, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.073414516496946, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.750105851670963, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.0625, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.846359955111028, "avg_speed_min": 3.7682255497424775, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 198.75, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.560599443547855, "mean_processing_ms": 3.16507669565806, "mean_inference_ms": 0.6794149473366786}, "off_policy_estimator": {}, "info": {"num_target_updates": 73, "num_steps_trained": 0, "num_steps_sampled": 7300, "sample_time_ms": 800.601, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.732, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 7300, "episodes_total": 16, "training_iteration": 73, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-19", "timestamp": 1585863679, "time_this_iter_s": 1.678541660308838, "time_total_s": 75.76492309570312, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 75.76492309570312, "timesteps_since_restore": 7300, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 7.833333333333333, "ram_util_percent": 72.8}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.073414516496946, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 20.29439588368928, "episode_len_mean": 432.29411764705884, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.073414516496946, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 20.29439588368928, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.11764705882352941, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.711917872662924, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 216.47058823529412, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.562426290425766, "mean_processing_ms": 3.1458479497949146, "mean_inference_ms": 0.6761532976744221}, "off_policy_estimator": {}, "info": {"num_target_updates": 74, "num_steps_trained": 0, "num_steps_sampled": 7400, "sample_time_ms": 894.849, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.642, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 7400, "episodes_total": 17, "training_iteration": 74, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-21", "timestamp": 1585863681, "time_this_iter_s": 1.659592866897583, "time_total_s": 77.42451596260071, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 77.42451596260071, "timesteps_since_restore": 7400, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 7.15, "ram_util_percent": 72.8}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.073414516496946, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 20.29439588368928, "episode_len_mean": 432.29411764705884, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.073414516496946, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 20.29439588368928, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.11764705882352941, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.711917872662923, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 216.47058823529412, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.562426290425766, "mean_processing_ms": 3.145847949794914, "mean_inference_ms": 0.676153297674422}, "off_policy_estimator": {}, "info": {"num_target_updates": 75, "num_steps_trained": 0, "num_steps_sampled": 7500, "sample_time_ms": 896.56, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.506, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 7500, "episodes_total": 17, "training_iteration": 75, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-22", "timestamp": 1585863682, "time_this_iter_s": 0.6201300621032715, "time_total_s": 78.04464602470398, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 78.04464602470398, "timesteps_since_restore": 7500, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 7.9, "ram_util_percent": 72.8}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.073414516496946, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 20.29439588368928, "episode_len_mean": 432.29411764705884, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.073414516496946, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 20.29439588368928, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.11764705882352941, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.711917872662923, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 216.47058823529412, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.562426290425766, "mean_processing_ms": 3.145847949794914, "mean_inference_ms": 0.676153297674422}, "off_policy_estimator": {}, "info": {"num_target_updates": 76, "num_steps_trained": 0, "num_steps_sampled": 7600, "sample_time_ms": 905.694, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 6.261, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 7600, "episodes_total": 17, "training_iteration": 76, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-22", "timestamp": 1585863682, "time_this_iter_s": 0.6276848316192627, "time_total_s": 78.67233085632324, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 78.67233085632324, "timesteps_since_restore": 7600, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 9.8, "ram_util_percent": 72.8}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.073414516496946, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 20.29439588368928, "episode_len_mean": 432.29411764705884, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.073414516496946, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 20.29439588368928, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.11764705882352941, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.711917872662923, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 216.47058823529412, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.562426290425766, "mean_processing_ms": 3.145847949794914, "mean_inference_ms": 0.676153297674422}, "off_policy_estimator": {}, "info": {"num_target_updates": 77, "num_steps_trained": 0, "num_steps_sampled": 7700, "sample_time_ms": 910.251, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 6.323, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 7700, "episodes_total": 17, "training_iteration": 77, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-23", "timestamp": 1585863683, "time_this_iter_s": 0.5509405136108398, "time_total_s": 79.22327136993408, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 79.22327136993408, "timesteps_since_restore": 7700, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 9.6, "ram_util_percent": 72.8}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.073414516496946, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 20.29439588368928, "episode_len_mean": 432.29411764705884, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.073414516496946, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 20.29439588368928, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.11764705882352941, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.711917872662923, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.558373680453003, "avg_rl_veh_arrival_mean": 216.47058823529412, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.562426290425766, "mean_processing_ms": 3.145847949794914, "mean_inference_ms": 0.676153297674422}, "off_policy_estimator": {}, "info": {"num_target_updates": 78, "num_steps_trained": 0, "num_steps_sampled": 7800, "sample_time_ms": 797.749, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 6.269, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 7800, "episodes_total": 17, "training_iteration": 78, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-23", "timestamp": 1585863683, "time_this_iter_s": 0.5377309322357178, "time_total_s": 79.7610023021698, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 79.7610023021698, "timesteps_since_restore": 7800, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 9.9, "ram_util_percent": 72.8}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 20.55991288849144, "episode_len_mean": 436.05555555555554, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 20.55991288849144, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.1111111111111111, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.762854631440914, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 214.38888888888889, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.557382224090314, "mean_processing_ms": 3.1275037970410624, "mean_inference_ms": 0.6732145477122482}, "off_policy_estimator": {}, "info": {"num_target_updates": 79, "num_steps_trained": 0, "num_steps_sampled": 7900, "sample_time_ms": 897.476, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 6.129, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 7900, "episodes_total": 18, "training_iteration": 79, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-25", "timestamp": 1585863685, "time_this_iter_s": 1.7402303218841553, "time_total_s": 81.50123262405396, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 81.50123262405396, "timesteps_since_restore": 7900, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 14.100000000000001, "ram_util_percent": 72.9}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 20.55991288849144, "episode_len_mean": 436.05555555555554, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 20.55991288849144, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.1111111111111111, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.762854631440914, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 214.38888888888889, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.557382224090315, "mean_processing_ms": 3.127503797041062, "mean_inference_ms": 0.6732145477122482}, "off_policy_estimator": {}, "info": {"num_target_updates": 80, "num_steps_trained": 0, "num_steps_sampled": 8000, "sample_time_ms": 914.478, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 6.252, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 8000, "episodes_total": 18, "training_iteration": 80, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-26", "timestamp": 1585863686, "time_this_iter_s": 0.7529942989349365, "time_total_s": 82.25422692298889, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 82.25422692298889, "timesteps_since_restore": 8000, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 9.7, "ram_util_percent": 72.9}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 20.55991288849144, "episode_len_mean": 436.05555555555554, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 20.55991288849144, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.1111111111111111, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.762854631440914, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 214.38888888888889, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.557382224090315, "mean_processing_ms": 3.127503797041062, "mean_inference_ms": 0.6732145477122482}, "off_policy_estimator": {}, "info": {"num_target_updates": 81, "num_steps_trained": 0, "num_steps_sampled": 8100, "sample_time_ms": 917.814, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 6.28, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 8100, "episodes_total": 18, "training_iteration": 81, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-27", "timestamp": 1585863687, "time_this_iter_s": 0.5343289375305176, "time_total_s": 82.78855586051941, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 82.78855586051941, "timesteps_since_restore": 8100, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 14.0, "ram_util_percent": 72.9}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 20.55991288849144, "episode_len_mean": 436.05555555555554, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 20.55991288849144, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.1111111111111111, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.762854631440914, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 214.38888888888889, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.557382224090315, "mean_processing_ms": 3.127503797041062, "mean_inference_ms": 0.6732145477122482}, "off_policy_estimator": {}, "info": {"num_target_updates": 82, "num_steps_trained": 0, "num_steps_sampled": 8200, "sample_time_ms": 913.661, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 6.378, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 8200, "episodes_total": 18, "training_iteration": 82, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-27", "timestamp": 1585863687, "time_this_iter_s": 0.524097204208374, "time_total_s": 83.31265306472778, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 83.31265306472778, "timesteps_since_restore": 8200, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 10.4, "ram_util_percent": 72.9}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 20.55991288849144, "episode_len_mean": 436.05555555555554, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 20.55991288849144, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.1111111111111111, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.762854631440914, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 214.38888888888889, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.557382224090315, "mean_processing_ms": 3.127503797041062, "mean_inference_ms": 0.6732145477122482}, "off_policy_estimator": {}, "info": {"num_target_updates": 83, "num_steps_trained": 0, "num_steps_sampled": 8300, "sample_time_ms": 799.137, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 6.336, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 8300, "episodes_total": 18, "training_iteration": 83, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-28", "timestamp": 1585863688, "time_this_iter_s": 0.5319678783416748, "time_total_s": 83.84462094306946, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 83.84462094306946, "timesteps_since_restore": 8300, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 10.1, "ram_util_percent": 72.9}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 20.79711454122314, "episode_len_mean": 439.42105263157896, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 20.79711454122314, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.10526315789473684, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.783892975519177, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 211.89473684210526, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.546946825473274, "mean_processing_ms": 3.1099920325959447, "mean_inference_ms": 0.670471102189181}, "off_policy_estimator": {}, "info": {"num_target_updates": 84, "num_steps_trained": 0, "num_steps_sampled": 8400, "sample_time_ms": 796.628, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 6.299, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 8400, "episodes_total": 19, "training_iteration": 84, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-29", "timestamp": 1585863689, "time_this_iter_s": 1.6341254711151123, "time_total_s": 85.47874641418457, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 85.47874641418457, "timesteps_since_restore": 8400, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 4.5, "ram_util_percent": 72.9}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 20.79711454122314, "episode_len_mean": 439.42105263157896, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 20.79711454122314, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.10526315789473684, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.783892975519177, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 211.89473684210526, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.546946825473275, "mean_processing_ms": 3.1099920325959447, "mean_inference_ms": 0.670471102189181}, "off_policy_estimator": {}, "info": {"num_target_updates": 85, "num_steps_trained": 0, "num_steps_sampled": 8500, "sample_time_ms": 799.219, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.382, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 8500, "episodes_total": 19, "training_iteration": 85, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-30", "timestamp": 1585863690, "time_this_iter_s": 0.6369082927703857, "time_total_s": 86.11565470695496, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 86.11565470695496, "timesteps_since_restore": 8500, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 8.4, "ram_util_percent": 72.9}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 20.79711454122314, "episode_len_mean": 439.42105263157896, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 20.79711454122314, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.10526315789473684, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.783892975519177, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 211.89473684210526, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.546946825473275, "mean_processing_ms": 3.1099920325959447, "mean_inference_ms": 0.670471102189181}, "off_policy_estimator": {}, "info": {"num_target_updates": 86, "num_steps_trained": 0, "num_steps_sampled": 8600, "sample_time_ms": 800.263, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.649, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 8600, "episodes_total": 19, "training_iteration": 86, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-31", "timestamp": 1585863691, "time_this_iter_s": 0.6307821273803711, "time_total_s": 86.74643683433533, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 86.74643683433533, "timesteps_since_restore": 8600, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 15.0, "ram_util_percent": 72.9}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 20.79711454122314, "episode_len_mean": 439.42105263157896, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 20.79711454122314, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.10526315789473684, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.783892975519177, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 211.89473684210526, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.546946825473275, "mean_processing_ms": 3.1099920325959447, "mean_inference_ms": 0.670471102189181}, "off_policy_estimator": {}, "info": {"num_target_updates": 87, "num_steps_trained": 0, "num_steps_sampled": 8700, "sample_time_ms": 814.229, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.739, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 8700, "episodes_total": 19, "training_iteration": 87, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-31", "timestamp": 1585863691, "time_this_iter_s": 0.6919369697570801, "time_total_s": 87.43837380409241, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 87.43837380409241, "timesteps_since_restore": 8700, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 24.2, "ram_util_percent": 72.9}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 20.79711454122314, "episode_len_mean": 439.42105263157896, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 20.79711454122314, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.10526315789473684, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.783892975519177, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 211.89473684210526, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.546946825473275, "mean_processing_ms": 3.1099920325959447, "mean_inference_ms": 0.670471102189181}, "off_policy_estimator": {}, "info": {"num_target_updates": 88, "num_steps_trained": 0, "num_steps_sampled": 8800, "sample_time_ms": 818.195, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.84, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 8800, "episodes_total": 19, "training_iteration": 88, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-32", "timestamp": 1585863692, "time_this_iter_s": 0.5780158042907715, "time_total_s": 88.01638960838318, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 88.01638960838318, "timesteps_since_restore": 8800, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 20.2, "ram_util_percent": 73.1}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 21.01083143647312, "episode_len_mean": 442.45, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.01083143647312, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.802917256994242, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 208.9, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.533634607618185, "mean_processing_ms": 3.093360836374999, "mean_inference_ms": 0.6681599127297785}, "off_policy_estimator": {}, "info": {"num_target_updates": 89, "num_steps_trained": 0, "num_steps_sampled": 8900, "sample_time_ms": 814.43, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.915, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 8900, "episodes_total": 20, "training_iteration": 89, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-34", "timestamp": 1585863694, "time_this_iter_s": 1.703256607055664, "time_total_s": 89.71964621543884, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 89.71964621543884, "timesteps_since_restore": 8900, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 10.95, "ram_util_percent": 73.05}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 21.01083143647312, "episode_len_mean": 442.45, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.01083143647312, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.802917256994242, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 208.9, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.533634607618185, "mean_processing_ms": 3.093360836374999, "mean_inference_ms": 0.6681599127297786}, "off_policy_estimator": {}, "info": {"num_target_updates": 90, "num_steps_trained": 0, "num_steps_sampled": 9000, "sample_time_ms": 800.889, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.928, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 9000, "episodes_total": 20, "training_iteration": 90, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-34", "timestamp": 1585863694, "time_this_iter_s": 0.6177172660827637, "time_total_s": 90.3373634815216, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 90.3373634815216, "timesteps_since_restore": 9000, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 8.0, "ram_util_percent": 73.1}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 21.01083143647312, "episode_len_mean": 442.45, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.01083143647312, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.802917256994242, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 208.9, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.533634607618185, "mean_processing_ms": 3.093360836374999, "mean_inference_ms": 0.6681599127297786}, "off_policy_estimator": {}, "info": {"num_target_updates": 91, "num_steps_trained": 0, "num_steps_sampled": 9100, "sample_time_ms": 802.77, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.889, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 9100, "episodes_total": 20, "training_iteration": 91, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-35", "timestamp": 1585863695, "time_this_iter_s": 0.5528810024261475, "time_total_s": 90.89024448394775, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 90.89024448394775, "timesteps_since_restore": 9100, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 9.0, "ram_util_percent": 73.1}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 21.01083143647312, "episode_len_mean": 442.45, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.01083143647312, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.802917256994242, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 208.9, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.533634607618185, "mean_processing_ms": 3.093360836374999, "mean_inference_ms": 0.6681599127297786}, "off_policy_estimator": {}, "info": {"num_target_updates": 92, "num_steps_trained": 0, "num_steps_sampled": 9200, "sample_time_ms": 802.257, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.779, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 9200, "episodes_total": 20, "training_iteration": 92, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-35", "timestamp": 1585863695, "time_this_iter_s": 0.517916202545166, "time_total_s": 91.40816068649292, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 91.40816068649292, "timesteps_since_restore": 9200, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 9.4, "ram_util_percent": 73.1}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 21.01083143647312, "episode_len_mean": 442.45, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.01083143647312, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.802917256994242, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 208.9, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.533634607618185, "mean_processing_ms": 3.093360836374999, "mean_inference_ms": 0.6681599127297786}, "off_policy_estimator": {}, "info": {"num_target_updates": 93, "num_steps_trained": 0, "num_steps_sampled": 9300, "sample_time_ms": 831.002, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.781, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 9300, "episodes_total": 20, "training_iteration": 93, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-36", "timestamp": 1585863696, "time_this_iter_s": 0.8199429512023926, "time_total_s": 92.22810363769531, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 92.22810363769531, "timesteps_since_restore": 9300, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 28.6, "ram_util_percent": 73.2}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 21.203961524499377, "episode_len_mean": 445.1904761904762, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.203961524499377, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.09523809523809523, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.823722167944157, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 206.85714285714286, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.518481082468852, "mean_processing_ms": 3.0775839776046348, "mean_inference_ms": 0.6662388487155287}, "off_policy_estimator": {}, "info": {"num_target_updates": 94, "num_steps_trained": 0, "num_steps_sampled": 9400, "sample_time_ms": 845.345, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.836, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 9400, "episodes_total": 21, "training_iteration": 94, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-38", "timestamp": 1585863698, "time_this_iter_s": 1.7788124084472656, "time_total_s": 94.00691604614258, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 94.00691604614258, "timesteps_since_restore": 9400, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 14.966666666666667, "ram_util_percent": 73.16666666666667}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 21.203961524499377, "episode_len_mean": 445.1904761904762, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.203961524499377, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.09523809523809523, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.823722167944158, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 206.85714285714286, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.518481082468851, "mean_processing_ms": 3.077583977604635, "mean_inference_ms": 0.6662388487155287}, "off_policy_estimator": {}, "info": {"num_target_updates": 95, "num_steps_trained": 0, "num_steps_sampled": 9500, "sample_time_ms": 857.743, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.502, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 9500, "episodes_total": 21, "training_iteration": 95, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-39", "timestamp": 1585863699, "time_this_iter_s": 0.7675669193267822, "time_total_s": 94.77448296546936, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 94.77448296546936, "timesteps_since_restore": 9500, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 23.5, "ram_util_percent": 73.0}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 21.203961524499377, "episode_len_mean": 445.1904761904762, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.203961524499377, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.09523809523809523, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.823722167944158, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 206.85714285714286, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.518481082468851, "mean_processing_ms": 3.077583977604635, "mean_inference_ms": 0.6662388487155287}, "off_policy_estimator": {}, "info": {"num_target_updates": 96, "num_steps_trained": 0, "num_steps_sampled": 9600, "sample_time_ms": 847.091, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.454, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 9600, "episodes_total": 21, "training_iteration": 96, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-39", "timestamp": 1585863699, "time_this_iter_s": 0.5235662460327148, "time_total_s": 95.29804921150208, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 95.29804921150208, "timesteps_since_restore": 9600, "iterations_since_restore": 96, "perf": {}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 21.203961524499377, "episode_len_mean": 445.1904761904762, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.203961524499377, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.09523809523809523, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.823722167944158, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 206.85714285714286, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.518481082468851, "mean_processing_ms": 3.077583977604635, "mean_inference_ms": 0.6662388487155287}, "off_policy_estimator": {}, "info": {"num_target_updates": 97, "num_steps_trained": 0, "num_steps_sampled": 9700, "sample_time_ms": 829.688, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.31, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 9700, "episodes_total": 21, "training_iteration": 97, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-40", "timestamp": 1585863700, "time_this_iter_s": 0.5159821510314941, "time_total_s": 95.81403136253357, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 95.81403136253357, "timesteps_since_restore": 9700, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 11.4, "ram_util_percent": 73.0}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 21.203961524499377, "episode_len_mean": 445.1904761904762, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.203961524499377, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.09523809523809523, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.823722167944158, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 206.85714285714286, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.518481082468851, "mean_processing_ms": 3.077583977604635, "mean_inference_ms": 0.6662388487155287}, "off_policy_estimator": {}, "info": {"num_target_updates": 98, "num_steps_trained": 0, "num_steps_sampled": 9800, "sample_time_ms": 822.119, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.225, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 9800, "episodes_total": 21, "training_iteration": 98, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-40", "timestamp": 1585863700, "time_this_iter_s": 0.5010859966278076, "time_total_s": 96.31511735916138, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 96.31511735916138, "timesteps_since_restore": 9800, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 9.4, "ram_util_percent": 73.0}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 21.379471939853325, "episode_len_mean": 447.6818181818182, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.379471939853325, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.09090909090909091, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.841900308228625, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 204.77272727272728, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.500808272024217, "mean_processing_ms": 3.0625694904522245, "mean_inference_ms": 0.6644136408198302}, "off_policy_estimator": {}, "info": {"num_target_updates": 99, "num_steps_trained": 0, "num_steps_sampled": 9900, "sample_time_ms": 816.752, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.166, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 9900, "episodes_total": 22, "training_iteration": 99, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-42", "timestamp": 1585863702, "time_this_iter_s": 1.6491143703460693, "time_total_s": 97.96423172950745, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 97.96423172950745, "timesteps_since_restore": 9900, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 4.75, "ram_util_percent": 73.0}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 21.379471939853328, "episode_len_mean": 447.6818181818182, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.379471939853328, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.09090909090909091, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.841900308228625, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 204.77272727272728, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.500808272024218, "mean_processing_ms": 3.0625694904522245, "mean_inference_ms": 0.6644136408198302}, "off_policy_estimator": {}, "info": {"num_target_updates": 100, "num_steps_trained": 0, "num_steps_sampled": 10000, "sample_time_ms": 819.4, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.076, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 10000, "episodes_total": 22, "training_iteration": 100, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-43", "timestamp": 1585863703, "time_this_iter_s": 0.6433444023132324, "time_total_s": 98.60757613182068, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 98.60757613182068, "timesteps_since_restore": 10000, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 7.3, "ram_util_percent": 73.0}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 21.379471939853328, "episode_len_mean": 447.6818181818182, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.379471939853328, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.09090909090909091, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.841900308228625, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 204.77272727272728, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.500808272024218, "mean_processing_ms": 3.0625694904522245, "mean_inference_ms": 0.6644136408198302}, "off_policy_estimator": {}, "info": {"num_target_updates": 101, "num_steps_trained": 0, "num_steps_sampled": 10100, "sample_time_ms": 820.705, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.097, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 10100, "episodes_total": 22, "training_iteration": 101, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-43", "timestamp": 1585863703, "time_this_iter_s": 0.5661900043487549, "time_total_s": 99.17376613616943, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 99.17376613616943, "timesteps_since_restore": 10100, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 9.6, "ram_util_percent": 73.1}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 21.379471939853328, "episode_len_mean": 447.6818181818182, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.379471939853328, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.09090909090909091, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.841900308228625, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 204.77272727272728, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.500808272024218, "mean_processing_ms": 3.0625694904522245, "mean_inference_ms": 0.6644136408198302}, "off_policy_estimator": {}, "info": {"num_target_updates": 102, "num_steps_trained": 0, "num_steps_sampled": 10200, "sample_time_ms": 822.531, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 6.199, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 10200, "episodes_total": 22, "training_iteration": 102, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-44", "timestamp": 1585863704, "time_this_iter_s": 0.5471343994140625, "time_total_s": 99.7209005355835, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 99.7209005355835, "timesteps_since_restore": 10200, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 8.7, "ram_util_percent": 73.1}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 21.379471939853328, "episode_len_mean": 447.6818181818182, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.379471939853328, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.09090909090909091, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.841900308228625, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 204.77272727272728, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.500808272024218, "mean_processing_ms": 3.0625694904522245, "mean_inference_ms": 0.6644136408198302}, "off_policy_estimator": {}, "info": {"num_target_updates": 103, "num_steps_trained": 0, "num_steps_sampled": 10300, "sample_time_ms": 792.699, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 6.188, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 10300, "episodes_total": 22, "training_iteration": 103, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-45", "timestamp": 1585863705, "time_this_iter_s": 0.5210068225860596, "time_total_s": 100.24190735816956, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 100.24190735816956, "timesteps_since_restore": 10300, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 9.9, "ram_util_percent": 73.1}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 21.53999794283698, "episode_len_mean": 449.95652173913044, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.53999794283698, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.08695652173913043, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.855693559844457, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 203.7826086956522, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.481153780790973, "mean_processing_ms": 3.0483904922169005, "mean_inference_ms": 0.6626412530482084}, "off_policy_estimator": {}, "info": {"num_target_updates": 104, "num_steps_trained": 0, "num_steps_sampled": 10400, "sample_time_ms": 781.879, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 6.162, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 10400, "episodes_total": 23, "training_iteration": 104, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-46", "timestamp": 1585863706, "time_this_iter_s": 1.6697988510131836, "time_total_s": 101.91170620918274, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 101.91170620918274, "timesteps_since_restore": 10400, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 4.1499999999999995, "ram_util_percent": 73.0}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 21.53999794283698, "episode_len_mean": 449.95652173913044, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.53999794283698, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.08695652173913043, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.855693559844457, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 203.7826086956522, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.481153780790973, "mean_processing_ms": 3.048390492216901, "mean_inference_ms": 0.6626412530482084}, "off_policy_estimator": {}, "info": {"num_target_updates": 105, "num_steps_trained": 0, "num_steps_sampled": 10500, "sample_time_ms": 774.408, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.543, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 10500, "episodes_total": 23, "training_iteration": 105, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-47", "timestamp": 1585863707, "time_this_iter_s": 0.6870286464691162, "time_total_s": 102.59873485565186, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 102.59873485565186, "timesteps_since_restore": 10500, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 12.3, "ram_util_percent": 73.1}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 21.53999794283698, "episode_len_mean": 449.95652173913044, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.53999794283698, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.08695652173913043, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.855693559844457, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 203.7826086956522, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.481153780790973, "mean_processing_ms": 3.048390492216901, "mean_inference_ms": 0.6626412530482084}, "off_policy_estimator": {}, "info": {"num_target_updates": 106, "num_steps_trained": 0, "num_steps_sampled": 10600, "sample_time_ms": 778.131, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.546, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 10600, "episodes_total": 23, "training_iteration": 106, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-47", "timestamp": 1585863707, "time_this_iter_s": 0.5610306262969971, "time_total_s": 103.15976548194885, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 103.15976548194885, "timesteps_since_restore": 10600, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 9.2, "ram_util_percent": 73.1}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 21.53999794283698, "episode_len_mean": 449.95652173913044, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.53999794283698, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.08695652173913043, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.855693559844457, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 203.7826086956522, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.481153780790973, "mean_processing_ms": 3.048390492216901, "mean_inference_ms": 0.6626412530482084}, "off_policy_estimator": {}, "info": {"num_target_updates": 107, "num_steps_trained": 0, "num_steps_sampled": 10700, "sample_time_ms": 781.905, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.553, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 10700, "episodes_total": 23, "training_iteration": 107, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-48", "timestamp": 1585863708, "time_this_iter_s": 0.5539653301239014, "time_total_s": 103.71373081207275, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 103.71373081207275, "timesteps_since_restore": 10700, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 9.5, "ram_util_percent": 73.1}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 21.53999794283698, "episode_len_mean": 449.95652173913044, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.53999794283698, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.08695652173913043, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.855693559844457, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 203.7826086956522, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.481153780790973, "mean_processing_ms": 3.048390492216901, "mean_inference_ms": 0.6626412530482084}, "off_policy_estimator": {}, "info": {"num_target_updates": 108, "num_steps_trained": 0, "num_steps_sampled": 10800, "sample_time_ms": 790.372, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.562, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 10800, "episodes_total": 23, "training_iteration": 108, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-49", "timestamp": 1585863709, "time_this_iter_s": 0.5861997604370117, "time_total_s": 104.29993057250977, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 104.29993057250977, "timesteps_since_restore": 10800, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 10.2, "ram_util_percent": 73.1}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 21.68694414393035, "episode_len_mean": 452.0416666666667, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.68694414393035, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.08333333333333333, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.866496017764951, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 204.29166666666666, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.4606842033284835, "mean_processing_ms": 3.034894431724528, "mean_inference_ms": 0.6609627908866623}, "off_policy_estimator": {}, "info": {"num_target_updates": 109, "num_steps_trained": 0, "num_steps_sampled": 10900, "sample_time_ms": 795.627, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.607, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 10900, "episodes_total": 24, "training_iteration": 109, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-50", "timestamp": 1585863710, "time_this_iter_s": 1.7020025253295898, "time_total_s": 106.00193309783936, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 106.00193309783936, "timesteps_since_restore": 10900, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 4.75, "ram_util_percent": 73.1}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 21.68694414393035, "episode_len_mean": 452.0416666666667, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.68694414393035, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.08333333333333333, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.866496017764951, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 204.29166666666666, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.4606842033284835, "mean_processing_ms": 3.0348944317245277, "mean_inference_ms": 0.6609627908866622}, "off_policy_estimator": {}, "info": {"num_target_updates": 110, "num_steps_trained": 0, "num_steps_sampled": 11000, "sample_time_ms": 803.227, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.68, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 11000, "episodes_total": 24, "training_iteration": 110, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-51", "timestamp": 1585863711, "time_this_iter_s": 0.7203035354614258, "time_total_s": 106.72223663330078, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 106.72223663330078, "timesteps_since_restore": 11000, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 8.4, "ram_util_percent": 73.1}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 21.68694414393035, "episode_len_mean": 452.0416666666667, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.68694414393035, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.08333333333333333, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.866496017764951, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 204.29166666666666, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.4606842033284835, "mean_processing_ms": 3.0348944317245277, "mean_inference_ms": 0.6609627908866622}, "off_policy_estimator": {}, "info": {"num_target_updates": 111, "num_steps_trained": 0, "num_steps_sampled": 11100, "sample_time_ms": 809.422, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.757, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 11100, "episodes_total": 24, "training_iteration": 111, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-52", "timestamp": 1585863712, "time_this_iter_s": 0.6291060447692871, "time_total_s": 107.35134267807007, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 107.35134267807007, "timesteps_since_restore": 11100, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 9.9, "ram_util_percent": 73.1}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 21.68694414393035, "episode_len_mean": 452.0416666666667, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.68694414393035, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.08333333333333333, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.866496017764951, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 204.29166666666666, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.4606842033284835, "mean_processing_ms": 3.0348944317245277, "mean_inference_ms": 0.6609627908866622}, "off_policy_estimator": {}, "info": {"num_target_updates": 112, "num_steps_trained": 0, "num_steps_sampled": 11200, "sample_time_ms": 811.172, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.73, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 11200, "episodes_total": 24, "training_iteration": 112, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-52", "timestamp": 1585863712, "time_this_iter_s": 0.5544204711914062, "time_total_s": 107.90576314926147, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 107.90576314926147, "timesteps_since_restore": 11200, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 9.1, "ram_util_percent": 73.1}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 21.68694414393035, "episode_len_mean": 452.0416666666667, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.68694414393035, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.08333333333333333, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.866496017764951, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 204.29166666666666, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.4606842033284835, "mean_processing_ms": 3.0348944317245277, "mean_inference_ms": 0.6609627908866622}, "off_policy_estimator": {}, "info": {"num_target_updates": 113, "num_steps_trained": 0, "num_steps_sampled": 11300, "sample_time_ms": 810.388, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.723, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 11300, "episodes_total": 24, "training_iteration": 113, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-53", "timestamp": 1585863713, "time_this_iter_s": 0.5131990909576416, "time_total_s": 108.41896224021912, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 108.41896224021912, "timesteps_since_restore": 11300, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 9.2, "ram_util_percent": 73.1}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 21.822279841446512, "episode_len_mean": 453.96, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.822279841446512, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.871312487097648, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 203.4, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.439680879456855, "mean_processing_ms": 3.022164464224078, "mean_inference_ms": 0.6593776919218629}, "off_policy_estimator": {}, "info": {"num_target_updates": 114, "num_steps_trained": 0, "num_steps_sampled": 11400, "sample_time_ms": 813.851, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.733, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 11400, "episodes_total": 25, "training_iteration": 114, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-55", "timestamp": 1585863715, "time_this_iter_s": 1.7048890590667725, "time_total_s": 110.12385129928589, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 110.12385129928589, "timesteps_since_restore": 11400, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 4.15, "ram_util_percent": 73.05}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 21.822279841446516, "episode_len_mean": 453.96, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.822279841446516, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.871312487097648, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 203.4, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.439680879456855, "mean_processing_ms": 3.0221644642240775, "mean_inference_ms": 0.6593776919218629}, "off_policy_estimator": {}, "info": {"num_target_updates": 115, "num_steps_trained": 0, "num_steps_sampled": 11500, "sample_time_ms": 810.882, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.779, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 11500, "episodes_total": 25, "training_iteration": 115, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-55", "timestamp": 1585863715, "time_this_iter_s": 0.6574175357818604, "time_total_s": 110.78126883506775, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 110.78126883506775, "timesteps_since_restore": 11500, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 9.5, "ram_util_percent": 73.0}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 21.822279841446516, "episode_len_mean": 453.96, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.822279841446516, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.871312487097648, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 203.4, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.439680879456855, "mean_processing_ms": 3.0221644642240775, "mean_inference_ms": 0.6593776919218629}, "off_policy_estimator": {}, "info": {"num_target_updates": 116, "num_steps_trained": 0, "num_steps_sampled": 11600, "sample_time_ms": 808.195, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.776, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 11600, "episodes_total": 25, "training_iteration": 116, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-56", "timestamp": 1585863716, "time_this_iter_s": 0.5340144634246826, "time_total_s": 111.31528329849243, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 111.31528329849243, "timesteps_since_restore": 11600, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 9.1, "ram_util_percent": 73.0}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 21.822279841446516, "episode_len_mean": 453.96, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.822279841446516, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.871312487097648, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 203.4, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.439680879456855, "mean_processing_ms": 3.0221644642240775, "mean_inference_ms": 0.6593776919218629}, "off_policy_estimator": {}, "info": {"num_target_updates": 117, "num_steps_trained": 0, "num_steps_sampled": 11700, "sample_time_ms": 811.153, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.765, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 11700, "episodes_total": 25, "training_iteration": 117, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-56", "timestamp": 1585863716, "time_this_iter_s": 0.5832679271697998, "time_total_s": 111.89855122566223, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 111.89855122566223, "timesteps_since_restore": 11700, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 13.6, "ram_util_percent": 73.1}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 21.822279841446516, "episode_len_mean": 453.96, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.822279841446516, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.871312487097648, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 203.4, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.439680879456855, "mean_processing_ms": 3.0221644642240775, "mean_inference_ms": 0.6593776919218629}, "off_policy_estimator": {}, "info": {"num_target_updates": 118, "num_steps_trained": 0, "num_steps_sampled": 11800, "sample_time_ms": 812.546, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.79, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 11800, "episodes_total": 25, "training_iteration": 118, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-57", "timestamp": 1585863717, "time_this_iter_s": 0.6002044677734375, "time_total_s": 112.49875569343567, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 112.49875569343567, "timesteps_since_restore": 11800, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 13.0, "ram_util_percent": 73.0}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 21.947320735074335, "episode_len_mean": 455.7307692307692, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.947320735074335, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07692307692307693, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.86939820224822, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 202.69230769230768, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.418154946830644, "mean_processing_ms": 3.01042469178276, "mean_inference_ms": 0.6578740963678569}, "off_policy_estimator": {}, "info": {"num_target_updates": 119, "num_steps_trained": 0, "num_steps_sampled": 11900, "sample_time_ms": 818.363, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.713, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 11900, "episodes_total": 26, "training_iteration": 119, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-59", "timestamp": 1585863719, "time_this_iter_s": 1.7593607902526855, "time_total_s": 114.25811648368835, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 114.25811648368835, "timesteps_since_restore": 11900, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 7.7, "ram_util_percent": 72.85}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 21.947320735074335, "episode_len_mean": 455.7307692307692, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.947320735074335, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07692307692307693, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.86939820224822, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 202.69230769230768, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.418154946830644, "mean_processing_ms": 3.01042469178276, "mean_inference_ms": 0.6578740963678569}, "off_policy_estimator": {}, "info": {"num_target_updates": 120, "num_steps_trained": 0, "num_steps_sampled": 12000, "sample_time_ms": 809.01, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.622, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 12000, "episodes_total": 26, "training_iteration": 120, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-41-59", "timestamp": 1585863719, "time_this_iter_s": 0.6254870891571045, "time_total_s": 114.88360357284546, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 114.88360357284546, "timesteps_since_restore": 12000, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 9.6, "ram_util_percent": 72.8}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 21.947320735074335, "episode_len_mean": 455.7307692307692, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.947320735074335, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07692307692307693, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.86939820224822, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 202.69230769230768, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.418154946830644, "mean_processing_ms": 3.01042469178276, "mean_inference_ms": 0.6578740963678569}, "off_policy_estimator": {}, "info": {"num_target_updates": 121, "num_steps_trained": 0, "num_steps_sampled": 12100, "sample_time_ms": 802.884, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.542, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 12100, "episodes_total": 26, "training_iteration": 121, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-00", "timestamp": 1585863720, "time_this_iter_s": 0.5669395923614502, "time_total_s": 115.45054316520691, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 115.45054316520691, "timesteps_since_restore": 12100, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 10.5, "ram_util_percent": 72.8}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 21.947320735074335, "episode_len_mean": 455.7307692307692, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.947320735074335, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07692307692307693, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.86939820224822, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 202.69230769230768, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.418154946830644, "mean_processing_ms": 3.01042469178276, "mean_inference_ms": 0.6578740963678569}, "off_policy_estimator": {}, "info": {"num_target_updates": 122, "num_steps_trained": 0, "num_steps_sampled": 12200, "sample_time_ms": 803.09, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.528, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 12200, "episodes_total": 26, "training_iteration": 122, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-01", "timestamp": 1585863721, "time_this_iter_s": 0.5563533306121826, "time_total_s": 116.00689649581909, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 116.00689649581909, "timesteps_since_restore": 12200, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 8.9, "ram_util_percent": 72.8}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 21.947320735074335, "episode_len_mean": 455.7307692307692, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 21.947320735074335, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07692307692307693, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.86939820224822, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 202.69230769230768, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.418154946830644, "mean_processing_ms": 3.01042469178276, "mean_inference_ms": 0.6578740963678569}, "off_policy_estimator": {}, "info": {"num_target_updates": 123, "num_steps_trained": 0, "num_steps_sampled": 12300, "sample_time_ms": 810.064, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.562, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 12300, "episodes_total": 26, "training_iteration": 123, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-01", "timestamp": 1585863721, "time_this_iter_s": 0.583397626876831, "time_total_s": 116.59029412269592, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 116.59029412269592, "timesteps_since_restore": 12300, "iterations_since_restore": 123, "perf": {}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.06281414354985, "episode_len_mean": 457.3703703703704, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.06281414354985, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07407407407407407, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.873887822371548, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 201.0, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.39629912110838, "mean_processing_ms": 2.999185970145435, "mean_inference_ms": 0.6564408695387006}, "off_policy_estimator": {}, "info": {"num_target_updates": 124, "num_steps_trained": 0, "num_steps_sampled": 12400, "sample_time_ms": 805.598, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.591, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 12400, "episodes_total": 27, "training_iteration": 124, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-03", "timestamp": 1585863723, "time_this_iter_s": 1.6601593494415283, "time_total_s": 118.25045347213745, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 118.25045347213745, "timesteps_since_restore": 12400, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 5.466666666666666, "ram_util_percent": 72.8}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.06281414354985, "episode_len_mean": 457.3703703703704, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.06281414354985, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07407407407407407, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.873887822371549, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 201.0, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.396299121108381, "mean_processing_ms": 2.999185970145435, "mean_inference_ms": 0.6564408695387006}, "off_policy_estimator": {}, "info": {"num_target_updates": 125, "num_steps_trained": 0, "num_steps_sampled": 12500, "sample_time_ms": 803.987, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.476, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 12500, "episodes_total": 27, "training_iteration": 125, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-04", "timestamp": 1585863724, "time_this_iter_s": 0.6405181884765625, "time_total_s": 118.89097166061401, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 118.89097166061401, "timesteps_since_restore": 12500, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 10.3, "ram_util_percent": 72.8}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.06281414354985, "episode_len_mean": 457.3703703703704, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.06281414354985, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07407407407407407, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.873887822371549, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 201.0, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.396299121108381, "mean_processing_ms": 2.999185970145435, "mean_inference_ms": 0.6564408695387006}, "off_policy_estimator": {}, "info": {"num_target_updates": 126, "num_steps_trained": 0, "num_steps_sampled": 12600, "sample_time_ms": 808.373, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.523, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 12600, "episodes_total": 27, "training_iteration": 126, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-04", "timestamp": 1585863724, "time_this_iter_s": 0.5783624649047852, "time_total_s": 119.4693341255188, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 119.4693341255188, "timesteps_since_restore": 12600, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 9.8, "ram_util_percent": 72.8}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.06281414354985, "episode_len_mean": 457.3703703703704, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.06281414354985, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07407407407407407, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.873887822371549, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 201.0, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.396299121108381, "mean_processing_ms": 2.999185970145435, "mean_inference_ms": 0.6564408695387006}, "off_policy_estimator": {}, "info": {"num_target_updates": 127, "num_steps_trained": 0, "num_steps_sampled": 12700, "sample_time_ms": 805.912, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.576, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 12700, "episodes_total": 27, "training_iteration": 127, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-05", "timestamp": 1585863725, "time_this_iter_s": 0.5594046115875244, "time_total_s": 120.02873873710632, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 120.02873873710632, "timesteps_since_restore": 12700, "iterations_since_restore": 127, "perf": {}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.06281414354985, "episode_len_mean": 457.3703703703704, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.06281414354985, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07407407407407407, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.873887822371549, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 201.0, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.396299121108381, "mean_processing_ms": 2.999185970145435, "mean_inference_ms": 0.6564408695387006}, "off_policy_estimator": {}, "info": {"num_target_updates": 128, "num_steps_trained": 0, "num_steps_sampled": 12800, "sample_time_ms": 803.358, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.563, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 12800, "episodes_total": 27, "training_iteration": 128, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-05", "timestamp": 1585863725, "time_this_iter_s": 0.5748484134674072, "time_total_s": 120.60358715057373, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 120.60358715057373, "timesteps_since_restore": 12800, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 8.8, "ram_util_percent": 72.8}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.17004478770588, "episode_len_mean": 458.89285714285717, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.17004478770588, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07142857142857142, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.880207908495666, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 199.67857142857142, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.374358658046448, "mean_processing_ms": 2.988436439760167, "mean_inference_ms": 0.6550763904036229}, "off_policy_estimator": {}, "info": {"num_target_updates": 129, "num_steps_trained": 0, "num_steps_sampled": 12900, "sample_time_ms": 795.164, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.611, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 12900, "episodes_total": 28, "training_iteration": 129, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-07", "timestamp": 1585863727, "time_this_iter_s": 1.6781179904937744, "time_total_s": 122.2817051410675, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 122.2817051410675, "timesteps_since_restore": 12900, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 6.7, "ram_util_percent": 72.8}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.17004478770588, "episode_len_mean": 458.89285714285717, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.17004478770588, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07142857142857142, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.880207908495666, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 199.67857142857142, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.374358658046448, "mean_processing_ms": 2.988436439760167, "mean_inference_ms": 0.6550763904036229}, "off_policy_estimator": {}, "info": {"num_target_updates": 130, "num_steps_trained": 0, "num_steps_sampled": 13000, "sample_time_ms": 804.289, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.696, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 13000, "episodes_total": 28, "training_iteration": 130, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-08", "timestamp": 1585863728, "time_this_iter_s": 0.7178888320922852, "time_total_s": 122.99959397315979, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 122.99959397315979, "timesteps_since_restore": 13000, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 8.6, "ram_util_percent": 72.8}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.17004478770588, "episode_len_mean": 458.89285714285717, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.17004478770588, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07142857142857142, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.880207908495666, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 199.67857142857142, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.374358658046448, "mean_processing_ms": 2.988436439760167, "mean_inference_ms": 0.6550763904036229}, "off_policy_estimator": {}, "info": {"num_target_updates": 131, "num_steps_trained": 0, "num_steps_sampled": 13100, "sample_time_ms": 800.929, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.677, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 13100, "episodes_total": 28, "training_iteration": 131, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-08", "timestamp": 1585863728, "time_this_iter_s": 0.5330274105072021, "time_total_s": 123.53262138366699, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 123.53262138366699, "timesteps_since_restore": 13100, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 10.3, "ram_util_percent": 72.9}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.17004478770588, "episode_len_mean": 458.89285714285717, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.17004478770588, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07142857142857142, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.880207908495666, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 199.67857142857142, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.374358658046448, "mean_processing_ms": 2.988436439760167, "mean_inference_ms": 0.6550763904036229}, "off_policy_estimator": {}, "info": {"num_target_updates": 132, "num_steps_trained": 0, "num_steps_sampled": 13200, "sample_time_ms": 800.177, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.619, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 13200, "episodes_total": 28, "training_iteration": 132, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-09", "timestamp": 1585863729, "time_this_iter_s": 0.548475980758667, "time_total_s": 124.08109736442566, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 124.08109736442566, "timesteps_since_restore": 13200, "iterations_since_restore": 132, "perf": {}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.17004478770588, "episode_len_mean": 458.89285714285717, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.17004478770588, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07142857142857142, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.880207908495666, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 199.67857142857142, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.374358658046448, "mean_processing_ms": 2.988436439760167, "mean_inference_ms": 0.6550763904036229}, "off_policy_estimator": {}, "info": {"num_target_updates": 133, "num_steps_trained": 0, "num_steps_sampled": 13300, "sample_time_ms": 797.463, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.623, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 13300, "episodes_total": 28, "training_iteration": 133, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-09", "timestamp": 1585863729, "time_this_iter_s": 0.556309700012207, "time_total_s": 124.63740706443787, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 124.63740706443787, "timesteps_since_restore": 13300, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 10.4, "ram_util_percent": 72.8}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.27007877070561, "episode_len_mean": 460.3103448275862, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.27007877070561, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06896551724137931, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.889860628148804, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 198.72413793103448, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.352495156484182, "mean_processing_ms": 2.9782022511979145, "mean_inference_ms": 0.6537757268575103}, "off_policy_estimator": {}, "info": {"num_target_updates": 134, "num_steps_trained": 0, "num_steps_sampled": 13400, "sample_time_ms": 802.353, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.56, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 13400, "episodes_total": 29, "training_iteration": 134, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-11", "timestamp": 1585863731, "time_this_iter_s": 1.7089462280273438, "time_total_s": 126.34635329246521, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 126.34635329246521, "timesteps_since_restore": 13400, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 5.866666666666667, "ram_util_percent": 72.83333333333333}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.27007877070561, "episode_len_mean": 460.3103448275862, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.27007877070561, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06896551724137931, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.889860628148804, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 198.72413793103448, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.352495156484182, "mean_processing_ms": 2.9782022511979145, "mean_inference_ms": 0.6537757268575103}, "off_policy_estimator": {}, "info": {"num_target_updates": 135, "num_steps_trained": 0, "num_steps_sampled": 13500, "sample_time_ms": 809.431, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.669, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 13500, "episodes_total": 29, "training_iteration": 135, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-12", "timestamp": 1585863732, "time_this_iter_s": 0.7123134136199951, "time_total_s": 127.0586667060852, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 127.0586667060852, "timesteps_since_restore": 13500, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 8.9, "ram_util_percent": 72.8}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.27007877070561, "episode_len_mean": 460.3103448275862, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.27007877070561, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06896551724137931, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.889860628148804, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 198.72413793103448, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.352495156484182, "mean_processing_ms": 2.9782022511979145, "mean_inference_ms": 0.6537757268575103}, "off_policy_estimator": {}, "info": {"num_target_updates": 136, "num_steps_trained": 0, "num_steps_sampled": 13600, "sample_time_ms": 814.427, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.697, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 13600, "episodes_total": 29, "training_iteration": 136, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-12", "timestamp": 1585863732, "time_this_iter_s": 0.628697395324707, "time_total_s": 127.68736410140991, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 127.68736410140991, "timesteps_since_restore": 13600, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 9.7, "ram_util_percent": 72.8}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.27007877070561, "episode_len_mean": 460.3103448275862, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.27007877070561, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06896551724137931, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.889860628148804, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 198.72413793103448, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.352495156484182, "mean_processing_ms": 2.9782022511979145, "mean_inference_ms": 0.6537757268575103}, "off_policy_estimator": {}, "info": {"num_target_updates": 137, "num_steps_trained": 0, "num_steps_sampled": 13700, "sample_time_ms": 817.482, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.695, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 13700, "episodes_total": 29, "training_iteration": 137, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-13", "timestamp": 1585863733, "time_this_iter_s": 0.5898594856262207, "time_total_s": 128.27722358703613, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 128.27722358703613, "timesteps_since_restore": 13700, "iterations_since_restore": 137, "perf": {}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.27007877070561, "episode_len_mean": 460.3103448275862, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.27007877070561, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06896551724137931, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.889860628148804, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 198.72413793103448, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.352495156484182, "mean_processing_ms": 2.9782022511979145, "mean_inference_ms": 0.6537757268575103}, "off_policy_estimator": {}, "info": {"num_target_updates": 138, "num_steps_trained": 0, "num_steps_sampled": 13800, "sample_time_ms": 818.33, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.722, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 13800, "episodes_total": 29, "training_iteration": 138, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-14", "timestamp": 1585863734, "time_this_iter_s": 0.5834898948669434, "time_total_s": 128.86071348190308, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 128.86071348190308, "timesteps_since_restore": 13800, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 10.9, "ram_util_percent": 72.8}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.36343688276299, "episode_len_mean": 461.6333333333333, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.36343688276299, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06666666666666667, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.881919110184337, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 198.2, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.331121104072439, "mean_processing_ms": 2.9684820861290944, "mean_inference_ms": 0.6525770663358654}, "off_policy_estimator": {}, "info": {"num_target_updates": 139, "num_steps_trained": 0, "num_steps_sampled": 13900, "sample_time_ms": 822.743, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.737, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 13900, "episodes_total": 30, "training_iteration": 139, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-15", "timestamp": 1585863735, "time_this_iter_s": 1.7223522663116455, "time_total_s": 130.58306574821472, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 130.58306574821472, "timesteps_since_restore": 13900, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 6.3999999999999995, "ram_util_percent": 72.86666666666666}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.36343688276299, "episode_len_mean": 461.6333333333333, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.36343688276299, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06666666666666667, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.881919110184338, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 198.2, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.331121104072439, "mean_processing_ms": 2.9684820861290944, "mean_inference_ms": 0.6525770663358654}, "off_policy_estimator": {}, "info": {"num_target_updates": 140, "num_steps_trained": 0, "num_steps_sampled": 14000, "sample_time_ms": 820.326, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.641, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 14000, "episodes_total": 30, "training_iteration": 140, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-16", "timestamp": 1585863736, "time_this_iter_s": 0.6926717758178711, "time_total_s": 131.2757375240326, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 131.2757375240326, "timesteps_since_restore": 14000, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 14.4, "ram_util_percent": 72.9}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.36343688276299, "episode_len_mean": 461.6333333333333, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.36343688276299, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06666666666666667, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.881919110184338, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 198.2, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.331121104072439, "mean_processing_ms": 2.9684820861290944, "mean_inference_ms": 0.6525770663358654}, "off_policy_estimator": {}, "info": {"num_target_updates": 141, "num_steps_trained": 0, "num_steps_sampled": 14100, "sample_time_ms": 818.571, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.642, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 14100, "episodes_total": 30, "training_iteration": 141, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-17", "timestamp": 1585863737, "time_this_iter_s": 0.5156002044677734, "time_total_s": 131.79133772850037, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 131.79133772850037, "timesteps_since_restore": 14100, "iterations_since_restore": 141, "perf": {}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.36343688276299, "episode_len_mean": 461.6333333333333, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.36343688276299, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06666666666666667, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.881919110184338, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 198.2, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.331121104072439, "mean_processing_ms": 2.9684820861290944, "mean_inference_ms": 0.6525770663358654}, "off_policy_estimator": {}, "info": {"num_target_updates": 142, "num_steps_trained": 0, "num_steps_sampled": 14200, "sample_time_ms": 818.324, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.663, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 14200, "episodes_total": 30, "training_iteration": 142, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-17", "timestamp": 1585863737, "time_this_iter_s": 0.5460193157196045, "time_total_s": 132.33735704421997, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 132.33735704421997, "timesteps_since_restore": 14200, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 9.6, "ram_util_percent": 72.9}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.36343688276299, "episode_len_mean": 461.6333333333333, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.36343688276299, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06666666666666667, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.881919110184338, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 198.2, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.331121104072439, "mean_processing_ms": 2.9684820861290944, "mean_inference_ms": 0.6525770663358654}, "off_policy_estimator": {}, "info": {"num_target_updates": 143, "num_steps_trained": 0, "num_steps_sampled": 14300, "sample_time_ms": 819.323, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.652, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 14300, "episodes_total": 30, "training_iteration": 143, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-18", "timestamp": 1585863738, "time_this_iter_s": 0.5661754608154297, "time_total_s": 132.9035325050354, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 132.9035325050354, "timesteps_since_restore": 14300, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 9.9, "ram_util_percent": 72.9}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.450629359720633, "episode_len_mean": 462.8709677419355, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.450629359720633, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06451612903225806, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.8757953506207174, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 196.6451612903226, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.309878698580666, "mean_processing_ms": 2.9591494943185754, "mean_inference_ms": 0.6514390581536144}, "off_policy_estimator": {}, "info": {"num_target_updates": 144, "num_steps_trained": 0, "num_steps_sampled": 14400, "sample_time_ms": 816.662, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.696, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 14400, "episodes_total": 31, "training_iteration": 144, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-20", "timestamp": 1585863740, "time_this_iter_s": 1.6826190948486328, "time_total_s": 134.58615159988403, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 134.58615159988403, "timesteps_since_restore": 14400, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 8.966666666666667, "ram_util_percent": 72.86666666666667}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.450629359720637, "episode_len_mean": 462.8709677419355, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.450629359720637, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06451612903225806, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.8757953506207174, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 196.6451612903226, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.309878698580666, "mean_processing_ms": 2.9591494943185754, "mean_inference_ms": 0.6514390581536144}, "off_policy_estimator": {}, "info": {"num_target_updates": 145, "num_steps_trained": 0, "num_steps_sampled": 14500, "sample_time_ms": 816.151, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.642, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 14500, "episodes_total": 31, "training_iteration": 145, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-20", "timestamp": 1585863740, "time_this_iter_s": 0.7066731452941895, "time_total_s": 135.29282474517822, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 135.29282474517822, "timesteps_since_restore": 14500, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 13.7, "ram_util_percent": 72.9}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.450629359720637, "episode_len_mean": 462.8709677419355, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.450629359720637, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06451612903225806, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.8757953506207174, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 196.6451612903226, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.309878698580666, "mean_processing_ms": 2.9591494943185754, "mean_inference_ms": 0.6514390581536144}, "off_policy_estimator": {}, "info": {"num_target_updates": 146, "num_steps_trained": 0, "num_steps_sampled": 14600, "sample_time_ms": 811.578, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.55, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 14600, "episodes_total": 31, "training_iteration": 146, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-21", "timestamp": 1585863741, "time_this_iter_s": 0.5821080207824707, "time_total_s": 135.8749327659607, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 135.8749327659607, "timesteps_since_restore": 14600, "iterations_since_restore": 146, "perf": {}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.450629359720637, "episode_len_mean": 462.8709677419355, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.450629359720637, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06451612903225806, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.8757953506207174, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 196.6451612903226, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.309878698580666, "mean_processing_ms": 2.9591494943185754, "mean_inference_ms": 0.6514390581536144}, "off_policy_estimator": {}, "info": {"num_target_updates": 147, "num_steps_trained": 0, "num_steps_sampled": 14700, "sample_time_ms": 802.93, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.459, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 14700, "episodes_total": 31, "training_iteration": 147, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-21", "timestamp": 1585863741, "time_this_iter_s": 0.5022931098937988, "time_total_s": 136.3772258758545, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 136.3772258758545, "timesteps_since_restore": 14700, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 13.3, "ram_util_percent": 72.9}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.450629359720637, "episode_len_mean": 462.8709677419355, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.450629359720637, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06451612903225806, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.8757953506207174, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 196.6451612903226, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.309878698580666, "mean_processing_ms": 2.9591494943185754, "mean_inference_ms": 0.6514390581536144}, "off_policy_estimator": {}, "info": {"num_target_updates": 148, "num_steps_trained": 0, "num_steps_sampled": 14800, "sample_time_ms": 798.72, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.389, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 14800, "episodes_total": 31, "training_iteration": 148, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-22", "timestamp": 1585863742, "time_this_iter_s": 0.540757417678833, "time_total_s": 136.91798329353333, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 136.91798329353333, "timesteps_since_restore": 14800, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 9.7, "ram_util_percent": 72.9}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.532542886826455, "episode_len_mean": 464.03125, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.532542886826455, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.0625, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.8748789974560065, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 195.78125, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.288999612931632, "mean_processing_ms": 2.950278928498023, "mean_inference_ms": 0.6503929179873258}, "off_policy_estimator": {}, "info": {"num_target_updates": 149, "num_steps_trained": 0, "num_steps_sampled": 14900, "sample_time_ms": 806.889, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.336, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 14900, "episodes_total": 32, "training_iteration": 149, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-24", "timestamp": 1585863744, "time_this_iter_s": 1.8035743236541748, "time_total_s": 138.7215576171875, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 138.7215576171875, "timesteps_since_restore": 14900, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 12.299999999999999, "ram_util_percent": 72.96666666666667}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.53254288682646, "episode_len_mean": 464.03125, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.53254288682646, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.0625, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.874878997456007, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 195.78125, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.288999612931632, "mean_processing_ms": 2.950278928498023, "mean_inference_ms": 0.6503929179873258}, "off_policy_estimator": {}, "info": {"num_target_updates": 150, "num_steps_trained": 0, "num_steps_sampled": 15000, "sample_time_ms": 805.846, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.411, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 15000, "episodes_total": 32, "training_iteration": 150, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-24", "timestamp": 1585863744, "time_this_iter_s": 0.682957649230957, "time_total_s": 139.40451526641846, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 139.40451526641846, "timesteps_since_restore": 15000, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 12.3, "ram_util_percent": 73.1}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.53254288682646, "episode_len_mean": 464.03125, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.53254288682646, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.0625, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.874878997456007, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 195.78125, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.288999612931632, "mean_processing_ms": 2.950278928498023, "mean_inference_ms": 0.6503929179873258}, "off_policy_estimator": {}, "info": {"num_target_updates": 151, "num_steps_trained": 0, "num_steps_sampled": 15100, "sample_time_ms": 811.484, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.409, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 15100, "episodes_total": 32, "training_iteration": 151, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-25", "timestamp": 1585863745, "time_this_iter_s": 0.5719642639160156, "time_total_s": 139.97647953033447, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 139.97647953033447, "timesteps_since_restore": 15100, "iterations_since_restore": 151, "perf": {}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.53254288682646, "episode_len_mean": 464.03125, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.53254288682646, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.0625, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.874878997456007, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 195.78125, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.288999612931632, "mean_processing_ms": 2.950278928498023, "mean_inference_ms": 0.6503929179873258}, "off_policy_estimator": {}, "info": {"num_target_updates": 152, "num_steps_trained": 0, "num_steps_sampled": 15200, "sample_time_ms": 806.998, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.365, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 15200, "episodes_total": 32, "training_iteration": 152, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-26", "timestamp": 1585863746, "time_this_iter_s": 0.5008389949798584, "time_total_s": 140.47731852531433, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 140.47731852531433, "timesteps_since_restore": 15200, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 10.3, "ram_util_percent": 73.1}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.53254288682646, "episode_len_mean": 464.03125, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.53254288682646, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.0625, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.874878997456007, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 195.78125, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.288999612931632, "mean_processing_ms": 2.950278928498023, "mean_inference_ms": 0.6503929179873258}, "off_policy_estimator": {}, "info": {"num_target_updates": 153, "num_steps_trained": 0, "num_steps_sampled": 15300, "sample_time_ms": 813.706, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.353, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 15300, "episodes_total": 32, "training_iteration": 153, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-26", "timestamp": 1585863746, "time_this_iter_s": 0.6332392692565918, "time_total_s": 141.11055779457092, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 141.11055779457092, "timesteps_since_restore": 15300, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 11.0, "ram_util_percent": 73.1}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.609321793218673, "episode_len_mean": 465.1212121212121, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.609321793218673, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06060606060606061, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.86859769586924, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 195.6060606060606, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.26886880419123, "mean_processing_ms": 2.9419085573804145, "mean_inference_ms": 0.649478583252542}, "off_policy_estimator": {}, "info": {"num_target_updates": 154, "num_steps_trained": 0, "num_steps_sampled": 15400, "sample_time_ms": 847.354, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.345, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 15400, "episodes_total": 33, "training_iteration": 154, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-28", "timestamp": 1585863748, "time_this_iter_s": 2.0210509300231934, "time_total_s": 143.13160872459412, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 143.13160872459412, "timesteps_since_restore": 15400, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 18.833333333333332, "ram_util_percent": 73.13333333333333}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.609321793218676, "episode_len_mean": 465.1212121212121, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.609321793218676, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06060606060606061, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.868597695869241, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 195.6060606060606, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.26886880419123, "mean_processing_ms": 2.941908557380415, "mean_inference_ms": 0.649478583252542}, "off_policy_estimator": {}, "info": {"num_target_updates": 155, "num_steps_trained": 0, "num_steps_sampled": 15500, "sample_time_ms": 858.861, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.474, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 15500, "episodes_total": 33, "training_iteration": 155, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-29", "timestamp": 1585863749, "time_this_iter_s": 0.8329601287841797, "time_total_s": 143.9645688533783, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 143.9645688533783, "timesteps_since_restore": 15500, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 31.6, "ram_util_percent": 73.4}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.609321793218676, "episode_len_mean": 465.1212121212121, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.609321793218676, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06060606060606061, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.868597695869241, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 195.6060606060606, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.26886880419123, "mean_processing_ms": 2.941908557380415, "mean_inference_ms": 0.649478583252542}, "off_policy_estimator": {}, "info": {"num_target_updates": 156, "num_steps_trained": 0, "num_steps_sampled": 15600, "sample_time_ms": 860.06, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.623, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 15600, "episodes_total": 33, "training_iteration": 156, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-30", "timestamp": 1585863750, "time_this_iter_s": 0.5956196784973145, "time_total_s": 144.5601885318756, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 144.5601885318756, "timesteps_since_restore": 15600, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 15.8, "ram_util_percent": 73.4}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.609321793218676, "episode_len_mean": 465.1212121212121, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.609321793218676, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06060606060606061, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.868597695869241, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 195.6060606060606, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.26886880419123, "mean_processing_ms": 2.941908557380415, "mean_inference_ms": 0.649478583252542}, "off_policy_estimator": {}, "info": {"num_target_updates": 157, "num_steps_trained": 0, "num_steps_sampled": 15700, "sample_time_ms": 865.237, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.715, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 15700, "episodes_total": 33, "training_iteration": 157, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-30", "timestamp": 1585863750, "time_this_iter_s": 0.5549831390380859, "time_total_s": 145.1151716709137, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 145.1151716709137, "timesteps_since_restore": 15700, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 11.0, "ram_util_percent": 73.4}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.609321793218676, "episode_len_mean": 465.1212121212121, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.609321793218676, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06060606060606061, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.868597695869241, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 195.6060606060606, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.26886880419123, "mean_processing_ms": 2.941908557380415, "mean_inference_ms": 0.649478583252542}, "off_policy_estimator": {}, "info": {"num_target_updates": 158, "num_steps_trained": 0, "num_steps_sampled": 15800, "sample_time_ms": 866.227, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.738, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 15800, "episodes_total": 33, "training_iteration": 158, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-31", "timestamp": 1585863751, "time_this_iter_s": 0.5505828857421875, "time_total_s": 145.66575455665588, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 145.66575455665588, "timesteps_since_restore": 15800, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 15.8, "ram_util_percent": 73.5}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.6815737223278, "episode_len_mean": 466.1470588235294, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.6815737223278, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.058823529411764705, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.878024475315439, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 194.7058823529412, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.249229853133248, "mean_processing_ms": 2.9338684191144124, "mean_inference_ms": 0.6486644120935895}, "off_policy_estimator": {}, "info": {"num_target_updates": 159, "num_steps_trained": 0, "num_steps_sampled": 15900, "sample_time_ms": 852.218, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.73, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 15900, "episodes_total": 34, "training_iteration": 159, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-33", "timestamp": 1585863753, "time_this_iter_s": 1.6634113788604736, "time_total_s": 147.32916593551636, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 147.32916593551636, "timesteps_since_restore": 15900, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 4.75, "ram_util_percent": 73.45}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.681573722327805, "episode_len_mean": 466.1470588235294, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.681573722327805, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.058823529411764705, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.878024475315439, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 194.7058823529412, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.249229853133248, "mean_processing_ms": 2.9338684191144124, "mean_inference_ms": 0.6486644120935894}, "off_policy_estimator": {}, "info": {"num_target_updates": 160, "num_steps_trained": 0, "num_steps_sampled": 16000, "sample_time_ms": 858.135, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.662, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 16000, "episodes_total": 34, "training_iteration": 160, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-33", "timestamp": 1585863753, "time_this_iter_s": 0.741417646408081, "time_total_s": 148.07058358192444, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 148.07058358192444, "timesteps_since_restore": 16000, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 9.0, "ram_util_percent": 73.5}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.681573722327805, "episode_len_mean": 466.1470588235294, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.681573722327805, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.058823529411764705, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.878024475315439, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 194.7058823529412, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.249229853133248, "mean_processing_ms": 2.9338684191144124, "mean_inference_ms": 0.6486644120935894}, "off_policy_estimator": {}, "info": {"num_target_updates": 161, "num_steps_trained": 0, "num_steps_sampled": 16100, "sample_time_ms": 853.405, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.678, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 16100, "episodes_total": 34, "training_iteration": 161, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-34", "timestamp": 1585863754, "time_this_iter_s": 0.5248706340789795, "time_total_s": 148.59545421600342, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 148.59545421600342, "timesteps_since_restore": 16100, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 16.0, "ram_util_percent": 73.5}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.681573722327805, "episode_len_mean": 466.1470588235294, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.681573722327805, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.058823529411764705, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.878024475315439, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 194.7058823529412, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.249229853133248, "mean_processing_ms": 2.9338684191144124, "mean_inference_ms": 0.6486644120935894}, "off_policy_estimator": {}, "info": {"num_target_updates": 162, "num_steps_trained": 0, "num_steps_sampled": 16200, "sample_time_ms": 854.849, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.699, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 16200, "episodes_total": 34, "training_iteration": 162, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-34", "timestamp": 1585863754, "time_this_iter_s": 0.5153679847717285, "time_total_s": 149.11082220077515, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 149.11082220077515, "timesteps_since_restore": 16200, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 9.9, "ram_util_percent": 73.5}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.681573722327805, "episode_len_mean": 466.1470588235294, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.681573722327805, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.058823529411764705, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.878024475315439, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 194.7058823529412, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.249229853133248, "mean_processing_ms": 2.9338684191144124, "mean_inference_ms": 0.6486644120935894}, "off_policy_estimator": {}, "info": {"num_target_updates": 163, "num_steps_trained": 0, "num_steps_sampled": 16300, "sample_time_ms": 845.141, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.693, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 16300, "episodes_total": 34, "training_iteration": 163, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-35", "timestamp": 1585863755, "time_this_iter_s": 0.5360288619995117, "time_total_s": 149.64685106277466, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 149.64685106277466, "timesteps_since_restore": 16300, "iterations_since_restore": 163, "perf": {}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.749690743926994, "episode_len_mean": 467.1142857142857, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.749690743926994, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.05714285714285714, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.884032690150779, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 193.45714285714286, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.229869897602063, "mean_processing_ms": 2.926181453875165, "mean_inference_ms": 0.6478829170790734}, "off_policy_estimator": {}, "info": {"num_target_updates": 164, "num_steps_trained": 0, "num_steps_sampled": 16400, "sample_time_ms": 816.778, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.668, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 16400, "episodes_total": 35, "training_iteration": 164, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-37", "timestamp": 1585863757, "time_this_iter_s": 1.735292673110962, "time_total_s": 151.38214373588562, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 151.38214373588562, "timesteps_since_restore": 16400, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 11.1, "ram_util_percent": 73.5}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.035019392309696, "episode_len_mean": 457.72222222222223, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.035019392309696, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.08333333333333333, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.83733908987768, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 201.97222222222223, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.211528507903255, "mean_processing_ms": 2.920373045554583, "mean_inference_ms": 0.6471441789589932}, "off_policy_estimator": {}, "info": {"num_target_updates": 165, "num_steps_trained": 0, "num_steps_sampled": 16500, "sample_time_ms": 909.103, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.592, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 16500, "episodes_total": 36, "training_iteration": 165, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-38", "timestamp": 1585863758, "time_this_iter_s": 1.746103048324585, "time_total_s": 153.1282467842102, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 153.1282467842102, "timesteps_since_restore": 16500, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 8.6, "ram_util_percent": 73.5}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.0350193923097, "episode_len_mean": 457.72222222222223, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.0350193923097, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.08333333333333333, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.83733908987768, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 201.97222222222223, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.211528507903254, "mean_processing_ms": 2.920373045554583, "mean_inference_ms": 0.6471441789589932}, "off_policy_estimator": {}, "info": {"num_target_updates": 166, "num_steps_trained": 0, "num_steps_sampled": 16600, "sample_time_ms": 914.044, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.539, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 16600, "episodes_total": 36, "training_iteration": 166, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-39", "timestamp": 1585863759, "time_this_iter_s": 0.6441693305969238, "time_total_s": 153.77241611480713, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 153.77241611480713, "timesteps_since_restore": 16600, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 8.6, "ram_util_percent": 73.5}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.0350193923097, "episode_len_mean": 457.72222222222223, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.0350193923097, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.08333333333333333, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.83733908987768, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 201.97222222222223, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.211528507903254, "mean_processing_ms": 2.920373045554583, "mean_inference_ms": 0.6471441789589932}, "off_policy_estimator": {}, "info": {"num_target_updates": 167, "num_steps_trained": 0, "num_steps_sampled": 16700, "sample_time_ms": 914.982, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.554, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 16700, "episodes_total": 36, "training_iteration": 167, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-40", "timestamp": 1585863760, "time_this_iter_s": 0.5645983219146729, "time_total_s": 154.3370144367218, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 154.3370144367218, "timesteps_since_restore": 16700, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 10.2, "ram_util_percent": 73.5}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.0350193923097, "episode_len_mean": 457.72222222222223, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.0350193923097, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.08333333333333333, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.83733908987768, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 201.97222222222223, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.211528507903254, "mean_processing_ms": 2.920373045554583, "mean_inference_ms": 0.6471441789589932}, "off_policy_estimator": {}, "info": {"num_target_updates": 168, "num_steps_trained": 0, "num_steps_sampled": 16800, "sample_time_ms": 912.615, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.535, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 16800, "episodes_total": 36, "training_iteration": 168, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-40", "timestamp": 1585863760, "time_this_iter_s": 0.5268251895904541, "time_total_s": 154.86383962631226, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 154.86383962631226, "timesteps_since_restore": 16800, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 11.3, "ram_util_percent": 73.5}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.0350193923097, "episode_len_mean": 457.72222222222223, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.0350193923097, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.08333333333333333, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.83733908987768, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 201.97222222222223, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.211528507903254, "mean_processing_ms": 2.920373045554583, "mean_inference_ms": 0.6471441789589932}, "off_policy_estimator": {}, "info": {"num_target_updates": 169, "num_steps_trained": 0, "num_steps_sampled": 16900, "sample_time_ms": 797.399, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.56, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 16900, "episodes_total": 36, "training_iteration": 169, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-41", "timestamp": 1585863761, "time_this_iter_s": 0.5102667808532715, "time_total_s": 155.37410640716553, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 155.37410640716553, "timesteps_since_restore": 16900, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 10.9, "ram_util_percent": 73.5}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.117130851108993, "episode_len_mean": 458.86486486486484, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.117130851108993, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.08108108108108109, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.851323209575533, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 200.56756756756758, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.193225563376307, "mean_processing_ms": 2.9146775191033867, "mean_inference_ms": 0.6464119531260856}, "off_policy_estimator": {}, "info": {"num_target_updates": 170, "num_steps_trained": 0, "num_steps_sampled": 17000, "sample_time_ms": 885.014, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.536, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 17000, "episodes_total": 37, "training_iteration": 170, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-42", "timestamp": 1585863762, "time_this_iter_s": 1.6179986000061035, "time_total_s": 156.99210500717163, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 156.99210500717163, "timesteps_since_restore": 17000, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 5.0, "ram_util_percent": 73.45}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.117130851108996, "episode_len_mean": 458.86486486486484, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.117130851108996, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.08108108108108109, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.851323209575534, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 200.56756756756758, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.1932255633763065, "mean_processing_ms": 2.9146775191033867, "mean_inference_ms": 0.6464119531260855}, "off_policy_estimator": {}, "info": {"num_target_updates": 171, "num_steps_trained": 0, "num_steps_sampled": 17100, "sample_time_ms": 893.13, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.566, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 17100, "episodes_total": 37, "training_iteration": 171, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-43", "timestamp": 1585863763, "time_this_iter_s": 0.6061646938323975, "time_total_s": 157.59826970100403, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 157.59826970100403, "timesteps_since_restore": 17100, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 7.4, "ram_util_percent": 73.5}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.117130851108996, "episode_len_mean": 458.86486486486484, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.117130851108996, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.08108108108108109, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.851323209575534, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 200.56756756756758, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.1932255633763065, "mean_processing_ms": 2.9146775191033867, "mean_inference_ms": 0.6464119531260855}, "off_policy_estimator": {}, "info": {"num_target_updates": 172, "num_steps_trained": 0, "num_steps_sampled": 17200, "sample_time_ms": 899.688, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.55, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 17200, "episodes_total": 37, "training_iteration": 172, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-44", "timestamp": 1585863764, "time_this_iter_s": 0.5808429718017578, "time_total_s": 158.1791126728058, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 158.1791126728058, "timesteps_since_restore": 17200, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 10.3, "ram_util_percent": 73.5}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.117130851108996, "episode_len_mean": 458.86486486486484, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.117130851108996, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.08108108108108109, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.851323209575534, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 200.56756756756758, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.1932255633763065, "mean_processing_ms": 2.9146775191033867, "mean_inference_ms": 0.6464119531260855}, "off_policy_estimator": {}, "info": {"num_target_updates": 173, "num_steps_trained": 0, "num_steps_sampled": 17300, "sample_time_ms": 901.113, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.573, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 17300, "episodes_total": 37, "training_iteration": 173, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-44", "timestamp": 1585863764, "time_this_iter_s": 0.5506742000579834, "time_total_s": 158.72978687286377, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 158.72978687286377, "timesteps_since_restore": 17300, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 11.1, "ram_util_percent": 73.5}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.117130851108996, "episode_len_mean": 458.86486486486484, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.117130851108996, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.08108108108108109, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.851323209575534, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 200.56756756756758, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.1932255633763065, "mean_processing_ms": 2.9146775191033867, "mean_inference_ms": 0.6464119531260855}, "off_policy_estimator": {}, "info": {"num_target_updates": 174, "num_steps_trained": 0, "num_steps_sampled": 17400, "sample_time_ms": 782.645, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.659, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 17400, "episodes_total": 37, "training_iteration": 174, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-45", "timestamp": 1585863765, "time_this_iter_s": 0.5507471561431885, "time_total_s": 159.28053402900696, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 159.28053402900696, "timesteps_since_restore": 17400, "iterations_since_restore": 174, "perf": {}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.19484423733941, "episode_len_mean": 459.94736842105266, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.19484423733941, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07894736842105263, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.864642564592671, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 200.3684210526316, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.175154607009351, "mean_processing_ms": 2.9091465031015074, "mean_inference_ms": 0.6456934147642265}, "off_policy_estimator": {}, "info": {"num_target_updates": 175, "num_steps_trained": 0, "num_steps_sampled": 17500, "sample_time_ms": 779.763, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.55, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 17500, "episodes_total": 38, "training_iteration": 175, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-46", "timestamp": 1585863766, "time_this_iter_s": 1.7164223194122314, "time_total_s": 160.9969563484192, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 160.9969563484192, "timesteps_since_restore": 17500, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 8.200000000000001, "ram_util_percent": 73.5}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.194844237339414, "episode_len_mean": 459.94736842105266, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.194844237339414, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07894736842105263, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.864642564592672, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 200.3684210526316, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.175154607009351, "mean_processing_ms": 2.909146503101508, "mean_inference_ms": 0.6456934147642264}, "off_policy_estimator": {}, "info": {"num_target_updates": 176, "num_steps_trained": 0, "num_steps_sampled": 17600, "sample_time_ms": 781.721, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.542, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 17600, "episodes_total": 38, "training_iteration": 176, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-47", "timestamp": 1585863767, "time_this_iter_s": 0.664055347442627, "time_total_s": 161.66101169586182, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 161.66101169586182, "timesteps_since_restore": 17600, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 9.7, "ram_util_percent": 73.5}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.194844237339414, "episode_len_mean": 459.94736842105266, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.194844237339414, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07894736842105263, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.864642564592672, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 200.3684210526316, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.175154607009351, "mean_processing_ms": 2.909146503101508, "mean_inference_ms": 0.6456934147642264}, "off_policy_estimator": {}, "info": {"num_target_updates": 177, "num_steps_trained": 0, "num_steps_sampled": 17700, "sample_time_ms": 794.261, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.503, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 17700, "episodes_total": 38, "training_iteration": 177, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-48", "timestamp": 1585863768, "time_this_iter_s": 0.6898331642150879, "time_total_s": 162.3508448600769, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 162.3508448600769, "timesteps_since_restore": 17700, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 15.4, "ram_util_percent": 73.5}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.194844237339414, "episode_len_mean": 459.94736842105266, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.194844237339414, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07894736842105263, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.864642564592672, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 200.3684210526316, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.175154607009351, "mean_processing_ms": 2.909146503101508, "mean_inference_ms": 0.6456934147642264}, "off_policy_estimator": {}, "info": {"num_target_updates": 178, "num_steps_trained": 0, "num_steps_sampled": 17800, "sample_time_ms": 796.97, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.492, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 17800, "episodes_total": 38, "training_iteration": 178, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-48", "timestamp": 1585863768, "time_this_iter_s": 0.554063081741333, "time_total_s": 162.90490794181824, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 162.90490794181824, "timesteps_since_restore": 17800, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 11.2, "ram_util_percent": 73.5}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.194844237339414, "episode_len_mean": 459.94736842105266, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.194844237339414, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07894736842105263, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.864642564592672, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 200.3684210526316, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.175154607009351, "mean_processing_ms": 2.909146503101508, "mean_inference_ms": 0.6456934147642264}, "off_policy_estimator": {}, "info": {"num_target_updates": 179, "num_steps_trained": 0, "num_steps_sampled": 17900, "sample_time_ms": 802.68, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.519, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 17900, "episodes_total": 38, "training_iteration": 179, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-49", "timestamp": 1585863769, "time_this_iter_s": 0.5680453777313232, "time_total_s": 163.47295331954956, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 163.47295331954956, "timesteps_since_restore": 17900, "iterations_since_restore": 179, "perf": {}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.268481176867674, "episode_len_mean": 460.97435897435895, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.268481176867674, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07692307692307693, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.873849741112302, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 199.3846153846154, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.157517639999459, "mean_processing_ms": 2.903743655963463, "mean_inference_ms": 0.6450151316406368}, "off_policy_estimator": {}, "info": {"num_target_updates": 180, "num_steps_trained": 0, "num_steps_sampled": 18000, "sample_time_ms": 806.147, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.589, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 18000, "episodes_total": 39, "training_iteration": 180, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-51", "timestamp": 1585863771, "time_this_iter_s": 1.6533877849578857, "time_total_s": 165.12634110450745, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 165.12634110450745, "timesteps_since_restore": 18000, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 7.133333333333334, "ram_util_percent": 73.5}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.268481176867677, "episode_len_mean": 460.97435897435895, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.268481176867677, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07692307692307693, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.873849741112302, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 199.3846153846154, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.157517639999459, "mean_processing_ms": 2.903743655963463, "mean_inference_ms": 0.6450151316406367}, "off_policy_estimator": {}, "info": {"num_target_updates": 181, "num_steps_trained": 0, "num_steps_sampled": 18100, "sample_time_ms": 813.083, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.631, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 18100, "episodes_total": 39, "training_iteration": 181, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-51", "timestamp": 1585863771, "time_this_iter_s": 0.676300048828125, "time_total_s": 165.80264115333557, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 165.80264115333557, "timesteps_since_restore": 18100, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 8.4, "ram_util_percent": 73.5}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.268481176867677, "episode_len_mean": 460.97435897435895, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.268481176867677, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07692307692307693, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.873849741112302, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 199.3846153846154, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.157517639999459, "mean_processing_ms": 2.903743655963463, "mean_inference_ms": 0.6450151316406367}, "off_policy_estimator": {}, "info": {"num_target_updates": 182, "num_steps_trained": 0, "num_steps_sampled": 18200, "sample_time_ms": 814.377, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.614, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 18200, "episodes_total": 39, "training_iteration": 182, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-52", "timestamp": 1585863772, "time_this_iter_s": 0.5937385559082031, "time_total_s": 166.39637970924377, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 166.39637970924377, "timesteps_since_restore": 18200, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 9.9, "ram_util_percent": 73.5}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.268481176867677, "episode_len_mean": 460.97435897435895, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.268481176867677, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07692307692307693, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.873849741112302, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 199.3846153846154, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.157517639999459, "mean_processing_ms": 2.903743655963463, "mean_inference_ms": 0.6450151316406367}, "off_policy_estimator": {}, "info": {"num_target_updates": 183, "num_steps_trained": 0, "num_steps_sampled": 18300, "sample_time_ms": 814.178, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.573, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 18300, "episodes_total": 39, "training_iteration": 183, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-52", "timestamp": 1585863772, "time_this_iter_s": 0.5481042861938477, "time_total_s": 166.94448399543762, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 166.94448399543762, "timesteps_since_restore": 18300, "iterations_since_restore": 183, "perf": {}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.268481176867677, "episode_len_mean": 460.97435897435895, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.268481176867677, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07692307692307693, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.873849741112302, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 199.3846153846154, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.157517639999459, "mean_processing_ms": 2.903743655963463, "mean_inference_ms": 0.6450151316406367}, "off_policy_estimator": {}, "info": {"num_target_updates": 184, "num_steps_trained": 0, "num_steps_sampled": 18400, "sample_time_ms": 811.163, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.532, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 18400, "episodes_total": 39, "training_iteration": 184, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-53", "timestamp": 1585863773, "time_this_iter_s": 0.5199990272521973, "time_total_s": 167.46448302268982, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 167.46448302268982, "timesteps_since_restore": 18400, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 9.6, "ram_util_percent": 73.5}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.338528120955306, "episode_len_mean": 461.95, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.338528120955306, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.075, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.8709638102894175, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 199.0, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.1401273837011825, "mean_processing_ms": 2.8984943329980437, "mean_inference_ms": 0.6443495976645202}, "off_policy_estimator": {}, "info": {"num_target_updates": 185, "num_steps_trained": 0, "num_steps_sampled": 18500, "sample_time_ms": 804.928, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.546, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 18500, "episodes_total": 40, "training_iteration": 185, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-55", "timestamp": 1585863775, "time_this_iter_s": 1.6539511680603027, "time_total_s": 169.11843419075012, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 169.11843419075012, "timesteps_since_restore": 18500, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 6.800000000000001, "ram_util_percent": 73.5}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.338528120955306, "episode_len_mean": 461.95, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.338528120955306, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.075, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.8709638102894175, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 199.0, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.1401273837011825, "mean_processing_ms": 2.8984943329980437, "mean_inference_ms": 0.6443495976645203}, "off_policy_estimator": {}, "info": {"num_target_updates": 186, "num_steps_trained": 0, "num_steps_sampled": 18600, "sample_time_ms": 801.227, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.536, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 18600, "episodes_total": 40, "training_iteration": 186, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-55", "timestamp": 1585863775, "time_this_iter_s": 0.6269335746765137, "time_total_s": 169.74536776542664, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 169.74536776542664, "timesteps_since_restore": 18600, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 10.4, "ram_util_percent": 73.5}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.338528120955306, "episode_len_mean": 461.95, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.338528120955306, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.075, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.8709638102894175, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 199.0, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.1401273837011825, "mean_processing_ms": 2.8984943329980437, "mean_inference_ms": 0.6443495976645203}, "off_policy_estimator": {}, "info": {"num_target_updates": 187, "num_steps_trained": 0, "num_steps_sampled": 18700, "sample_time_ms": 799.021, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.488, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 18700, "episodes_total": 40, "training_iteration": 187, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-56", "timestamp": 1585863776, "time_this_iter_s": 0.6672124862670898, "time_total_s": 170.41258025169373, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 170.41258025169373, "timesteps_since_restore": 18700, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 13.1, "ram_util_percent": 73.5}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.338528120955306, "episode_len_mean": 461.95, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.338528120955306, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.075, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.8709638102894175, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 199.0, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.1401273837011825, "mean_processing_ms": 2.8984943329980437, "mean_inference_ms": 0.6443495976645203}, "off_policy_estimator": {}, "info": {"num_target_updates": 188, "num_steps_trained": 0, "num_steps_sampled": 18800, "sample_time_ms": 799.69, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.559, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 18800, "episodes_total": 40, "training_iteration": 188, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-57", "timestamp": 1585863777, "time_this_iter_s": 0.5613460540771484, "time_total_s": 170.97392630577087, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 170.97392630577087, "timesteps_since_restore": 18800, "iterations_since_restore": 188, "perf": {}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.338528120955306, "episode_len_mean": 461.95, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.338528120955306, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.075, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.8709638102894175, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 199.0, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.1401273837011825, "mean_processing_ms": 2.8984943329980437, "mean_inference_ms": 0.6443495976645203}, "off_policy_estimator": {}, "info": {"num_target_updates": 189, "num_steps_trained": 0, "num_steps_sampled": 18900, "sample_time_ms": 794.435, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.486, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 18900, "episodes_total": 40, "training_iteration": 189, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-57", "timestamp": 1585863777, "time_this_iter_s": 0.5144855976104736, "time_total_s": 171.48841190338135, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 171.48841190338135, "timesteps_since_restore": 18900, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 9.3, "ram_util_percent": 73.5}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.405226647527925, "episode_len_mean": 462.8780487804878, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.405226647527925, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07317073170731707, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.886645363446769, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 198.09756097560975, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.1230066846547775, "mean_processing_ms": 2.893354365283221, "mean_inference_ms": 0.6436967325711431}, "off_policy_estimator": {}, "info": {"num_target_updates": 190, "num_steps_trained": 0, "num_steps_sampled": 19000, "sample_time_ms": 788.985, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.437, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 19000, "episodes_total": 41, "training_iteration": 190, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-59", "timestamp": 1585863779, "time_this_iter_s": 1.5985140800476074, "time_total_s": 173.08692598342896, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 173.08692598342896, "timesteps_since_restore": 19000, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 8.2, "ram_util_percent": 73.5}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.405226647527925, "episode_len_mean": 462.8780487804878, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.405226647527925, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07317073170731707, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.88664536344677, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 198.09756097560975, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.1230066846547775, "mean_processing_ms": 2.8933543652832214, "mean_inference_ms": 0.6436967325711432}, "off_policy_estimator": {}, "info": {"num_target_updates": 191, "num_steps_trained": 0, "num_steps_sampled": 19100, "sample_time_ms": 784.607, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.386, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 19100, "episodes_total": 41, "training_iteration": 191, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-42-59", "timestamp": 1585863779, "time_this_iter_s": 0.6322393417358398, "time_total_s": 173.7191653251648, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 173.7191653251648, "timesteps_since_restore": 19100, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 4.6, "ram_util_percent": 73.5}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.405226647527925, "episode_len_mean": 462.8780487804878, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.405226647527925, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07317073170731707, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.88664536344677, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 198.09756097560975, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.1230066846547775, "mean_processing_ms": 2.8933543652832214, "mean_inference_ms": 0.6436967325711432}, "off_policy_estimator": {}, "info": {"num_target_updates": 192, "num_steps_trained": 0, "num_steps_sampled": 19200, "sample_time_ms": 805.235, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.574, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 19200, "episodes_total": 41, "training_iteration": 192, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-00", "timestamp": 1585863780, "time_this_iter_s": 0.8023898601531982, "time_total_s": 174.521555185318, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 174.521555185318, "timesteps_since_restore": 19200, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 13.0, "ram_util_percent": 73.6}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.405226647527925, "episode_len_mean": 462.8780487804878, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.405226647527925, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07317073170731707, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.88664536344677, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 198.09756097560975, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.1230066846547775, "mean_processing_ms": 2.8933543652832214, "mean_inference_ms": 0.6436967325711432}, "off_policy_estimator": {}, "info": {"num_target_updates": 193, "num_steps_trained": 0, "num_steps_sampled": 19300, "sample_time_ms": 808.568, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.639, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 19300, "episodes_total": 41, "training_iteration": 193, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-01", "timestamp": 1585863781, "time_this_iter_s": 0.5821492671966553, "time_total_s": 175.10370445251465, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 175.10370445251465, "timesteps_since_restore": 19300, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 28.7, "ram_util_percent": 73.6}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.405226647527925, "episode_len_mean": 462.8780487804878, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.405226647527925, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07317073170731707, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.88664536344677, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 198.09756097560975, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.1230066846547775, "mean_processing_ms": 2.8933543652832214, "mean_inference_ms": 0.6436967325711432}, "off_policy_estimator": {}, "info": {"num_target_updates": 194, "num_steps_trained": 0, "num_steps_sampled": 19400, "sample_time_ms": 820.501, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.65, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 19400, "episodes_total": 41, "training_iteration": 194, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-01", "timestamp": 1585863781, "time_this_iter_s": 0.6391761302947998, "time_total_s": 175.74288058280945, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 175.74288058280945, "timesteps_since_restore": 19400, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 11.3, "ram_util_percent": 73.6}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.46856451726871, "episode_len_mean": 463.76190476190476, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.46856451726871, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07142857142857142, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.89072507252196, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 197.78571428571428, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.106522544100494, "mean_processing_ms": 2.888349409462946, "mean_inference_ms": 0.6431180348943595}, "off_policy_estimator": {}, "info": {"num_target_updates": 195, "num_steps_trained": 0, "num_steps_sampled": 19500, "sample_time_ms": 823.833, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.637, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 19500, "episodes_total": 42, "training_iteration": 195, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-03", "timestamp": 1585863783, "time_this_iter_s": 1.6875700950622559, "time_total_s": 177.4304506778717, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 177.4304506778717, "timesteps_since_restore": 19500, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 8.3, "ram_util_percent": 73.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.46856451726871, "episode_len_mean": 463.76190476190476, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.46856451726871, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07142857142857142, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.89072507252196, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 197.78571428571428, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.106522544100494, "mean_processing_ms": 2.8883494094629465, "mean_inference_ms": 0.6431180348943596}, "off_policy_estimator": {}, "info": {"num_target_updates": 196, "num_steps_trained": 0, "num_steps_sampled": 19600, "sample_time_ms": 832.307, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.715, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 19600, "episodes_total": 42, "training_iteration": 196, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-04", "timestamp": 1585863784, "time_this_iter_s": 0.7126843929290771, "time_total_s": 178.14313507080078, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 178.14313507080078, "timesteps_since_restore": 19600, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 9.0, "ram_util_percent": 73.6}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.46856451726871, "episode_len_mean": 463.76190476190476, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.46856451726871, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07142857142857142, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.89072507252196, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 197.78571428571428, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.106522544100494, "mean_processing_ms": 2.8883494094629465, "mean_inference_ms": 0.6431180348943596}, "off_policy_estimator": {}, "info": {"num_target_updates": 197, "num_steps_trained": 0, "num_steps_sampled": 19700, "sample_time_ms": 829.39, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.812, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 19700, "episodes_total": 42, "training_iteration": 197, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-05", "timestamp": 1585863785, "time_this_iter_s": 0.6390225887298584, "time_total_s": 178.78215765953064, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 178.78215765953064, "timesteps_since_restore": 19700, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 15.5, "ram_util_percent": 73.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.46856451726871, "episode_len_mean": 463.76190476190476, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.46856451726871, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07142857142857142, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.89072507252196, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 197.78571428571428, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.106522544100494, "mean_processing_ms": 2.8883494094629465, "mean_inference_ms": 0.6431180348943596}, "off_policy_estimator": {}, "info": {"num_target_updates": 198, "num_steps_trained": 0, "num_steps_sampled": 19800, "sample_time_ms": 825.476, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.716, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 19800, "episodes_total": 42, "training_iteration": 198, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-05", "timestamp": 1585863785, "time_this_iter_s": 0.5208485126495361, "time_total_s": 179.30300617218018, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 179.30300617218018, "timesteps_since_restore": 19800, "iterations_since_restore": 198, "perf": {}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.46856451726871, "episode_len_mean": 463.76190476190476, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.46856451726871, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.07142857142857142, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.89072507252196, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 197.78571428571428, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.106522544100494, "mean_processing_ms": 2.8883494094629465, "mean_inference_ms": 0.6431180348943596}, "off_policy_estimator": {}, "info": {"num_target_updates": 199, "num_steps_trained": 0, "num_steps_sampled": 19900, "sample_time_ms": 826.598, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.365, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 19900, "episodes_total": 42, "training_iteration": 199, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-06", "timestamp": 1585863786, "time_this_iter_s": 0.5322721004486084, "time_total_s": 179.83527827262878, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 179.83527827262878, "timesteps_since_restore": 19900, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 14.0, "ram_util_percent": 73.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.529136860800612, "episode_len_mean": 464.6046511627907, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.529136860800612, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06976744186046512, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.902186037909149, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 196.72093023255815, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.090374714632964, "mean_processing_ms": 2.883495097479457, "mean_inference_ms": 0.6425625406272151}, "off_policy_estimator": {}, "info": {"num_target_updates": 200, "num_steps_trained": 0, "num_steps_sampled": 20000, "sample_time_ms": 835.916, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.35, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 20000, "episodes_total": 43, "training_iteration": 200, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-07", "timestamp": 1585863787, "time_this_iter_s": 1.6917979717254639, "time_total_s": 181.52707624435425, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 181.52707624435425, "timesteps_since_restore": 20000, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 9.333333333333334, "ram_util_percent": 73.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.52913686080061, "episode_len_mean": 464.6046511627907, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.52913686080061, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06976744186046512, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.90218603790915, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 196.72093023255815, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.090374714632963, "mean_processing_ms": 2.883495097479457, "mean_inference_ms": 0.6425625406272151}, "off_policy_estimator": {}, "info": {"num_target_updates": 201, "num_steps_trained": 0, "num_steps_sampled": 20100, "sample_time_ms": 832.121, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.292, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 20100, "episodes_total": 43, "training_iteration": 201, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-08", "timestamp": 1585863788, "time_this_iter_s": 0.593252420425415, "time_total_s": 182.12032866477966, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 182.12032866477966, "timesteps_since_restore": 20100, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 10.0, "ram_util_percent": 73.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.52913686080061, "episode_len_mean": 464.6046511627907, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.52913686080061, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06976744186046512, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.90218603790915, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 196.72093023255815, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.090374714632963, "mean_processing_ms": 2.883495097479457, "mean_inference_ms": 0.6425625406272151}, "off_policy_estimator": {}, "info": {"num_target_updates": 202, "num_steps_trained": 0, "num_steps_sampled": 20200, "sample_time_ms": 816.003, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.135, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 20200, "episodes_total": 43, "training_iteration": 202, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-09", "timestamp": 1585863789, "time_this_iter_s": 0.6392765045166016, "time_total_s": 182.75960516929626, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 182.75960516929626, "timesteps_since_restore": 20200, "iterations_since_restore": 202, "perf": {}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.52913686080061, "episode_len_mean": 464.6046511627907, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.52913686080061, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06976744186046512, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.90218603790915, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 196.72093023255815, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.090374714632963, "mean_processing_ms": 2.883495097479457, "mean_inference_ms": 0.6425625406272151}, "off_policy_estimator": {}, "info": {"num_target_updates": 203, "num_steps_trained": 0, "num_steps_sampled": 20300, "sample_time_ms": 814.615, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.072, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 20300, "episodes_total": 43, "training_iteration": 203, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-09", "timestamp": 1585863789, "time_this_iter_s": 0.5677759647369385, "time_total_s": 183.3273811340332, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 183.3273811340332, "timesteps_since_restore": 20300, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 10.3, "ram_util_percent": 73.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.52913686080061, "episode_len_mean": 464.6046511627907, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.52913686080061, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06976744186046512, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.90218603790915, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 196.72093023255815, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.090374714632963, "mean_processing_ms": 2.883495097479457, "mean_inference_ms": 0.6425625406272151}, "off_policy_estimator": {}, "info": {"num_target_updates": 204, "num_steps_trained": 0, "num_steps_sampled": 20400, "sample_time_ms": 809.644, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.072, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 20400, "episodes_total": 43, "training_iteration": 204, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-10", "timestamp": 1585863790, "time_this_iter_s": 0.5897212028503418, "time_total_s": 183.91710233688354, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 183.91710233688354, "timesteps_since_restore": 20400, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 9.5, "ram_util_percent": 73.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.586947503175804, "episode_len_mean": 465.40909090909093, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.586947503175804, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06818181818181818, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.903711406972443, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 196.25, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.074507511844604, "mean_processing_ms": 2.878752446308939, "mean_inference_ms": 0.6420177101485317}, "off_policy_estimator": {}, "info": {"num_target_updates": 205, "num_steps_trained": 0, "num_steps_sampled": 20500, "sample_time_ms": 801.841, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.076, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 20500, "episodes_total": 44, "training_iteration": 205, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-11", "timestamp": 1585863791, "time_this_iter_s": 1.6092994213104248, "time_total_s": 185.52640175819397, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 185.52640175819397, "timesteps_since_restore": 20500, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 6.9, "ram_util_percent": 73.65}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.586947503175804, "episode_len_mean": 465.40909090909093, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.586947503175804, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06818181818181818, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.903711406972443, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 196.25, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.074507511844604, "mean_processing_ms": 2.878752446308939, "mean_inference_ms": 0.6420177101485318}, "off_policy_estimator": {}, "info": {"num_target_updates": 206, "num_steps_trained": 0, "num_steps_sampled": 20600, "sample_time_ms": 792.099, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.991, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 20600, "episodes_total": 44, "training_iteration": 206, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-12", "timestamp": 1585863792, "time_this_iter_s": 0.6139283180236816, "time_total_s": 186.14033007621765, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 186.14033007621765, "timesteps_since_restore": 20600, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 4.7, "ram_util_percent": 73.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.586947503175804, "episode_len_mean": 465.40909090909093, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.586947503175804, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06818181818181818, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.903711406972443, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 196.25, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.074507511844604, "mean_processing_ms": 2.878752446308939, "mean_inference_ms": 0.6420177101485318}, "off_policy_estimator": {}, "info": {"num_target_updates": 207, "num_steps_trained": 0, "num_steps_sampled": 20700, "sample_time_ms": 788.244, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.289, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 20700, "episodes_total": 44, "training_iteration": 207, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-13", "timestamp": 1585863793, "time_this_iter_s": 0.6035501956939697, "time_total_s": 186.74388027191162, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 186.74388027191162, "timesteps_since_restore": 20700, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 14.7, "ram_util_percent": 73.8}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.586947503175804, "episode_len_mean": 465.40909090909093, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.586947503175804, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06818181818181818, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.903711406972443, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 196.25, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.074507511844604, "mean_processing_ms": 2.878752446308939, "mean_inference_ms": 0.6420177101485318}, "off_policy_estimator": {}, "info": {"num_target_updates": 208, "num_steps_trained": 0, "num_steps_sampled": 20800, "sample_time_ms": 788.295, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.359, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 20800, "episodes_total": 44, "training_iteration": 208, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-13", "timestamp": 1585863793, "time_this_iter_s": 0.5224905014038086, "time_total_s": 187.26637077331543, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 187.26637077331543, "timesteps_since_restore": 20800, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 10.0, "ram_util_percent": 73.8}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.586947503175804, "episode_len_mean": 465.40909090909093, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.586947503175804, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06818181818181818, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.903711406972443, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 196.25, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.074507511844604, "mean_processing_ms": 2.878752446308939, "mean_inference_ms": 0.6420177101485318}, "off_policy_estimator": {}, "info": {"num_target_updates": 209, "num_steps_trained": 0, "num_steps_sampled": 20900, "sample_time_ms": 794.116, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.819, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 20900, "episodes_total": 44, "training_iteration": 209, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-14", "timestamp": 1585863794, "time_this_iter_s": 0.5854251384735107, "time_total_s": 187.85179591178894, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 187.85179591178894, "timesteps_since_restore": 20900, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 9.5, "ram_util_percent": 73.8}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.64203103784883, "episode_len_mean": 466.1777777777778, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.64203103784883, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06666666666666667, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.911676208944972, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 195.53333333333333, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.05885656267739, "mean_processing_ms": 2.87414234325002, "mean_inference_ms": 0.6414757779123678}, "off_policy_estimator": {}, "info": {"num_target_updates": 210, "num_steps_trained": 0, "num_steps_sampled": 21000, "sample_time_ms": 788.171, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.816, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 21000, "episodes_total": 45, "training_iteration": 210, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-16", "timestamp": 1585863796, "time_this_iter_s": 1.6320858001708984, "time_total_s": 189.48388171195984, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 189.48388171195984, "timesteps_since_restore": 21000, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 9.3, "ram_util_percent": 73.8}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.64203103784883, "episode_len_mean": 466.1777777777778, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.64203103784883, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06666666666666667, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.911676208944972, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 195.53333333333333, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.05885656267739, "mean_processing_ms": 2.874142343250019, "mean_inference_ms": 0.6414757779123678}, "off_policy_estimator": {}, "info": {"num_target_updates": 211, "num_steps_trained": 0, "num_steps_sampled": 21100, "sample_time_ms": 797.019, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.886, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 21100, "episodes_total": 45, "training_iteration": 211, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-16", "timestamp": 1585863796, "time_this_iter_s": 0.6825852394104004, "time_total_s": 190.16646695137024, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 190.16646695137024, "timesteps_since_restore": 21100, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 6.4, "ram_util_percent": 73.8}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.64203103784883, "episode_len_mean": 466.1777777777778, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.64203103784883, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06666666666666667, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.911676208944972, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 195.53333333333333, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.05885656267739, "mean_processing_ms": 2.874142343250019, "mean_inference_ms": 0.6414757779123678}, "off_policy_estimator": {}, "info": {"num_target_updates": 212, "num_steps_trained": 0, "num_steps_sampled": 21200, "sample_time_ms": 796.857, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.931, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 21200, "episodes_total": 45, "training_iteration": 212, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-17", "timestamp": 1585863797, "time_this_iter_s": 0.6379098892211914, "time_total_s": 190.80437684059143, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 190.80437684059143, "timesteps_since_restore": 21200, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 13.6, "ram_util_percent": 73.9}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.64203103784883, "episode_len_mean": 466.1777777777778, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.64203103784883, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06666666666666667, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.911676208944972, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 195.53333333333333, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.05885656267739, "mean_processing_ms": 2.874142343250019, "mean_inference_ms": 0.6414757779123678}, "off_policy_estimator": {}, "info": {"num_target_updates": 213, "num_steps_trained": 0, "num_steps_sampled": 21300, "sample_time_ms": 791.297, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.959, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 21300, "episodes_total": 45, "training_iteration": 213, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-17", "timestamp": 1585863797, "time_this_iter_s": 0.5122692584991455, "time_total_s": 191.31664609909058, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 191.31664609909058, "timesteps_since_restore": 21300, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 9.7, "ram_util_percent": 73.9}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.64203103784883, "episode_len_mean": 466.1777777777778, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.64203103784883, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06666666666666667, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.911676208944972, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 195.53333333333333, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.05885656267739, "mean_processing_ms": 2.874142343250019, "mean_inference_ms": 0.6414757779123678}, "off_policy_estimator": {}, "info": {"num_target_updates": 214, "num_steps_trained": 0, "num_steps_sampled": 21400, "sample_time_ms": 791.246, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.906, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 21400, "episodes_total": 45, "training_iteration": 214, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-18", "timestamp": 1585863798, "time_this_iter_s": 0.5885615348815918, "time_total_s": 191.90520763397217, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 191.90520763397217, "timesteps_since_restore": 21400, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 10.7, "ram_util_percent": 73.9}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.694856555863545, "episode_len_mean": 466.9130434782609, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.694856555863545, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06521739130434782, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.917052602379618, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 195.2173913043478, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.043561676337737, "mean_processing_ms": 2.8696358352603575, "mean_inference_ms": 0.6409517573806389}, "off_policy_estimator": {}, "info": {"num_target_updates": 215, "num_steps_trained": 0, "num_steps_sampled": 21500, "sample_time_ms": 794.969, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.891, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 21500, "episodes_total": 46, "training_iteration": 215, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-20", "timestamp": 1585863800, "time_this_iter_s": 1.646702527999878, "time_total_s": 193.55191016197205, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 193.55191016197205, "timesteps_since_restore": 21500, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 7.95, "ram_util_percent": 73.8}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.694856555863545, "episode_len_mean": 466.9130434782609, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.694856555863545, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06521739130434782, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.917052602379618, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 195.2173913043478, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.043561676337737, "mean_processing_ms": 2.869635835260357, "mean_inference_ms": 0.640951757380639}, "off_policy_estimator": {}, "info": {"num_target_updates": 216, "num_steps_trained": 0, "num_steps_sampled": 21600, "sample_time_ms": 794.15, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.954, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 21600, "episodes_total": 46, "training_iteration": 216, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-20", "timestamp": 1585863800, "time_this_iter_s": 0.6064541339874268, "time_total_s": 194.15836429595947, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 194.15836429595947, "timesteps_since_restore": 21600, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 6.7, "ram_util_percent": 73.8}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.694856555863545, "episode_len_mean": 466.9130434782609, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.694856555863545, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06521739130434782, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.917052602379618, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 195.2173913043478, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.043561676337737, "mean_processing_ms": 2.869635835260357, "mean_inference_ms": 0.640951757380639}, "off_policy_estimator": {}, "info": {"num_target_updates": 217, "num_steps_trained": 0, "num_steps_sampled": 21700, "sample_time_ms": 797.422, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.588, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 21700, "episodes_total": 46, "training_iteration": 217, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-21", "timestamp": 1585863801, "time_this_iter_s": 0.6326138973236084, "time_total_s": 194.79097819328308, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 194.79097819328308, "timesteps_since_restore": 21700, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 9.7, "ram_util_percent": 73.8}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.694856555863545, "episode_len_mean": 466.9130434782609, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.694856555863545, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06521739130434782, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.917052602379618, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 195.2173913043478, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.043561676337737, "mean_processing_ms": 2.869635835260357, "mean_inference_ms": 0.640951757380639}, "off_policy_estimator": {}, "info": {"num_target_updates": 218, "num_steps_trained": 0, "num_steps_sampled": 21800, "sample_time_ms": 797.796, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.544, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 21800, "episodes_total": 46, "training_iteration": 218, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-21", "timestamp": 1585863801, "time_this_iter_s": 0.525681734085083, "time_total_s": 195.31665992736816, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 195.31665992736816, "timesteps_since_restore": 21800, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 10.1, "ram_util_percent": 73.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.694856555863545, "episode_len_mean": 466.9130434782609, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.694856555863545, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06521739130434782, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.917052602379618, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 195.2173913043478, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.043561676337737, "mean_processing_ms": 2.869635835260357, "mean_inference_ms": 0.640951757380639}, "off_policy_estimator": {}, "info": {"num_target_updates": 219, "num_steps_trained": 0, "num_steps_sampled": 21900, "sample_time_ms": 796.312, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.89, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 21900, "episodes_total": 46, "training_iteration": 219, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-22", "timestamp": 1585863802, "time_this_iter_s": 0.5736949443817139, "time_total_s": 195.89035487174988, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 195.89035487174988, "timesteps_since_restore": 21900, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 16.0, "ram_util_percent": 73.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.745458421190893, "episode_len_mean": 467.6170212765957, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.745458421190893, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06382978723404255, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.927289070455636, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 194.38297872340425, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.028538436977368, "mean_processing_ms": 2.8652286323867617, "mean_inference_ms": 0.6404419259323666}, "off_policy_estimator": {}, "info": {"num_target_updates": 220, "num_steps_trained": 0, "num_steps_sampled": 22000, "sample_time_ms": 798.519, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.917, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 22000, "episodes_total": 47, "training_iteration": 220, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-24", "timestamp": 1585863804, "time_this_iter_s": 1.654707431793213, "time_total_s": 197.5450623035431, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 197.5450623035431, "timesteps_since_restore": 22000, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 6.85, "ram_util_percent": 73.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.74545842119089, "episode_len_mean": 467.6170212765957, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.74545842119089, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06382978723404255, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.927289070455636, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 194.38297872340425, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.028538436977368, "mean_processing_ms": 2.8652286323867617, "mean_inference_ms": 0.6404419259323666}, "off_policy_estimator": {}, "info": {"num_target_updates": 221, "num_steps_trained": 0, "num_steps_sampled": 22100, "sample_time_ms": 801.549, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.066, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 22100, "episodes_total": 47, "training_iteration": 221, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-24", "timestamp": 1585863804, "time_this_iter_s": 0.7144374847412109, "time_total_s": 198.2594997882843, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 198.2594997882843, "timesteps_since_restore": 22100, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 7.8, "ram_util_percent": 73.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.74545842119089, "episode_len_mean": 467.6170212765957, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.74545842119089, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06382978723404255, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.927289070455636, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 194.38297872340425, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.028538436977368, "mean_processing_ms": 2.8652286323867617, "mean_inference_ms": 0.6404419259323666}, "off_policy_estimator": {}, "info": {"num_target_updates": 222, "num_steps_trained": 0, "num_steps_sampled": 22200, "sample_time_ms": 794.423, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.087, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 22200, "episodes_total": 47, "training_iteration": 222, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-25", "timestamp": 1585863805, "time_this_iter_s": 0.5670647621154785, "time_total_s": 198.82656455039978, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 198.82656455039978, "timesteps_since_restore": 22200, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 9.9, "ram_util_percent": 73.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.74545842119089, "episode_len_mean": 467.6170212765957, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.74545842119089, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06382978723404255, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.927289070455636, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 194.38297872340425, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.028538436977368, "mean_processing_ms": 2.8652286323867617, "mean_inference_ms": 0.6404419259323666}, "off_policy_estimator": {}, "info": {"num_target_updates": 223, "num_steps_trained": 0, "num_steps_sampled": 22300, "sample_time_ms": 794.109, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.143, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 22300, "episodes_total": 47, "training_iteration": 223, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-26", "timestamp": 1585863806, "time_this_iter_s": 0.5095505714416504, "time_total_s": 199.33611512184143, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 199.33611512184143, "timesteps_since_restore": 22300, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 9.5, "ram_util_percent": 73.7}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.74545842119089, "episode_len_mean": 467.6170212765957, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.74545842119089, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06382978723404255, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.927289070455636, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 194.38297872340425, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.028538436977368, "mean_processing_ms": 2.8652286323867617, "mean_inference_ms": 0.6404419259323666}, "off_policy_estimator": {}, "info": {"num_target_updates": 224, "num_steps_trained": 0, "num_steps_sampled": 22400, "sample_time_ms": 799.39, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.25, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 22400, "episodes_total": 47, "training_iteration": 224, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-26", "timestamp": 1585863806, "time_this_iter_s": 0.6426265239715576, "time_total_s": 199.978741645813, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 199.978741645813, "timesteps_since_restore": 22400, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 20.6, "ram_util_percent": 73.6}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.793791680616124, "episode_len_mean": 468.2916666666667, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.793791680616124, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.0625, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.927587513700016, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 193.35416666666666, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.013851699629751, "mean_processing_ms": 2.860923413411158, "mean_inference_ms": 0.6399583029387067}, "off_policy_estimator": {}, "info": {"num_target_updates": 225, "num_steps_trained": 0, "num_steps_sampled": 22500, "sample_time_ms": 799.697, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.409, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 22500, "episodes_total": 48, "training_iteration": 225, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-28", "timestamp": 1585863808, "time_this_iter_s": 1.6512105464935303, "time_total_s": 201.62995219230652, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 201.62995219230652, "timesteps_since_restore": 22500, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 5.25, "ram_util_percent": 73.6}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.793791680616124, "episode_len_mean": 468.2916666666667, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.793791680616124, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.0625, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.927587513700016, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 193.35416666666666, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.013851699629754, "mean_processing_ms": 2.860923413411158, "mean_inference_ms": 0.6399583029387067}, "off_policy_estimator": {}, "info": {"num_target_updates": 226, "num_steps_trained": 0, "num_steps_sampled": 22600, "sample_time_ms": 799.093, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.368, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 22600, "episodes_total": 48, "training_iteration": 226, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-29", "timestamp": 1585863809, "time_this_iter_s": 0.6001856327056885, "time_total_s": 202.2301378250122, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 202.2301378250122, "timesteps_since_restore": 22600, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 8.7, "ram_util_percent": 73.6}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.793791680616124, "episode_len_mean": 468.2916666666667, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.793791680616124, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.0625, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.927587513700016, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 193.35416666666666, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.013851699629754, "mean_processing_ms": 2.860923413411158, "mean_inference_ms": 0.6399583029387067}, "off_policy_estimator": {}, "info": {"num_target_updates": 227, "num_steps_trained": 0, "num_steps_sampled": 22700, "sample_time_ms": 796.833, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.34, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 22700, "episodes_total": 48, "training_iteration": 227, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-29", "timestamp": 1585863809, "time_this_iter_s": 0.6094846725463867, "time_total_s": 202.8396224975586, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 202.8396224975586, "timesteps_since_restore": 22700, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 9.5, "ram_util_percent": 73.6}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.793791680616124, "episode_len_mean": 468.2916666666667, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.793791680616124, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.0625, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.927587513700016, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 193.35416666666666, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.013851699629754, "mean_processing_ms": 2.860923413411158, "mean_inference_ms": 0.6399583029387067}, "off_policy_estimator": {}, "info": {"num_target_updates": 228, "num_steps_trained": 0, "num_steps_sampled": 22800, "sample_time_ms": 794.709, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.351, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 22800, "episodes_total": 48, "training_iteration": 228, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-30", "timestamp": 1585863810, "time_this_iter_s": 0.5043501853942871, "time_total_s": 203.34397268295288, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 203.34397268295288, "timesteps_since_restore": 22800, "iterations_since_restore": 228, "perf": {}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.793791680616124, "episode_len_mean": 468.2916666666667, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.793791680616124, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.0625, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.927587513700016, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 193.35416666666666, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.013851699629754, "mean_processing_ms": 2.860923413411158, "mean_inference_ms": 0.6399583029387067}, "off_policy_estimator": {}, "info": {"num_target_updates": 229, "num_steps_trained": 0, "num_steps_sampled": 22900, "sample_time_ms": 792.359, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.935, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 22900, "episodes_total": 48, "training_iteration": 229, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-30", "timestamp": 1585863810, "time_this_iter_s": 0.5461757183074951, "time_total_s": 203.89014840126038, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 203.89014840126038, "timesteps_since_restore": 22900, "iterations_since_restore": 229, "perf": {"cpu_util_percent": 9.1, "ram_util_percent": 73.6}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.840174844088505, "episode_len_mean": 468.9387755102041, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.840174844088505, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.061224489795918366, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.935922356236421, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 193.71428571428572, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.999396391215872, "mean_processing_ms": 2.856710863297727, "mean_inference_ms": 0.6394728032093502}, "off_policy_estimator": {}, "info": {"num_target_updates": 230, "num_steps_trained": 0, "num_steps_sampled": 23000, "sample_time_ms": 793.819, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.962, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 23000, "episodes_total": 49, "training_iteration": 230, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-32", "timestamp": 1585863812, "time_this_iter_s": 1.669485330581665, "time_total_s": 205.55963373184204, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 205.55963373184204, "timesteps_since_restore": 23000, "iterations_since_restore": 230, "perf": {"cpu_util_percent": 13.633333333333333, "ram_util_percent": 73.83333333333333}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.840174844088505, "episode_len_mean": 468.9387755102041, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.840174844088505, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.061224489795918366, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.935922356236421, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 193.71428571428572, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.999396391215874, "mean_processing_ms": 2.856710863297727, "mean_inference_ms": 0.6394728032093501}, "off_policy_estimator": {}, "info": {"num_target_updates": 231, "num_steps_trained": 0, "num_steps_sampled": 23100, "sample_time_ms": 795.695, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.864, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 23100, "episodes_total": 49, "training_iteration": 231, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-33", "timestamp": 1585863813, "time_this_iter_s": 0.7321712970733643, "time_total_s": 206.2918050289154, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 206.2918050289154, "timesteps_since_restore": 23100, "iterations_since_restore": 231, "perf": {"cpu_util_percent": 15.5, "ram_util_percent": 74.2}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.840174844088505, "episode_len_mean": 468.9387755102041, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.840174844088505, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.061224489795918366, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.935922356236421, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 193.71428571428572, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.999396391215874, "mean_processing_ms": 2.856710863297727, "mean_inference_ms": 0.6394728032093501}, "off_policy_estimator": {}, "info": {"num_target_updates": 232, "num_steps_trained": 0, "num_steps_sampled": 23200, "sample_time_ms": 803.389, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.874, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 23200, "episodes_total": 49, "training_iteration": 232, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-33", "timestamp": 1585863813, "time_this_iter_s": 0.644017219543457, "time_total_s": 206.93582224845886, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 206.93582224845886, "timesteps_since_restore": 23200, "iterations_since_restore": 232, "perf": {"cpu_util_percent": 15.3, "ram_util_percent": 74.2}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.840174844088505, "episode_len_mean": 468.9387755102041, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.840174844088505, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.061224489795918366, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.935922356236421, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 193.71428571428572, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.999396391215874, "mean_processing_ms": 2.856710863297727, "mean_inference_ms": 0.6394728032093501}, "off_policy_estimator": {}, "info": {"num_target_updates": 233, "num_steps_trained": 0, "num_steps_sampled": 23300, "sample_time_ms": 809.075, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.846, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 23300, "episodes_total": 49, "training_iteration": 233, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-34", "timestamp": 1585863814, "time_this_iter_s": 0.5662684440612793, "time_total_s": 207.50209069252014, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 207.50209069252014, "timesteps_since_restore": 23300, "iterations_since_restore": 233, "perf": {}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.840174844088505, "episode_len_mean": 468.9387755102041, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.840174844088505, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.061224489795918366, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.935922356236421, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 193.71428571428572, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.999396391215874, "mean_processing_ms": 2.856710863297727, "mean_inference_ms": 0.6394728032093501}, "off_policy_estimator": {}, "info": {"num_target_updates": 234, "num_steps_trained": 0, "num_steps_sampled": 23400, "sample_time_ms": 798.533, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.753, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 23400, "episodes_total": 49, "training_iteration": 234, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-34", "timestamp": 1585863814, "time_this_iter_s": 0.5363445281982422, "time_total_s": 208.03843522071838, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 208.03843522071838, "timesteps_since_restore": 23400, "iterations_since_restore": 234, "perf": {"cpu_util_percent": 14.6, "ram_util_percent": 74.2}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.884692455261916, "episode_len_mean": 469.56, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.884692455261916, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.940703192780949, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 193.12, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.985278819723451, "mean_processing_ms": 2.8526027091449992, "mean_inference_ms": 0.639029929706812}, "off_policy_estimator": {}, "info": {"num_target_updates": 235, "num_steps_trained": 0, "num_steps_sampled": 23500, "sample_time_ms": 802.596, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.58, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 23500, "episodes_total": 50, "training_iteration": 235, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-36", "timestamp": 1585863816, "time_this_iter_s": 1.6902716159820557, "time_total_s": 209.72870683670044, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 209.72870683670044, "timesteps_since_restore": 23500, "iterations_since_restore": 235, "perf": {"cpu_util_percent": 13.333333333333334, "ram_util_percent": 74.23333333333333}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.884692455261916, "episode_len_mean": 469.56, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.884692455261916, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.9407031927809495, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 193.12, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.985278819723452, "mean_processing_ms": 2.8526027091449992, "mean_inference_ms": 0.6390299297068119}, "off_policy_estimator": {}, "info": {"num_target_updates": 236, "num_steps_trained": 0, "num_steps_sampled": 23600, "sample_time_ms": 811.039, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.635, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 23600, "episodes_total": 50, "training_iteration": 236, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-37", "timestamp": 1585863817, "time_this_iter_s": 0.6858565807342529, "time_total_s": 210.4145634174347, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 210.4145634174347, "timesteps_since_restore": 23600, "iterations_since_restore": 236, "perf": {"cpu_util_percent": 15.3, "ram_util_percent": 74.4}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.884692455261916, "episode_len_mean": 469.56, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.884692455261916, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.9407031927809495, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 193.12, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.985278819723452, "mean_processing_ms": 2.8526027091449992, "mean_inference_ms": 0.6390299297068119}, "off_policy_estimator": {}, "info": {"num_target_updates": 237, "num_steps_trained": 0, "num_steps_sampled": 23700, "sample_time_ms": 809.666, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.675, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 23700, "episodes_total": 50, "training_iteration": 237, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-37", "timestamp": 1585863817, "time_this_iter_s": 0.596447229385376, "time_total_s": 211.01101064682007, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 211.01101064682007, "timesteps_since_restore": 23700, "iterations_since_restore": 237, "perf": {"cpu_util_percent": 14.1, "ram_util_percent": 74.3}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.884692455261916, "episode_len_mean": 469.56, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.884692455261916, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.9407031927809495, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 193.12, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.985278819723452, "mean_processing_ms": 2.8526027091449992, "mean_inference_ms": 0.6390299297068119}, "off_policy_estimator": {}, "info": {"num_target_updates": 238, "num_steps_trained": 0, "num_steps_sampled": 23800, "sample_time_ms": 814.807, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.656, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 23800, "episodes_total": 50, "training_iteration": 238, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-38", "timestamp": 1585863818, "time_this_iter_s": 0.5556976795196533, "time_total_s": 211.56670832633972, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 211.56670832633972, "timesteps_since_restore": 23800, "iterations_since_restore": 238, "perf": {}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.884692455261916, "episode_len_mean": 469.56, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.884692455261916, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.9407031927809495, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 193.12, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.985278819723452, "mean_processing_ms": 2.8526027091449992, "mean_inference_ms": 0.6390299297068119}, "off_policy_estimator": {}, "info": {"num_target_updates": 239, "num_steps_trained": 0, "num_steps_sampled": 23900, "sample_time_ms": 812.131, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.663, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 23900, "episodes_total": 50, "training_iteration": 239, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-39", "timestamp": 1585863819, "time_this_iter_s": 0.51949143409729, "time_total_s": 212.086199760437, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 212.086199760437, "timesteps_since_restore": 23900, "iterations_since_restore": 239, "perf": {"cpu_util_percent": 12.3, "ram_util_percent": 74.3}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.927456207177816, "episode_len_mean": 470.15686274509807, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.927456207177816, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.058823529411764705, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.949841596433812, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 192.64705882352942, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.971442467103995, "mean_processing_ms": 2.8485923353416793, "mean_inference_ms": 0.6386177873342996}, "off_policy_estimator": {}, "info": {"num_target_updates": 240, "num_steps_trained": 0, "num_steps_sampled": 24000, "sample_time_ms": 815.403, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.67, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 24000, "episodes_total": 51, "training_iteration": 240, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-40", "timestamp": 1585863820, "time_this_iter_s": 1.7025327682495117, "time_total_s": 213.78873252868652, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 213.78873252868652, "timesteps_since_restore": 24000, "iterations_since_restore": 240, "perf": {"cpu_util_percent": 7.833333333333333, "ram_util_percent": 74.3}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.927456207177816, "episode_len_mean": 470.15686274509807, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.927456207177816, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.058823529411764705, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.949841596433812, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 192.64705882352942, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.971442467103997, "mean_processing_ms": 2.8485923353416793, "mean_inference_ms": 0.6386177873342996}, "off_policy_estimator": {}, "info": {"num_target_updates": 241, "num_steps_trained": 0, "num_steps_sampled": 24100, "sample_time_ms": 800.997, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.723, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 24100, "episodes_total": 51, "training_iteration": 241, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-41", "timestamp": 1585863821, "time_this_iter_s": 0.5884714126586914, "time_total_s": 214.37720394134521, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 214.37720394134521, "timesteps_since_restore": 24100, "iterations_since_restore": 241, "perf": {}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.48697055225172, "episode_len_mean": 463.65384615384613, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.48697055225172, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.057692307692307696, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.919772522996222, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 191.48076923076923, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.958525840379567, "mean_processing_ms": 2.845332237184842, "mean_inference_ms": 0.6382739222758624}, "off_policy_estimator": {}, "info": {"num_target_updates": 242, "num_steps_trained": 0, "num_steps_sampled": 24200, "sample_time_ms": 987.556, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.643, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 24200, "episodes_total": 52, "training_iteration": 242, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-43", "timestamp": 1585863823, "time_this_iter_s": 2.5101332664489746, "time_total_s": 216.8873372077942, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 216.8873372077942, "timesteps_since_restore": 24200, "iterations_since_restore": 242, "perf": {"cpu_util_percent": 29.825000000000003, "ram_util_percent": 74.375}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.48697055225172, "episode_len_mean": 463.65384615384613, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.48697055225172, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.057692307692307696, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.919772522996222, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 191.48076923076923, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.9585258403795685, "mean_processing_ms": 2.845332237184842, "mean_inference_ms": 0.6382739222758624}, "off_policy_estimator": {}, "info": {"num_target_updates": 243, "num_steps_trained": 0, "num_steps_sampled": 24300, "sample_time_ms": 1013.038, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.923, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 24300, "episodes_total": 52, "training_iteration": 243, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-44", "timestamp": 1585863824, "time_this_iter_s": 0.8242027759552002, "time_total_s": 217.7115399837494, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 217.7115399837494, "timesteps_since_restore": 24300, "iterations_since_restore": 243, "perf": {"cpu_util_percent": 31.7, "ram_util_percent": 74.6}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.48697055225172, "episode_len_mean": 463.65384615384613, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.48697055225172, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.057692307692307696, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.919772522996222, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 191.48076923076923, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.9585258403795685, "mean_processing_ms": 2.845332237184842, "mean_inference_ms": 0.6382739222758624}, "off_policy_estimator": {}, "info": {"num_target_updates": 244, "num_steps_trained": 0, "num_steps_sampled": 24400, "sample_time_ms": 1016.394, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.947, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 24400, "episodes_total": 52, "training_iteration": 244, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-45", "timestamp": 1585863825, "time_this_iter_s": 0.5704288482666016, "time_total_s": 218.281968832016, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 218.281968832016, "timesteps_since_restore": 24400, "iterations_since_restore": 244, "perf": {"cpu_util_percent": 13.9, "ram_util_percent": 74.6}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.48697055225172, "episode_len_mean": 463.65384615384613, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.48697055225172, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.057692307692307696, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.919772522996222, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 191.48076923076923, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.9585258403795685, "mean_processing_ms": 2.845332237184842, "mean_inference_ms": 0.6382739222758624}, "off_policy_estimator": {}, "info": {"num_target_updates": 245, "num_steps_trained": 0, "num_steps_sampled": 24500, "sample_time_ms": 903.406, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.958, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 24500, "episodes_total": 52, "training_iteration": 245, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-45", "timestamp": 1585863825, "time_this_iter_s": 0.5598175525665283, "time_total_s": 218.84178638458252, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 218.84178638458252, "timesteps_since_restore": 24500, "iterations_since_restore": 245, "perf": {"cpu_util_percent": 12.6, "ram_util_percent": 74.6}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.48697055225172, "episode_len_mean": 463.65384615384613, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.48697055225172, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.057692307692307696, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.919772522996222, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 191.48076923076923, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.9585258403795685, "mean_processing_ms": 2.845332237184842, "mean_inference_ms": 0.6382739222758624}, "off_policy_estimator": {}, "info": {"num_target_updates": 246, "num_steps_trained": 0, "num_steps_sampled": 24600, "sample_time_ms": 903.381, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.935, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 24600, "episodes_total": 52, "training_iteration": 246, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-46", "timestamp": 1585863826, "time_this_iter_s": 0.6888620853424072, "time_total_s": 219.53064846992493, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 219.53064846992493, "timesteps_since_restore": 24600, "iterations_since_restore": 246, "perf": {"cpu_util_percent": 11.3, "ram_util_percent": 74.6}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.535634613467312, "episode_len_mean": 464.33962264150944, "episodes_this_iter": 1, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.535634613467312, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.05660377358490566, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.91904472558393, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 190.96226415094338, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.946029323434985, "mean_processing_ms": 2.8421522790982743, "mean_inference_ms": 0.6379692290222407}, "off_policy_estimator": {}, "info": {"num_target_updates": 247, "num_steps_trained": 0, "num_steps_sampled": 24700, "sample_time_ms": 1021.125, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.946, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 24700, "episodes_total": 53, "training_iteration": 247, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-48", "timestamp": 1585863828, "time_this_iter_s": 1.7749450206756592, "time_total_s": 221.3055934906006, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 221.3055934906006, "timesteps_since_restore": 24700, "iterations_since_restore": 247, "perf": {"cpu_util_percent": 15.15, "ram_util_percent": 74.0}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.535634613467312, "episode_len_mean": 464.33962264150944, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.535634613467312, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.05660377358490566, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.91904472558393, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 190.96226415094338, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.946029323434987, "mean_processing_ms": 2.8421522790982743, "mean_inference_ms": 0.6379692290222408}, "off_policy_estimator": {}, "info": {"num_target_updates": 248, "num_steps_trained": 0, "num_steps_sampled": 24800, "sample_time_ms": 1025.686, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.011, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 24800, "episodes_total": 53, "training_iteration": 248, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-49", "timestamp": 1585863829, "time_this_iter_s": 0.6021099090576172, "time_total_s": 221.9077033996582, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 221.9077033996582, "timesteps_since_restore": 24800, "iterations_since_restore": 248, "perf": {"cpu_util_percent": 12.4, "ram_util_percent": 74.0}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.535634613467312, "episode_len_mean": 464.33962264150944, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.535634613467312, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.05660377358490566, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.91904472558393, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 190.96226415094338, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.946029323434987, "mean_processing_ms": 2.8421522790982743, "mean_inference_ms": 0.6379692290222408}, "off_policy_estimator": {}, "info": {"num_target_updates": 249, "num_steps_trained": 0, "num_steps_sampled": 24900, "sample_time_ms": 1030.257, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.971, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": false, "timesteps_total": 24900, "episodes_total": 53, "training_iteration": 249, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-49", "timestamp": 1585863829, "time_this_iter_s": 0.5650925636291504, "time_total_s": 222.47279596328735, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 222.47279596328735, "timesteps_since_restore": 24900, "iterations_since_restore": 249, "perf": {"cpu_util_percent": 9.9, "ram_util_percent": 73.9}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
{"episode_reward_max": 25.07370197012815, "episode_reward_min": -2.99696360401763, "episode_reward_mean": 22.535634613467312, "episode_len_mean": 464.33962264150944, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -2.99696360401763, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_max": {"policy_0": 25.07370197012815, "policy_1": 0.0, "policy_2": 0.0}, "policy_reward_mean": {"policy_0": 22.535634613467312, "policy_1": 0.0, "policy_2": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.05660377358490566, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 5.91904472558393, "avg_speed_min": 3.5608445534932436, "avg_speed_max": 6.628779530666765, "avg_rl_veh_arrival_mean": 190.96226415094338, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.946029323434987, "mean_processing_ms": 2.8421522790982743, "mean_inference_ms": 0.6379692290222408}, "off_policy_estimator": {}, "info": {"num_target_updates": 250, "num_steps_trained": 0, "num_steps_sampled": 25000, "sample_time_ms": 931.948, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 4.927, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 100, "done": true, "timesteps_total": 25000, "episodes_total": 53, "training_iteration": 250, "experiment_id": "b0ae3c125bb04d3a920089f2a3191a27", "date": "2020-04-02_14-43-50", "timestamp": 1585863830, "time_this_iter_s": 0.7180500030517578, "time_total_s": 223.1908459663391, "pid": 7489, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"num_workers": 1, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 1024, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"qmix\": true,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f72ad2de9d8>", "on_episode_step": "<function on_episode_step at 0x7f72ad2dea60>", "on_episode_end": "<function on_episode_end at 0x7f72ad2deae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 0, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 1, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}], "policy_2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(25,)", "Box(1,)", {"agent_id": 2, "use_local_critic": true, "obs_space_dict": {"0": "Box(25,)", "1": "Box(25,)", "2": "Box(25,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_QMIX.<locals>.<lambda> at 0x7f72ad2ec158>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 223.1908459663391, "timesteps_since_restore": 25000, "iterations_since_restore": 250, "perf": {"cpu_util_percent": 15.8, "ram_util_percent": 74.0}, "num_healthy_workers": 1, "trial_id": "76a54d9c", "experiment_tag": "0"}
