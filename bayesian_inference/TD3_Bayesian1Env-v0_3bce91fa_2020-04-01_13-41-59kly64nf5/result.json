{"episode_reward_max": 6.645956788876546, "episode_reward_min": 0.5936954270602125, "episode_reward_mean": 3.6198261079683793, "episode_len_mean": 500.0, "episodes_this_iter": 2, "policy_reward_min": {"av": 0.43570774736478984}, "policy_reward_max": {"av": 5.5250606985787805}, "policy_reward_mean": {"av": 1.8099130539841897}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 0.8738472671771663, "avg_speed_min": 0.7771171105139467, "avg_speed_max": 0.9705774238403859, "avg_rl_veh_arrival_mean": 500.5, "avg_rl_veh_arrival_min": 500.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.843734480165221, "mean_processing_ms": 3.4388807508257124, "mean_inference_ms": 1.6160247090098623}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 879, "num_steps_trained": 0, "num_steps_sampled": 1000, "sample_time_ms": 128.544, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 0.005, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 1000, "episodes_total": 2, "training_iteration": 1, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_13-42-19", "timestamp": 1585773739, "time_this_iter_s": 12.44058108329773, "time_total_s": 12.44058108329773, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18f86598>", "on_episode_step": "<function on_episode_step at 0x7ffa18f86488>", "on_episode_end": "<function on_episode_end at 0x7ffa18f86400>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa18f86ae8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 12.44058108329773, "timesteps_since_restore": 1000, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 52.74444444444445, "ram_util_percent": 65.03333333333333}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 9.194148159085412, "episode_reward_min": 0.5936954270602125, "episode_reward_mean": 5.096840585610597, "episode_len_mean": 500.0, "episodes_this_iter": 2, "policy_reward_min": {"av": 0.43570774736478984}, "policy_reward_max": {"av": 5.5250606985787805}, "policy_reward_mean": {"av": 2.5484202928052957}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 1.1018240238362451, "avg_speed_min": 0.7771171105139467, "avg_speed_max": 1.3963170969437644, "avg_rl_veh_arrival_mean": 500.25, "avg_rl_veh_arrival_min": 500.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.7586500915805985, "mean_processing_ms": 3.488386844332327, "mean_inference_ms": 1.6263060842079202}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 1775, "num_steps_trained": 0, "num_steps_sampled": 2000, "sample_time_ms": 122.39, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 0.005, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 2000, "episodes_total": 4, "training_iteration": 2, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_13-42-32", "timestamp": 1585773752, "time_this_iter_s": 12.61748480796814, "time_total_s": 25.05806589126587, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18f86f28>", "on_episode_step": "<function on_episode_step at 0x7ffa18f86bf8>", "on_episode_end": "<function on_episode_end at 0x7ffa18f86510>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9e8712950>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 25.05806589126587, "timesteps_since_restore": 2000, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 57.76111111111111, "ram_util_percent": 65.02777777777777}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 9.194148159085412, "episode_reward_min": 0.5373320236107403, "episode_reward_mean": 3.684444564614259, "episode_len_mean": 500.0, "episodes_this_iter": 2, "policy_reward_min": {"av": 0.43570774736478984}, "policy_reward_max": {"av": 5.5250606985787805}, "policy_reward_mean": {"av": 2.0096970352441392}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 0.9256182584481619, "avg_speed_min": 0.5113432233936803, "avg_speed_max": 1.3963170969437644, "avg_rl_veh_arrival_mean": 500.1666666666667, "avg_rl_veh_arrival_min": 500.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.561967433764212, "mean_processing_ms": 3.4913654733673987, "mean_inference_ms": 1.625629159632626}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 2652, "num_steps_trained": 0, "num_steps_sampled": 3000, "sample_time_ms": 123.753, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 0.006, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 3000, "episodes_total": 6, "training_iteration": 3, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_13-42-42", "timestamp": 1585773762, "time_this_iter_s": 10.826478004455566, "time_total_s": 35.884543895721436, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9e874b268>", "on_episode_step": "<function on_episode_step at 0x7ff9e874b0d0>", "on_episode_end": "<function on_episode_end at 0x7ff9e874b158>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa1817f840>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 35.884543895721436, "timesteps_since_restore": 3000, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 71.725, "ram_util_percent": 65.05}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 9.194148159085412, "episode_reward_min": -298.2416031608262, "episode_reward_mean": -34.43843769890528, "episode_len_mean": 447.125, "episodes_this_iter": 2, "policy_reward_min": {"av": -298.28246794957374}, "policy_reward_max": {"av": 5.5250606985787805}, "policy_reward_mean": {"av": -19.679107256517305}, "custom_metrics": {"num_ped_collisions_mean": 0.125, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 1.3599022438498294, "avg_speed_min": 0.5113432233936803, "avg_speed_max": 4.687145107939487, "avg_rl_veh_arrival_mean": 500.125, "avg_rl_veh_arrival_min": 500.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.3954071879781615, "mean_processing_ms": 3.4806853440336534, "mean_inference_ms": 1.615591223044823}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 3477, "num_steps_trained": 0, "num_steps_sampled": 4000, "sample_time_ms": 8.056, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 0.006, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 4000, "episodes_total": 8, "training_iteration": 4, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_13-42-53", "timestamp": 1585773773, "time_this_iter_s": 10.306469202041626, "time_total_s": 46.19101309776306, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18f860d0>", "on_episode_step": "<function on_episode_step at 0x7ffa18f86840>", "on_episode_end": "<function on_episode_end at 0x7ffa18f86a60>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa18f869d8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 46.19101309776306, "timesteps_since_restore": 4000, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 76.00714285714287, "ram_util_percent": 65.07142857142858}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 9.194148159085412, "episode_reward_min": -298.2416031608262, "episode_reward_mean": -26.861263735590313, "episode_len_mean": 457.7, "episodes_this_iter": 2, "policy_reward_min": {"av": -298.28246794957374}, "policy_reward_max": {"av": 5.5250606985787805}, "policy_reward_mean": {"av": -14.922924297550175}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 1.2627247140407056, "avg_speed_min": 0.5113432233936803, "avg_speed_max": 4.687145107939487, "avg_rl_veh_arrival_mean": 500.1, "avg_rl_veh_arrival_min": 500.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.274085213046881, "mean_processing_ms": 3.4714581840471603, "mean_inference_ms": 1.6081429720311333}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 4351, "num_steps_trained": 0, "num_steps_sampled": 5000, "sample_time_ms": 5.556, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 0.005, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 5000, "episodes_total": 10, "training_iteration": 5, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_13-43-04", "timestamp": 1585773784, "time_this_iter_s": 10.898777723312378, "time_total_s": 57.08979082107544, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9e874b730>", "on_episode_step": "<function on_episode_step at 0x7ff9e874b840>", "on_episode_end": "<function on_episode_end at 0x7ff9e874b6a8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9e874bd08>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 57.08979082107544, "timesteps_since_restore": 5000, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 76.56875, "ram_util_percent": 65.04374999999999}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 9.194148159085412, "episode_reward_min": -299.34238635385793, "episode_reward_mean": -43.58731273019386, "episode_len_mean": 455.53846153846155, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.6688395671563}, "policy_reward_max": {"av": 5.5250606985787805}, "policy_reward_mean": {"av": -25.75613934056911}, "custom_metrics": {"num_ped_collisions_mean": 0.15384615384615385, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 1.1367100904406073, "avg_speed_min": 0.5113432233936803, "avg_speed_max": 4.687145107939487, "avg_rl_veh_arrival_mean": 500.0769230769231, "avg_rl_veh_arrival_min": 500.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.1421194976523905, "mean_processing_ms": 3.5057071915599725, "mean_inference_ms": 1.5966664970041857}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 5181, "num_steps_trained": 0, "num_steps_sampled": 6000, "sample_time_ms": 8.841, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 0.005, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 6000, "episodes_total": 13, "training_iteration": 6, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_13-43-15", "timestamp": 1585773795, "time_this_iter_s": 11.7189302444458, "time_total_s": 68.80872106552124, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18f86bf8>", "on_episode_step": "<function on_episode_step at 0x7ffa18f867b8>", "on_episode_end": "<function on_episode_end at 0x7ffa18f86158>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa18f868c8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 68.80872106552124, "timesteps_since_restore": 6000, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 71.61176470588236, "ram_util_percent": 65.08235294117647}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 9.194148159085412, "episode_reward_min": -299.34238635385793, "episode_reward_mean": -37.36135863297083, "episode_len_mean": 461.46666666666664, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.6688395671563}, "policy_reward_max": {"av": 5.5250606985787805}, "policy_reward_mean": {"av": -21.554629980560094}, "custom_metrics": {"num_ped_collisions_mean": 0.13333333333333333, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 1.083691895443262, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 4.687145107939487, "avg_rl_veh_arrival_mean": 500.06666666666666, "avg_rl_veh_arrival_min": 500.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.089487623135886, "mean_processing_ms": 3.520432417589977, "mean_inference_ms": 1.592526935529589}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 6072, "num_steps_trained": 0, "num_steps_sampled": 7000, "sample_time_ms": 8.897, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 0.007, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 7000, "episodes_total": 15, "training_iteration": 7, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_13-43-28", "timestamp": 1585773808, "time_this_iter_s": 12.00898814201355, "time_total_s": 80.81770920753479, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18f86f28>", "on_episode_step": "<function on_episode_step at 0x7ffa18f861e0>", "on_episode_end": "<function on_episode_end at 0x7ffa18f869d8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa18f862f0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 80.81770920753479, "timesteps_since_restore": 7000, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 81.49411764705881, "ram_util_percent": 65.05294117647058}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 9.194148159085412, "episode_reward_min": -299.34238635385793, "episode_reward_mean": -32.68566914458155, "episode_len_mean": 466.0, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.6688395671563}, "policy_reward_max": {"av": 5.5250606985787805}, "policy_reward_mean": {"av": -17.36426173305895}, "custom_metrics": {"num_ped_collisions_mean": 0.11764705882352941, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 1.044150778987595, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 4.687145107939487, "avg_rl_veh_arrival_mean": 500.05882352941177, "avg_rl_veh_arrival_min": 500.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.075434240212253, "mean_processing_ms": 3.536593929116803, "mean_inference_ms": 1.5909600120052858}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 6944, "num_steps_trained": 0, "num_steps_sampled": 8000, "sample_time_ms": 9.946, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 0.005, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 8000, "episodes_total": 17, "training_iteration": 8, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_13-43-42", "timestamp": 1585773822, "time_this_iter_s": 14.12962293624878, "time_total_s": 94.94733214378357, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa08197ea0>", "on_episode_step": "<function on_episode_step at 0x7ffa08197bf8>", "on_episode_end": "<function on_episode_end at 0x7ffa08197158>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa08197840>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 94.94733214378357, "timesteps_since_restore": 8000, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 78.91, "ram_util_percent": 65.08499999999998}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 9.194148159085412, "episode_reward_min": -299.34238635385793, "episode_reward_mean": -42.558487613089646, "episode_len_mean": 449.65, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.6688395671563}, "policy_reward_max": {"av": 5.5250606985787805}, "policy_reward_mean": {"av": -23.004587898967372}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 1.234576807076693, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 5.490152571047218, "avg_rl_veh_arrival_mean": 500.05, "avg_rl_veh_arrival_min": 500.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.055958388095789, "mean_processing_ms": 3.5705633979338023, "mean_inference_ms": 1.5870668448700276}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 7819, "num_steps_trained": 0, "num_steps_sampled": 9055, "sample_time_ms": 137.299, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 0.006, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 1055, "done": false, "timesteps_total": 9055, "episodes_total": 20, "training_iteration": 9, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_13-43-55", "timestamp": 1585773835, "time_this_iter_s": 12.931803941726685, "time_total_s": 107.87913608551025, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9e874b840>", "on_episode_step": "<function on_episode_step at 0x7ff9e874b378>", "on_episode_end": "<function on_episode_end at 0x7ff9e874b620>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9e874be18>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 107.87913608551025, "timesteps_since_restore": 9055, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 78.08333333333333, "ram_util_percent": 65.06666666666666}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 9.194148159085412, "episode_reward_min": -299.34238635385793, "episode_reward_mean": -38.500270823933825, "episode_len_mean": 454.22727272727275, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.6688395671563}, "policy_reward_max": {"av": 5.5250606985787805}, "policy_reward_mean": {"av": -21.175148953163607}, "custom_metrics": {"num_ped_collisions_mean": 0.13636363636363635, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 1.193874832267693, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 5.490152571047218, "avg_rl_veh_arrival_mean": 500.04545454545456, "avg_rl_veh_arrival_min": 500.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.037599302749847, "mean_processing_ms": 3.5840231177440134, "mean_inference_ms": 1.5843501541290037}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 8711, "num_steps_trained": 800, "num_steps_sampled": 10055, "sample_time_ms": 139.967, "replay_time_ms": 16.88, "grad_time_ms": 230.506, "update_time_ms": 0.006, "opt_peak_throughput": 433.828, "opt_samples": 100.0, "learner": {"av": {"mean_q": 20.9623966217041, "max_q": 61.32807922363281, "min_q": 0.37991881370544434}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 10055, "episodes_total": 22, "training_iteration": 10, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_13-44-07", "timestamp": 1585773847, "time_this_iter_s": 12.348846197128296, "time_total_s": 120.22798228263855, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18f86a60>", "on_episode_step": "<function on_episode_step at 0x7ffa18f86840>", "on_episode_end": "<function on_episode_end at 0x7ffa18f86620>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa18f86f28>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 120.22798228263855, "timesteps_since_restore": 10055, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 84.56111111111112, "ram_util_percent": 65.07222222222221}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 9.194148159085412, "episode_reward_min": -299.34238635385793, "episode_reward_mean": -35.19613315806209, "episode_len_mean": 458.0416666666667, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.6688395671563}, "policy_reward_max": {"av": 5.5250606985787805}, "policy_reward_mean": {"av": -19.197890813488417}, "custom_metrics": {"num_ped_collisions_mean": 0.125, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 1.226928312159947, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 5.490152571047218, "avg_rl_veh_arrival_mean": 500.0416666666667, "avg_rl_veh_arrival_min": 500.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.036423794092235, "mean_processing_ms": 3.597054149949541, "mean_inference_ms": 1.5890294442546715}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 9593, "num_steps_trained": 89000, "num_steps_sampled": 11055, "sample_time_ms": 155.323, "replay_time_ms": 16.918, "grad_time_ms": 23.223, "update_time_ms": 0.006, "opt_peak_throughput": 4306.161, "opt_samples": 100.0, "learner": {"av": {"mean_q": -2.050614356994629, "max_q": 2.190368413925171, "min_q": -12.244654655456543}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 11055, "episodes_total": 24, "training_iteration": 11, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_13-44-57", "timestamp": 1585773897, "time_this_iter_s": 50.14644193649292, "time_total_s": 170.37442421913147, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9e874b730>", "on_episode_step": "<function on_episode_step at 0x7ff9e874b510>", "on_episode_end": "<function on_episode_end at 0x7ff9e874b7b8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9e874b2f0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 170.37442421913147, "timesteps_since_restore": 11055, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 87.9619718309859, "ram_util_percent": 65.09859154929582}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 9.194148159085412, "episode_reward_min": -299.34238635385793, "episode_reward_mean": -32.45334023173328, "episode_len_mean": 461.2692307692308, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.6688395671563}, "policy_reward_max": {"av": 5.5250606985787805}, "policy_reward_mean": {"av": -17.952911617554584}, "custom_metrics": {"num_ped_collisions_mean": 0.11538461538461539, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 1.2480818825032867, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 5.490152571047218, "avg_rl_veh_arrival_mean": 500.03846153846155, "avg_rl_veh_arrival_min": 500.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.041481647314431, "mean_processing_ms": 3.60823661980667, "mean_inference_ms": 1.5976796257343355}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 10483, "num_steps_trained": 178000, "num_steps_sampled": 12055, "sample_time_ms": 7.061, "replay_time_ms": 15.607, "grad_time_ms": 17.016, "update_time_ms": 0.005, "opt_peak_throughput": 5876.803, "opt_samples": 100.0, "learner": {"av": {"mean_q": -4.723398208618164, "max_q": 2.5485291481018066, "min_q": -20.740556716918945}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 12055, "episodes_total": 26, "training_iteration": 12, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_13-45-45", "timestamp": 1585773945, "time_this_iter_s": 48.13726186752319, "time_total_s": 218.51168608665466, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa08197a60>", "on_episode_step": "<function on_episode_step at 0x7ffa08197c80>", "on_episode_end": "<function on_episode_end at 0x7ffa08197048>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa081972f0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 218.51168608665466, "timesteps_since_restore": 12055, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 80.67246376811595, "ram_util_percent": 65.12753623188405}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 9.194148159085412, "episode_reward_min": -299.34238635385793, "episode_reward_mean": -40.79263702910436, "episode_len_mean": 449.67857142857144, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.6688395671563}, "policy_reward_max": {"av": 5.5250606985787805}, "policy_reward_mean": {"av": -22.843876736298444}, "custom_metrics": {"num_ped_collisions_mean": 0.14285714285714285, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 1.2893266360593019, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 5.490152571047218, "avg_rl_veh_arrival_mean": 500.0357142857143, "avg_rl_veh_arrival_min": 500.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.050042490086044, "mean_processing_ms": 3.617669583050563, "mean_inference_ms": 1.6084461800833658}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 11368, "num_steps_trained": 266500, "num_steps_sampled": 13055, "sample_time_ms": 10.56, "replay_time_ms": 18.711, "grad_time_ms": 23.746, "update_time_ms": 0.006, "opt_peak_throughput": 4211.187, "opt_samples": 100.0, "learner": {"av": {"mean_q": -5.728137969970703, "max_q": 0.2089788168668747, "min_q": -17.16061782836914}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 13055, "episodes_total": 28, "training_iteration": 13, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_13-46-33", "timestamp": 1585773993, "time_this_iter_s": 47.6087749004364, "time_total_s": 266.12046098709106, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18f862f0>", "on_episode_step": "<function on_episode_step at 0x7ffa18f861e0>", "on_episode_end": "<function on_episode_end at 0x7ffa18f869d8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa18f86d08>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 266.12046098709106, "timesteps_since_restore": 13055, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 82.14264705882354, "ram_util_percent": 65.17500000000001}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 9.194148159085412, "episode_reward_min": -299.4249156551641, "episode_reward_mean": -54.39281072116069, "episode_len_mean": 428.03125, "episodes_this_iter": 4, "policy_reward_min": {"av": -299.6688395671563}, "policy_reward_max": {"av": 5.5250606985787805}, "policy_reward_mean": {"av": -30.009826604778315}, "custom_metrics": {"num_ped_collisions_mean": 0.1875, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 1.5298259198682738, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 5.490152571047218, "avg_rl_veh_arrival_mean": 500.03125, "avg_rl_veh_arrival_min": 500.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.089004056820412, "mean_processing_ms": 3.6573165459099766, "mean_inference_ms": 1.6297349845122495}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 12167, "num_steps_trained": 346400, "num_steps_sampled": 14055, "sample_time_ms": 15.853, "replay_time_ms": 14.77, "grad_time_ms": 24.441, "update_time_ms": 0.006, "opt_peak_throughput": 4091.553, "opt_samples": 100.0, "learner": {"av": {"mean_q": -6.507376194000244, "max_q": -0.1836836338043213, "min_q": -19.321252822875977}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 14055, "episodes_total": 32, "training_iteration": 14, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_13-47-24", "timestamp": 1585774044, "time_this_iter_s": 50.596372842788696, "time_total_s": 316.71683382987976, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9e8712950>", "on_episode_step": "<function on_episode_step at 0x7ff9e8712d90>", "on_episode_end": "<function on_episode_end at 0x7ff9e87121e0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9e8712048>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 316.71683382987976, "timesteps_since_restore": 14055, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 76.18055555555556, "ram_util_percent": 65.19305555555555}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 9.194148159085412, "episode_reward_min": -299.4249156551641, "episode_reward_mean": -51.116401209402134, "episode_len_mean": 432.2647058823529, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.6688395671563}, "policy_reward_max": {"av": 5.5250606985787805}, "policy_reward_mean": {"av": -27.155588142494885}, "custom_metrics": {"num_ped_collisions_mean": 0.17647058823529413, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 1.51405891651184, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 5.490152571047218, "avg_rl_veh_arrival_mean": 500.02941176470586, "avg_rl_veh_arrival_min": 500.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.116763725448541, "mean_processing_ms": 3.6745034778631793, "mean_inference_ms": 1.6409959669716745}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 13046, "num_steps_trained": 434300, "num_steps_sampled": 15055, "sample_time_ms": 12.983, "replay_time_ms": 17.49, "grad_time_ms": 21.517, "update_time_ms": 0.007, "opt_peak_throughput": 4647.593, "opt_samples": 100.0, "learner": {"av": {"mean_q": -6.873674392700195, "max_q": -0.40483027696609497, "min_q": -16.45142364501953}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 15055, "episodes_total": 34, "training_iteration": 15, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_13-48-17", "timestamp": 1585774097, "time_this_iter_s": 53.219714879989624, "time_total_s": 369.9365487098694, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa08197a60>", "on_episode_step": "<function on_episode_step at 0x7ffa08197158>", "on_episode_end": "<function on_episode_end at 0x7ffa081971e0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa08197d90>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 369.9365487098694, "timesteps_since_restore": 15055, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 82.17466666666667, "ram_util_percent": 65.17066666666666}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 9.194148159085412, "episode_reward_min": -299.4249156551641, "episode_reward_mean": -48.274804179898226, "episode_len_mean": 436.02777777777777, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.6688395671563}, "policy_reward_max": {"av": 5.5250606985787805}, "policy_reward_mean": {"av": -25.186854354729505}, "custom_metrics": {"num_ped_collisions_mean": 0.16666666666666666, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 1.5003122226657262, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 5.490152571047218, "avg_rl_veh_arrival_mean": 500.02777777777777, "avg_rl_veh_arrival_min": 500.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.145363325684436, "mean_processing_ms": 3.6895966685196147, "mean_inference_ms": 1.6534340247217334}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 13907, "num_steps_trained": 520400, "num_steps_sampled": 16055, "sample_time_ms": 8.491, "replay_time_ms": 15.716, "grad_time_ms": 23.397, "update_time_ms": 0.006, "opt_peak_throughput": 4274.023, "opt_samples": 100.0, "learner": {"av": {"mean_q": -7.762308120727539, "max_q": -0.4234709143638611, "min_q": -21.577545166015625}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 16055, "episodes_total": 36, "training_iteration": 16, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_13-49-06", "timestamp": 1585774146, "time_this_iter_s": 49.306774854660034, "time_total_s": 419.2433235645294, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f2017ae8>", "on_episode_step": "<function on_episode_step at 0x7ff9f9080d90>", "on_episode_end": "<function on_episode_end at 0x7ffa1817f840>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f9063f28>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 419.2433235645294, "timesteps_since_restore": 16055, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 75.41571428571429, "ram_util_percent": 65.19714285714285}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 9.194148159085412, "episode_reward_min": -299.4249156551641, "episode_reward_mean": -45.732986653628565, "episode_len_mean": 439.39473684210526, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.6688395671563}, "policy_reward_max": {"av": 5.5250606985787805}, "policy_reward_mean": {"av": -24.136854067192854}, "custom_metrics": {"num_ped_collisions_mean": 0.15789473684210525, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 1.4905508275123125, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 5.490152571047218, "avg_rl_veh_arrival_mean": 500.0263157894737, "avg_rl_veh_arrival_min": 500.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.173975803656123, "mean_processing_ms": 3.7029701632039522, "mean_inference_ms": 1.6659799428981137}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 14758, "num_steps_trained": 605500, "num_steps_sampled": 17055, "sample_time_ms": 15.664, "replay_time_ms": 15.944, "grad_time_ms": 26.329, "update_time_ms": 0.006, "opt_peak_throughput": 3798.118, "opt_samples": 100.0, "learner": {"av": {"mean_q": -8.473682403564453, "max_q": -0.3709828555583954, "min_q": -20.15762710571289}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 17055, "episodes_total": 38, "training_iteration": 17, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_13-49-54", "timestamp": 1585774194, "time_this_iter_s": 48.015992164611816, "time_total_s": 467.25931572914124, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9e8712d08>", "on_episode_step": "<function on_episode_step at 0x7ffa18f862f0>", "on_episode_end": "<function on_episode_end at 0x7ffa18f86ae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa18f86158>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 467.25931572914124, "timesteps_since_restore": 17055, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 79.51739130434783, "ram_util_percent": 65.17681159420292}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 9.194148159085412, "episode_reward_min": -299.4249156551641, "episode_reward_mean": -43.44535893190586, "episode_len_mean": 442.425, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.6688395671563}, "policy_reward_max": {"av": 5.5250606985787805}, "policy_reward_mean": {"av": -23.170858097016463}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 1.4766995432890577, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 5.490152571047218, "avg_rl_veh_arrival_mean": 500.025, "avg_rl_veh_arrival_min": 500.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.199909846608302, "mean_processing_ms": 3.714255832855258, "mean_inference_ms": 1.678861093459588}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 15647, "num_steps_trained": 694400, "num_steps_sampled": 18055, "sample_time_ms": 9.135, "replay_time_ms": 17.602, "grad_time_ms": 26.582, "update_time_ms": 0.006, "opt_peak_throughput": 3761.954, "opt_samples": 100.0, "learner": {"av": {"mean_q": -11.185955047607422, "max_q": -0.14886438846588135, "min_q": -26.95673370361328}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 18055, "episodes_total": 40, "training_iteration": 18, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_13-50-44", "timestamp": 1585774244, "time_this_iter_s": 49.2754590511322, "time_total_s": 516.5347747802734, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18a2a488>", "on_episode_step": "<function on_episode_step at 0x7ffa18f86268>", "on_episode_end": "<function on_episode_end at 0x7ffa18f86510>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa18f86e18>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 516.5347747802734, "timesteps_since_restore": 18055, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 83.55428571428573, "ram_util_percent": 65.10000000000002}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 9.194148159085412, "episode_reward_min": -299.4249156551641, "episode_reward_mean": -41.35754601372792, "episode_len_mean": 445.1666666666667, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.6688395671563}, "policy_reward_max": {"av": 5.5250606985787805}, "policy_reward_mean": {"av": -22.26944785354581}, "custom_metrics": {"num_ped_collisions_mean": 0.14285714285714285, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 1.4586562043440432, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 5.490152571047218, "avg_rl_veh_arrival_mean": 500.0238095238095, "avg_rl_veh_arrival_min": 500.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.226744687827256, "mean_processing_ms": 3.7246721210344487, "mean_inference_ms": 1.6919169892425583}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 16547, "num_steps_trained": 784400, "num_steps_sampled": 19055, "sample_time_ms": 13.426, "replay_time_ms": 16.977, "grad_time_ms": 24.53, "update_time_ms": 0.006, "opt_peak_throughput": 4076.565, "opt_samples": 100.0, "learner": {"av": {"mean_q": -9.669468879699707, "max_q": -0.19915619492530823, "min_q": -21.416658401489258}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 19055, "episodes_total": 42, "training_iteration": 19, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_13-51-35", "timestamp": 1585774295, "time_this_iter_s": 51.425565242767334, "time_total_s": 567.9603400230408, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9e8712d90>", "on_episode_step": "<function on_episode_step at 0x7ffa1817f840>", "on_episode_end": "<function on_episode_end at 0x7ffa18f86620>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa18f86f28>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 567.9603400230408, "timesteps_since_restore": 19055, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 68.73287671232876, "ram_util_percent": 65.16438356164383}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 63.839295143776425, "episode_reward_min": -299.4249156551641, "episode_reward_mean": -36.430632202254586, "episode_len_mean": 448.8222222222222, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.6688395671563}, "policy_reward_max": {"av": 32.16996147500441}, "policy_reward_mean": {"av": -19.516410108350673}, "custom_metrics": {"num_ped_collisions_mean": 0.13333333333333333, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 1.6526766239066155, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 7.170021219847445, "avg_rl_veh_arrival_mean": 485.43333333333334, "avg_rl_veh_arrival_min": 147.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.256379605867432, "mean_processing_ms": 3.7382261780834494, "mean_inference_ms": 1.7057209146950003}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 17008, "num_steps_trained": 830500, "num_steps_sampled": 20269, "sample_time_ms": 223.274, "replay_time_ms": 17.534, "grad_time_ms": 22.118, "update_time_ms": 0.006, "opt_peak_throughput": 4521.103, "opt_samples": 100.0, "learner": {"av": {"mean_q": -11.036267280578613, "max_q": -0.17637640237808228, "min_q": -22.780818939208984}}}, "timesteps_this_iter": 1214, "done": false, "timesteps_total": 20269, "episodes_total": 45, "training_iteration": 20, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_13-52-05", "timestamp": 1585774325, "time_this_iter_s": 29.64719295501709, "time_total_s": 597.6075329780579, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f2017c80>", "on_episode_step": "<function on_episode_step at 0x7ff9f2017d08>", "on_episode_end": "<function on_episode_end at 0x7ff9f2017f28>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f2017ea0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 597.6075329780579, "timesteps_since_restore": 20269, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 71.02380952380952, "ram_util_percent": 65.19761904761904}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 64.49968822142593, "episode_reward_min": -299.4249156551641, "episode_reward_mean": -32.15474428431538, "episode_len_mean": 451.0, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.6688395671563}, "policy_reward_max": {"av": 32.28586244396289}, "policy_reward_mean": {"av": -17.173556606395714}, "custom_metrics": {"num_ped_collisions_mean": 0.1276595744680851, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 1.8441429893636567, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 7.170021219847445, "avg_rl_veh_arrival_mean": 472.9468085106383, "avg_rl_veh_arrival_min": 147.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.270657529301767, "mean_processing_ms": 3.74483247616289, "mean_inference_ms": 1.712190039141122}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 17359, "num_steps_trained": 865600, "num_steps_sampled": 21269, "sample_time_ms": 11.292, "replay_time_ms": 17.075, "grad_time_ms": 22.945, "update_time_ms": 0.006, "opt_peak_throughput": 4358.325, "opt_samples": 100.0, "learner": {"av": {"mean_q": -10.697866439819336, "max_q": -0.20484977960586548, "min_q": -24.853845596313477}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 21269, "episodes_total": 47, "training_iteration": 21, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_13-52-27", "timestamp": 1585774347, "time_this_iter_s": 22.70866084098816, "time_total_s": 620.316193819046, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa081977b8>", "on_episode_step": "<function on_episode_step at 0x7ffa08197268>", "on_episode_end": "<function on_episode_end at 0x7ffa08197ae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa081979d8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 620.316193819046, "timesteps_since_restore": 21269, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 78.390625, "ram_util_percent": 65.140625}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 64.49968822142593, "episode_reward_min": -299.4249156551641, "episode_reward_mean": -36.11678697233332, "episode_len_mean": 438.72549019607845, "episodes_this_iter": 4, "policy_reward_min": {"av": -299.6688395671563}, "policy_reward_max": {"av": 32.28586244396289}, "policy_reward_mean": {"av": -19.38901195356842}, "custom_metrics": {"num_ped_collisions_mean": 0.13725490196078433, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0196078431372549, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.023360606930508, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 7.170021219847445, "avg_rl_veh_arrival_mean": 457.55882352941177, "avg_rl_veh_arrival_min": 96.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.292462243753879, "mean_processing_ms": 3.7614435244263777, "mean_inference_ms": 1.721869624146981}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 17929, "num_steps_trained": 922600, "num_steps_sampled": 22421, "sample_time_ms": 213.967, "replay_time_ms": 14.812, "grad_time_ms": 27.881, "update_time_ms": 0.009, "opt_peak_throughput": 3586.659, "opt_samples": 100.0, "learner": {"av": {"mean_q": -11.387198448181152, "max_q": -0.2715446352958679, "min_q": -26.40298080444336}}}, "timesteps_this_iter": 1152, "done": false, "timesteps_total": 22421, "episodes_total": 51, "training_iteration": 22, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_13-53-03", "timestamp": 1585774383, "time_this_iter_s": 35.630125999450684, "time_total_s": 655.9463198184967, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18f861e0>", "on_episode_step": "<function on_episode_step at 0x7ffa18f862f0>", "on_episode_end": "<function on_episode_end at 0x7ffa18f868c8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f2017b70>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 655.9463198184967, "timesteps_since_restore": 22421, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 79.45686274509804, "ram_util_percent": 64.96666666666667}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 66.858652174777, "episode_reward_min": -299.4249156551641, "episode_reward_mean": -32.291055151836446, "episode_len_mean": 441.0377358490566, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.6688395671563}, "policy_reward_max": {"av": 32.28586244396289}, "policy_reward_mean": {"av": -17.114259230473316}, "custom_metrics": {"num_ped_collisions_mean": 0.1320754716981132, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.018867924528301886, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.1360629252010797, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 7.170021219847445, "avg_rl_veh_arrival_mean": 447.7232704402516, "avg_rl_veh_arrival_min": 96.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.30084446079892, "mean_processing_ms": 3.7678436639133017, "mean_inference_ms": 1.7257946304866354}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 18529, "num_steps_trained": 982600, "num_steps_sampled": 23437, "sample_time_ms": 206.832, "replay_time_ms": 16.712, "grad_time_ms": 22.703, "update_time_ms": 0.006, "opt_peak_throughput": 4404.768, "opt_samples": 100.0, "learner": {"av": {"mean_q": -11.908581733703613, "max_q": -0.5968093872070312, "min_q": -24.872825622558594}}}, "timesteps_this_iter": 1016, "done": false, "timesteps_total": 23437, "episodes_total": 53, "training_iteration": 23, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_13-53-36", "timestamp": 1585774416, "time_this_iter_s": 33.24520993232727, "time_total_s": 689.191529750824, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa08197730>", "on_episode_step": "<function on_episode_step at 0x7ffa081979d8>", "on_episode_end": "<function on_episode_end at 0x7ffa08197ae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f2017ea0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 689.191529750824, "timesteps_since_restore": 23437, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 90.13617021276595, "ram_util_percent": 64.74255319148938}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 66.858652174777, "episode_reward_min": -299.4249156551641, "episode_reward_mean": -29.95574928698601, "episode_len_mean": 443.1818181818182, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.6688395671563}, "policy_reward_max": {"av": 32.28586244396289}, "policy_reward_mean": {"av": -16.15260990964932}, "custom_metrics": {"num_ped_collisions_mean": 0.12727272727272726, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01818181818181818, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.208437303582028, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 7.170021219847445, "avg_rl_veh_arrival_mean": 439.76969696969695, "avg_rl_veh_arrival_min": 96.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.305751179136438, "mean_processing_ms": 3.772512577940792, "mean_inference_ms": 1.7279730603451562}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 18857, "num_steps_trained": 1015400, "num_steps_sampled": 24442, "sample_time_ms": 199.389, "replay_time_ms": 15.195, "grad_time_ms": 25.776, "update_time_ms": 0.011, "opt_peak_throughput": 3879.563, "opt_samples": 100.0, "learner": {"av": {"mean_q": -11.047794342041016, "max_q": -0.2366846799850464, "min_q": -26.106956481933594}}}, "timesteps_this_iter": 1005, "done": false, "timesteps_total": 24442, "episodes_total": 55, "training_iteration": 24, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_13-53-57", "timestamp": 1585774437, "time_this_iter_s": 20.4442036151886, "time_total_s": 709.6357333660126, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18f860d0>", "on_episode_step": "<function on_episode_step at 0x7ffa18f86620>", "on_episode_end": "<function on_episode_end at 0x7ffa1817f840>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f906e268>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 709.6357333660126, "timesteps_since_restore": 24442, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 90.1241379310345, "ram_util_percent": 64.84482758620692}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.4530496077018, "episode_reward_min": -299.4249156551641, "episode_reward_mean": -26.083037417559105, "episode_len_mean": 445.17543859649123, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.6688395671563}, "policy_reward_max": {"av": 32.3097908889684}, "policy_reward_mean": {"av": -13.894702175709062}, "custom_metrics": {"num_ped_collisions_mean": 0.12280701754385964, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.017543859649122806, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.3293771261522283, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 7.170021219847445, "avg_rl_veh_arrival_mean": 431.02046783625735, "avg_rl_veh_arrival_min": 96.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.308518735630553, "mean_processing_ms": 3.7759351379840513, "mean_inference_ms": 1.7289749663738285}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 19242, "num_steps_trained": 1053900, "num_steps_sampled": 25444, "sample_time_ms": 185.14, "replay_time_ms": 16.617, "grad_time_ms": 19.973, "update_time_ms": 0.005, "opt_peak_throughput": 5006.791, "opt_samples": 100.0, "learner": {"av": {"mean_q": -11.853813171386719, "max_q": -0.24148264527320862, "min_q": -25.377605438232422}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 25444, "episodes_total": 57, "training_iteration": 25, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_13-54-21", "timestamp": 1585774461, "time_this_iter_s": 23.755115747451782, "time_total_s": 733.3908491134644, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa081979d8>", "on_episode_step": "<function on_episode_step at 0x7ffa08197730>", "on_episode_end": "<function on_episode_end at 0x7ffa08197840>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa081976a8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 733.3908491134644, "timesteps_since_restore": 25444, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 87.80000000000001, "ram_util_percent": 64.84411764705884}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.4530496077018, "episode_reward_min": -299.4249156551641, "episode_reward_mean": -23.578967416281664, "episode_len_mean": 447.03389830508473, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.6688395671563}, "policy_reward_max": {"av": 32.3097908889684}, "policy_reward_mean": {"av": -12.646900705096533}, "custom_metrics": {"num_ped_collisions_mean": 0.11864406779661017, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01694915254237288, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.50661261483838, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 7.959034873696776, "avg_rl_veh_arrival_mean": 420.96045197740114, "avg_rl_veh_arrival_min": 96.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.308530939087188, "mean_processing_ms": 3.7780465841817983, "mean_inference_ms": 1.728433148523447}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 19455, "num_steps_trained": 1075200, "num_steps_sampled": 26444, "sample_time_ms": 7.254, "replay_time_ms": 14.661, "grad_time_ms": 25.977, "update_time_ms": 0.006, "opt_peak_throughput": 3849.529, "opt_samples": 100.0, "learner": {"av": {"mean_q": -11.307512283325195, "max_q": -0.5919416546821594, "min_q": -25.28371810913086}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 26444, "episodes_total": 59, "training_iteration": 26, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_13-54-37", "timestamp": 1585774477, "time_this_iter_s": 15.272618055343628, "time_total_s": 748.663467168808, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18f86158>", "on_episode_step": "<function on_episode_step at 0x7ffa18f86620>", "on_episode_end": "<function on_episode_end at 0x7ffa081977b8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa08197400>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 748.663467168808, "timesteps_since_restore": 26444, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 96.26086956521739, "ram_util_percent": 64.89565217391308}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.4530496077018, "episode_reward_min": -299.4249156551641, "episode_reward_mean": -21.154394933859017, "episode_len_mean": 448.7704918032787, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.6688395671563}, "policy_reward_max": {"av": 32.3097908889684}, "policy_reward_mean": {"av": -11.319456938292983}, "custom_metrics": {"num_ped_collisions_mean": 0.11475409836065574, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01639344262295082, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.619071263012958, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 9.6935804237601, "avg_rl_veh_arrival_mean": 413.6229508196721, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.307552386990439, "mean_processing_ms": 3.7793011360298596, "mean_inference_ms": 1.7273480089106181}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 19926, "num_steps_trained": 1122300, "num_steps_sampled": 27444, "sample_time_ms": 7.53, "replay_time_ms": 13.377, "grad_time_ms": 13.467, "update_time_ms": 0.005, "opt_peak_throughput": 7425.295, "opt_samples": 100.0, "learner": {"av": {"mean_q": -12.7252836227417, "max_q": -0.26593953371047974, "min_q": -28.301666259765625}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 27444, "episodes_total": 61, "training_iteration": 27, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_13-55-04", "timestamp": 1585774504, "time_this_iter_s": 27.526490926742554, "time_total_s": 776.1899580955505, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18f862f0>", "on_episode_step": "<function on_episode_step at 0x7ffa18f861e0>", "on_episode_end": "<function on_episode_end at 0x7ffa18f866a8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa18f86b70>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 776.1899580955505, "timesteps_since_restore": 27444, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 93.20512820512822, "ram_util_percent": 64.9}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.4530496077018, "episode_reward_min": -299.4249156551641, "episode_reward_mean": -18.959581978986833, "episode_len_mean": 450.3968253968254, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.6688395671563}, "policy_reward_max": {"av": 32.3097908889684}, "policy_reward_mean": {"av": -10.037425753581267}, "custom_metrics": {"num_ped_collisions_mean": 0.1111111111111111, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.015873015873015872, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.5837956581982215, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 9.6935804237601, "avg_rl_veh_arrival_mean": 410.24603174603175, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.306751167263846, "mean_processing_ms": 3.780331691979079, "mean_inference_ms": 1.727014979078125}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 20817, "num_steps_trained": 1211400, "num_steps_sampled": 28444, "sample_time_ms": 155.768, "replay_time_ms": 17.373, "grad_time_ms": 23.728, "update_time_ms": 0.006, "opt_peak_throughput": 4214.407, "opt_samples": 100.0, "learner": {"av": {"mean_q": -10.206278800964355, "max_q": -0.2769521176815033, "min_q": -29.42164421081543}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 28444, "episodes_total": 63, "training_iteration": 28, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_13-55-51", "timestamp": 1585774551, "time_this_iter_s": 47.052972078323364, "time_total_s": 823.2429301738739, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9e8090b70>", "on_episode_step": "<function on_episode_step at 0x7ff9e8712b70>", "on_episode_end": "<function on_episode_end at 0x7ff9e8712400>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9e8712d90>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 823.2429301738739, "timesteps_since_restore": 28444, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 89.02089552238807, "ram_util_percent": 64.9044776119403}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.4530496077018, "episode_reward_min": -299.4249156551641, "episode_reward_mean": -16.429291899785458, "episode_len_mean": 451.9230769230769, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.6688395671563}, "policy_reward_max": {"av": 32.3097908889684}, "policy_reward_mean": {"av": -8.61212881843593}, "custom_metrics": {"num_ped_collisions_mean": 0.1076923076923077, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.015384615384615385, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.575051720611827, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 9.6935804237601, "avg_rl_veh_arrival_mean": 406.2589743589744, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.306082559734895, "mean_processing_ms": 3.7810979224294385, "mean_inference_ms": 1.7273162005669453}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 21651, "num_steps_trained": 1294800, "num_steps_sampled": 29444, "sample_time_ms": 156.544, "replay_time_ms": 16.828, "grad_time_ms": 23.349, "update_time_ms": 0.007, "opt_peak_throughput": 4282.922, "opt_samples": 100.0, "learner": {"av": {"mean_q": -11.430863380432129, "max_q": -0.19785821437835693, "min_q": -30.75931167602539}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 29444, "episodes_total": 65, "training_iteration": 29, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_13-56-37", "timestamp": 1585774597, "time_this_iter_s": 45.509827852249146, "time_total_s": 868.752758026123, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa08197158>", "on_episode_step": "<function on_episode_step at 0x7ffa08197ae8>", "on_episode_end": "<function on_episode_end at 0x7ffa08197950>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f2040bf8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 868.752758026123, "timesteps_since_restore": 29444, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 92.62461538461538, "ram_util_percent": 64.86769230769231}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.4530496077018, "episode_reward_min": -299.4249156551641, "episode_reward_mean": -14.524204919299848, "episode_len_mean": 453.35820895522386, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.6688395671563}, "policy_reward_max": {"av": 32.3097908889684}, "policy_reward_mean": {"av": -7.662375823567641}, "custom_metrics": {"num_ped_collisions_mean": 0.1044776119402985, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.014925373134328358, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.623576243681161, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 9.6935804237601, "avg_rl_veh_arrival_mean": 401.0348258706467, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.304512055405453, "mean_processing_ms": 3.7812821015416778, "mean_inference_ms": 1.7271674947177436}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 22094, "num_steps_trained": 1339100, "num_steps_sampled": 30444, "sample_time_ms": 11.67, "replay_time_ms": 15.827, "grad_time_ms": 22.204, "update_time_ms": 0.006, "opt_peak_throughput": 4503.694, "opt_samples": 100.0, "learner": {"av": {"mean_q": -11.614930152893066, "max_q": 0.45282918214797974, "min_q": -30.8644962310791}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 30444, "episodes_total": 67, "training_iteration": 30, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_13-57-04", "timestamp": 1585774624, "time_this_iter_s": 26.93595600128174, "time_total_s": 895.6887140274048, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f2040510>", "on_episode_step": "<function on_episode_step at 0x7ff9f20406a8>", "on_episode_end": "<function on_episode_end at 0x7ff9f2040488>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f2040378>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 895.6887140274048, "timesteps_since_restore": 30444, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 94.05, "ram_util_percent": 64.96052631578948}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.4530496077018, "episode_reward_min": -299.4249156551641, "episode_reward_mean": -12.250925611695008, "episode_len_mean": 454.71014492753625, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.6688395671563}, "policy_reward_max": {"av": 32.33684099556174}, "policy_reward_mean": {"av": -6.4527776122668365}, "custom_metrics": {"num_ped_collisions_mean": 0.10144927536231885, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.014492753623188406, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.7454946403666383, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 9.6935804237601, "avg_rl_veh_arrival_mean": 393.8599033816425, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.301581685416653, "mean_processing_ms": 3.7808293747348407, "mean_inference_ms": 1.7261592102666379}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 22372, "num_steps_trained": 1366900, "num_steps_sampled": 31448, "sample_time_ms": 207.663, "replay_time_ms": 17.281, "grad_time_ms": 17.737, "update_time_ms": 0.006, "opt_peak_throughput": 5637.915, "opt_samples": 100.0, "learner": {"av": {"mean_q": -11.457820892333984, "max_q": -0.35675424337387085, "min_q": -29.707143783569336}}}, "timesteps_this_iter": 1004, "done": false, "timesteps_total": 31448, "episodes_total": 69, "training_iteration": 31, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_13-57-23", "timestamp": 1585774643, "time_this_iter_s": 18.478344917297363, "time_total_s": 914.1670589447021, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f9063f28>", "on_episode_step": "<function on_episode_step at 0x7ffa18f86b70>", "on_episode_end": "<function on_episode_end at 0x7ffa18f86620>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa18f86268>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 914.1670589447021, "timesteps_since_restore": 31448, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 96.3153846153846, "ram_util_percent": 64.98846153846154}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.4530496077018, "episode_reward_min": -299.4249156551641, "episode_reward_mean": -10.554260343933406, "episode_len_mean": 455.98591549295776, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.6688395671563}, "policy_reward_max": {"av": 32.33684099556174}, "policy_reward_mean": {"av": -5.592182719546807}, "custom_metrics": {"num_ped_collisions_mean": 0.09859154929577464, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.014084507042253521, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.8505983275923, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 9.6935804237601, "avg_rl_veh_arrival_mean": 387.4835680751174, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.297474396928199, "mean_processing_ms": 3.7797609809264716, "mean_inference_ms": 1.7242248254160226}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 22561, "num_steps_trained": 1385800, "num_steps_sampled": 32450, "sample_time_ms": 220.917, "replay_time_ms": 17.723, "grad_time_ms": 24.021, "update_time_ms": 0.008, "opt_peak_throughput": 4163.073, "opt_samples": 100.0, "learner": {"av": {"mean_q": -9.640807151794434, "max_q": -0.309399276971817, "min_q": -29.319976806640625}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 32450, "episodes_total": 71, "training_iteration": 32, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_13-57-37", "timestamp": 1585774657, "time_this_iter_s": 14.539194107055664, "time_total_s": 928.7062530517578, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f20402f0>", "on_episode_step": "<function on_episode_step at 0x7ff9f2040bf8>", "on_episode_end": "<function on_episode_end at 0x7ff9f20407b8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f906e268>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 928.7062530517578, "timesteps_since_restore": 32450, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 87.66666666666667, "ram_util_percent": 65.02857142857142}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.4530496077018, "episode_reward_min": -299.4249156551641, "episode_reward_mean": -8.940333332252077, "episode_len_mean": 457.1917808219178, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.6688395671563}, "policy_reward_max": {"av": 32.37221088858867}, "policy_reward_mean": {"av": -4.763827250032132}, "custom_metrics": {"num_ped_collisions_mean": 0.0958904109589041, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0136986301369863, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.908882086076665, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 9.6935804237601, "avg_rl_veh_arrival_mean": 383.9840182648402, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.292513697112197, "mean_processing_ms": 3.778273494932707, "mean_inference_ms": 1.7218937518166908}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 22978, "num_steps_trained": 1427500, "num_steps_sampled": 33450, "sample_time_ms": 8.326, "replay_time_ms": 19.661, "grad_time_ms": 23.343, "update_time_ms": 0.006, "opt_peak_throughput": 4284.016, "opt_samples": 100.0, "learner": {"av": {"mean_q": -11.537006378173828, "max_q": 1.7746851444244385, "min_q": -29.70498275756836}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 33450, "episodes_total": 73, "training_iteration": 33, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_13-58-02", "timestamp": 1585774682, "time_this_iter_s": 24.5070059299469, "time_total_s": 953.2132589817047, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18f869d8>", "on_episode_step": "<function on_episode_step at 0x7ffa18f86840>", "on_episode_end": "<function on_episode_end at 0x7ffa18f86ae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa18f86950>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 953.2132589817047, "timesteps_since_restore": 33450, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 93.91714285714285, "ram_util_percent": 64.97428571428571}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.4530496077018, "episode_reward_min": -299.4249156551641, "episode_reward_mean": -7.007969908203098, "episode_len_mean": 458.3333333333333, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.6688395671563}, "policy_reward_max": {"av": 32.37221088858867}, "policy_reward_mean": {"av": -3.727643568193137}, "custom_metrics": {"num_ped_collisions_mean": 0.09333333333333334, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.013333333333333334, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.986608967326451, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 9.6935804237601, "avg_rl_veh_arrival_mean": 379.5844444444445, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.286865675969355, "mean_processing_ms": 3.7764226250311275, "mean_inference_ms": 1.7191726734971173}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 23330, "num_steps_trained": 1462700, "num_steps_sampled": 34450, "sample_time_ms": 207.805, "replay_time_ms": 17.899, "grad_time_ms": 18.945, "update_time_ms": 0.006, "opt_peak_throughput": 5278.53, "opt_samples": 100.0, "learner": {"av": {"mean_q": -13.640758514404297, "max_q": 2.2212107181549072, "min_q": -29.980138778686523}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 34450, "episodes_total": 75, "training_iteration": 34, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_13-58-24", "timestamp": 1585774704, "time_this_iter_s": 21.980027198791504, "time_total_s": 975.1932861804962, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9e87120d0>", "on_episode_step": "<function on_episode_step at 0x7ff9e8712378>", "on_episode_end": "<function on_episode_end at 0x7ff9e8712400>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9e8712158>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 975.1932861804962, "timesteps_since_restore": 34450, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 96.7548387096774, "ram_util_percent": 65.0}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.4530496077018, "episode_reward_min": -299.4249156551641, "episode_reward_mean": -4.761124332468024, "episode_len_mean": 459.4155844155844, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.6688395671563}, "policy_reward_max": {"av": 32.37221088858867}, "policy_reward_mean": {"av": -2.5110039287673853}, "custom_metrics": {"num_ped_collisions_mean": 0.09090909090909091, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.012987012987012988, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.0554463287968354, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 9.6935804237601, "avg_rl_veh_arrival_mean": 374.71645021645026, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.28078262555181, "mean_processing_ms": 3.7742960943870116, "mean_inference_ms": 1.7161010012600313}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 23688, "num_steps_trained": 1498500, "num_steps_sampled": 35451, "sample_time_ms": 205.416, "replay_time_ms": 17.395, "grad_time_ms": 20.565, "update_time_ms": 0.027, "opt_peak_throughput": 4862.747, "opt_samples": 100.0, "learner": {"av": {"mean_q": -12.921928405761719, "max_q": 0.4008651375770569, "min_q": -29.656614303588867}}}, "timesteps_this_iter": 1001, "done": false, "timesteps_total": 35451, "episodes_total": 77, "training_iteration": 35, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_13-58-46", "timestamp": 1585774726, "time_this_iter_s": 22.522619009017944, "time_total_s": 997.7159051895142, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9e8712b70>", "on_episode_step": "<function on_episode_step at 0x7ff9e8712598>", "on_episode_end": "<function on_episode_end at 0x7ff9e8712a60>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa08197d90>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 997.7159051895142, "timesteps_since_restore": 35451, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 96.434375, "ram_util_percent": 64.984375}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.4530496077018, "episode_reward_min": -299.4249156551641, "episode_reward_mean": -3.0134147068141193, "episode_len_mean": 460.44303797468353, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.6688395671563}, "policy_reward_max": {"av": 32.37221088858867}, "policy_reward_mean": {"av": -1.5870650789221024}, "custom_metrics": {"num_ped_collisions_mean": 0.08860759493670886, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.012658227848101266, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.149927479510822, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 9.6935804237601, "avg_rl_veh_arrival_mean": 369.5, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.274006463596949, "mean_processing_ms": 3.7718421982266106, "mean_inference_ms": 1.7125446980383583}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 23947, "num_steps_trained": 1524400, "num_steps_sampled": 36451, "sample_time_ms": 189.187, "replay_time_ms": 17.549, "grad_time_ms": 18.163, "update_time_ms": 0.005, "opt_peak_throughput": 5505.615, "opt_samples": 100.0, "learner": {"av": {"mean_q": -11.91026496887207, "max_q": 4.901656150817871, "min_q": -30.21508026123047}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 36451, "episodes_total": 79, "training_iteration": 36, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_13-59-03", "timestamp": 1585774743, "time_this_iter_s": 16.635864734649658, "time_total_s": 1014.3517699241638, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18f86950>", "on_episode_step": "<function on_episode_step at 0x7ffa18f86840>", "on_episode_end": "<function on_episode_end at 0x7ffa18f86ae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa18f86268>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1014.3517699241638, "timesteps_since_restore": 36451, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 94.8, "ram_util_percent": 64.89583333333333}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.4530496077018, "episode_reward_min": -299.4249156551641, "episode_reward_mean": -1.3562612940142982, "episode_len_mean": 461.41975308641975, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.6688395671563}, "policy_reward_max": {"av": 32.37221088858867}, "policy_reward_mean": {"av": -0.7133582130854434}, "custom_metrics": {"num_ped_collisions_mean": 0.08641975308641975, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.012345679012345678, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.2256552956049207, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 9.6935804237601, "avg_rl_veh_arrival_mean": 364.75925925925924, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.266777882296561, "mean_processing_ms": 3.7691298470024477, "mean_inference_ms": 1.70865932245464}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 24234, "num_steps_trained": 1553100, "num_steps_sampled": 37451, "sample_time_ms": 9.99, "replay_time_ms": 16.886, "grad_time_ms": 26.534, "update_time_ms": 0.006, "opt_peak_throughput": 3768.802, "opt_samples": 100.0, "learner": {"av": {"mean_q": -12.342336654663086, "max_q": 5.1772918701171875, "min_q": -30.588031768798828}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 37451, "episodes_total": 81, "training_iteration": 37, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_13-59-22", "timestamp": 1585774762, "time_this_iter_s": 19.238497972488403, "time_total_s": 1033.5902678966522, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18a2a488>", "on_episode_step": "<function on_episode_step at 0x7ff9e8712598>", "on_episode_end": "<function on_episode_end at 0x7ff9e8712048>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9e8712d90>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1033.5902678966522, "timesteps_since_restore": 37451, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 96.48148148148148, "ram_util_percent": 64.85925925925928}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.4530496077018, "episode_reward_min": -299.4249156551641, "episode_reward_mean": -2.962219518973394, "episode_len_mean": 458.04761904761904, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.6688395671563}, "policy_reward_max": {"av": 32.37221088858867}, "policy_reward_mean": {"av": -1.5455058359861245}, "custom_metrics": {"num_ped_collisions_mean": 0.09523809523809523, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.011904761904761904, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.3308844508249753, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 9.6935804237601, "avg_rl_veh_arrival_mean": 361.8511904761905, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.255671951796375, "mean_processing_ms": 3.7657688292901517, "mean_inference_ms": 1.7024840520385838}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 24566, "num_steps_trained": 1586300, "num_steps_sampled": 38531, "sample_time_ms": 180.403, "replay_time_ms": 16.849, "grad_time_ms": 25.889, "update_time_ms": 0.006, "opt_peak_throughput": 3862.663, "opt_samples": 100.0, "learner": {"av": {"mean_q": -12.684528350830078, "max_q": 3.728722333908081, "min_q": -30.87682342529297}}}, "timesteps_this_iter": 1080, "done": false, "timesteps_total": 38531, "episodes_total": 84, "training_iteration": 38, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_13-59-45", "timestamp": 1585774785, "time_this_iter_s": 22.542392253875732, "time_total_s": 1056.132660150528, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18f86510>", "on_episode_step": "<function on_episode_step at 0x7ffa18f86158>", "on_episode_end": "<function on_episode_end at 0x7ffa18f868c8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa18f86620>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1056.132660150528, "timesteps_since_restore": 38531, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 96.553125, "ram_util_percent": 64.915625}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.4530496077018, "episode_reward_min": -299.4249156551641, "episode_reward_mean": -1.03802643077085, "episode_len_mean": 459.0232558139535, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.6688395671563}, "policy_reward_max": {"av": 32.37221088858867}, "policy_reward_mean": {"av": -0.5377727291945398}, "custom_metrics": {"num_ped_collisions_mean": 0.09302325581395349, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.011627906976744186, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.4073492547669426, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 9.6935804237601, "avg_rl_veh_arrival_mean": 357.25387596899225, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.247949762434222, "mean_processing_ms": 3.7632962937352956, "mean_inference_ms": 1.6980567941821463}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 24785, "num_steps_trained": 1608200, "num_steps_sampled": 39531, "sample_time_ms": 205.545, "replay_time_ms": 16.447, "grad_time_ms": 19.665, "update_time_ms": 0.006, "opt_peak_throughput": 5085.114, "opt_samples": 100.0, "learner": {"av": {"mean_q": -11.193342208862305, "max_q": 7.870324611663818, "min_q": -33.20003128051758}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 39531, "episodes_total": 86, "training_iteration": 39, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-00-00", "timestamp": 1585774800, "time_this_iter_s": 15.759981870651245, "time_total_s": 1071.8926420211792, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa081971e0>", "on_episode_step": "<function on_episode_step at 0x7ffa08197d90>", "on_episode_end": "<function on_episode_end at 0x7ffa081970d0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa08197e18>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1071.8926420211792, "timesteps_since_restore": 39531, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 91.66956521739131, "ram_util_percent": 64.91739130434786}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.4530496077018, "episode_reward_min": -299.4249156551641, "episode_reward_mean": 0.0702926369907689, "episode_len_mean": 459.95454545454544, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.6688395671563}, "policy_reward_max": {"av": 32.37221088858867}, "policy_reward_mean": {"av": 0.036602083166786196}, "custom_metrics": {"num_ped_collisions_mean": 0.09090909090909091, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.011363636363636364, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.4611730834167016, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 9.6935804237601, "avg_rl_veh_arrival_mean": 352.719696969697, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.239783054898694, "mean_processing_ms": 3.760616333958822, "mean_inference_ms": 1.693406022338917}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 25062, "num_steps_trained": 1635900, "num_steps_sampled": 40531, "sample_time_ms": 209.663, "replay_time_ms": 17.635, "grad_time_ms": 22.44, "update_time_ms": 0.006, "opt_peak_throughput": 4456.389, "opt_samples": 100.0, "learner": {"av": {"mean_q": -12.179662704467773, "max_q": 8.59316349029541, "min_q": -34.688873291015625}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 40531, "episodes_total": 88, "training_iteration": 40, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-00-19", "timestamp": 1585774819, "time_this_iter_s": 18.152137994766235, "time_total_s": 1090.0447800159454, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9e8106ae8>", "on_episode_step": "<function on_episode_step at 0x7ff9f2017b70>", "on_episode_end": "<function on_episode_end at 0x7ff9f2017ae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f2017c80>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1090.0447800159454, "timesteps_since_restore": 40531, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 96.80400000000002, "ram_util_percent": 64.92800000000001}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.62645751409235, "episode_reward_min": -299.4249156551641, "episode_reward_mean": -0.3024628697828717, "episode_len_mean": 456.83516483516485, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.6688395671563}, "policy_reward_max": {"av": 32.37221088858867}, "policy_reward_mean": {"av": -0.15550350932339901}, "custom_metrics": {"num_ped_collisions_mean": 0.08791208791208792, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02197802197802198, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.5380601991101144, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 9.6935804237601, "avg_rl_veh_arrival_mean": 345.8003663003663, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.22772465708255, "mean_processing_ms": 3.757254996490889, "mean_inference_ms": 1.6863455634192543}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 25434, "num_steps_trained": 1673100, "num_steps_sampled": 41637, "sample_time_ms": 195.24, "replay_time_ms": 16.972, "grad_time_ms": 21.937, "update_time_ms": 0.006, "opt_peak_throughput": 4558.471, "opt_samples": 100.0, "learner": {"av": {"mean_q": -11.353140830993652, "max_q": 8.113205909729004, "min_q": -29.890899658203125}}}, "timesteps_this_iter": 1106, "done": false, "timesteps_total": 41637, "episodes_total": 91, "training_iteration": 41, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-00-44", "timestamp": 1585774844, "time_this_iter_s": 25.058867931365967, "time_total_s": 1115.1036479473114, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f2040378>", "on_episode_step": "<function on_episode_step at 0x7ff9f20406a8>", "on_episode_end": "<function on_episode_end at 0x7ff9f2040840>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f20400d0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1115.1036479473114, "timesteps_since_restore": 41637, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 96.03055555555555, "ram_util_percent": 64.92222222222225}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.62645751409235, "episode_reward_min": -299.4249156551641, "episode_reward_mean": -2.395367786618861, "episode_len_mean": 454.5425531914894, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.6688395671563}, "policy_reward_max": {"av": 32.37221088858867}, "policy_reward_mean": {"av": -1.2371679777042504}, "custom_metrics": {"num_ped_collisions_mean": 0.09574468085106383, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02127659574468085, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.6195720702489345, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 9.6935804237601, "avg_rl_veh_arrival_mean": 343.1737588652482, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.21539218483884, "mean_processing_ms": 3.754234810804884, "mean_inference_ms": 1.6790243157685596}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 25692, "num_steps_trained": 1698900, "num_steps_sampled": 42777, "sample_time_ms": 211.675, "replay_time_ms": 19.333, "grad_time_ms": 21.513, "update_time_ms": 0.021, "opt_peak_throughput": 4648.33, "opt_samples": 100.0, "learner": {"av": {"mean_q": -12.633249282836914, "max_q": 8.71363353729248, "min_q": -33.17915725708008}}}, "timesteps_this_iter": 1140, "done": false, "timesteps_total": 42777, "episodes_total": 94, "training_iteration": 42, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-01-03", "timestamp": 1585774863, "time_this_iter_s": 19.229817152023315, "time_total_s": 1134.3334650993347, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9e8106ae8>", "on_episode_step": "<function on_episode_step at 0x7ff9f2017ae8>", "on_episode_end": "<function on_episode_end at 0x7ff9f2017b70>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f2017c80>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1134.3334650993347, "timesteps_since_restore": 42777, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 92.96666666666667, "ram_util_percent": 64.86296296296297}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.62645751409235, "episode_reward_min": -299.4249156551641, "episode_reward_mean": -0.6790777214536868, "episode_len_mean": 455.4895833333333, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.6688395671563}, "policy_reward_max": {"av": 32.37221088858867}, "policy_reward_mean": {"av": -0.3486174398906667}, "custom_metrics": {"num_ped_collisions_mean": 0.09375, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.020833333333333332, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.659736993902195, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 9.6935804237601, "avg_rl_veh_arrival_mean": 340.4600694444445, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.207326896735748, "mean_processing_ms": 3.7520929977219466, "mean_inference_ms": 1.674167181165548}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 26066, "num_steps_trained": 1736300, "num_steps_sampled": 43798, "sample_time_ms": 187.758, "replay_time_ms": 18.385, "grad_time_ms": 18.189, "update_time_ms": 0.005, "opt_peak_throughput": 5497.742, "opt_samples": 100.0, "learner": {"av": {"mean_q": -12.214244842529297, "max_q": 3.226191759109497, "min_q": -30.34628677368164}}}, "timesteps_this_iter": 1021, "done": false, "timesteps_total": 43798, "episodes_total": 96, "training_iteration": 43, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-01-27", "timestamp": 1585774887, "time_this_iter_s": 23.676367044448853, "time_total_s": 1158.0098321437836, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f2040598>", "on_episode_step": "<function on_episode_step at 0x7ff9f2040730>", "on_episode_end": "<function on_episode_end at 0x7ff9f9063f28>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa08197950>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1158.0098321437836, "timesteps_since_restore": 43798, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 93.87941176470588, "ram_util_percent": 64.85000000000001}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.62645751409235, "episode_reward_min": -299.4249156551641, "episode_reward_mean": -2.6945226058292477, "episode_len_mean": 453.4949494949495, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.73928828949926}, "policy_reward_max": {"av": 32.37221088858867}, "policy_reward_mean": {"av": -1.3893632186307083}, "custom_metrics": {"num_ped_collisions_mean": 0.10101010101010101, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.020202020202020204, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.7566731815271956, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 9.813273374268864, "avg_rl_veh_arrival_mean": 337.5774410774411, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 4.195030277153684, "mean_processing_ms": 3.7491389021621058, "mean_inference_ms": 1.6666090731123862}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 26323, "num_steps_trained": 1762000, "num_steps_sampled": 44972, "sample_time_ms": 239.754, "replay_time_ms": 17.409, "grad_time_ms": 20.462, "update_time_ms": 0.009, "opt_peak_throughput": 4887.173, "opt_samples": 100.0, "learner": {"av": {"mean_q": -13.635981559753418, "max_q": 5.263057708740234, "min_q": -46.44570541381836}}}, "timesteps_this_iter": 1174, "done": false, "timesteps_total": 44972, "episodes_total": 99, "training_iteration": 44, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-01-46", "timestamp": 1585774906, "time_this_iter_s": 19.68510890007019, "time_total_s": 1177.6949410438538, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f906e268>", "on_episode_step": "<function on_episode_step at 0x7ff9f20176a8>", "on_episode_end": "<function on_episode_end at 0x7ff9e8712d90>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9e87120d0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1177.6949410438538, "timesteps_since_restore": 44972, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 89.42857142857143, "ram_util_percent": 64.88928571428572}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.62645751409235, "episode_reward_min": -299.4249156551641, "episode_reward_mean": -4.756790324345497, "episode_len_mean": 450.82, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.73928828949926}, "policy_reward_max": {"av": 32.37221088858867}, "policy_reward_mean": {"av": -2.464658199142747}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.851732207866736, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 9.813273374268864, "avg_rl_veh_arrival_mean": 332.5216666666667, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.169488042633703, "mean_processing_ms": 3.752644864176588, "mean_inference_ms": 1.6598330326344206}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 26640, "num_steps_trained": 1793700, "num_steps_sampled": 46127, "sample_time_ms": 199.552, "replay_time_ms": 17.36, "grad_time_ms": 21.046, "update_time_ms": 0.005, "opt_peak_throughput": 4751.498, "opt_samples": 100.0, "learner": {"av": {"mean_q": -13.119494438171387, "max_q": 11.88067626953125, "min_q": -51.73521423339844}}}, "timesteps_this_iter": 1155, "done": false, "timesteps_total": 46127, "episodes_total": 102, "training_iteration": 45, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-02-08", "timestamp": 1585774928, "time_this_iter_s": 21.124603986740112, "time_total_s": 1198.8195450305939, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18f868c8>", "on_episode_step": "<function on_episode_step at 0x7ffa18f86510>", "on_episode_end": "<function on_episode_end at 0x7ff9f204d048>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f204d0d0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1198.8195450305939, "timesteps_since_restore": 46127, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 86.36999999999999, "ram_util_percent": 64.87666666666667}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.62645751409235, "episode_reward_min": -299.4249156551641, "episode_reward_mean": -10.478893654785534, "episode_len_mean": 440.31, "episodes_this_iter": 4, "policy_reward_min": {"av": -299.73928828949926}, "policy_reward_max": {"av": 32.37221088858867}, "policy_reward_mean": {"av": -5.45775711186747}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.958980527729959, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 9.813273374268864, "avg_rl_veh_arrival_mean": 322.7316666666667, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.1436611681161, "mean_processing_ms": 3.7601113056078934, "mean_inference_ms": 1.6509449955187947}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 27143, "num_steps_trained": 1844000, "num_steps_sampled": 47127, "sample_time_ms": 8.083, "replay_time_ms": 17.113, "grad_time_ms": 18.341, "update_time_ms": 0.005, "opt_peak_throughput": 5452.353, "opt_samples": 100.0, "learner": {"av": {"mean_q": -13.749044418334961, "max_q": 3.055835485458374, "min_q": -42.46474075317383}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 47127, "episodes_total": 106, "training_iteration": 46, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-02-40", "timestamp": 1585774960, "time_this_iter_s": 32.73963284492493, "time_total_s": 1231.5591778755188, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f204d598>", "on_episode_step": "<function on_episode_step at 0x7ff9f204d488>", "on_episode_end": "<function on_episode_end at 0x7ff9f204d400>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f204d620>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1231.5591778755188, "timesteps_since_restore": 47127, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 82.02340425531915, "ram_util_percent": 64.92127659574469}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.62645751409235, "episode_reward_min": -299.4249156551641, "episode_reward_mean": -6.225102817086533, "episode_len_mean": 444.54, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.73928828949926}, "policy_reward_max": {"av": 32.37221088858867}, "policy_reward_mean": {"av": -3.2254418741381015}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.031661835168005, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 9.813273374268864, "avg_rl_veh_arrival_mean": 316.01166666666666, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.140816048007114, "mean_processing_ms": 3.7649609287259365, "mean_inference_ms": 1.6471059097868082}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 27401, "num_steps_trained": 1869800, "num_steps_sampled": 48127, "sample_time_ms": 12.907, "replay_time_ms": 16.419, "grad_time_ms": 19.909, "update_time_ms": 0.007, "opt_peak_throughput": 5022.77, "opt_samples": 100.0, "learner": {"av": {"mean_q": -15.365997314453125, "max_q": 12.985445022583008, "min_q": -53.144718170166016}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 48127, "episodes_total": 108, "training_iteration": 47, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-02-58", "timestamp": 1585774978, "time_this_iter_s": 17.16233491897583, "time_total_s": 1248.7215127944946, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f20406a8>", "on_episode_step": "<function on_episode_step at 0x7ff9f2040598>", "on_episode_end": "<function on_episode_end at 0x7ff9f2040510>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f2040730>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1248.7215127944946, "timesteps_since_restore": 48127, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 84.52083333333333, "ram_util_percent": 64.91250000000001}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.62645751409235, "episode_reward_min": -299.4249156551641, "episode_reward_mean": -6.665069498617405, "episode_len_mean": 440.62, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.73928828949926}, "policy_reward_max": {"av": 32.37221088858867}, "policy_reward_mean": {"av": -3.4005456625599018}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.174598012067484, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 9.813273374268864, "avg_rl_veh_arrival_mean": 305.7216666666667, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.140153928495355, "mean_processing_ms": 3.7711379302093606, "mean_inference_ms": 1.6413753943931118}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 27713, "num_steps_trained": 1901000, "num_steps_sampled": 49191, "sample_time_ms": 187.89, "replay_time_ms": 15.115, "grad_time_ms": 24.959, "update_time_ms": 0.015, "opt_peak_throughput": 4006.626, "opt_samples": 100.0, "learner": {"av": {"mean_q": -12.580513000488281, "max_q": 8.851092338562012, "min_q": -50.48272705078125}}}, "timesteps_this_iter": 1064, "done": false, "timesteps_total": 49191, "episodes_total": 111, "training_iteration": 48, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-03-19", "timestamp": 1585774999, "time_this_iter_s": 21.783198833465576, "time_total_s": 1270.5047116279602, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f204dae8>", "on_episode_step": "<function on_episode_step at 0x7ff9f204d950>", "on_episode_end": "<function on_episode_end at 0x7ff9f204d9d8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f204d840>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1270.5047116279602, "timesteps_since_restore": 49191, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 83.80645161290322, "ram_util_percent": 64.91290322580647}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.62645751409235, "episode_reward_min": -299.4249156551641, "episode_reward_mean": -2.403116458518649, "episode_len_mean": 442.17, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.73928828949926}, "policy_reward_max": {"av": 32.37221088858867}, "policy_reward_mean": {"av": -1.2198560703140358}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.31178757931389, "avg_speed_min": 0.4566290767718654, "avg_speed_max": 9.813273374268864, "avg_rl_veh_arrival_mean": 298.63166666666666, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.140339313650714, "mean_processing_ms": 3.7724933395231157, "mean_inference_ms": 1.63749480495871}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 27915, "num_steps_trained": 1921200, "num_steps_sampled": 50192, "sample_time_ms": 193.962, "replay_time_ms": 17.898, "grad_time_ms": 19.801, "update_time_ms": 0.005, "opt_peak_throughput": 5050.312, "opt_samples": 100.0, "learner": {"av": {"mean_q": -14.804060935974121, "max_q": 12.524579048156738, "min_q": -65.86359405517578}}}, "timesteps_this_iter": 1001, "done": false, "timesteps_total": 50192, "episodes_total": 113, "training_iteration": 49, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-03-34", "timestamp": 1585775014, "time_this_iter_s": 14.455137968063354, "time_total_s": 1284.9598495960236, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18f861e0>", "on_episode_step": "<function on_episode_step at 0x7ffa18f86e18>", "on_episode_end": "<function on_episode_end at 0x7ff9e8712400>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9e8712b70>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1284.9598495960236, "timesteps_since_restore": 50192, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 76.83999999999999, "ram_util_percent": 64.90000000000002}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.62645751409235, "episode_reward_min": -299.4249156551641, "episode_reward_mean": -3.8976152092000644, "episode_len_mean": 438.76, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.73928828949926}, "policy_reward_max": {"av": 32.37221088858867}, "policy_reward_mean": {"av": -1.9885791883673782}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.4070035996899914, "avg_speed_min": 0.5016121079866268, "avg_speed_max": 9.813273374268864, "avg_rl_veh_arrival_mean": 293.305, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.136967802166887, "mean_processing_ms": 3.7744832491058093, "mean_inference_ms": 1.6313357465278713}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 28527, "num_steps_trained": 1982400, "num_steps_sampled": 51362, "sample_time_ms": 203.29, "replay_time_ms": 18.263, "grad_time_ms": 20.952, "update_time_ms": 0.005, "opt_peak_throughput": 4772.79, "opt_samples": 100.0, "learner": {"av": {"mean_q": -14.857573509216309, "max_q": 13.340237617492676, "min_q": -71.58307647705078}}}, "timesteps_this_iter": 1170, "done": false, "timesteps_total": 51362, "episodes_total": 116, "training_iteration": 50, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-04-10", "timestamp": 1585775050, "time_this_iter_s": 36.311136960983276, "time_total_s": 1321.2709865570068, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f2040f28>", "on_episode_step": "<function on_episode_step at 0x7ff9f204d1e0>", "on_episode_end": "<function on_episode_end at 0x7ff9f204d158>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f204d0d0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1321.2709865570068, "timesteps_since_restore": 51362, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 94.64038461538463, "ram_util_percent": 64.91538461538462}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.62645751409235, "episode_reward_min": -299.4249156551641, "episode_reward_mean": -2.656820611844007, "episode_len_mean": 438.76, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.73928828949926}, "policy_reward_max": {"av": 32.37221088858867}, "policy_reward_mean": {"av": -1.3694951607443338}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.4924721821305305, "avg_speed_min": 0.5016121079866268, "avg_speed_max": 9.813273374268864, "avg_rl_veh_arrival_mean": 287.47499999999997, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.131756837883916, "mean_processing_ms": 3.7740119849769234, "mean_inference_ms": 1.6270861980783562}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 28945, "num_steps_trained": 2024200, "num_steps_sampled": 52375, "sample_time_ms": 197.3, "replay_time_ms": 15.95, "grad_time_ms": 19.311, "update_time_ms": 0.006, "opt_peak_throughput": 5178.518, "opt_samples": 100.0, "learner": {"av": {"mean_q": -14.998222351074219, "max_q": 12.241738319396973, "min_q": -36.54533004760742}}}, "timesteps_this_iter": 1013, "done": false, "timesteps_total": 52375, "episodes_total": 118, "training_iteration": 51, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-04-36", "timestamp": 1585775076, "time_this_iter_s": 25.268220901489258, "time_total_s": 1346.539207458496, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f204d400>", "on_episode_step": "<function on_episode_step at 0x7ff9f204dd08>", "on_episode_end": "<function on_episode_end at 0x7ff9f204d2f0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f204d598>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1346.539207458496, "timesteps_since_restore": 52375, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 96.28333333333333, "ram_util_percent": 64.89444444444446}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.62645751409235, "episode_reward_min": -299.67590803944563, "episode_reward_mean": -7.439430262154189, "episode_len_mean": 433.0, "episodes_this_iter": 4, "policy_reward_min": {"av": -299.73928828949926}, "policy_reward_max": {"av": 32.37221088858867}, "policy_reward_mean": {"av": -3.757288011188983}, "custom_metrics": {"num_ped_collisions_mean": 0.13, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.583454609039492, "avg_speed_min": 0.7749184226853371, "avg_speed_max": 9.813273374268864, "avg_rl_veh_arrival_mean": 283.86499999999995, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.123760766947531, "mean_processing_ms": 3.7734461434455535, "mean_inference_ms": 1.6188764231672819}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 29372, "num_steps_trained": 2066900, "num_steps_sampled": 53375, "sample_time_ms": 10.644, "replay_time_ms": 17.63, "grad_time_ms": 23.233, "update_time_ms": 0.006, "opt_peak_throughput": 4304.133, "opt_samples": 100.0, "learner": {"av": {"mean_q": -17.87891960144043, "max_q": 17.289365768432617, "min_q": -78.52442932128906}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 53375, "episodes_total": 122, "training_iteration": 52, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-05-05", "timestamp": 1585775105, "time_this_iter_s": 29.09584403038025, "time_total_s": 1375.6350514888763, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f204db70>", "on_episode_step": "<function on_episode_step at 0x7ff9f204dbf8>", "on_episode_end": "<function on_episode_end at 0x7ff9f204df28>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f204dea0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1375.6350514888763, "timesteps_since_restore": 53375, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 96.3609756097561, "ram_util_percent": 64.89756097560976}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.62645751409235, "episode_reward_min": -299.67590803944563, "episode_reward_mean": -6.191739619157495, "episode_len_mean": 433.0, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.73928828949926}, "policy_reward_max": {"av": 32.37221088858867}, "policy_reward_mean": {"av": -3.1271412217967147}, "custom_metrics": {"num_ped_collisions_mean": 0.13, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.714968543761784, "avg_speed_min": 0.7749184226853371, "avg_speed_max": 9.813273374268864, "avg_rl_veh_arrival_mean": 276.525, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.116799784468696, "mean_processing_ms": 3.772891683507097, "mean_inference_ms": 1.6128675910915558}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 29547, "num_steps_trained": 2084400, "num_steps_sampled": 54375, "sample_time_ms": 9.716, "replay_time_ms": 17.702, "grad_time_ms": 21.447, "update_time_ms": 0.006, "opt_peak_throughput": 4662.591, "opt_samples": 100.0, "learner": {"av": {"mean_q": -15.904196739196777, "max_q": 11.152345657348633, "min_q": -78.41368103027344}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 54375, "episodes_total": 124, "training_iteration": 53, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-05-18", "timestamp": 1585775118, "time_this_iter_s": 13.309234857559204, "time_total_s": 1388.9442863464355, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18f861e0>", "on_episode_step": "<function on_episode_step at 0x7ff9e8712158>", "on_episode_end": "<function on_episode_end at 0x7ff9e8712d08>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9e8712378>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1388.9442863464355, "timesteps_since_restore": 54375, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 97.4157894736842, "ram_util_percent": 64.8842105263158}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.62645751409235, "episode_reward_min": -299.67590803944563, "episode_reward_mean": -5.252659889503152, "episode_len_mean": 433.0, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.73928828949926}, "policy_reward_max": {"av": 32.37221088858867}, "policy_reward_mean": {"av": -2.6528585300520975}, "custom_metrics": {"num_ped_collisions_mean": 0.13, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.870633188943263, "avg_speed_min": 0.7749184226853371, "avg_speed_max": 9.844079478972782, "avg_rl_veh_arrival_mean": 268.715, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.107672762914201, "mean_processing_ms": 3.7720035491794888, "mean_inference_ms": 1.6053120583231777}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 29697, "num_steps_trained": 2099400, "num_steps_sampled": 55375, "sample_time_ms": 11.512, "replay_time_ms": 16.429, "grad_time_ms": 27.139, "update_time_ms": 0.005, "opt_peak_throughput": 3684.718, "opt_samples": 100.0, "learner": {"av": {"mean_q": -16.32317543029785, "max_q": 14.832001686096191, "min_q": -36.065643310546875}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 55375, "episodes_total": 126, "training_iteration": 54, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-05-30", "timestamp": 1585775130, "time_this_iter_s": 11.894120931625366, "time_total_s": 1400.838407278061, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f204dd08>", "on_episode_step": "<function on_episode_step at 0x7ff9f204d598>", "on_episode_end": "<function on_episode_end at 0x7ff9f204d400>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f2040d08>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1400.838407278061, "timesteps_since_restore": 55375, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 96.4, "ram_util_percent": 64.9}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.62645751409235, "episode_reward_min": -299.67590803944563, "episode_reward_mean": -1.3159466217029245, "episode_len_mean": 437.02, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.73928828949926}, "policy_reward_max": {"av": 32.37221088858867}, "policy_reward_mean": {"av": -0.66461950591057}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.0239304788893016, "avg_speed_min": 0.7749184226853371, "avg_speed_max": 10.036612626088925, "avg_rl_veh_arrival_mean": 261.01, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.096819318342037, "mean_processing_ms": 3.7708799051850486, "mean_inference_ms": 1.5964753231571955}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 29822, "num_steps_trained": 2111900, "num_steps_sampled": 56375, "sample_time_ms": 13.492, "replay_time_ms": 16.434, "grad_time_ms": 16.359, "update_time_ms": 0.006, "opt_peak_throughput": 6113.023, "opt_samples": 100.0, "learner": {"av": {"mean_q": -15.841927528381348, "max_q": 15.563752174377441, "min_q": -40.512718200683594}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 56375, "episodes_total": 128, "training_iteration": 55, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-05-41", "timestamp": 1585775141, "time_this_iter_s": 10.580088138580322, "time_total_s": 1411.4184954166412, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa08197ae8>", "on_episode_step": "<function on_episode_step at 0x7ffa08197400>", "on_episode_end": "<function on_episode_end at 0x7ffa08197950>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa08197bf8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1411.4184954166412, "timesteps_since_restore": 56375, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 96.44, "ram_util_percent": 64.90666666666667}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.62645751409235, "episode_reward_min": -299.67590803944563, "episode_reward_mean": 2.9576338471075845, "episode_len_mean": 441.47, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.73928828949926}, "policy_reward_max": {"av": 32.37221088858867}, "policy_reward_mean": {"av": 1.4788169235537902}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.036742373324058, "avg_speed_min": 0.7749184226853371, "avg_speed_max": 10.036612626088925, "avg_rl_veh_arrival_mean": 255.71666666666667, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.082001926361829, "mean_processing_ms": 3.765778887510737, "mean_inference_ms": 1.5871736127610063}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 30454, "num_steps_trained": 2175100, "num_steps_sampled": 57375, "sample_time_ms": 12.979, "replay_time_ms": 17.389, "grad_time_ms": 23.415, "update_time_ms": 0.006, "opt_peak_throughput": 4270.842, "opt_samples": 100.0, "learner": {"av": {"mean_q": -15.41497802734375, "max_q": 14.767914772033691, "min_q": -70.1978530883789}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 57375, "episodes_total": 130, "training_iteration": 56, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-06-16", "timestamp": 1585775176, "time_this_iter_s": 35.56254982948303, "time_total_s": 1446.9810452461243, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa081970d0>", "on_episode_step": "<function on_episode_step at 0x7ffa08197e18>", "on_episode_end": "<function on_episode_end at 0x7ffa08197d90>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa08197510>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1446.9810452461243, "timesteps_since_restore": 57375, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 94.5, "ram_util_percent": 64.91372549019607}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.62645751409235, "episode_reward_min": -299.67590803944563, "episode_reward_mean": 0.23810601624667171, "episode_len_mean": 436.57, "episodes_this_iter": 4, "policy_reward_min": {"av": -299.73928828949926}, "policy_reward_max": {"av": 32.37221088858867}, "policy_reward_mean": {"av": 0.12086599809475643}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.097836090795122, "avg_speed_min": 0.7749184226853371, "avg_speed_max": 10.036612626088925, "avg_rl_veh_arrival_mean": 248.61166666666668, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.048665549401726, "mean_processing_ms": 3.7567649565987633, "mean_inference_ms": 1.5678214042013434}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 31019, "num_steps_trained": 2231600, "num_steps_sampled": 58403, "sample_time_ms": 187.194, "replay_time_ms": 18.09, "grad_time_ms": 23.914, "update_time_ms": 0.006, "opt_peak_throughput": 4181.65, "opt_samples": 100.0, "learner": {"av": {"mean_q": -19.278751373291016, "max_q": 20.23529624938965, "min_q": -91.7891845703125}}}, "timesteps_this_iter": 1028, "done": false, "timesteps_total": 58403, "episodes_total": 134, "training_iteration": 57, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-06-52", "timestamp": 1585775212, "time_this_iter_s": 35.80577611923218, "time_total_s": 1482.7868213653564, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f2017b70>", "on_episode_step": "<function on_episode_step at 0x7ff9f2017c80>", "on_episode_end": "<function on_episode_end at 0x7ff9e8712378>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9e8712b70>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1482.7868213653564, "timesteps_since_restore": 58403, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 91.23921568627449, "ram_util_percent": 64.9372549019608}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.62645751409235, "episode_reward_min": -299.67590803944563, "episode_reward_mean": 1.1993202446777678, "episode_len_mean": 436.57, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.73928828949926}, "policy_reward_max": {"av": 32.37221088858867}, "policy_reward_mean": {"av": 0.6150360229116731}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.231396182484689, "avg_speed_min": 0.7749184226853371, "avg_speed_max": 10.036612626088925, "avg_rl_veh_arrival_mean": 241.2266666666667, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.028100658962455, "mean_processing_ms": 3.7519207644283505, "mean_inference_ms": 1.556547750969852}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 31182, "num_steps_trained": 2247900, "num_steps_sampled": 59403, "sample_time_ms": 200.992, "replay_time_ms": 17.808, "grad_time_ms": 20.196, "update_time_ms": 0.006, "opt_peak_throughput": 4951.468, "opt_samples": 100.0, "learner": {"av": {"mean_q": -16.96576499938965, "max_q": 8.88631534576416, "min_q": -85.92302703857422}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 59403, "episodes_total": 136, "training_iteration": 58, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-07-04", "timestamp": 1585775224, "time_this_iter_s": 12.230469226837158, "time_total_s": 1495.0172905921936, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f204d048>", "on_episode_step": "<function on_episode_step at 0x7ff9e8106ae8>", "on_episode_end": "<function on_episode_end at 0x7ff9e8712400>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9e8712d08>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1495.0172905921936, "timesteps_since_restore": 59403, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 90.74705882352941, "ram_util_percent": 64.9}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.62645751409235, "episode_reward_min": -299.67590803944563, "episode_reward_mean": 3.110768389266878, "episode_len_mean": 436.57, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.73928828949926}, "policy_reward_max": {"av": 32.37221088858867}, "policy_reward_mean": {"av": 1.5710951460943803}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.333847357363888, "avg_speed_min": 0.7749184226853371, "avg_speed_max": 10.036612626088925, "avg_rl_veh_arrival_mean": 234.62333333333333, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.006261737866696, "mean_processing_ms": 3.7469379189646825, "mean_inference_ms": 1.544597529319346}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 31522, "num_steps_trained": 2281900, "num_steps_sampled": 60440, "sample_time_ms": 209.827, "replay_time_ms": 16.478, "grad_time_ms": 25.808, "update_time_ms": 0.012, "opt_peak_throughput": 3874.757, "opt_samples": 100.0, "learner": {"av": {"mean_q": -17.488208770751953, "max_q": 9.525390625, "min_q": -95.06074523925781}}}, "timesteps_this_iter": 1037, "done": false, "timesteps_total": 60440, "episodes_total": 138, "training_iteration": 59, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-07-27", "timestamp": 1585775247, "time_this_iter_s": 22.384671926498413, "time_total_s": 1517.401962518692, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18f86268>", "on_episode_step": "<function on_episode_step at 0x7ffa18f861e0>", "on_episode_end": "<function on_episode_end at 0x7ff9f2017c80>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa18a2a488>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1517.401962518692, "timesteps_since_restore": 60440, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 81.45, "ram_util_percent": 64.975}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.62645751409235, "episode_reward_min": -299.8328792795605, "episode_reward_mean": 1.705520547996525, "episode_len_mean": 432.51, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.8328792795605}, "policy_reward_max": {"av": 32.37221088858867}, "policy_reward_mean": {"av": 0.8527602739982637}, "custom_metrics": {"num_ped_collisions_mean": 0.13, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.505174028104116, "avg_speed_min": 1.127602501620488, "avg_speed_max": 10.036612626088925, "avg_rl_veh_arrival_mean": 227.57666666666668, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.9721271712462407, "mean_processing_ms": 3.740051425971818, "mean_inference_ms": 1.5250691177688163}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 31764, "num_steps_trained": 2306100, "num_steps_sampled": 61510, "sample_time_ms": 193.242, "replay_time_ms": 16.542, "grad_time_ms": 18.981, "update_time_ms": 0.007, "opt_peak_throughput": 5268.485, "opt_samples": 100.0, "learner": {"av": {"mean_q": -19.138103485107422, "max_q": 14.438827514648438, "min_q": -97.49888610839844}}}, "timesteps_this_iter": 1070, "done": false, "timesteps_total": 61510, "episodes_total": 141, "training_iteration": 60, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-07-45", "timestamp": 1585775265, "time_this_iter_s": 18.247364044189453, "time_total_s": 1535.6493265628815, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18f862f0>", "on_episode_step": "<function on_episode_step at 0x7ff9f9063f28>", "on_episode_end": "<function on_episode_end at 0x7ff9f9080d90>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f2017ae8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1535.6493265628815, "timesteps_since_restore": 61510, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 95.7846153846154, "ram_util_percent": 64.93846153846154}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.62645751409235, "episode_reward_min": -299.8328792795605, "episode_reward_mean": -1.263516719927446, "episode_len_mean": 428.27, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.8328792795605}, "policy_reward_max": {"av": 32.37221088858867}, "policy_reward_mean": {"av": -0.6413790456484493}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.618572465999296, "avg_speed_min": 1.127602501620488, "avg_speed_max": 10.036612626088925, "avg_rl_veh_arrival_mean": 224.0716666666667, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.9377843961455623, "mean_processing_ms": 3.7332816196363927, "mean_inference_ms": 1.5057086863993048}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 32011, "num_steps_trained": 2330800, "num_steps_sampled": 62606, "sample_time_ms": 211.303, "replay_time_ms": 17.698, "grad_time_ms": 20.806, "update_time_ms": 0.006, "opt_peak_throughput": 4806.404, "opt_samples": 100.0, "learner": {"av": {"mean_q": -18.546049118041992, "max_q": 19.320892333984375, "min_q": -98.37569427490234}}}, "timesteps_this_iter": 1096, "done": false, "timesteps_total": 62606, "episodes_total": 144, "training_iteration": 61, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-08-03", "timestamp": 1585775283, "time_this_iter_s": 17.99878716468811, "time_total_s": 1553.6481137275696, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa08197ae8>", "on_episode_step": "<function on_episode_step at 0x7ffa08197400>", "on_episode_end": "<function on_episode_end at 0x7ffa08197bf8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f20176a8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1553.6481137275696, "timesteps_since_restore": 62606, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 84.78461538461536, "ram_util_percent": 64.84615384615385}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.62645751409235, "episode_reward_min": -299.8328792795605, "episode_reward_mean": -2.5673318950434987, "episode_len_mean": 421.99, "episodes_this_iter": 4, "policy_reward_min": {"av": -299.8328792795605}, "policy_reward_max": {"av": 32.37221088858867}, "policy_reward_mean": {"av": -1.2966322702239914}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.552889690508933, "avg_speed_min": 1.127602501620488, "avg_speed_max": 10.036612626088925, "avg_rl_veh_arrival_mean": 222.99666666666667, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.896320511775748, "mean_processing_ms": 3.7260993116139076, "mean_inference_ms": 1.4822432982944285}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 32595, "num_steps_trained": 2389200, "num_steps_sampled": 63606, "sample_time_ms": 10.184, "replay_time_ms": 16.585, "grad_time_ms": 23.407, "update_time_ms": 0.006, "opt_peak_throughput": 4272.225, "opt_samples": 100.0, "learner": {"av": {"mean_q": -17.3211727142334, "max_q": 10.024693489074707, "min_q": -52.680274963378906}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 63606, "episodes_total": 148, "training_iteration": 62, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-08-39", "timestamp": 1585775319, "time_this_iter_s": 36.0232880115509, "time_total_s": 1589.6714017391205, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f204dd90>", "on_episode_step": "<function on_episode_step at 0x7ff9f204d950>", "on_episode_end": "<function on_episode_end at 0x7ff9f204de18>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f204df28>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1589.6714017391205, "timesteps_since_restore": 63606, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 84.81176470588234, "ram_util_percent": 64.82156862745099}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.62645751409235, "episode_reward_min": -299.8328792795605, "episode_reward_mean": -0.3459061429697964, "episode_len_mean": 426.03, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.8328792795605}, "policy_reward_max": {"av": 32.37221088858867}, "policy_reward_mean": {"av": -0.17382218239688324}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.648199130467689, "avg_speed_min": 1.127602501620488, "avg_speed_max": 10.036612626088925, "avg_rl_veh_arrival_mean": 221.0066666666667, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.876401283547998, "mean_processing_ms": 3.721548848529049, "mean_inference_ms": 1.470910473267876}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 32872, "num_steps_trained": 2416900, "num_steps_sampled": 64606, "sample_time_ms": 10.422, "replay_time_ms": 16.927, "grad_time_ms": 23.939, "update_time_ms": 0.006, "opt_peak_throughput": 4177.223, "opt_samples": 100.0, "learner": {"av": {"mean_q": -22.003582000732422, "max_q": 8.90921688079834, "min_q": -67.57195281982422}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 64606, "episodes_total": 150, "training_iteration": 63, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-08-57", "timestamp": 1585775337, "time_this_iter_s": 18.40474009513855, "time_total_s": 1608.076141834259, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f2040598>", "on_episode_step": "<function on_episode_step at 0x7ff9f2040268>", "on_episode_end": "<function on_episode_end at 0x7ff9f2040510>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f2040620>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1608.076141834259, "timesteps_since_restore": 64606, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 74.42307692307692, "ram_util_percent": 64.8076923076923}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.62645751409235, "episode_reward_min": -299.8328792795605, "episode_reward_mean": -0.07296956572066876, "episode_len_mean": 426.03, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.8328792795605}, "policy_reward_max": {"av": 32.37221088858867}, "policy_reward_mean": {"av": -0.036668123477725134}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.678265849049517, "avg_speed_min": 1.127602501620488, "avg_speed_max": 10.036612626088925, "avg_rl_veh_arrival_mean": 220.08833333333337, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.856526283147044, "mean_processing_ms": 3.717067136329472, "mean_inference_ms": 1.4595128337350571}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 33135, "num_steps_trained": 2443200, "num_steps_sampled": 65606, "sample_time_ms": 15.981, "replay_time_ms": 15.546, "grad_time_ms": 23.095, "update_time_ms": 0.006, "opt_peak_throughput": 4329.85, "opt_samples": 100.0, "learner": {"av": {"mean_q": -20.747119903564453, "max_q": 22.6400203704834, "min_q": -105.31958770751953}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 65606, "episodes_total": 152, "training_iteration": 64, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-09-15", "timestamp": 1585775355, "time_this_iter_s": 17.694654941558838, "time_total_s": 1625.7707967758179, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f20402f0>", "on_episode_step": "<function on_episode_step at 0x7ff9f2040048>", "on_episode_end": "<function on_episode_end at 0x7ff9f2040730>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f2040d08>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1625.7707967758179, "timesteps_since_restore": 65606, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 76.78, "ram_util_percent": 64.83200000000001}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.62645751409235, "episode_reward_min": -299.8328792795605, "episode_reward_mean": -2.9865302698396077, "episode_len_mean": 422.44, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.8328792795605}, "policy_reward_max": {"av": 32.37221088858867}, "policy_reward_mean": {"av": -1.4858359551440852}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.705646000368067, "avg_speed_min": 1.127602501620488, "avg_speed_max": 10.036612626088925, "avg_rl_veh_arrival_mean": 222.37833333333336, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.828391814423646, "mean_processing_ms": 3.7115740062373628, "mean_inference_ms": 1.4431279366584828}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 33446, "num_steps_trained": 2474300, "num_steps_sampled": 66689, "sample_time_ms": 215.067, "replay_time_ms": 18.44, "grad_time_ms": 23.453, "update_time_ms": 0.006, "opt_peak_throughput": 4263.869, "opt_samples": 100.0, "learner": {"av": {"mean_q": -19.113615036010742, "max_q": 21.398643493652344, "min_q": -83.92961883544922}}}, "timesteps_this_iter": 1083, "done": false, "timesteps_total": 66689, "episodes_total": 155, "training_iteration": 65, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-09-36", "timestamp": 1585775376, "time_this_iter_s": 21.320491075515747, "time_total_s": 1647.0912878513336, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f2040598>", "on_episode_step": "<function on_episode_step at 0x7ffa18f86d08>", "on_episode_end": "<function on_episode_end at 0x7ffa18f862f0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa18f861e0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1647.0912878513336, "timesteps_since_restore": 66689, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 77.05999999999999, "ram_util_percent": 64.85333333333335}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.62645751409235, "episode_reward_min": -299.8328792795605, "episode_reward_mean": -3.63240506302168, "episode_len_mean": 422.44, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.8328792795605}, "policy_reward_max": {"av": 32.37221088858867}, "policy_reward_mean": {"av": -1.8253291773978308}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.681486951041218, "avg_speed_min": 1.127602501620488, "avg_speed_max": 10.036612626088925, "avg_rl_veh_arrival_mean": 223.17, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.811008066729473, "mean_processing_ms": 3.708502520791756, "mean_inference_ms": 1.4329986564518113}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 33841, "num_steps_trained": 2513800, "num_steps_sampled": 67701, "sample_time_ms": 202.429, "replay_time_ms": 16.703, "grad_time_ms": 23.812, "update_time_ms": 0.005, "opt_peak_throughput": 4199.612, "opt_samples": 100.0, "learner": {"av": {"mean_q": -21.034645080566406, "max_q": 16.314163208007812, "min_q": -108.36100769042969}}}, "timesteps_this_iter": 1012, "done": false, "timesteps_total": 67701, "episodes_total": 157, "training_iteration": 66, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-10-00", "timestamp": 1585775400, "time_this_iter_s": 23.928709268569946, "time_total_s": 1671.0199971199036, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f20176a8>", "on_episode_step": "<function on_episode_step at 0x7ff9f2017ae8>", "on_episode_end": "<function on_episode_end at 0x7ff9f204d378>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f204d510>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1671.0199971199036, "timesteps_since_restore": 67701, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 82.62058823529412, "ram_util_percent": 64.9}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.62645751409235, "episode_reward_min": -299.8328792795605, "episode_reward_mean": -5.931338901212644, "episode_len_mean": 418.54, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.8328792795605}, "policy_reward_max": {"av": 32.37221088858867}, "policy_reward_mean": {"av": -2.950914876225196}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.663124081966129, "avg_speed_min": 1.127602501620488, "avg_speed_max": 10.036612626088925, "avg_rl_veh_arrival_mean": 222.76, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.795295392872836, "mean_processing_ms": 3.7059752365616108, "mean_inference_ms": 1.4238114397244248}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 34379, "num_steps_trained": 2567600, "num_steps_sampled": 68701, "sample_time_ms": 9.029, "replay_time_ms": 14.814, "grad_time_ms": 27.577, "update_time_ms": 0.006, "opt_peak_throughput": 3626.236, "opt_samples": 100.0, "learner": {"av": {"mean_q": -23.767126083374023, "max_q": 11.5952787399292, "min_q": -88.64396667480469}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 68701, "episodes_total": 159, "training_iteration": 67, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-10-33", "timestamp": 1585775433, "time_this_iter_s": 32.16797709465027, "time_total_s": 1703.1879742145538, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f204db70>", "on_episode_step": "<function on_episode_step at 0x7ff9f204d730>", "on_episode_end": "<function on_episode_end at 0x7ff9f204d400>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f204d9d8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1703.1879742145538, "timesteps_since_restore": 68701, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 87.83260869565218, "ram_util_percent": 64.93913043478263}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.62645751409235, "episode_reward_min": -299.8328792795605, "episode_reward_mean": -6.297696137242869, "episode_len_mean": 418.54, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.8328792795605}, "policy_reward_max": {"av": 32.37221088858867}, "policy_reward_mean": {"av": -3.1488480686214335}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.629633577925654, "avg_speed_min": 1.127602501620488, "avg_speed_max": 10.036612626088925, "avg_rl_veh_arrival_mean": 225.65166666666667, "avg_rl_veh_arrival_min": 93.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.772471276580374, "mean_processing_ms": 3.70312431570884, "mean_inference_ms": 1.4103371798421327}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 34870, "num_steps_trained": 2616700, "num_steps_sampled": 69782, "sample_time_ms": 183.444, "replay_time_ms": 16.442, "grad_time_ms": 19.131, "update_time_ms": 0.006, "opt_peak_throughput": 5227.166, "opt_samples": 100.0, "learner": {"av": {"mean_q": -21.524389266967773, "max_q": 20.072362899780273, "min_q": -108.76948547363281}}}, "timesteps_this_iter": 1081, "done": false, "timesteps_total": 69782, "episodes_total": 162, "training_iteration": 68, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-11-03", "timestamp": 1585775463, "time_this_iter_s": 30.628468990325928, "time_total_s": 1733.8164432048798, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9e8106ae8>", "on_episode_step": "<function on_episode_step at 0x7ff9f204d2f0>", "on_episode_end": "<function on_episode_end at 0x7ff9f204d620>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f204dea0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1733.8164432048798, "timesteps_since_restore": 69782, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 78.94090909090909, "ram_util_percent": 64.95681818181819}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.62645751409235, "episode_reward_min": -299.8328792795605, "episode_reward_mean": -5.65081185868347, "episode_len_mean": 418.54, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.8328792795605}, "policy_reward_max": {"av": 32.37221088858867}, "policy_reward_mean": {"av": -2.8254059293417333}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.7620168341151485, "avg_speed_min": 1.4706955970801447, "avg_speed_max": 10.036612626088925, "avg_rl_veh_arrival_mean": 222.14166666666665, "avg_rl_veh_arrival_min": 93.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.756878475316382, "mean_processing_ms": 3.701157924157859, "mean_inference_ms": 1.4006552801814849}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 35075, "num_steps_trained": 2637200, "num_steps_sampled": 70782, "sample_time_ms": 9.083, "replay_time_ms": 16.336, "grad_time_ms": 17.396, "update_time_ms": 0.009, "opt_peak_throughput": 5748.433, "opt_samples": 100.0, "learner": {"av": {"mean_q": -20.666475296020508, "max_q": 19.199514389038086, "min_q": -58.41707229614258}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 70782, "episodes_total": 164, "training_iteration": 69, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-11-18", "timestamp": 1585775478, "time_this_iter_s": 14.56906509399414, "time_total_s": 1748.385508298874, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18f86ae8>", "on_episode_step": "<function on_episode_step at 0x7ffa18f862f0>", "on_episode_end": "<function on_episode_end at 0x7ffa18f861e0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa18f86e18>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1748.385508298874, "timesteps_since_restore": 70782, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 76.65, "ram_util_percent": 64.995}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.62645751409235, "episode_reward_min": -299.8328792795605, "episode_reward_mean": -5.32217471968731, "episode_len_mean": 418.54, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.8328792795605}, "policy_reward_max": {"av": 32.37221088858867}, "policy_reward_mean": {"av": -2.6478481192474157}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.821974962350817, "avg_speed_min": 1.4706955970801447, "avg_speed_max": 10.036612626088925, "avg_rl_veh_arrival_mean": 220.58166666666668, "avg_rl_veh_arrival_min": 93.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.7413467836497296, "mean_processing_ms": 3.6992492190257495, "mean_inference_ms": 1.3907723189752335}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 35345, "num_steps_trained": 2664200, "num_steps_sampled": 71801, "sample_time_ms": 195.099, "replay_time_ms": 16.211, "grad_time_ms": 21.707, "update_time_ms": 0.006, "opt_peak_throughput": 4606.761, "opt_samples": 100.0, "learner": {"av": {"mean_q": -18.597362518310547, "max_q": 21.902132034301758, "min_q": -64.27320098876953}}}, "timesteps_this_iter": 1019, "done": false, "timesteps_total": 71801, "episodes_total": 166, "training_iteration": 70, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-11-36", "timestamp": 1585775496, "time_this_iter_s": 18.26583504676819, "time_total_s": 1766.651343345642, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f2017b70>", "on_episode_step": "<function on_episode_step at 0x7ff9e8106ae8>", "on_episode_end": "<function on_episode_end at 0x7ffa1817f840>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa08197d90>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1766.651343345642, "timesteps_since_restore": 71801, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 70.4576923076923, "ram_util_percent": 64.96923076923078}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.62645751409235, "episode_reward_min": -299.8328792795605, "episode_reward_mean": -11.215177254995103, "episode_len_mean": 410.36, "episodes_this_iter": 4, "policy_reward_min": {"av": -299.85823660140716}, "policy_reward_max": {"av": 32.37221088858867}, "policy_reward_mean": {"av": -5.552067948017377}, "custom_metrics": {"num_ped_collisions_mean": 0.16, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.802452597111877, "avg_speed_min": 1.4706955970801447, "avg_speed_max": 10.036612626088925, "avg_rl_veh_arrival_mean": 223.145, "avg_rl_veh_arrival_min": 93.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.712813020831743, "mean_processing_ms": 3.697530715522796, "mean_inference_ms": 1.372434397908347}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 35803, "num_steps_trained": 2710000, "num_steps_sampled": 72965, "sample_time_ms": 180.064, "replay_time_ms": 16.512, "grad_time_ms": 15.786, "update_time_ms": 0.005, "opt_peak_throughput": 6334.62, "opt_samples": 100.0, "learner": {"av": {"mean_q": -20.541894912719727, "max_q": 23.68776512145996, "min_q": -59.78727722167969}}}, "timesteps_this_iter": 1164, "done": false, "timesteps_total": 72965, "episodes_total": 170, "training_iteration": 71, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-12-07", "timestamp": 1585775527, "time_this_iter_s": 30.9885470867157, "time_total_s": 1797.6398904323578, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f204d488>", "on_episode_step": "<function on_episode_step at 0x7ff9f204d268>", "on_episode_end": "<function on_episode_end at 0x7ff9f204d378>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f204d7b8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1797.6398904323578, "timesteps_since_restore": 72965, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 67.86363636363636, "ram_util_percent": 64.92045454545456}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.62645751409235, "episode_reward_min": -299.8328792795605, "episode_reward_mean": -10.269609446231186, "episode_len_mean": 410.36, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.85823660140716}, "policy_reward_max": {"av": 32.36360690229824}, "policy_reward_mean": {"av": -5.009565583527409}, "custom_metrics": {"num_ped_collisions_mean": 0.16, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.84784344215463, "avg_speed_min": 1.4706955970801447, "avg_speed_max": 10.036612626088925, "avg_rl_veh_arrival_mean": 221.4333333333333, "avg_rl_veh_arrival_min": 93.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.699743455751533, "mean_processing_ms": 3.697134761578379, "mean_inference_ms": 1.3639740016670039}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 36060, "num_steps_trained": 2735700, "num_steps_sampled": 73978, "sample_time_ms": 204.844, "replay_time_ms": 17.08, "grad_time_ms": 23.917, "update_time_ms": 0.025, "opt_peak_throughput": 4181.158, "opt_samples": 100.0, "learner": {"av": {"mean_q": -25.546903610229492, "max_q": 17.63314437866211, "min_q": -115.9512939453125}}}, "timesteps_this_iter": 1013, "done": false, "timesteps_total": 73978, "episodes_total": 172, "training_iteration": 72, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-12-25", "timestamp": 1585775545, "time_this_iter_s": 17.631407976150513, "time_total_s": 1815.2712984085083, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f20176a8>", "on_episode_step": "<function on_episode_step at 0x7ff9f2017400>", "on_episode_end": "<function on_episode_end at 0x7ff9f2017b70>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f2017c80>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1815.2712984085083, "timesteps_since_restore": 73978, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 73.172, "ram_util_percent": 64.928}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.62645751409235, "episode_reward_min": -299.8328792795605, "episode_reward_mean": -9.630059812913515, "episode_len_mean": 410.36, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.85823660140716}, "policy_reward_max": {"av": 32.36586846649257}, "policy_reward_mean": {"av": -4.652202808170777}, "custom_metrics": {"num_ped_collisions_mean": 0.16, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.851151672944225, "avg_speed_min": 1.4706955970801447, "avg_speed_max": 10.036612626088925, "avg_rl_veh_arrival_mean": 221.16, "avg_rl_veh_arrival_min": 93.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.6874171704501477, "mean_processing_ms": 3.6969715731507864, "mean_inference_ms": 1.355853209466802}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 36481, "num_steps_trained": 2777800, "num_steps_sampled": 74978, "sample_time_ms": 8.831, "replay_time_ms": 18.543, "grad_time_ms": 20.076, "update_time_ms": 0.005, "opt_peak_throughput": 4981.104, "opt_samples": 100.0, "learner": {"av": {"mean_q": -22.827774047851562, "max_q": 22.89978790283203, "min_q": -62.34473419189453}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 74978, "episodes_total": 174, "training_iteration": 73, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-12-50", "timestamp": 1585775570, "time_this_iter_s": 25.456806898117065, "time_total_s": 1840.7281053066254, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f204d598>", "on_episode_step": "<function on_episode_step at 0x7ff9f204d950>", "on_episode_end": "<function on_episode_end at 0x7ff9f204dd08>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f204dbf8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1840.7281053066254, "timesteps_since_restore": 74978, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 73.22702702702703, "ram_util_percent": 64.95675675675676}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.62645751409235, "episode_reward_min": -299.8328792795605, "episode_reward_mean": -14.121603213680803, "episode_len_mean": 403.3, "episodes_this_iter": 4, "policy_reward_min": {"av": -299.85823660140716}, "policy_reward_max": {"av": 32.36586846649257}, "policy_reward_mean": {"av": -6.855147191107189}, "custom_metrics": {"num_ped_collisions_mean": 0.17, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.7952109168030566, "avg_speed_min": 1.4706955970801447, "avg_speed_max": 10.036612626088925, "avg_rl_veh_arrival_mean": 224.46166666666664, "avg_rl_veh_arrival_min": 93.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.6645576774858255, "mean_processing_ms": 3.6981455580409044, "mean_inference_ms": 1.3405936153889393}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 36898, "num_steps_trained": 2819500, "num_steps_sampled": 76275, "sample_time_ms": 217.93, "replay_time_ms": 16.313, "grad_time_ms": 23.043, "update_time_ms": 0.006, "opt_peak_throughput": 4339.724, "opt_samples": 100.0, "learner": {"av": {"mean_q": -21.232011795043945, "max_q": 25.604429244995117, "min_q": -65.47401428222656}}}, "timesteps_this_iter": 1297, "done": false, "timesteps_total": 76275, "episodes_total": 178, "training_iteration": 74, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-13-19", "timestamp": 1585775599, "time_this_iter_s": 28.779329776763916, "time_total_s": 1869.5074350833893, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa08197488>", "on_episode_step": "<function on_episode_step at 0x7ffa08197e18>", "on_episode_end": "<function on_episode_end at 0x7ffa08197950>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa08197bf8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1869.5074350833893, "timesteps_since_restore": 76275, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 82.17073170731707, "ram_util_percent": 64.9439024390244}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.62645751409235, "episode_reward_min": -299.8328792795605, "episode_reward_mean": -14.127827750915953, "episode_len_mean": 403.3, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.85823660140716}, "policy_reward_max": {"av": 32.36586846649257}, "policy_reward_mean": {"av": -6.8581688111242505}, "custom_metrics": {"num_ped_collisions_mean": 0.17, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.769176640418826, "avg_speed_min": 1.4706955970801447, "avg_speed_max": 10.036612626088925, "avg_rl_veh_arrival_mean": 225.21833333333336, "avg_rl_veh_arrival_min": 93.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.654102583515433, "mean_processing_ms": 3.699098704519257, "mean_inference_ms": 1.3336397037749683}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 37353, "num_steps_trained": 2865000, "num_steps_sampled": 77275, "sample_time_ms": 197.708, "replay_time_ms": 17.265, "grad_time_ms": 20.945, "update_time_ms": 0.006, "opt_peak_throughput": 4774.414, "opt_samples": 100.0, "learner": {"av": {"mean_q": -20.717124938964844, "max_q": 22.45065689086914, "min_q": -68.05538177490234}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 77275, "episodes_total": 180, "training_iteration": 75, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-13-46", "timestamp": 1585775626, "time_this_iter_s": 26.90913200378418, "time_total_s": 1896.4165670871735, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa08197048>", "on_episode_step": "<function on_episode_step at 0x7ffa08197ae8>", "on_episode_end": "<function on_episode_end at 0x7ffa08197d90>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa08197400>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1896.4165670871735, "timesteps_since_restore": 77275, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 73.16315789473686, "ram_util_percent": 64.91315789473687}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.62645751409235, "episode_reward_min": -299.8328792795605, "episode_reward_mean": -14.445743016071301, "episode_len_mean": 403.3, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.85823660140716}, "policy_reward_max": {"av": 32.36586846649257}, "policy_reward_mean": {"av": -7.046703910278685}, "custom_metrics": {"num_ped_collisions_mean": 0.17, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.736839078314784, "avg_speed_min": 1.4706955970801447, "avg_speed_max": 10.036612626088925, "avg_rl_veh_arrival_mean": 225.61333333333334, "avg_rl_veh_arrival_min": 93.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.6440117675377737, "mean_processing_ms": 3.6999206652855627, "mean_inference_ms": 1.3269915441699487}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 37677, "num_steps_trained": 2897400, "num_steps_sampled": 78275, "sample_time_ms": 10.97, "replay_time_ms": 17.632, "grad_time_ms": 20.434, "update_time_ms": 0.006, "opt_peak_throughput": 4893.851, "opt_samples": 100.0, "learner": {"av": {"mean_q": -27.535554885864258, "max_q": 23.188196182250977, "min_q": -119.01600646972656}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 78275, "episodes_total": 182, "training_iteration": 76, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-14-07", "timestamp": 1585775647, "time_this_iter_s": 20.453869104385376, "time_total_s": 1916.8704361915588, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa081971e0>", "on_episode_step": "<function on_episode_step at 0x7ffa08197950>", "on_episode_end": "<function on_episode_end at 0x7ff9f204d9d8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f204d048>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1916.8704361915588, "timesteps_since_restore": 78275, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 79.48275862068965, "ram_util_percent": 64.90344827586209}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.62645751409235, "episode_reward_min": -299.8328792795605, "episode_reward_mean": -11.154695918963005, "episode_len_mean": 407.29, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.85823660140716}, "policy_reward_max": {"av": 32.36586846649257}, "policy_reward_mean": {"av": -5.467988195570102}, "custom_metrics": {"num_ped_collisions_mean": 0.16, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.762777169496895, "avg_speed_min": 1.4706955970801447, "avg_speed_max": 10.036612626088925, "avg_rl_veh_arrival_mean": 221.65333333333336, "avg_rl_veh_arrival_min": 93.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.6340200838698524, "mean_processing_ms": 3.700467135565529, "mean_inference_ms": 1.3204768512738716}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 38010, "num_steps_trained": 2930700, "num_steps_sampled": 79275, "sample_time_ms": 11.418, "replay_time_ms": 17.986, "grad_time_ms": 24.302, "update_time_ms": 0.006, "opt_peak_throughput": 4114.887, "opt_samples": 100.0, "learner": {"av": {"mean_q": -22.89693832397461, "max_q": 27.45587730407715, "min_q": -118.6130142211914}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 79275, "episodes_total": 184, "training_iteration": 77, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-14-28", "timestamp": 1585775668, "time_this_iter_s": 21.139246940612793, "time_total_s": 1938.0096831321716, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f2040048>", "on_episode_step": "<function on_episode_step at 0x7ff9f2017b70>", "on_episode_end": "<function on_episode_end at 0x7ff9f2017400>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff978028488>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1938.0096831321716, "timesteps_since_restore": 79275, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 73.86333333333333, "ram_util_percent": 64.89333333333336}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.62645751409235, "episode_reward_min": -299.8328792795605, "episode_reward_mean": -18.73379327722713, "episode_len_mean": 399.74, "episodes_this_iter": 4, "policy_reward_min": {"av": -299.85823660140716}, "policy_reward_max": {"av": 32.36586846649257}, "policy_reward_mean": {"av": -9.228469594693168}, "custom_metrics": {"num_ped_collisions_mean": 0.18, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.687730639235981, "avg_speed_min": 1.4706955970801447, "avg_speed_max": 10.036612626088925, "avg_rl_veh_arrival_mean": 229.445, "avg_rl_veh_arrival_min": 93.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.61569577716739, "mean_processing_ms": 3.7030419880821843, "mean_inference_ms": 1.3085999250999978}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 38446, "num_steps_trained": 2974300, "num_steps_sampled": 80532, "sample_time_ms": 202.585, "replay_time_ms": 16.368, "grad_time_ms": 20.2, "update_time_ms": 0.006, "opt_peak_throughput": 4950.497, "opt_samples": 100.0, "learner": {"av": {"mean_q": -24.362607955932617, "max_q": 24.82050323486328, "min_q": -73.03915405273438}}}, "timesteps_this_iter": 1257, "done": false, "timesteps_total": 80532, "episodes_total": 188, "training_iteration": 78, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-14-57", "timestamp": 1585775697, "time_this_iter_s": 29.089133739471436, "time_total_s": 1967.098816871643, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f2040d90>", "on_episode_step": "<function on_episode_step at 0x7ff9f2040e18>", "on_episode_end": "<function on_episode_end at 0x7ff9f2040d08>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff978028268>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1967.098816871643, "timesteps_since_restore": 80532, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 77.57560975609756, "ram_util_percent": 64.9}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.20274159899326, "episode_reward_min": -299.8328792795605, "episode_reward_mean": -18.113765617907102, "episode_len_mean": 400.37, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.85823660140716}, "policy_reward_max": {"av": 32.36586846649257}, "policy_reward_mean": {"av": -9.05688280895355}, "custom_metrics": {"num_ped_collisions_mean": 0.18, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.62658273138778, "avg_speed_min": 1.4706955970801447, "avg_speed_max": 10.036612626088925, "avg_rl_veh_arrival_mean": 231.18, "avg_rl_veh_arrival_min": 93.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.602810188894499, "mean_processing_ms": 3.7049514289530094, "mean_inference_ms": 1.3003527899922043}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 38897, "num_steps_trained": 3019400, "num_steps_sampled": 81656, "sample_time_ms": 188.341, "replay_time_ms": 15.357, "grad_time_ms": 17.693, "update_time_ms": 0.006, "opt_peak_throughput": 5652.03, "opt_samples": 100.0, "learner": {"av": {"mean_q": -25.58740234375, "max_q": 16.549236297607422, "min_q": -69.8985366821289}}}, "timesteps_this_iter": 1124, "done": false, "timesteps_total": 81656, "episodes_total": 191, "training_iteration": 79, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-15-26", "timestamp": 1585775726, "time_this_iter_s": 28.67148494720459, "time_total_s": 1995.7703018188477, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18f862f0>", "on_episode_step": "<function on_episode_step at 0x7ff9e8712b70>", "on_episode_end": "<function on_episode_end at 0x7ff9e8712400>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9e8712d08>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1995.7703018188477, "timesteps_since_restore": 81656, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 68.04634146341463, "ram_util_percent": 64.92682926829269}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.20274159899326, "episode_reward_min": -299.8328792795605, "episode_reward_mean": -14.230644101326654, "episode_len_mean": 403.82, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.85823660140716}, "policy_reward_max": {"av": 32.36586846649257}, "policy_reward_mean": {"av": -7.079922438470973}, "custom_metrics": {"num_ped_collisions_mean": 0.17, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.599513270665691, "avg_speed_min": 1.4706955970801447, "avg_speed_max": 10.036612626088925, "avg_rl_veh_arrival_mean": 228.82166666666663, "avg_rl_veh_arrival_min": 93.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.5948797895088456, "mean_processing_ms": 3.7060312762759655, "mean_inference_ms": 1.295334705315219}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 39388, "num_steps_trained": 3068500, "num_steps_sampled": 82681, "sample_time_ms": 180.426, "replay_time_ms": 15.757, "grad_time_ms": 20.714, "update_time_ms": 0.006, "opt_peak_throughput": 4827.565, "opt_samples": 100.0, "learner": {"av": {"mean_q": -24.294843673706055, "max_q": 26.075878143310547, "min_q": -125.0412826538086}}}, "timesteps_this_iter": 1025, "done": false, "timesteps_total": 82681, "episodes_total": 193, "training_iteration": 80, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-15-55", "timestamp": 1585775755, "time_this_iter_s": 29.4684579372406, "time_total_s": 2025.2387597560883, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff978028c80>", "on_episode_step": "<function on_episode_step at 0x7ff9780286a8>", "on_episode_end": "<function on_episode_end at 0x7ff978028730>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9780288c8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2025.2387597560883, "timesteps_since_restore": 82681, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 66.78571428571429, "ram_util_percent": 64.86904761904762}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.20274159899326, "episode_reward_min": -299.8328792795605, "episode_reward_mean": -15.1941708299969, "episode_len_mean": 400.31, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.85823660140716}, "policy_reward_max": {"av": 32.36586846649257}, "policy_reward_mean": {"av": -7.6352617236165345}, "custom_metrics": {"num_ped_collisions_mean": 0.17, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.5990123426795, "avg_speed_min": 1.4706955970801447, "avg_speed_max": 10.036612626088925, "avg_rl_veh_arrival_mean": 227.37833333333336, "avg_rl_veh_arrival_min": 93.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.5828034224822294, "mean_processing_ms": 3.707910095784683, "mean_inference_ms": 1.287766042181546}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 39635, "num_steps_trained": 3093200, "num_steps_sampled": 83809, "sample_time_ms": 210.525, "replay_time_ms": 18.204, "grad_time_ms": 25.62, "update_time_ms": 0.006, "opt_peak_throughput": 3903.152, "opt_samples": 100.0, "learner": {"av": {"mean_q": -27.208030700683594, "max_q": 22.849451065063477, "min_q": -121.52719116210938}}}, "timesteps_this_iter": 1128, "done": false, "timesteps_total": 83809, "episodes_total": 196, "training_iteration": 81, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-16-13", "timestamp": 1585775773, "time_this_iter_s": 18.008185863494873, "time_total_s": 2043.2469456195831, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f9080d90>", "on_episode_step": "<function on_episode_step at 0x7ff9780289d8>", "on_episode_end": "<function on_episode_end at 0x7ff978028e18>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9780281e0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2043.2469456195831, "timesteps_since_restore": 83809, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 62.692307692307686, "ram_util_percent": 64.92692307692309}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.20274159899326, "episode_reward_min": -299.8328792795605, "episode_reward_mean": -16.172390362410713, "episode_len_mean": 395.58, "episodes_this_iter": 4, "policy_reward_min": {"av": -299.85823660140716}, "policy_reward_max": {"av": 32.36586846649257}, "policy_reward_mean": {"av": -8.00613384277758}, "custom_metrics": {"num_ped_collisions_mean": 0.16, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.577056254422675, "avg_speed_min": 1.4706955970801447, "avg_speed_max": 10.036612626088925, "avg_rl_veh_arrival_mean": 222.99833333333336, "avg_rl_veh_arrival_min": 90.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.567824222717063, "mean_processing_ms": 3.710928789666971, "mean_inference_ms": 1.2785437725183453}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 39919, "num_steps_trained": 3121600, "num_steps_sampled": 85021, "sample_time_ms": 224.208, "replay_time_ms": 19.331, "grad_time_ms": 20.838, "update_time_ms": 0.006, "opt_peak_throughput": 4798.903, "opt_samples": 100.0, "learner": {"av": {"mean_q": -25.882890701293945, "max_q": 28.69346046447754, "min_q": -71.47388458251953}}}, "timesteps_this_iter": 1212, "done": false, "timesteps_total": 85021, "episodes_total": 200, "training_iteration": 82, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-16-36", "timestamp": 1585775796, "time_this_iter_s": 22.30500102043152, "time_total_s": 2065.5519466400146, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff978028a60>", "on_episode_step": "<function on_episode_step at 0x7ff9780282f0>", "on_episode_end": "<function on_episode_end at 0x7ff978028ea0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff978028598>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2065.5519466400146, "timesteps_since_restore": 85021, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 65.10967741935484, "ram_util_percent": 64.93870967741937}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.20274159899326, "episode_reward_min": -299.8328792795605, "episode_reward_mean": -12.561826834497799, "episode_len_mean": 398.72, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.85823660140716}, "policy_reward_max": {"av": 32.36586846649257}, "policy_reward_mean": {"av": -6.218726155691981}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.6363349564164835, "avg_speed_min": 1.4706955970801447, "avg_speed_max": 10.036612626088925, "avg_rl_veh_arrival_mean": 218.95333333333335, "avg_rl_veh_arrival_min": 90.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.5604951298136815, "mean_processing_ms": 3.7121984131221892, "mean_inference_ms": 1.2740473357744617}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 40124, "num_steps_trained": 3142100, "num_steps_sampled": 86045, "sample_time_ms": 219.548, "replay_time_ms": 16.325, "grad_time_ms": 26.538, "update_time_ms": 0.006, "opt_peak_throughput": 3768.132, "opt_samples": 100.0, "learner": {"av": {"mean_q": -33.0019645690918, "max_q": 22.074893951416016, "min_q": -121.73948669433594}}}, "timesteps_this_iter": 1024, "done": false, "timesteps_total": 86045, "episodes_total": 202, "training_iteration": 83, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-16-51", "timestamp": 1585775811, "time_this_iter_s": 15.135624885559082, "time_total_s": 2080.6875715255737, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9e8712d08>", "on_episode_step": "<function on_episode_step at 0x7ff978028268>", "on_episode_end": "<function on_episode_end at 0x7ff978028488>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff978028378>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2080.6875715255737, "timesteps_since_restore": 86045, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 61.64545454545455, "ram_util_percent": 64.95}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.20274159899326, "episode_reward_min": -299.8328792795605, "episode_reward_mean": -10.957485385693536, "episode_len_mean": 400.96, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.85823660140716}, "policy_reward_max": {"av": 32.36586846649257}, "policy_reward_mean": {"av": -5.371316365536049}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.746478852876817, "avg_speed_min": 1.4706955970801447, "avg_speed_max": 10.036612626088925, "avg_rl_veh_arrival_mean": 217.85333333333332, "avg_rl_veh_arrival_min": 90.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.5492234855660474, "mean_processing_ms": 3.712909661270987, "mean_inference_ms": 1.2670534925607497}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 40348, "num_steps_trained": 3164500, "num_steps_sampled": 87080, "sample_time_ms": 151.518, "replay_time_ms": 18.356, "grad_time_ms": 19.214, "update_time_ms": 0.006, "opt_peak_throughput": 5204.51, "opt_samples": 100.0, "learner": {"av": {"mean_q": -25.3786563873291, "max_q": 17.567848205566406, "min_q": -76.6977767944336}}}, "timesteps_this_iter": 1035, "done": false, "timesteps_total": 87080, "episodes_total": 205, "training_iteration": 84, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-17-08", "timestamp": 1585775828, "time_this_iter_s": 17.080890893936157, "time_total_s": 2097.76846241951, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff978028a60>", "on_episode_step": "<function on_episode_step at 0x7ff978028e18>", "on_episode_end": "<function on_episode_end at 0x7ff9780282f0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff978028598>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2097.76846241951, "timesteps_since_restore": 87080, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 68.22916666666667, "ram_util_percent": 64.96666666666667}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.20274159899326, "episode_reward_min": -299.8328792795605, "episode_reward_mean": -16.200123799502563, "episode_len_mean": 397.06, "episodes_this_iter": 4, "policy_reward_min": {"av": -299.85823660140716}, "policy_reward_max": {"av": 32.36586846649257}, "policy_reward_mean": {"av": -8.059763084329635}, "custom_metrics": {"num_ped_collisions_mean": 0.17, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.702094679963522, "avg_speed_min": 1.4706955970801447, "avg_speed_max": 10.036612626088925, "avg_rl_veh_arrival_mean": 225.72833333333332, "avg_rl_veh_arrival_min": 90.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.534743641104888, "mean_processing_ms": 3.71467014517322, "mean_inference_ms": 1.2581825334398458}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 40787, "num_steps_trained": 3208400, "num_steps_sampled": 88315, "sample_time_ms": 205.618, "replay_time_ms": 16.613, "grad_time_ms": 22.718, "update_time_ms": 0.006, "opt_peak_throughput": 4401.791, "opt_samples": 100.0, "learner": {"av": {"mean_q": -21.722579956054688, "max_q": 27.6606388092041, "min_q": -71.61238098144531}}}, "timesteps_this_iter": 1235, "done": false, "timesteps_total": 88315, "episodes_total": 209, "training_iteration": 85, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-17-37", "timestamp": 1585775857, "time_this_iter_s": 29.351474046707153, "time_total_s": 2127.119936466217, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9e87120d0>", "on_episode_step": "<function on_episode_step at 0x7ffa08197e18>", "on_episode_end": "<function on_episode_end at 0x7ff9f204d598>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f204dd90>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2127.119936466217, "timesteps_since_restore": 88315, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 83.08095238095238, "ram_util_percent": 64.96666666666667}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.20274159899326, "episode_reward_min": -299.8328792795605, "episode_reward_mean": -13.917560831860524, "episode_len_mean": 400.98, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.85823660140716}, "policy_reward_max": {"av": 32.36586846649257}, "policy_reward_mean": {"av": -6.993749161738957}, "custom_metrics": {"num_ped_collisions_mean": 0.17, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.663187532992673, "avg_speed_min": 1.4706955970801447, "avg_speed_max": 10.036612626088925, "avg_rl_veh_arrival_mean": 229.5583333333333, "avg_rl_veh_arrival_min": 90.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.527951129236893, "mean_processing_ms": 3.7153852646398904, "mean_inference_ms": 1.254098227434989}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 41359, "num_steps_trained": 3265600, "num_steps_sampled": 89315, "sample_time_ms": 10.938, "replay_time_ms": 16.234, "grad_time_ms": 27.646, "update_time_ms": 0.006, "opt_peak_throughput": 3617.214, "opt_samples": 100.0, "learner": {"av": {"mean_q": -24.197153091430664, "max_q": 29.16581916809082, "min_q": -67.23258972167969}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 89315, "episodes_total": 211, "training_iteration": 86, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-18-10", "timestamp": 1585775890, "time_this_iter_s": 33.31362199783325, "time_total_s": 2160.4335584640503, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f204dd08>", "on_episode_step": "<function on_episode_step at 0x7ff9f204d8c8>", "on_episode_end": "<function on_episode_end at 0x7ff978028c80>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff978028510>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2160.4335584640503, "timesteps_since_restore": 89315, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 75.91489361702129, "ram_util_percent": 64.94042553191491}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.20274159899326, "episode_reward_min": -299.8328792795605, "episode_reward_mean": -13.910448537237356, "episode_len_mean": 400.15, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.85823660140716}, "policy_reward_max": {"av": 32.36586846649257}, "policy_reward_mean": {"av": -6.955224268618676}, "custom_metrics": {"num_ped_collisions_mean": 0.17, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.621623366502796, "avg_speed_min": 1.4706955970801447, "avg_speed_max": 10.036612626088925, "avg_rl_veh_arrival_mean": 230.86, "avg_rl_veh_arrival_min": 90.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.5184488110936525, "mean_processing_ms": 3.71696418626114, "mean_inference_ms": 1.2483572872117765}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 41735, "num_steps_trained": 3303200, "num_steps_sampled": 90389, "sample_time_ms": 183.997, "replay_time_ms": 17.795, "grad_time_ms": 23.813, "update_time_ms": 0.006, "opt_peak_throughput": 4199.465, "opt_samples": 100.0, "learner": {"av": {"mean_q": -22.864116668701172, "max_q": 25.69767189025879, "min_q": -121.33175659179688}}}, "timesteps_this_iter": 1074, "done": false, "timesteps_total": 90389, "episodes_total": 214, "training_iteration": 87, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-18-35", "timestamp": 1585775915, "time_this_iter_s": 24.23441481590271, "time_total_s": 2184.667973279953, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18fb7048>", "on_episode_step": "<function on_episode_step at 0x7ffa18fb70d0>", "on_episode_end": "<function on_episode_end at 0x7ffa18fb7158>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa18fb71e0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2184.667973279953, "timesteps_since_restore": 90389, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 76.87714285714286, "ram_util_percent": 64.90000000000002}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.20274159899326, "episode_reward_min": -299.8328792795605, "episode_reward_mean": -13.91721591623686, "episode_len_mean": 400.15, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.85823660140716}, "policy_reward_max": {"av": 32.36586846649257}, "policy_reward_mean": {"av": -6.958607958118429}, "custom_metrics": {"num_ped_collisions_mean": 0.17, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.688265896586485, "avg_speed_min": 1.4706955970801447, "avg_speed_max": 10.036612626088925, "avg_rl_veh_arrival_mean": 228.98666666666668, "avg_rl_veh_arrival_min": 90.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.5119490981837895, "mean_processing_ms": 3.717749671017448, "mean_inference_ms": 1.2443938689507368}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 41958, "num_steps_trained": 3325500, "num_steps_sampled": 91389, "sample_time_ms": 7.211, "replay_time_ms": 15.89, "grad_time_ms": 17.245, "update_time_ms": 0.005, "opt_peak_throughput": 5798.724, "opt_samples": 100.0, "learner": {"av": {"mean_q": -26.148630142211914, "max_q": 28.208833694458008, "min_q": -96.8089599609375}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 91389, "episodes_total": 216, "training_iteration": 88, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-18-50", "timestamp": 1585775930, "time_this_iter_s": 15.67968201637268, "time_total_s": 2200.3476552963257, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff978028e18>", "on_episode_step": "<function on_episode_step at 0x7ff978028c80>", "on_episode_end": "<function on_episode_end at 0x7ff978028510>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff978028ae8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2200.3476552963257, "timesteps_since_restore": 91389, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 82.92272727272727, "ram_util_percent": 64.9318181818182}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.20274159899326, "episode_reward_min": -299.8328792795605, "episode_reward_mean": -13.59841099455746, "episode_len_mean": 400.15, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.85823660140716}, "policy_reward_max": {"av": 32.36586846649257}, "policy_reward_mean": {"av": -6.765378604257441}, "custom_metrics": {"num_ped_collisions_mean": 0.17, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.7061868236447495, "avg_speed_min": 1.4706955970801447, "avg_speed_max": 10.036612626088925, "avg_rl_veh_arrival_mean": 228.825, "avg_rl_veh_arrival_min": 90.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.505655301141589, "mean_processing_ms": 3.718615243899042, "mean_inference_ms": 1.2405210691135948}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 42355, "num_steps_trained": 3365200, "num_steps_sampled": 92389, "sample_time_ms": 8.866, "replay_time_ms": 16.998, "grad_time_ms": 21.839, "update_time_ms": 0.008, "opt_peak_throughput": 4578.895, "opt_samples": 100.0, "learner": {"av": {"mean_q": -21.103294372558594, "max_q": 24.26662254333496, "min_q": -75.24072265625}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 92389, "episodes_total": 218, "training_iteration": 89, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-19-15", "timestamp": 1585775955, "time_this_iter_s": 24.436374187469482, "time_total_s": 2224.784029483795, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff978028598>", "on_episode_step": "<function on_episode_step at 0x7ff978028d90>", "on_episode_end": "<function on_episode_end at 0x7ff9e8712378>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9e8712b70>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2224.784029483795, "timesteps_since_restore": 92389, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 66.0457142857143, "ram_util_percent": 64.96285714285715}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.20274159899326, "episode_reward_min": -299.8328792795605, "episode_reward_mean": -10.925858424291867, "episode_len_mean": 403.37, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.85823660140716}, "policy_reward_max": {"av": 32.36586846649257}, "policy_reward_mean": {"av": -5.518110315298921}, "custom_metrics": {"num_ped_collisions_mean": 0.16, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.733937569113485, "avg_speed_min": 1.4706955970801447, "avg_speed_max": 10.036612626088925, "avg_rl_veh_arrival_mean": 227.00499999999997, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.49910097872832, "mean_processing_ms": 3.7185300240530035, "mean_inference_ms": 1.2366428258708644}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 42647, "num_steps_trained": 3394400, "num_steps_sampled": 93398, "sample_time_ms": 177.345, "replay_time_ms": 16.691, "grad_time_ms": 23.063, "update_time_ms": 0.006, "opt_peak_throughput": 4335.888, "opt_samples": 100.0, "learner": {"av": {"mean_q": -26.178369522094727, "max_q": 26.358173370361328, "min_q": -84.31678009033203}}}, "timesteps_this_iter": 1009, "done": false, "timesteps_total": 93398, "episodes_total": 220, "training_iteration": 90, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-19-33", "timestamp": 1585775973, "time_this_iter_s": 18.45091414451599, "time_total_s": 2243.234943628311, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f2040e18>", "on_episode_step": "<function on_episode_step at 0x7ff9f2040840>", "on_episode_end": "<function on_episode_end at 0x7ffa18fb1048>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa18fb10d0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2243.234943628311, "timesteps_since_restore": 93398, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 63.126923076923084, "ram_util_percent": 65.0}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.20274159899326, "episode_reward_min": -299.8328792795605, "episode_reward_mean": -4.280371794915047, "episode_len_mean": 410.2, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.85823660140716}, "policy_reward_max": {"av": 32.36586846649257}, "policy_reward_mean": {"av": -2.1727775608705797}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.782649773258884, "avg_speed_min": 1.4706955970801447, "avg_speed_max": 10.036612626088925, "avg_rl_veh_arrival_mean": 221.485, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.4924685125046633, "mean_processing_ms": 3.7183365774431927, "mean_inference_ms": 1.2327153563146995}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 43012, "num_steps_trained": 3430900, "num_steps_sampled": 94398, "sample_time_ms": 11.407, "replay_time_ms": 16.806, "grad_time_ms": 21.246, "update_time_ms": 0.006, "opt_peak_throughput": 4706.847, "opt_samples": 100.0, "learner": {"av": {"mean_q": -23.858213424682617, "max_q": 29.248188018798828, "min_q": -77.43273162841797}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 94398, "episodes_total": 222, "training_iteration": 91, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-19-56", "timestamp": 1585775996, "time_this_iter_s": 22.607351064682007, "time_total_s": 2265.842294692993, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f2017400>", "on_episode_step": "<function on_episode_step at 0x7ff9f204d9d8>", "on_episode_end": "<function on_episode_end at 0x7ff9f204d598>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f204d730>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2265.842294692993, "timesteps_since_restore": 94398, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 90.296875, "ram_util_percent": 64.95625}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.20274159899326, "episode_reward_min": -299.8328792795605, "episode_reward_mean": -4.591740701199073, "episode_len_mean": 410.2, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.85823660140716}, "policy_reward_max": {"av": 32.36586846649257}, "policy_reward_mean": {"av": -2.342724847550547}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.75308236143727, "avg_speed_min": 1.4706955970801447, "avg_speed_max": 10.036612626088925, "avg_rl_veh_arrival_mean": 221.795, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.4860835900015616, "mean_processing_ms": 3.7182670048308637, "mean_inference_ms": 1.2289713956107031}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 43192, "num_steps_trained": 3448900, "num_steps_sampled": 95398, "sample_time_ms": 9.066, "replay_time_ms": 14.656, "grad_time_ms": 22.467, "update_time_ms": 0.006, "opt_peak_throughput": 4450.983, "opt_samples": 100.0, "learner": {"av": {"mean_q": -24.820274353027344, "max_q": 26.795814514160156, "min_q": -118.60960388183594}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 95398, "episodes_total": 224, "training_iteration": 92, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-20-10", "timestamp": 1585776010, "time_this_iter_s": 13.630698204040527, "time_total_s": 2279.4729928970337, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff978028f28>", "on_episode_step": "<function on_episode_step at 0x7ff978028c80>", "on_episode_end": "<function on_episode_end at 0x7ff978028510>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f20406a8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2279.4729928970337, "timesteps_since_restore": 95398, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 96.05789473684212, "ram_util_percent": 64.93684210526317}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.20274159899326, "episode_reward_min": -299.8328792795605, "episode_reward_mean": -4.578739731542954, "episode_len_mean": 410.2, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.85823660140716}, "policy_reward_max": {"av": 32.36586846649257}, "policy_reward_mean": {"av": -2.3360916997668126}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.682903555766526, "avg_speed_min": 1.4706955970801447, "avg_speed_max": 10.036612626088925, "avg_rl_veh_arrival_mean": 223.055, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.480189924045057, "mean_processing_ms": 3.7183625834971927, "mean_inference_ms": 1.2254797945293605}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 43454, "num_steps_trained": 3475100, "num_steps_sampled": 96398, "sample_time_ms": 204.687, "replay_time_ms": 18.217, "grad_time_ms": 23.253, "update_time_ms": 0.009, "opt_peak_throughput": 4300.562, "opt_samples": 100.0, "learner": {"av": {"mean_q": -24.027631759643555, "max_q": 31.48955535888672, "min_q": -80.58834838867188}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 96398, "episodes_total": 226, "training_iteration": 93, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-20-28", "timestamp": 1585776028, "time_this_iter_s": 18.21323299407959, "time_total_s": 2297.6862258911133, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9780282f0>", "on_episode_step": "<function on_episode_step at 0x7ff978028ea0>", "on_episode_end": "<function on_episode_end at 0x7ffa18fd6048>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa18fd60d0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2297.6862258911133, "timesteps_since_restore": 96398, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 85.35769230769232, "ram_util_percent": 64.90384615384616}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.13302450668182, "episode_reward_min": -299.8328792795605, "episode_reward_mean": -9.773877485773477, "episode_len_mean": 402.25, "episodes_this_iter": 4, "policy_reward_min": {"av": -299.85823660140716}, "policy_reward_max": {"av": 32.36586846649257}, "policy_reward_mean": {"av": -4.986672186619123}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.580887708870522, "avg_speed_min": 1.4789361085409627, "avg_speed_max": 9.584100353665322, "avg_rl_veh_arrival_mean": 224.04333333333332, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.469636569102468, "mean_processing_ms": 3.719840785021994, "mean_inference_ms": 1.2191170721885536}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 44037, "num_steps_trained": 3533400, "num_steps_sampled": 97588, "sample_time_ms": 187.483, "replay_time_ms": 14.939, "grad_time_ms": 19.355, "update_time_ms": 0.006, "opt_peak_throughput": 5166.512, "opt_samples": 100.0, "learner": {"av": {"mean_q": -26.904678344726562, "max_q": 28.775062561035156, "min_q": -116.2620849609375}}}, "timesteps_this_iter": 1190, "done": false, "timesteps_total": 97588, "episodes_total": 230, "training_iteration": 94, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-21-04", "timestamp": 1585776064, "time_this_iter_s": 36.50709676742554, "time_total_s": 2334.193322658539, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa08197950>", "on_episode_step": "<function on_episode_step at 0x7ffa08197bf8>", "on_episode_end": "<function on_episode_end at 0x7ffa18f86158>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa18f862f0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2334.193322658539, "timesteps_since_restore": 97588, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 81.24999999999999, "ram_util_percent": 64.86538461538463}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.13302450668182, "episode_reward_min": -299.8328792795605, "episode_reward_mean": -3.1141883441102145, "episode_len_mean": 408.01, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.85823660140716}, "policy_reward_max": {"av": 32.36586846649257}, "policy_reward_mean": {"av": -1.588871604137866}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.619016383566309, "avg_speed_min": 1.4789361085409627, "avg_speed_max": 9.584100353665322, "avg_rl_veh_arrival_mean": 219.38666666666668, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.461593454990116, "mean_processing_ms": 3.7200849387440718, "mean_inference_ms": 1.2142430111639118}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 44591, "num_steps_trained": 3588800, "num_steps_sampled": 98704, "sample_time_ms": 168.377, "replay_time_ms": 16.981, "grad_time_ms": 21.464, "update_time_ms": 0.006, "opt_peak_throughput": 4659.013, "opt_samples": 100.0, "learner": {"av": {"mean_q": -28.557514190673828, "max_q": 30.3648624420166, "min_q": -89.58401489257812}}}, "timesteps_this_iter": 1116, "done": false, "timesteps_total": 98704, "episodes_total": 233, "training_iteration": 95, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-21-39", "timestamp": 1585776099, "time_this_iter_s": 34.06738901138306, "time_total_s": 2368.260711669922, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f204da60>", "on_episode_step": "<function on_episode_step at 0x7ffa1817f840>", "on_episode_end": "<function on_episode_end at 0x7ffa18fd4048>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa18fd40d0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2368.260711669922, "timesteps_since_restore": 98704, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 88.53061224489795, "ram_util_percent": 64.82857142857144}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.13302450668182, "episode_reward_min": -299.8328792795605, "episode_reward_mean": -6.410344698789803, "episode_len_mean": 403.9, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.85823660140716}, "policy_reward_max": {"av": 32.36586846649257}, "policy_reward_mean": {"av": -3.253982080603959}, "custom_metrics": {"num_ped_collisions_mean": 0.13, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.598283642123234, "avg_speed_min": 1.4789361085409627, "avg_speed_max": 9.584100353665322, "avg_rl_veh_arrival_mean": 223.04, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.453755723659014, "mean_processing_ms": 3.7206303305070065, "mean_inference_ms": 1.209491994997592}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 44833, "num_steps_trained": 3613000, "num_steps_sampled": 99820, "sample_time_ms": 196.34, "replay_time_ms": 17.023, "grad_time_ms": 22.827, "update_time_ms": 0.013, "opt_peak_throughput": 4380.822, "opt_samples": 100.0, "learner": {"av": {"mean_q": -25.849853515625, "max_q": 29.083492279052734, "min_q": -117.05209350585938}}}, "timesteps_this_iter": 1116, "done": false, "timesteps_total": 99820, "episodes_total": 236, "training_iteration": 96, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-21-57", "timestamp": 1585776117, "time_this_iter_s": 18.317726850509644, "time_total_s": 2386.5784385204315, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff978028510>", "on_episode_step": "<function on_episode_step at 0x7ff978028ea0>", "on_episode_end": "<function on_episode_end at 0x7ff9f2040620>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f20402f0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2386.5784385204315, "timesteps_since_restore": 99820, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 94.97692307692306, "ram_util_percent": 64.82692307692308}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.13302450668182, "episode_reward_min": -299.74245839747306, "episode_reward_mean": -6.343370058706448, "episode_len_mean": 403.95, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.85823660140716}, "policy_reward_max": {"av": 32.36586846649257}, "policy_reward_mean": {"av": -3.2364132952583904}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.576924762144165, "avg_speed_min": 1.4789361085409627, "avg_speed_max": 9.584100353665322, "avg_rl_veh_arrival_mean": 219.4283333333333, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.4464074994149207, "mean_processing_ms": 3.721642839305064, "mean_inference_ms": 1.2050882343235534}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 45127, "num_steps_trained": 3642400, "num_steps_sampled": 100907, "sample_time_ms": 201.696, "replay_time_ms": 16.976, "grad_time_ms": 22.762, "update_time_ms": 0.006, "opt_peak_throughput": 4393.331, "opt_samples": 100.0, "learner": {"av": {"mean_q": -23.83489990234375, "max_q": 29.60356903076172, "min_q": -138.0738983154297}}}, "timesteps_this_iter": 1087, "done": false, "timesteps_total": 100907, "episodes_total": 239, "training_iteration": 97, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-22-18", "timestamp": 1585776138, "time_this_iter_s": 21.177895307540894, "time_total_s": 2407.7563338279724, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff978028950>", "on_episode_step": "<function on_episode_step at 0x7ff978028ae8>", "on_episode_end": "<function on_episode_end at 0x7ff978028488>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa1817f840>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2407.7563338279724, "timesteps_since_restore": 100907, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 83.70666666666666, "ram_util_percent": 64.85666666666668}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.13302450668182, "episode_reward_min": -299.74245839747306, "episode_reward_mean": -6.655731571778035, "episode_len_mean": 403.95, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.85823660140716}, "policy_reward_max": {"av": 32.36586846649257}, "policy_reward_mean": {"av": -3.41319567783489}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.552157389167429, "avg_speed_min": 1.4789361085409627, "avg_speed_max": 9.584100353665322, "avg_rl_veh_arrival_mean": 219.77, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.441638822311774, "mean_processing_ms": 3.7221111526873427, "mean_inference_ms": 1.2022084994253788}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 45367, "num_steps_trained": 3666400, "num_steps_sampled": 101907, "sample_time_ms": 214.66, "replay_time_ms": 16.659, "grad_time_ms": 21.018, "update_time_ms": 0.006, "opt_peak_throughput": 4757.874, "opt_samples": 100.0, "learner": {"av": {"mean_q": -27.711835861206055, "max_q": 29.219615936279297, "min_q": -118.4581298828125}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 101907, "episodes_total": 241, "training_iteration": 98, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-22-35", "timestamp": 1585776155, "time_this_iter_s": 17.001217126846313, "time_total_s": 2424.7575509548187, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f2040d08>", "on_episode_step": "<function on_episode_step at 0x7ff9f2040d90>", "on_episode_end": "<function on_episode_end at 0x7ff9f2040048>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f2040e18>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2424.7575509548187, "timesteps_since_restore": 101907, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 88.31666666666666, "ram_util_percent": 64.83333333333333}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.13302450668182, "episode_reward_min": -299.74245839747306, "episode_reward_mean": -2.7533797883618685, "episode_len_mean": 408.19, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.85823660140716}, "policy_reward_max": {"av": 32.36586846649257}, "policy_reward_mean": {"av": -1.4047856063070754}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.540144447917547, "avg_speed_min": 1.4789361085409627, "avg_speed_max": 9.584100353665322, "avg_rl_veh_arrival_mean": 216.84, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.437180491740428, "mean_processing_ms": 3.722387012065078, "mean_inference_ms": 1.1994868900410625}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 45678, "num_steps_trained": 3697500, "num_steps_sampled": 102910, "sample_time_ms": 191.574, "replay_time_ms": 16.853, "grad_time_ms": 21.954, "update_time_ms": 0.006, "opt_peak_throughput": 4554.976, "opt_samples": 100.0, "learner": {"av": {"mean_q": -24.8579158782959, "max_q": 25.52050018310547, "min_q": -112.95545959472656}}}, "timesteps_this_iter": 1003, "done": false, "timesteps_total": 102910, "episodes_total": 243, "training_iteration": 99, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-22-55", "timestamp": 1585776175, "time_this_iter_s": 19.96154499053955, "time_total_s": 2444.7190959453583, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18a2a488>", "on_episode_step": "<function on_episode_step at 0x7ff978028b70>", "on_episode_end": "<function on_episode_end at 0x7ff978028e18>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff978028488>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2444.7190959453583, "timesteps_since_restore": 102910, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 89.04642857142856, "ram_util_percent": 64.89285714285715}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.13302450668182, "episode_reward_min": -299.74245839747306, "episode_reward_mean": -1.135685099024804, "episode_len_mean": 412.03, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.85823660140716}, "policy_reward_max": {"av": 32.36586846649257}, "policy_reward_mean": {"av": -0.5764898979821331}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.543342363373252, "avg_speed_min": 1.4789361085409627, "avg_speed_max": 9.584100353665322, "avg_rl_veh_arrival_mean": 217.86, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.4325983868033427, "mean_processing_ms": 3.722209891094814, "mean_inference_ms": 1.196662280029179}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 45976, "num_steps_trained": 3727300, "num_steps_sampled": 103912, "sample_time_ms": 195.577, "replay_time_ms": 17.567, "grad_time_ms": 20.105, "update_time_ms": 0.005, "opt_peak_throughput": 4973.933, "opt_samples": 100.0, "learner": {"av": {"mean_q": -22.56108856201172, "max_q": 27.283531188964844, "min_q": -107.21051025390625}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 103912, "episodes_total": 245, "training_iteration": 100, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-23-15", "timestamp": 1585776195, "time_this_iter_s": 19.8131320476532, "time_total_s": 2464.5322279930115, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f2017ae8>", "on_episode_step": "<function on_episode_step at 0x7ff9f2017b70>", "on_episode_end": "<function on_episode_end at 0x7ff9f2017c80>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f2017400>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2464.5322279930115, "timesteps_since_restore": 103912, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 82.45357142857142, "ram_util_percent": 64.81071428571428}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.13302450668182, "episode_reward_min": -299.74245839747306, "episode_reward_mean": 2.804332994912218, "episode_len_mean": 418.65, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.85823660140716}, "policy_reward_max": {"av": 32.36586846649257}, "policy_reward_mean": {"av": 1.423519286757471}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.565918820775993, "avg_speed_min": 1.4789361085409627, "avg_speed_max": 9.584100353665322, "avg_rl_veh_arrival_mean": 215.85, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.427963365782618, "mean_processing_ms": 3.721611800673469, "mean_inference_ms": 1.193805083948661}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 46419, "num_steps_trained": 3771600, "num_steps_sampled": 104915, "sample_time_ms": 195.227, "replay_time_ms": 18.182, "grad_time_ms": 20.626, "update_time_ms": 0.006, "opt_peak_throughput": 4848.262, "opt_samples": 100.0, "learner": {"av": {"mean_q": -29.781721115112305, "max_q": 31.651756286621094, "min_q": -139.70069885253906}}}, "timesteps_this_iter": 1003, "done": false, "timesteps_total": 104915, "episodes_total": 247, "training_iteration": 101, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-23-42", "timestamp": 1585776222, "time_this_iter_s": 26.772701263427734, "time_total_s": 2491.304929256439, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f204d488>", "on_episode_step": "<function on_episode_step at 0x7ff9f204da60>", "on_episode_end": "<function on_episode_end at 0x7ff9f204d730>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f204d048>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2491.304929256439, "timesteps_since_restore": 104915, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 87.17179487179487, "ram_util_percent": 64.84615384615388}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.13302450668182, "episode_reward_min": -299.74893073534804, "episode_reward_mean": -1.4460196853693263, "episode_len_mean": 415.48, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.85823660140716}, "policy_reward_max": {"av": 32.36586846649257}, "policy_reward_mean": {"av": -0.7453709718398595}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.50798761366121, "avg_speed_min": 1.4789361085409627, "avg_speed_max": 9.584100353665322, "avg_rl_veh_arrival_mean": 219.825, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.421037908076649, "mean_processing_ms": 3.720922832016987, "mean_inference_ms": 1.1895930063736806}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 46823, "num_steps_trained": 3812000, "num_steps_sampled": 106092, "sample_time_ms": 217.974, "replay_time_ms": 18.186, "grad_time_ms": 22.648, "update_time_ms": 0.006, "opt_peak_throughput": 4415.391, "opt_samples": 100.0, "learner": {"av": {"mean_q": -26.618959426879883, "max_q": 29.90410614013672, "min_q": -83.66426086425781}}}, "timesteps_this_iter": 1177, "done": false, "timesteps_total": 106092, "episodes_total": 250, "training_iteration": 102, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-24-08", "timestamp": 1585776248, "time_this_iter_s": 25.83772110939026, "time_total_s": 2517.1426503658295, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f2040d08>", "on_episode_step": "<function on_episode_step at 0x7ff9f2040840>", "on_episode_end": "<function on_episode_end at 0x7ff9f2040598>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f2040048>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2517.1426503658295, "timesteps_since_restore": 106092, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 77.22222222222223, "ram_util_percent": 64.82500000000002}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.13302450668182, "episode_reward_min": -299.74893073534804, "episode_reward_mean": -1.8234524265912628, "episode_len_mean": 415.05, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.85823660140716}, "policy_reward_max": {"av": 32.36586846649257}, "policy_reward_mean": {"av": -0.9447940034151621}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.483499405698967, "avg_speed_min": 1.4789361085409627, "avg_speed_max": 9.584100353665322, "avg_rl_veh_arrival_mean": 219.71, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.414584342111541, "mean_processing_ms": 3.7206371342859814, "mean_inference_ms": 1.1855986492042168}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 47046, "num_steps_trained": 3834300, "num_steps_sampled": 107191, "sample_time_ms": 229.849, "replay_time_ms": 17.854, "grad_time_ms": 22.423, "update_time_ms": 0.006, "opt_peak_throughput": 4459.762, "opt_samples": 100.0, "learner": {"av": {"mean_q": -26.384780883789062, "max_q": 27.713457107543945, "min_q": -115.7270736694336}}}, "timesteps_this_iter": 1099, "done": false, "timesteps_total": 107191, "episodes_total": 253, "training_iteration": 103, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-24-25", "timestamp": 1585776265, "time_this_iter_s": 17.542635202407837, "time_total_s": 2534.6852855682373, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa08197488>", "on_episode_step": "<function on_episode_step at 0x7ffa08197e18>", "on_episode_end": "<function on_episode_end at 0x7ff9f2040620>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f20408c8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2534.6852855682373, "timesteps_since_restore": 107191, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 88.964, "ram_util_percent": 64.80799999999999}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.13302450668182, "episode_reward_min": -299.74893073534804, "episode_reward_mean": -2.7783579827645473, "episode_len_mean": 410.6, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.85823660140716}, "policy_reward_max": {"av": 32.36586846649257}, "policy_reward_mean": {"av": -1.4546376873112796}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.426115323421755, "avg_speed_min": 1.4789361085409627, "avg_speed_max": 9.584100353665322, "avg_rl_veh_arrival_mean": 219.735, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.4085026645262, "mean_processing_ms": 3.7205440173696336, "mean_inference_ms": 1.1818967948244081}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 47630, "num_steps_trained": 3892700, "num_steps_sampled": 108230, "sample_time_ms": 327.859, "replay_time_ms": 16.3, "grad_time_ms": 21.775, "update_time_ms": 0.005, "opt_peak_throughput": 4592.451, "opt_samples": 100.0, "learner": {"av": {"mean_q": -20.412572860717773, "max_q": 28.673112869262695, "min_q": -105.85151672363281}}}, "timesteps_this_iter": 1039, "done": false, "timesteps_total": 108230, "episodes_total": 256, "training_iteration": 104, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-24-59", "timestamp": 1585776299, "time_this_iter_s": 34.042107343673706, "time_total_s": 2568.727392911911, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff978028e18>", "on_episode_step": "<function on_episode_step at 0x7ff9780281e0>", "on_episode_end": "<function on_episode_end at 0x7ff978028510>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff978028158>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2568.727392911911, "timesteps_since_restore": 108230, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 80.6265306122449, "ram_util_percent": 64.83469387755102}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.1518648601973, "episode_reward_min": -299.74893073534804, "episode_reward_mean": 0.1587669906270525, "episode_len_mean": 414.5, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.85823660140716}, "policy_reward_max": {"av": 32.36586846649257}, "policy_reward_mean": {"av": 0.08312407886233059}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.506140071906973, "avg_speed_min": 1.4789361085409627, "avg_speed_max": 9.833505934413216, "avg_rl_veh_arrival_mean": 218.81833333333336, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.4043315712016367, "mean_processing_ms": 3.7205107409043103, "mean_inference_ms": 1.1793132778611897}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 47802, "num_steps_trained": 3909900, "num_steps_sampled": 109230, "sample_time_ms": 209.42, "replay_time_ms": 18.858, "grad_time_ms": 20.867, "update_time_ms": 0.006, "opt_peak_throughput": 4792.17, "opt_samples": 100.0, "learner": {"av": {"mean_q": -23.9847354888916, "max_q": 30.74321174621582, "min_q": -96.94003295898438}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 109230, "episodes_total": 258, "training_iteration": 105, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-25-13", "timestamp": 1585776313, "time_this_iter_s": 13.465258836746216, "time_total_s": 2582.192651748657, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa08197950>", "on_episode_step": "<function on_episode_step at 0x7ff9f2017730>", "on_episode_end": "<function on_episode_end at 0x7ff9f20179d8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f20177b8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2582.192651748657, "timesteps_since_restore": 109230, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 66.13684210526316, "ram_util_percent": 64.80526315789473}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.1518648601973, "episode_reward_min": -299.74893073534804, "episode_reward_mean": -7.989907451820789, "episode_len_mean": 402.42, "episodes_this_iter": 4, "policy_reward_min": {"av": -299.85823660140716}, "policy_reward_max": {"av": 32.36586846649257}, "policy_reward_mean": {"av": -4.1614101311566625}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.527884091864901, "avg_speed_min": 1.4789361085409627, "avg_speed_max": 9.833505934413216, "avg_rl_veh_arrival_mean": 216.7133333333333, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.3961262154514906, "mean_processing_ms": 3.7210670336992338, "mean_inference_ms": 1.174094758986659}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 48223, "num_steps_trained": 3952000, "num_steps_sampled": 110230, "sample_time_ms": 8.383, "replay_time_ms": 18.283, "grad_time_ms": 19.938, "update_time_ms": 0.006, "opt_peak_throughput": 5015.574, "opt_samples": 100.0, "learner": {"av": {"mean_q": -21.504497528076172, "max_q": 29.00067901611328, "min_q": -99.13301849365234}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 110230, "episodes_total": 262, "training_iteration": 106, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-25-42", "timestamp": 1585776342, "time_this_iter_s": 28.660113096237183, "time_total_s": 2610.8527648448944, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa08197bf8>", "on_episode_step": "<function on_episode_step at 0x7ffa08197268>", "on_episode_end": "<function on_episode_end at 0x7ffa08197e18>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f2017950>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2610.8527648448944, "timesteps_since_restore": 110230, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 81.88, "ram_util_percent": 64.8075}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.1518648601973, "episode_reward_min": -299.74893073534804, "episode_reward_mean": -11.935788059318089, "episode_len_mean": 398.66, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.85823660140716}, "policy_reward_max": {"av": 32.36586846649257}, "policy_reward_mean": {"av": -6.2491036959780555}, "custom_metrics": {"num_ped_collisions_mean": 0.13, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.4356001577847834, "avg_speed_min": 1.4789361085409627, "avg_speed_max": 9.833505934413216, "avg_rl_veh_arrival_mean": 222.43, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.39053357458109, "mean_processing_ms": 3.722012360689149, "mean_inference_ms": 1.1705624375266745}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 48631, "num_steps_trained": 3992800, "num_steps_sampled": 111230, "sample_time_ms": 9.368, "replay_time_ms": 17.372, "grad_time_ms": 24.737, "update_time_ms": 0.005, "opt_peak_throughput": 4042.5, "opt_samples": 100.0, "learner": {"av": {"mean_q": -23.036108016967773, "max_q": 23.18680763244629, "min_q": -111.20756530761719}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 111230, "episodes_total": 265, "training_iteration": 107, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-26-07", "timestamp": 1585776367, "time_this_iter_s": 25.537126064300537, "time_total_s": 2636.389890909195, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f204dea0>", "on_episode_step": "<function on_episode_step at 0x7ff9f204d048>", "on_episode_end": "<function on_episode_end at 0x7ff9f204dae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f204dc80>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2636.389890909195, "timesteps_since_restore": 111230, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 69.92432432432433, "ram_util_percent": 64.82162162162163}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.1518648601973, "episode_reward_min": -299.74893073534804, "episode_reward_mean": -9.33262300993466, "episode_len_mean": 402.6, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.85823660140716}, "policy_reward_max": {"av": 32.36586846649257}, "policy_reward_mean": {"av": -4.886190057557413}, "custom_metrics": {"num_ped_collisions_mean": 0.13, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.428262228993756, "avg_speed_min": 1.4789361085409627, "avg_speed_max": 9.833505934413216, "avg_rl_veh_arrival_mean": 223.61, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.3869879371250597, "mean_processing_ms": 3.722475430286937, "mean_inference_ms": 1.168352879120357}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 49060, "num_steps_trained": 4035700, "num_steps_sampled": 112230, "sample_time_ms": 12.618, "replay_time_ms": 16.28, "grad_time_ms": 25.882, "update_time_ms": 0.006, "opt_peak_throughput": 3863.745, "opt_samples": 100.0, "learner": {"av": {"mean_q": -27.156904220581055, "max_q": 28.158241271972656, "min_q": -79.3903579711914}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 112230, "episodes_total": 267, "training_iteration": 108, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-26-34", "timestamp": 1585776394, "time_this_iter_s": 27.00158190727234, "time_total_s": 2663.3914728164673, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa08197e18>", "on_episode_step": "<function on_episode_step at 0x7ffa08197268>", "on_episode_end": "<function on_episode_end at 0x7ff9f8fe9730>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f204d7b8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2663.3914728164673, "timesteps_since_restore": 112230, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 78.7421052631579, "ram_util_percent": 64.83157894736844}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.1518648601973, "episode_reward_min": -299.74893073534804, "episode_reward_mean": -5.405994151747176, "episode_len_mean": 406.84, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.80236228414424}, "policy_reward_max": {"av": 32.36586846649257}, "policy_reward_mean": {"av": -2.815621954034988}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.447157083268821, "avg_speed_min": 1.4789361085409627, "avg_speed_max": 9.833505934413216, "avg_rl_veh_arrival_mean": 219.51666666666665, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.3833763868163818, "mean_processing_ms": 3.72261960764768, "mean_inference_ms": 1.1661271555404442}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 49384, "num_steps_trained": 4068100, "num_steps_sampled": 113230, "sample_time_ms": 8.914, "replay_time_ms": 14.475, "grad_time_ms": 14.531, "update_time_ms": 0.006, "opt_peak_throughput": 6882.0, "opt_samples": 100.0, "learner": {"av": {"mean_q": -24.678667068481445, "max_q": 32.99761199951172, "min_q": -107.59131622314453}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 113230, "episodes_total": 269, "training_iteration": 109, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-26-55", "timestamp": 1585776415, "time_this_iter_s": 20.851213216781616, "time_total_s": 2684.242686033249, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f204d9d8>", "on_episode_step": "<function on_episode_step at 0x7ff9f204d2f0>", "on_episode_end": "<function on_episode_end at 0x7ffa1817f840>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff978028598>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2684.242686033249, "timesteps_since_restore": 113230, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 90.27000000000001, "ram_util_percent": 64.82333333333334}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.1518648601973, "episode_reward_min": -299.74893073534804, "episode_reward_mean": -14.930193583316678, "episode_len_mean": 396.25, "episodes_this_iter": 5, "policy_reward_min": {"av": -299.80236228414424}, "policy_reward_max": {"av": 32.351473637572006}, "policy_reward_mean": {"av": -7.941592331551423}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.351468385935727, "avg_speed_min": 1.4789361085409627, "avg_speed_max": 9.833505934413216, "avg_rl_veh_arrival_mean": 225.28833333333333, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.3745848130271985, "mean_processing_ms": 3.724323544642043, "mean_inference_ms": 1.1608357755806826}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 49914, "num_steps_trained": 4121100, "num_steps_sampled": 114592, "sample_time_ms": 200.199, "replay_time_ms": 16.725, "grad_time_ms": 24.93, "update_time_ms": 0.006, "opt_peak_throughput": 4011.258, "opt_samples": 100.0, "learner": {"av": {"mean_q": -26.601083755493164, "max_q": 30.970518112182617, "min_q": -98.58612060546875}}}, "timesteps_this_iter": 1362, "done": false, "timesteps_total": 114592, "episodes_total": 274, "training_iteration": 110, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-27-31", "timestamp": 1585776451, "time_this_iter_s": 35.526161193847656, "time_total_s": 2719.7688472270966, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa08197a60>", "on_episode_step": "<function on_episode_step at 0x7ffa08197488>", "on_episode_end": "<function on_episode_end at 0x7ffa08197268>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa08197bf8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2719.7688472270966, "timesteps_since_restore": 114592, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 74.884, "ram_util_percent": 64.808}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.1518648601973, "episode_reward_min": -299.74893073534804, "episode_reward_mean": -11.374824660740467, "episode_len_mean": 399.7, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.80236228414424}, "policy_reward_max": {"av": 32.351473637572006}, "policy_reward_mean": {"av": -6.082793936224852}, "custom_metrics": {"num_ped_collisions_mean": 0.13, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.350259175658761, "avg_speed_min": 1.4789361085409627, "avg_speed_max": 9.833505934413216, "avg_rl_veh_arrival_mean": 222.94333333333333, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.3711329087298894, "mean_processing_ms": 3.7247265854968536, "mean_inference_ms": 1.158859619400339}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 50264, "num_steps_trained": 4156100, "num_steps_sampled": 115592, "sample_time_ms": 201.459, "replay_time_ms": 18.275, "grad_time_ms": 21.637, "update_time_ms": 0.008, "opt_peak_throughput": 4621.69, "opt_samples": 100.0, "learner": {"av": {"mean_q": -18.45440101623535, "max_q": 31.778732299804688, "min_q": -90.1413803100586}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 115592, "episodes_total": 276, "training_iteration": 111, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-27-53", "timestamp": 1585776473, "time_this_iter_s": 22.227675199508667, "time_total_s": 2741.996522426605, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f204d9d8>", "on_episode_step": "<function on_episode_step at 0x7ff9f204dd08>", "on_episode_end": "<function on_episode_end at 0x7ff978028a60>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff978028268>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2741.996522426605, "timesteps_since_restore": 115592, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 75.003125, "ram_util_percent": 64.85624999999999}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.1518648601973, "episode_reward_min": -299.74893073534804, "episode_reward_mean": -14.38603632689008, "episode_len_mean": 399.23, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.80236228414424}, "policy_reward_max": {"av": 32.351473637572006}, "policy_reward_mean": {"av": -7.652146982388344}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.373557582871855, "avg_speed_min": 1.4789361085409627, "avg_speed_max": 9.833505934413216, "avg_rl_veh_arrival_mean": 225.84833333333333, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.3676498562509947, "mean_processing_ms": 3.7250446007244102, "mean_inference_ms": 1.1569220597754937}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 50781, "num_steps_trained": 4207800, "num_steps_sampled": 116592, "sample_time_ms": 6.372, "replay_time_ms": 16.756, "grad_time_ms": 18.968, "update_time_ms": 0.005, "opt_peak_throughput": 5271.995, "opt_samples": 100.0, "learner": {"av": {"mean_q": -25.36077880859375, "max_q": 31.667390823364258, "min_q": -94.03865814208984}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 116592, "episodes_total": 278, "training_iteration": 112, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-28-22", "timestamp": 1585776502, "time_this_iter_s": 29.57055401802063, "time_total_s": 2771.567076444626, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff978054730>", "on_episode_step": "<function on_episode_step at 0x7ff9780547b8>", "on_episode_end": "<function on_episode_end at 0x7ff9780548c8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9780540d0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2771.567076444626, "timesteps_since_restore": 116592, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 69.01190476190476, "ram_util_percent": 64.82857142857145}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.1518648601973, "episode_reward_min": -299.74893073534804, "episode_reward_mean": -14.699674748820557, "episode_len_mean": 399.23, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.80236228414424}, "policy_reward_max": {"av": 32.351473637572006}, "policy_reward_mean": {"av": -7.860788635732918}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.320624373348316, "avg_speed_min": 1.4789361085409627, "avg_speed_max": 9.833505934413216, "avg_rl_veh_arrival_mean": 229.28333333333333, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.3625807493274986, "mean_processing_ms": 3.725881350824293, "mean_inference_ms": 1.1540659927914785}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 51219, "num_steps_trained": 4251600, "num_steps_sampled": 117689, "sample_time_ms": 191.785, "replay_time_ms": 18.163, "grad_time_ms": 20.889, "update_time_ms": 0.007, "opt_peak_throughput": 4787.095, "opt_samples": 100.0, "learner": {"av": {"mean_q": -22.926729202270508, "max_q": 32.82212829589844, "min_q": -103.6028823852539}}}, "timesteps_this_iter": 1097, "done": false, "timesteps_total": 117689, "episodes_total": 281, "training_iteration": 113, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-28-51", "timestamp": 1585776531, "time_this_iter_s": 28.331485986709595, "time_total_s": 2799.8985624313354, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9780289d8>", "on_episode_step": "<function on_episode_step at 0x7ff978028ea0>", "on_episode_end": "<function on_episode_end at 0x7ff978028b70>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9e8090b70>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2799.8985624313354, "timesteps_since_restore": 117689, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 74.7825, "ram_util_percent": 64.86}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.1518648601973, "episode_reward_min": -299.74893073534804, "episode_reward_mean": -14.381864913417983, "episode_len_mean": 399.23, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.80236228414424}, "policy_reward_max": {"av": 32.351473637572006}, "policy_reward_mean": {"av": -7.649928145435097}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.344392495319865, "avg_speed_min": 1.4789361085409627, "avg_speed_max": 9.833505934413216, "avg_rl_veh_arrival_mean": 228.85833333333332, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.3593522511644, "mean_processing_ms": 3.7265079382711535, "mean_inference_ms": 1.1522011728604369}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 51514, "num_steps_trained": 4281100, "num_steps_sampled": 118698, "sample_time_ms": 217.323, "replay_time_ms": 16.076, "grad_time_ms": 24.673, "update_time_ms": 0.022, "opt_peak_throughput": 4053.051, "opt_samples": 100.0, "learner": {"av": {"mean_q": -24.115150451660156, "max_q": 28.315216064453125, "min_q": -105.61385345458984}}}, "timesteps_this_iter": 1009, "done": false, "timesteps_total": 118698, "episodes_total": 283, "training_iteration": 114, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-29-11", "timestamp": 1585776551, "time_this_iter_s": 19.83612322807312, "time_total_s": 2819.7346856594086, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff978054bf8>", "on_episode_step": "<function on_episode_step at 0x7ff978054b70>", "on_episode_end": "<function on_episode_end at 0x7ff978054048>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff978054950>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2819.7346856594086, "timesteps_since_restore": 118698, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 72.10357142857143, "ram_util_percent": 64.97857142857143}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.1518648601973, "episode_reward_min": -299.74893073534804, "episode_reward_mean": -13.447489558716043, "episode_len_mean": 400.36, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.80236228414424}, "policy_reward_max": {"av": 32.351473637572006}, "policy_reward_mean": {"av": -7.115073840590501}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.348612073799826, "avg_speed_min": 1.6489247944487202, "avg_speed_max": 9.833505934413216, "avg_rl_veh_arrival_mean": 228.94333333333333, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.3550255273049676, "mean_processing_ms": 3.7275162274643994, "mean_inference_ms": 1.1495986371553222}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 52021, "num_steps_trained": 4331800, "num_steps_sampled": 119698, "sample_time_ms": 6.835, "replay_time_ms": 16.849, "grad_time_ms": 19.5, "update_time_ms": 0.006, "opt_peak_throughput": 5128.232, "opt_samples": 100.0, "learner": {"av": {"mean_q": -27.696500778198242, "max_q": 31.894004821777344, "min_q": -102.10659790039062}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 119698, "episodes_total": 286, "training_iteration": 115, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-29-43", "timestamp": 1585776583, "time_this_iter_s": 32.13200783729553, "time_total_s": 2851.866693496704, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f20179d8>", "on_episode_step": "<function on_episode_step at 0x7ff9780282f0>", "on_episode_end": "<function on_episode_end at 0x7ff978028598>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff978028d90>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2851.866693496704, "timesteps_since_restore": 119698, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 69.12826086956521, "ram_util_percent": 64.8304347826087}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.15276199123332, "episode_reward_min": -299.74893073534804, "episode_reward_mean": -15.782488980981052, "episode_len_mean": 397.44, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.80236228414424}, "policy_reward_max": {"av": 32.351473637572006}, "policy_reward_mean": {"av": -8.220046344260966}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.343468307396692, "avg_speed_min": 1.6489247944487202, "avg_speed_max": 9.833505934413216, "avg_rl_veh_arrival_mean": 230.95333333333332, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.35071310830609, "mean_processing_ms": 3.7284397460816647, "mean_inference_ms": 1.1469946870249514}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 52379, "num_steps_trained": 4367600, "num_steps_sampled": 120765, "sample_time_ms": 196.882, "replay_time_ms": 17.559, "grad_time_ms": 21.109, "update_time_ms": 0.006, "opt_peak_throughput": 4737.314, "opt_samples": 100.0, "learner": {"av": {"mean_q": -20.475923538208008, "max_q": 32.47254180908203, "min_q": -88.71500396728516}}}, "timesteps_this_iter": 1067, "done": false, "timesteps_total": 120765, "episodes_total": 289, "training_iteration": 116, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-30-07", "timestamp": 1585776607, "time_this_iter_s": 23.99985909461975, "time_total_s": 2875.866552591324, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f2040620>", "on_episode_step": "<function on_episode_step at 0x7ff9f2040e18>", "on_episode_end": "<function on_episode_end at 0x7ff9f2040840>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f204d730>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2875.866552591324, "timesteps_since_restore": 120765, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 76.49705882352941, "ram_util_percent": 64.81764705882354}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.15276199123332, "episode_reward_min": -299.74893073534804, "episode_reward_mean": -17.716878364456317, "episode_len_mean": 396.81, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.80236228414424}, "policy_reward_max": {"av": 32.351473637572006}, "policy_reward_mean": {"av": -9.324672823398064}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.38594911280275, "avg_speed_min": 1.7350874099750981, "avg_speed_max": 9.833505934413216, "avg_rl_veh_arrival_mean": 230.29166666666669, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.346258133461011, "mean_processing_ms": 3.729376149644109, "mean_inference_ms": 1.1442640178478432}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 52642, "num_steps_trained": 4393900, "num_steps_sampled": 121857, "sample_time_ms": 217.728, "replay_time_ms": 15.582, "grad_time_ms": 21.737, "update_time_ms": 0.006, "opt_peak_throughput": 4600.536, "opt_samples": 100.0, "learner": {"av": {"mean_q": -21.902803421020508, "max_q": 34.46757507324219, "min_q": -88.79750061035156}}}, "timesteps_this_iter": 1092, "done": false, "timesteps_total": 121857, "episodes_total": 292, "training_iteration": 117, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-30-25", "timestamp": 1585776625, "time_this_iter_s": 18.51472806930542, "time_total_s": 2894.3812806606293, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f20178c8>", "on_episode_step": "<function on_episode_step at 0x7ff9f2017730>", "on_episode_end": "<function on_episode_end at 0x7ff9f2017950>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f20179d8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2894.3812806606293, "timesteps_since_restore": 121857, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 81.4962962962963, "ram_util_percent": 64.8777777777778}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.15276199123332, "episode_reward_min": -299.74893073534804, "episode_reward_mean": -17.08744187937293, "episode_len_mean": 400.32, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.80236228414424}, "policy_reward_max": {"av": 32.351473637572006}, "policy_reward_mean": {"av": -8.946304648886356}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.433367615227326, "avg_speed_min": 1.7350874099750981, "avg_speed_max": 9.833505934413216, "avg_rl_veh_arrival_mean": 230.5716666666667, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.343378618223603, "mean_processing_ms": 3.7299735850985445, "mean_inference_ms": 1.142461277095941}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 52961, "num_steps_trained": 4425800, "num_steps_sampled": 122863, "sample_time_ms": 191.93, "replay_time_ms": 17.471, "grad_time_ms": 18.993, "update_time_ms": 0.005, "opt_peak_throughput": 5265.039, "opt_samples": 100.0, "learner": {"av": {"mean_q": -21.2640438079834, "max_q": 34.5223503112793, "min_q": -122.5736083984375}}}, "timesteps_this_iter": 1006, "done": false, "timesteps_total": 122863, "episodes_total": 294, "training_iteration": 118, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-30-46", "timestamp": 1585776646, "time_this_iter_s": 20.47759699821472, "time_total_s": 2914.858877658844, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f204dea0>", "on_episode_step": "<function on_episode_step at 0x7ff9f204d7b8>", "on_episode_end": "<function on_episode_end at 0x7ff9f204d598>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f204d730>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2914.858877658844, "timesteps_since_restore": 122863, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 83.3103448275862, "ram_util_percent": 64.90689655172415}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.15276199123332, "episode_reward_min": -299.74893073534804, "episode_reward_mean": -16.755190693165478, "episode_len_mean": 400.32, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.80236228414424}, "policy_reward_max": {"av": 32.351473637572006}, "policy_reward_mean": {"av": -8.72666181935702}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.409692947034049, "avg_speed_min": 1.7350874099750981, "avg_speed_max": 9.833505934413216, "avg_rl_veh_arrival_mean": 231.61666666666665, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.340642731806361, "mean_processing_ms": 3.7304837126012784, "mean_inference_ms": 1.140744255781722}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 53378, "num_steps_trained": 4467500, "num_steps_sampled": 123865, "sample_time_ms": 233.498, "replay_time_ms": 15.694, "grad_time_ms": 23.893, "update_time_ms": 0.006, "opt_peak_throughput": 4185.381, "opt_samples": 100.0, "learner": {"av": {"mean_q": -27.73040008544922, "max_q": 26.233356475830078, "min_q": -105.00839233398438}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 123865, "episodes_total": 296, "training_iteration": 119, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-31-11", "timestamp": 1585776671, "time_this_iter_s": 25.221543073654175, "time_total_s": 2940.080420732498, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f204d048>", "on_episode_step": "<function on_episode_step at 0x7ff9f204d400>", "on_episode_end": "<function on_episode_end at 0x7ff9f204d8c8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f204df28>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2940.080420732498, "timesteps_since_restore": 123865, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 94.09444444444446, "ram_util_percent": 64.84722222222223}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.15276199123332, "episode_reward_min": -299.74893073534804, "episode_reward_mean": -12.482630279443217, "episode_len_mean": 404.49, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.80236228414424}, "policy_reward_max": {"av": 32.351473637572006}, "policy_reward_mean": {"av": -6.604566285419691}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.364805434811193, "avg_speed_min": 1.7350874099750981, "avg_speed_max": 9.833505934413216, "avg_rl_veh_arrival_mean": 233.55333333333337, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.3367330343061394, "mean_processing_ms": 3.7309432399905704, "mean_inference_ms": 1.1383530289575965}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 53756, "num_steps_trained": 4505300, "num_steps_sampled": 124949, "sample_time_ms": 195.403, "replay_time_ms": 15.922, "grad_time_ms": 22.666, "update_time_ms": 0.005, "opt_peak_throughput": 4411.913, "opt_samples": 100.0, "learner": {"av": {"mean_q": -19.353267669677734, "max_q": 30.484891891479492, "min_q": -97.10446166992188}}}, "timesteps_this_iter": 1084, "done": false, "timesteps_total": 124949, "episodes_total": 299, "training_iteration": 120, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-31-36", "timestamp": 1585776696, "time_this_iter_s": 25.097808122634888, "time_total_s": 2965.178228855133, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff978054840>", "on_episode_step": "<function on_episode_step at 0x7ff978054a60>", "on_episode_end": "<function on_episode_end at 0x7ff978054e18>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff978054bf8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2965.178228855133, "timesteps_since_restore": 124949, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 96.56857142857143, "ram_util_percent": 64.95428571428572}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.15276199123332, "episode_reward_min": -299.74893073534804, "episode_reward_mean": -12.4886394257098, "episode_len_mean": 404.49, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.80236228414424}, "policy_reward_max": {"av": 32.351473637572006}, "policy_reward_mean": {"av": -6.6077457278887834}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.4055052863403406, "avg_speed_min": 1.7350874099750981, "avg_speed_max": 9.833505934413216, "avg_rl_veh_arrival_mean": 232.87333333333336, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.3340560306669715, "mean_processing_ms": 3.731196623003523, "mean_inference_ms": 1.1367198019414766}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 53909, "num_steps_trained": 4520600, "num_steps_sampled": 125974, "sample_time_ms": 205.361, "replay_time_ms": 17.926, "grad_time_ms": 23.083, "update_time_ms": 0.006, "opt_peak_throughput": 4332.104, "opt_samples": 100.0, "learner": {"av": {"mean_q": -18.590930938720703, "max_q": 32.634334564208984, "min_q": -102.75508880615234}}}, "timesteps_this_iter": 1025, "done": false, "timesteps_total": 125974, "episodes_total": 301, "training_iteration": 121, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-31-49", "timestamp": 1585776709, "time_this_iter_s": 12.16940712928772, "time_total_s": 2977.347635984421, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9e8712b70>", "on_episode_step": "<function on_episode_step at 0x7ff9e8712d08>", "on_episode_end": "<function on_episode_end at 0x7ff9f8fdfd90>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff978028b70>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2977.347635984421, "timesteps_since_restore": 125974, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 95.65294117647059, "ram_util_percent": 64.87647058823529}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.15276199123332, "episode_reward_min": -299.74893073534804, "episode_reward_mean": -11.84347126308, "episode_len_mean": 404.49, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.80236228414424}, "policy_reward_max": {"av": 32.351473637572006}, "policy_reward_mean": {"av": -6.200770294806283}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.394577984276193, "avg_speed_min": 1.7350874099750981, "avg_speed_max": 9.833505934413216, "avg_rl_veh_arrival_mean": 233.57, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.3315629770717603, "mean_processing_ms": 3.7313978000902512, "mean_inference_ms": 1.1352037531483075}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 54254, "num_steps_trained": 4555100, "num_steps_sampled": 126980, "sample_time_ms": 196.986, "replay_time_ms": 18.087, "grad_time_ms": 20.184, "update_time_ms": 0.006, "opt_peak_throughput": 4954.374, "opt_samples": 100.0, "learner": {"av": {"mean_q": -22.612226486206055, "max_q": 27.893278121948242, "min_q": -129.3109130859375}}}, "timesteps_this_iter": 1006, "done": false, "timesteps_total": 126980, "episodes_total": 303, "training_iteration": 122, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-32-11", "timestamp": 1585776731, "time_this_iter_s": 22.087143898010254, "time_total_s": 2999.434779882431, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff978054bf8>", "on_episode_step": "<function on_episode_step at 0x7ff978054f28>", "on_episode_end": "<function on_episode_end at 0x7ff978054840>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff978054048>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2999.434779882431, "timesteps_since_restore": 126980, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 90.753125, "ram_util_percent": 64.925}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.15276199123332, "episode_reward_min": -299.74893073534804, "episode_reward_mean": -10.18451893121959, "episode_len_mean": 404.69, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.80236228414424}, "policy_reward_max": {"av": 32.351473637572006}, "policy_reward_mean": {"av": -5.3886343551426386}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.370063634089786, "avg_speed_min": 1.7350874099750981, "avg_speed_max": 9.833505934413216, "avg_rl_veh_arrival_mean": 229.28500000000003, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.327820115436357, "mean_processing_ms": 3.731558344446461, "mean_inference_ms": 1.1329131332716222}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 54454, "num_steps_trained": 4575100, "num_steps_sampled": 128052, "sample_time_ms": 219.758, "replay_time_ms": 16.833, "grad_time_ms": 23.989, "update_time_ms": 0.027, "opt_peak_throughput": 4168.663, "opt_samples": 100.0, "learner": {"av": {"mean_q": -21.247949600219727, "max_q": 32.13175582885742, "min_q": -101.52835845947266}}}, "timesteps_this_iter": 1072, "done": false, "timesteps_total": 128052, "episodes_total": 306, "training_iteration": 123, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-32-26", "timestamp": 1585776746, "time_this_iter_s": 15.771162986755371, "time_total_s": 3015.2059428691864, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18fc31e0>", "on_episode_step": "<function on_episode_step at 0x7ffa18fc3378>", "on_episode_end": "<function on_episode_end at 0x7ffa18fc3400>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa18fc37b8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3015.2059428691864, "timesteps_since_restore": 128052, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 83.07272727272728, "ram_util_percent": 64.94090909090909}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.15276199123332, "episode_reward_min": -299.74893073534804, "episode_reward_mean": -3.2955779003254015, "episode_len_mean": 412.6, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.74893073534804}, "policy_reward_max": {"av": 32.351473637572006}, "policy_reward_mean": {"av": -1.7436920107541813}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.437158240233108, "avg_speed_min": 1.7350874099750981, "avg_speed_max": 9.833505934413216, "avg_rl_veh_arrival_mean": 221.83, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.325237761249205, "mean_processing_ms": 3.731351799463181, "mean_inference_ms": 1.1313229636116209}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 54627, "num_steps_trained": 4592400, "num_steps_sampled": 129076, "sample_time_ms": 210.377, "replay_time_ms": 17.939, "grad_time_ms": 16.364, "update_time_ms": 0.006, "opt_peak_throughput": 6110.814, "opt_samples": 100.0, "learner": {"av": {"mean_q": -24.812732696533203, "max_q": 31.476238250732422, "min_q": -108.1443099975586}}}, "timesteps_this_iter": 1024, "done": false, "timesteps_total": 129076, "episodes_total": 308, "training_iteration": 124, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-32-39", "timestamp": 1585776759, "time_this_iter_s": 12.891897916793823, "time_total_s": 3028.09784078598, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f204df28>", "on_episode_step": "<function on_episode_step at 0x7ff9f204d048>", "on_episode_end": "<function on_episode_end at 0x7ff9f204d730>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f2040a60>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3028.09784078598, "timesteps_since_restore": 129076, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 80.99473684210527, "ram_util_percent": 64.91578947368423}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.15276199123332, "episode_reward_min": -299.74893073534804, "episode_reward_mean": -5.907512904591198, "episode_len_mean": 408.7, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.74893073534804}, "policy_reward_max": {"av": 32.351473637572006}, "policy_reward_mean": {"av": -3.0929386935032466}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.416825166671198, "avg_speed_min": 1.504697142281848, "avg_speed_max": 9.833505934413216, "avg_rl_veh_arrival_mean": 222.08, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.322779390380703, "mean_processing_ms": 3.73116293161597, "mean_inference_ms": 1.1298865472779087}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 55492, "num_steps_trained": 4678900, "num_steps_sampled": 130076, "sample_time_ms": 11.636, "replay_time_ms": 18.275, "grad_time_ms": 20.477, "update_time_ms": 0.006, "opt_peak_throughput": 4883.543, "opt_samples": 100.0, "learner": {"av": {"mean_q": -22.847597122192383, "max_q": 30.93841552734375, "min_q": -88.9109115600586}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 130076, "episodes_total": 310, "training_iteration": 125, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-33-27", "timestamp": 1585776807, "time_this_iter_s": 47.36802101135254, "time_total_s": 3075.4658617973328, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18fd8ae8>", "on_episode_step": "<function on_episode_step at 0x7ffa18fd8b70>", "on_episode_end": "<function on_episode_end at 0x7ffa18fd8bf8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa18fd89d8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3075.4658617973328, "timesteps_since_restore": 130076, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 80.86567164179104, "ram_util_percent": 64.94925373134326}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.15276199123332, "episode_reward_min": -299.74893073534804, "episode_reward_mean": -3.2347297039381973, "episode_len_mean": 412.94, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.74893073534804}, "policy_reward_max": {"av": 32.351473637572006}, "policy_reward_mean": {"av": -1.7114971978509006}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.397838988761188, "avg_speed_min": 1.504697142281848, "avg_speed_max": 9.833505934413216, "avg_rl_veh_arrival_mean": 220.03333333333336, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.318966778022605, "mean_processing_ms": 3.7309136109519447, "mean_inference_ms": 1.127659153681632}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 55831, "num_steps_trained": 4712800, "num_steps_sampled": 131162, "sample_time_ms": 202.498, "replay_time_ms": 16.859, "grad_time_ms": 23.324, "update_time_ms": 0.006, "opt_peak_throughput": 4287.374, "opt_samples": 100.0, "learner": {"av": {"mean_q": -25.08220672607422, "max_q": 30.61500358581543, "min_q": -85.03144836425781}}}, "timesteps_this_iter": 1086, "done": false, "timesteps_total": 131162, "episodes_total": 313, "training_iteration": 126, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-33-49", "timestamp": 1585776829, "time_this_iter_s": 22.57157278060913, "time_total_s": 3098.037434577942, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9e8712b70>", "on_episode_step": "<function on_episode_step at 0x7ff9e8712400>", "on_episode_end": "<function on_episode_end at 0x7ff978028b70>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9780282f0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3098.037434577942, "timesteps_since_restore": 131162, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 78.540625, "ram_util_percent": 64.92812500000001}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.15276199123332, "episode_reward_min": -299.74893073534804, "episode_reward_mean": -3.2344785977082005, "episode_len_mean": 412.94, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.74893073534804}, "policy_reward_max": {"av": 32.351473637572006}, "policy_reward_mean": {"av": -1.7113643374117473}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.385523697007365, "avg_speed_min": 1.504697142281848, "avg_speed_max": 9.833505934413216, "avg_rl_veh_arrival_mean": 220.19333333333336, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.3165038668199407, "mean_processing_ms": 3.730703526112353, "mean_inference_ms": 1.1262373988738117}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 56183, "num_steps_trained": 4748000, "num_steps_sampled": 132162, "sample_time_ms": 9.809, "replay_time_ms": 17.746, "grad_time_ms": 17.781, "update_time_ms": 0.006, "opt_peak_throughput": 5623.884, "opt_samples": 100.0, "learner": {"av": {"mean_q": -25.06063461303711, "max_q": 30.460908889770508, "min_q": -104.88570404052734}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 132162, "episodes_total": 315, "training_iteration": 127, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-34-12", "timestamp": 1585776852, "time_this_iter_s": 22.16698980331421, "time_total_s": 3120.204424381256, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f2040e18>", "on_episode_step": "<function on_episode_step at 0x7ffa18fc3ea0>", "on_episode_end": "<function on_episode_end at 0x7ffa18fc3e18>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa18fc3b70>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3120.204424381256, "timesteps_since_restore": 132162, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 75.578125, "ram_util_percent": 64.90937500000001}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.15276199123332, "episode_reward_min": -299.74893073534804, "episode_reward_mean": -5.788405690424717, "episode_len_mean": 409.33, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.74893073534804}, "policy_reward_max": {"av": 32.351473637572006}, "policy_reward_mean": {"av": -3.112046070120816}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.11, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.319879523075181, "avg_speed_min": 1.504697142281848, "avg_speed_max": 9.833505934413216, "avg_rl_veh_arrival_mean": 220.405, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.3129089521481228, "mean_processing_ms": 3.730659286198444, "mean_inference_ms": 1.1241722971855193}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 56567, "num_steps_trained": 4786400, "num_steps_sampled": 133301, "sample_time_ms": 201.886, "replay_time_ms": 17.594, "grad_time_ms": 19.519, "update_time_ms": 0.006, "opt_peak_throughput": 5123.202, "opt_samples": 100.0, "learner": {"av": {"mean_q": -23.90087890625, "max_q": 27.58036994934082, "min_q": -73.70050811767578}}}, "timesteps_this_iter": 1139, "done": false, "timesteps_total": 133301, "episodes_total": 318, "training_iteration": 128, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-34-37", "timestamp": 1585776877, "time_this_iter_s": 24.89689302444458, "time_total_s": 3145.1013174057007, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18fd8400>", "on_episode_step": "<function on_episode_step at 0x7ffa18fd86a8>", "on_episode_end": "<function on_episode_end at 0x7ff9780282f0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff978028b70>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3145.1013174057007, "timesteps_since_restore": 133301, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 76.73142857142857, "ram_util_percent": 64.90857142857143}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.15276199123332, "episode_reward_min": -299.74893073534804, "episode_reward_mean": -9.060246702611039, "episode_len_mean": 401.37, "episodes_this_iter": 4, "policy_reward_min": {"av": -299.74893073534804}, "policy_reward_max": {"av": 32.351473637572006}, "policy_reward_mean": {"av": -4.7435846610529016}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.13, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.236173745288006, "avg_speed_min": 1.3313036254195314, "avg_speed_max": 9.833505934413216, "avg_rl_veh_arrival_mean": 218.075, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.3088677481955724, "mean_processing_ms": 3.731567176881855, "mean_inference_ms": 1.1218235607091407}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 57257, "num_steps_trained": 4855400, "num_steps_sampled": 134528, "sample_time_ms": 201.973, "replay_time_ms": 19.685, "grad_time_ms": 24.611, "update_time_ms": 0.006, "opt_peak_throughput": 4063.146, "opt_samples": 100.0, "learner": {"av": {"mean_q": -19.338905334472656, "max_q": 30.186580657958984, "min_q": -107.27510070800781}}}, "timesteps_this_iter": 1227, "done": false, "timesteps_total": 134528, "episodes_total": 322, "training_iteration": 129, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-35-19", "timestamp": 1585776919, "time_this_iter_s": 42.80471086502075, "time_total_s": 3187.9060282707214, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa08197268>", "on_episode_step": "<function on_episode_step at 0x7ffa081977b8>", "on_episode_end": "<function on_episode_end at 0x7ffa1817f840>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f2040a60>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3187.9060282707214, "timesteps_since_restore": 134528, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 74.46557377049182, "ram_util_percent": 64.9377049180328}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.15276199123332, "episode_reward_min": -299.74893073534804, "episode_reward_mean": -9.058076965425204, "episode_len_mean": 401.37, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.74893073534804}, "policy_reward_max": {"av": 32.351473637572006}, "policy_reward_mean": {"av": -4.742448672997491}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.13, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.2458462618923605, "avg_speed_min": 1.3313036254195314, "avg_speed_max": 9.833505934413216, "avg_rl_veh_arrival_mean": 218.06, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.3069786007646518, "mean_processing_ms": 3.7321209075929755, "mean_inference_ms": 1.1207097419180214}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 57408, "num_steps_trained": 4870500, "num_steps_sampled": 135531, "sample_time_ms": 226.706, "replay_time_ms": 16.887, "grad_time_ms": 20.68, "update_time_ms": 0.013, "opt_peak_throughput": 4835.518, "opt_samples": 100.0, "learner": {"av": {"mean_q": -24.440996170043945, "max_q": 32.82107925415039, "min_q": -107.01538848876953}}}, "timesteps_this_iter": 1003, "done": false, "timesteps_total": 135531, "episodes_total": 324, "training_iteration": 130, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-35-32", "timestamp": 1585776932, "time_this_iter_s": 12.265949964523315, "time_total_s": 3200.1719782352448, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f204d400>", "on_episode_step": "<function on_episode_step at 0x7ff9f204d2f0>", "on_episode_end": "<function on_episode_end at 0x7ff9f204d620>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f204d8c8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3200.1719782352448, "timesteps_since_restore": 135531, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 90.21176470588236, "ram_util_percent": 64.85294117647058}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.15276199123332, "episode_reward_min": -299.74893073534804, "episode_reward_mean": -8.746257680057747, "episode_len_mean": 401.37, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.74893073534804}, "policy_reward_max": {"av": 32.351473637572006}, "policy_reward_mean": {"av": -4.555342541696744}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.13, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.2778772355765025, "avg_speed_min": 1.3313036254195314, "avg_speed_max": 9.833505934413216, "avg_rl_veh_arrival_mean": 217.69, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.305101408432413, "mean_processing_ms": 3.732712672407291, "mean_inference_ms": 1.1196235443415519}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 57697, "num_steps_trained": 4899400, "num_steps_sampled": 136531, "sample_time_ms": 13.008, "replay_time_ms": 16.184, "grad_time_ms": 20.968, "update_time_ms": 0.006, "opt_peak_throughput": 4769.1, "opt_samples": 100.0, "learner": {"av": {"mean_q": -25.449016571044922, "max_q": 31.329635620117188, "min_q": -110.36869812011719}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 136531, "episodes_total": 326, "training_iteration": 131, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-35-50", "timestamp": 1585776950, "time_this_iter_s": 18.8154079914093, "time_total_s": 3218.987386226654, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff978028ea0>", "on_episode_step": "<function on_episode_step at 0x7ff978028598>", "on_episode_end": "<function on_episode_end at 0x7ff978028268>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff978028e18>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3218.987386226654, "timesteps_since_restore": 136531, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 75.13333333333333, "ram_util_percent": 64.85185185185186}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.15276199123332, "episode_reward_min": -299.74893073534804, "episode_reward_mean": -6.138426308996626, "episode_len_mean": 405.34, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.74893073534804}, "policy_reward_max": {"av": 32.351473637572006}, "policy_reward_mean": {"av": -3.1805317663194965}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.2704654669892435, "avg_speed_min": 1.3313036254195314, "avg_speed_max": 9.833505934413216, "avg_rl_veh_arrival_mean": 217.90666666666664, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.3031904487005215, "mean_processing_ms": 3.732943846236076, "mean_inference_ms": 1.1185866859175686}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 58313, "num_steps_trained": 4961000, "num_steps_sampled": 137531, "sample_time_ms": 13.845, "replay_time_ms": 16.861, "grad_time_ms": 25.169, "update_time_ms": 0.006, "opt_peak_throughput": 3973.154, "opt_samples": 100.0, "learner": {"av": {"mean_q": -22.40432357788086, "max_q": 29.859521865844727, "min_q": -106.21239471435547}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 137531, "episodes_total": 328, "training_iteration": 132, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-36-25", "timestamp": 1585776985, "time_this_iter_s": 34.678828954696655, "time_total_s": 3253.6662151813507, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18fc3c80>", "on_episode_step": "<function on_episode_step at 0x7ffa18fc31e0>", "on_episode_end": "<function on_episode_end at 0x7ffa18fc3ea0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa18fc3f28>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3253.6662151813507, "timesteps_since_restore": 137531, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 66.95918367346938, "ram_util_percent": 64.80204081632654}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.40948228908438, "episode_reward_min": -299.74893073534804, "episode_reward_mean": -2.597161181192504, "episode_len_mean": 409.32, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.74893073534804}, "policy_reward_max": {"av": 32.351473637572006}, "policy_reward_mean": {"av": -1.3318775288166704}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.11, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.303643416088397, "avg_speed_min": 1.3313036254195314, "avg_speed_max": 9.833505934413216, "avg_rl_veh_arrival_mean": 217.7566666666667, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.301283874719329, "mean_processing_ms": 3.7330997401347825, "mean_inference_ms": 1.1175053515208362}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 58596, "num_steps_trained": 4989300, "num_steps_sampled": 138531, "sample_time_ms": 210.603, "replay_time_ms": 16.181, "grad_time_ms": 19.356, "update_time_ms": 0.006, "opt_peak_throughput": 5166.245, "opt_samples": 100.0, "learner": {"av": {"mean_q": -23.073802947998047, "max_q": 30.132022857666016, "min_q": -111.84000396728516}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 138531, "episodes_total": 330, "training_iteration": 133, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-36-45", "timestamp": 1585777005, "time_this_iter_s": 19.503841638565063, "time_total_s": 3273.1700568199158, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18fd86a8>", "on_episode_step": "<function on_episode_step at 0x7ffa18fd8a60>", "on_episode_end": "<function on_episode_end at 0x7ffa18fd82f0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa18fd8400>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3273.1700568199158, "timesteps_since_restore": 138531, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 68.61785714285715, "ram_util_percent": 64.83928571428572}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.40948228908438, "episode_reward_min": -299.74893073534804, "episode_reward_mean": -1.3401286092828832, "episode_len_mean": 412.95, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.74893073534804}, "policy_reward_max": {"av": 32.351473637572006}, "policy_reward_mean": {"av": -0.68724544065789}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.334178242183625, "avg_speed_min": 1.3313036254195314, "avg_speed_max": 9.906499337978444, "avg_rl_veh_arrival_mean": 218.18666666666667, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.2992753321217116, "mean_processing_ms": 3.733063041621831, "mean_inference_ms": 1.1163962082038896}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 59064, "num_steps_trained": 5036100, "num_steps_sampled": 139531, "sample_time_ms": 234.843, "replay_time_ms": 18.497, "grad_time_ms": 28.135, "update_time_ms": 0.009, "opt_peak_throughput": 3554.29, "opt_samples": 100.0, "learner": {"av": {"mean_q": -23.779756546020508, "max_q": 29.069494247436523, "min_q": -119.43753051757812}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 139531, "episodes_total": 332, "training_iteration": 134, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-37-12", "timestamp": 1585777032, "time_this_iter_s": 27.51395606994629, "time_total_s": 3300.684012889862, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18fd8730>", "on_episode_step": "<function on_episode_step at 0x7ffa18fd87b8>", "on_episode_end": "<function on_episode_end at 0x7ffa18fd8d90>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa18fd88c8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3300.684012889862, "timesteps_since_restore": 139531, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 64.37948717948719, "ram_util_percent": 64.91538461538462}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.40948228908438, "episode_reward_min": -299.74893073534804, "episode_reward_mean": -2.617262830907451, "episode_len_mean": 412.95, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.74893073534804}, "policy_reward_max": {"av": 32.351473637572006}, "policy_reward_mean": {"av": -1.363157724430965}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.285761169520741, "avg_speed_min": 1.3313036254195314, "avg_speed_max": 9.906499337978444, "avg_rl_veh_arrival_mean": 221.375, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.2974298388093497, "mean_processing_ms": 3.7329662271688595, "mean_inference_ms": 1.1154361000214879}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 59682, "num_steps_trained": 5097900, "num_steps_sampled": 140531, "sample_time_ms": 14.664, "replay_time_ms": 17.866, "grad_time_ms": 21.911, "update_time_ms": 0.006, "opt_peak_throughput": 4563.957, "opt_samples": 100.0, "learner": {"av": {"mean_q": -21.533935546875, "max_q": 29.5926456451416, "min_q": -109.31756591796875}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 140531, "episodes_total": 334, "training_iteration": 135, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-37-48", "timestamp": 1585777068, "time_this_iter_s": 35.513367652893066, "time_total_s": 3336.197380542755, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18fc31e0>", "on_episode_step": "<function on_episode_step at 0x7ffa18fc3f28>", "on_episode_end": "<function on_episode_end at 0x7ffa18fc3b70>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa18fc3ea0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3336.197380542755, "timesteps_since_restore": 140531, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 63.33599999999999, "ram_util_percent": 64.94200000000001}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.40948228908438, "episode_reward_min": -299.74893073534804, "episode_reward_mean": 0.31957897498498733, "episode_len_mean": 413.08, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.74893073534804}, "policy_reward_max": {"av": 32.351473637572006}, "policy_reward_mean": {"av": 0.16388665383845433}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.11, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.262817745065332, "avg_speed_min": 1.3313036254195314, "avg_speed_max": 9.906499337978444, "avg_rl_veh_arrival_mean": 217.51666666666665, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.294791587088712, "mean_processing_ms": 3.7328800194980682, "mean_inference_ms": 1.1140921626078066}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 60032, "num_steps_trained": 5132900, "num_steps_sampled": 141603, "sample_time_ms": 187.409, "replay_time_ms": 17.397, "grad_time_ms": 25.021, "update_time_ms": 0.006, "opt_peak_throughput": 3996.608, "opt_samples": 100.0, "learner": {"av": {"mean_q": -25.992626190185547, "max_q": 30.116941452026367, "min_q": -104.37079620361328}}}, "timesteps_this_iter": 1072, "done": false, "timesteps_total": 141603, "episodes_total": 337, "training_iteration": 136, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-38-13", "timestamp": 1585777093, "time_this_iter_s": 25.34059977531433, "time_total_s": 3361.5379803180695, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18fc3268>", "on_episode_step": "<function on_episode_step at 0x7ffa18fc3c80>", "on_episode_end": "<function on_episode_end at 0x7ff978054950>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff978054730>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3361.5379803180695, "timesteps_since_restore": 141603, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 64.27027027027026, "ram_util_percent": 65.28108108108107}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.40948228908438, "episode_reward_min": -299.74893073534804, "episode_reward_mean": 2.6093771838493405, "episode_len_mean": 417.09, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.74893073534804}, "policy_reward_max": {"av": 32.351473637572006}, "policy_reward_mean": {"av": 1.352008903548882}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.319560693593393, "avg_speed_min": 1.3313036254195314, "avg_speed_max": 9.906499337978444, "avg_rl_veh_arrival_mean": 217.57666666666668, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.293132163031336, "mean_processing_ms": 3.73272092500408, "mean_inference_ms": 1.1132402721048522}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 60310, "num_steps_trained": 5160700, "num_steps_sampled": 142621, "sample_time_ms": 221.876, "replay_time_ms": 24.405, "grad_time_ms": 26.937, "update_time_ms": 0.007, "opt_peak_throughput": 3712.394, "opt_samples": 100.0, "learner": {"av": {"mean_q": -21.295082092285156, "max_q": 29.279211044311523, "min_q": -82.4572982788086}}}, "timesteps_this_iter": 1018, "done": false, "timesteps_total": 142621, "episodes_total": 339, "training_iteration": 137, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-38-37", "timestamp": 1585777117, "time_this_iter_s": 23.96753215789795, "time_total_s": 3385.5055124759674, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff978028ea0>", "on_episode_step": "<function on_episode_step at 0x7ff978028b70>", "on_episode_end": "<function on_episode_end at 0x7ff9780288c8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff978028e18>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3385.5055124759674, "timesteps_since_restore": 142621, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 73.0029411764706, "ram_util_percent": 65.02941176470588}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.40948228908438, "episode_reward_min": -299.74893073534804, "episode_reward_mean": 2.283521658516381, "episode_len_mean": 417.09, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.74893073534804}, "policy_reward_max": {"av": 32.351473637572006}, "policy_reward_mean": {"av": 1.1893341971439486}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.287298043978111, "avg_speed_min": 1.3313036254195314, "avg_speed_max": 9.906499337978444, "avg_rl_veh_arrival_mean": 218.74166666666667, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.2916197225495343, "mean_processing_ms": 3.73264367195993, "mean_inference_ms": 1.1125137209094382}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 60683, "num_steps_trained": 5198000, "num_steps_sampled": 143621, "sample_time_ms": 9.971, "replay_time_ms": 23.36, "grad_time_ms": 29.639, "update_time_ms": 0.008, "opt_peak_throughput": 3373.949, "opt_samples": 100.0, "learner": {"av": {"mean_q": -21.252748489379883, "max_q": 27.603878021240234, "min_q": -106.03865814208984}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 143621, "episodes_total": 341, "training_iteration": 138, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-39-07", "timestamp": 1585777147, "time_this_iter_s": 29.697021007537842, "time_total_s": 3415.2025334835052, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18fd88c8>", "on_episode_step": "<function on_episode_step at 0x7ffa18fd8a60>", "on_episode_end": "<function on_episode_end at 0x7ffa18fd87b8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa18fd8510>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3415.2025334835052, "timesteps_since_restore": 143621, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 71.68095238095236, "ram_util_percent": 64.86666666666666}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.40948228908438, "episode_reward_min": -299.74893073534804, "episode_reward_mean": 0.2925445202434139, "episode_len_mean": 413.04, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.74893073534804}, "policy_reward_max": {"av": 32.351473637572006}, "policy_reward_mean": {"av": 0.15002283089405957}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.11, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.241308821213755, "avg_speed_min": 1.3313036254195314, "avg_speed_max": 9.906499337978444, "avg_rl_veh_arrival_mean": 218.70166666666668, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.2896279196727427, "mean_processing_ms": 3.7329014443269837, "mean_inference_ms": 1.111546154873973}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 61096, "num_steps_trained": 5239300, "num_steps_sampled": 144721, "sample_time_ms": 207.867, "replay_time_ms": 19.283, "grad_time_ms": 23.93, "update_time_ms": 0.008, "opt_peak_throughput": 4178.855, "opt_samples": 100.0, "learner": {"av": {"mean_q": -27.8750057220459, "max_q": 28.725208282470703, "min_q": -103.81855773925781}}}, "timesteps_this_iter": 1100, "done": false, "timesteps_total": 144721, "episodes_total": 344, "training_iteration": 139, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-39-37", "timestamp": 1585777177, "time_this_iter_s": 29.66452193260193, "time_total_s": 3444.867055416107, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9780a5f28>", "on_episode_step": "<function on_episode_step at 0x7ff9780a5620>", "on_episode_end": "<function on_episode_end at 0x7ff9780a5730>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9780a5598>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3444.867055416107, "timesteps_since_restore": 144721, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 67.90952380952382, "ram_util_percent": 63.9452380952381}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.40948228908438, "episode_reward_min": -299.74893073534804, "episode_reward_mean": -0.022804438403592187, "episode_len_mean": 413.04, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.74893073534804}, "policy_reward_max": {"av": 32.351473637572006}, "policy_reward_mean": {"av": -0.011754865156491441}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.11, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.270961638343013, "avg_speed_min": 1.3313036254195314, "avg_speed_max": 9.906499337978444, "avg_rl_veh_arrival_mean": 217.52166666666668, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.288267105310212, "mean_processing_ms": 3.7331136572939045, "mean_inference_ms": 1.1109074451036804}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 61407, "num_steps_trained": 5270400, "num_steps_sampled": 145721, "sample_time_ms": 9.667, "replay_time_ms": 17.74, "grad_time_ms": 24.434, "update_time_ms": 0.011, "opt_peak_throughput": 4092.619, "opt_samples": 100.0, "learner": {"av": {"mean_q": -21.404315948486328, "max_q": 28.981081008911133, "min_q": -113.25431823730469}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 145721, "episodes_total": 346, "training_iteration": 140, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-39-58", "timestamp": 1585777198, "time_this_iter_s": 21.32617497444153, "time_total_s": 3466.1932303905487, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9780a5840>", "on_episode_step": "<function on_episode_step at 0x7ff9780a5378>", "on_episode_end": "<function on_episode_end at 0x7ff9780a5048>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9780a5950>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3466.1932303905487, "timesteps_since_restore": 145721, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 73.85483870967742, "ram_util_percent": 63.967741935483886}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.40948228908438, "episode_reward_min": -298.58075831887555, "episode_reward_mean": 3.2995841114584565, "episode_len_mean": 416.21, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.73736018229766}, "policy_reward_max": {"av": 32.351473637572006}, "policy_reward_mean": {"av": 1.700816552298175}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.11, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.284112142546048, "avg_speed_min": 1.3313036254195314, "avg_speed_max": 9.906499337978444, "avg_rl_veh_arrival_mean": 216.02166666666665, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.287083715004847, "mean_processing_ms": 3.73333654517235, "mean_inference_ms": 1.1103696465727517}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 61989, "num_steps_trained": 5328600, "num_steps_sampled": 146721, "sample_time_ms": 11.169, "replay_time_ms": 19.265, "grad_time_ms": 18.46, "update_time_ms": 0.006, "opt_peak_throughput": 5417.136, "opt_samples": 100.0, "learner": {"av": {"mean_q": -23.231796264648438, "max_q": 29.226337432861328, "min_q": -75.08662414550781}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 146721, "episodes_total": 348, "training_iteration": 141, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-40-35", "timestamp": 1585777235, "time_this_iter_s": 37.260793685913086, "time_total_s": 3503.454024076462, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18fd8730>", "on_episode_step": "<function on_episode_step at 0x7ffa18fd8d08>", "on_episode_end": "<function on_episode_end at 0x7ff9f20178c8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f20179d8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3503.454024076462, "timesteps_since_restore": 146721, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 71.85471698113209, "ram_util_percent": 64.16792452830188}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.40948228908438, "episode_reward_min": -298.58075831887555, "episode_reward_mean": 3.6331808888034276, "episode_len_mean": 416.99, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.73736018229766}, "policy_reward_max": {"av": 32.351473637572006}, "policy_reward_mean": {"av": 1.8536637187772596}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.11, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.2562774990818335, "avg_speed_min": 1.3313036254195314, "avg_speed_max": 9.906499337978444, "avg_rl_veh_arrival_mean": 217.04166666666669, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.2858301956560285, "mean_processing_ms": 3.7338185078008705, "mean_inference_ms": 1.1098424219659964}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 62639, "num_steps_trained": 5393600, "num_steps_sampled": 147876, "sample_time_ms": 251.693, "replay_time_ms": 23.631, "grad_time_ms": 39.698, "update_time_ms": 0.011, "opt_peak_throughput": 2519.046, "opt_samples": 100.0, "learner": {"av": {"mean_q": -18.802383422851562, "max_q": 25.814435958862305, "min_q": -101.64434814453125}}}, "timesteps_this_iter": 1155, "done": false, "timesteps_total": 147876, "episodes_total": 351, "training_iteration": 142, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-41-22", "timestamp": 1585777282, "time_this_iter_s": 46.631341218948364, "time_total_s": 3550.08536529541, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9780a51e0>", "on_episode_step": "<function on_episode_step at 0x7ff9780a52f0>", "on_episode_end": "<function on_episode_end at 0x7ff9780a56a8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9780a57b8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3550.08536529541, "timesteps_since_restore": 147876, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 91.74545454545455, "ram_util_percent": 64.62424242424242}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.40948228908438, "episode_reward_min": -298.58075831887555, "episode_reward_mean": 0.37684504889368553, "episode_len_mean": 412.97, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.73736018229766}, "policy_reward_max": {"av": 32.351473637572006}, "policy_reward_mean": {"av": 0.19129190299172086}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.11, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.271290820411785, "avg_speed_min": 1.3313036254195314, "avg_speed_max": 9.906499337978444, "avg_rl_veh_arrival_mean": 220.71166666666667, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.2849672481864634, "mean_processing_ms": 3.7343397035866173, "mean_inference_ms": 1.10952496367731}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 63145, "num_steps_trained": 5444200, "num_steps_sampled": 148990, "sample_time_ms": 191.358, "replay_time_ms": 19.751, "grad_time_ms": 30.429, "update_time_ms": 0.006, "opt_peak_throughput": 3286.361, "opt_samples": 100.0, "learner": {"av": {"mean_q": -23.557842254638672, "max_q": 28.606670379638672, "min_q": -112.65515899658203}}}, "timesteps_this_iter": 1114, "done": false, "timesteps_total": 148990, "episodes_total": 354, "training_iteration": 143, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-42-03", "timestamp": 1585777323, "time_this_iter_s": 40.99054479598999, "time_total_s": 3591.0759100914, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9780a5bf8>", "on_episode_step": "<function on_episode_step at 0x7ff9780a5b70>", "on_episode_end": "<function on_episode_end at 0x7ff9780a5ae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9780a5d90>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3591.0759100914, "timesteps_since_restore": 148990, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 78.59661016949154, "ram_util_percent": 64.66271186440677}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.40948228908438, "episode_reward_min": -298.58075831887555, "episode_reward_mean": 1.0187284803349554, "episode_len_mean": 412.93, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.73736018229766}, "policy_reward_max": {"av": 32.351473637572006}, "policy_reward_mean": {"av": 0.5119238594648017}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.11, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.228249842666214, "avg_speed_min": 1.3313036254195314, "avg_speed_max": 9.906499337978444, "avg_rl_veh_arrival_mean": 222.37166666666664, "avg_rl_veh_arrival_min": 51.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.2842650461476164, "mean_processing_ms": 3.734953061188799, "mean_inference_ms": 1.1092364564652322}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 63534, "num_steps_trained": 5483100, "num_steps_sampled": 150021, "sample_time_ms": 328.773, "replay_time_ms": 19.457, "grad_time_ms": 27.675, "update_time_ms": 0.006, "opt_peak_throughput": 3613.353, "opt_samples": 100.0, "learner": {"av": {"mean_q": -21.153879165649414, "max_q": 27.972911834716797, "min_q": -95.66664123535156}}}, "timesteps_this_iter": 1031, "done": false, "timesteps_total": 150021, "episodes_total": 357, "training_iteration": 144, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-42-33", "timestamp": 1585777353, "time_this_iter_s": 29.90361714363098, "time_total_s": 3620.979527235031, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff978028268>", "on_episode_step": "<function on_episode_step at 0x7ff978028950>", "on_episode_end": "<function on_episode_end at 0x7ff9780289d8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff978028d90>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3620.979527235031, "timesteps_since_restore": 150021, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 65.27674418604651, "ram_util_percent": 64.26046511627906}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.40948228908438, "episode_reward_min": -298.58075831887555, "episode_reward_mean": 4.247113387044311, "episode_len_mean": 417.08, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.73736018229766}, "policy_reward_max": {"av": 32.351473637572006}, "policy_reward_mean": {"av": 2.1558951203270604}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.11, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.167267435922927, "avg_speed_min": 1.3313036254195314, "avg_speed_max": 9.906499337978444, "avg_rl_veh_arrival_mean": 221.25833333333335, "avg_rl_veh_arrival_min": 51.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.2840637188666357, "mean_processing_ms": 3.7352469176761356, "mean_inference_ms": 1.1092161802901481}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 64009, "num_steps_trained": 5530600, "num_steps_sampled": 151038, "sample_time_ms": 222.408, "replay_time_ms": 24.8, "grad_time_ms": 32.957, "update_time_ms": 0.006, "opt_peak_throughput": 3034.289, "opt_samples": 100.0, "learner": {"av": {"mean_q": -18.57785415649414, "max_q": 28.01863670349121, "min_q": -99.0241928100586}}}, "timesteps_this_iter": 1017, "done": false, "timesteps_total": 151038, "episodes_total": 359, "training_iteration": 145, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-43-11", "timestamp": 1585777391, "time_this_iter_s": 38.006990909576416, "time_total_s": 3658.9865181446075, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9780a50d0>", "on_episode_step": "<function on_episode_step at 0x7ff9780a5048>", "on_episode_end": "<function on_episode_end at 0x7ff9780a5950>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa18fd82f0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3658.9865181446075, "timesteps_since_restore": 151038, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 72.56296296296296, "ram_util_percent": 64.42037037037038}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.63749703666302, "episode_reward_min": -298.58075831887555, "episode_reward_mean": 7.1893241644360115, "episode_len_mean": 421.14, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.73736018229766}, "policy_reward_max": {"av": 32.351473637572006}, "policy_reward_mean": {"av": 3.6309718002202085}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.136944360787441, "avg_speed_min": 1.3313036254195314, "avg_speed_max": 9.906499337978444, "avg_rl_veh_arrival_mean": 223.93, "avg_rl_veh_arrival_min": 51.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.2839912834107947, "mean_processing_ms": 3.735353243780711, "mean_inference_ms": 1.1092968383314368}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 64565, "num_steps_trained": 5586200, "num_steps_sampled": 152038, "sample_time_ms": 9.386, "replay_time_ms": 21.675, "grad_time_ms": 23.386, "update_time_ms": 0.006, "opt_peak_throughput": 4275.984, "opt_samples": 100.0, "learner": {"av": {"mean_q": -21.50702667236328, "max_q": 26.910507202148438, "min_q": -74.60176849365234}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 152038, "episodes_total": 361, "training_iteration": 146, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-43-53", "timestamp": 1585777433, "time_this_iter_s": 41.75977396965027, "time_total_s": 3700.746292114258, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff978054950>", "on_episode_step": "<function on_episode_step at 0x7ff9780547b8>", "on_episode_end": "<function on_episode_end at 0x7ff978054f28>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff978054a60>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3700.746292114258, "timesteps_since_restore": 152038, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 74.40338983050847, "ram_util_percent": 64.82033898305085}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.63749703666302, "episode_reward_min": -298.58075831887555, "episode_reward_mean": 9.797431422146081, "episode_len_mean": 425.01, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.73736018229766}, "policy_reward_max": {"av": 32.351473637572006}, "policy_reward_mean": {"av": 4.948197687952566}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.188223278603209, "avg_speed_min": 1.3313036254195314, "avg_speed_max": 9.906499337978444, "avg_rl_veh_arrival_mean": 223.58500000000004, "avg_rl_veh_arrival_min": 51.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.283971251418298, "mean_processing_ms": 3.7353424514493576, "mean_inference_ms": 1.1093951190137554}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 64936, "num_steps_trained": 5623300, "num_steps_sampled": 153038, "sample_time_ms": 226.154, "replay_time_ms": 23.321, "grad_time_ms": 26.505, "update_time_ms": 0.006, "opt_peak_throughput": 3772.874, "opt_samples": 100.0, "learner": {"av": {"mean_q": -22.01226234436035, "max_q": 26.03992462158203, "min_q": -105.29637145996094}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 153038, "episodes_total": 363, "training_iteration": 147, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-44-20", "timestamp": 1585777460, "time_this_iter_s": 27.346897840499878, "time_total_s": 3728.0931899547577, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9780a5158>", "on_episode_step": "<function on_episode_step at 0x7ff9780a52f0>", "on_episode_end": "<function on_episode_end at 0x7ff9780a5ae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9780a5bf8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3728.0931899547577, "timesteps_since_restore": 153038, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 91.3153846153846, "ram_util_percent": 64.67435897435898}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.63749703666302, "episode_reward_min": -298.58075831887555, "episode_reward_mean": 13.101554761204646, "episode_len_mean": 428.77, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.73736018229766}, "policy_reward_max": {"av": 32.351473637572006}, "policy_reward_mean": {"av": 6.650535411779007}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.223854841233046, "avg_speed_min": 1.3313036254195314, "avg_speed_max": 9.906499337978444, "avg_rl_veh_arrival_mean": 220.07, "avg_rl_veh_arrival_min": 51.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.2839015301371886, "mean_processing_ms": 3.7351936578533764, "mean_inference_ms": 1.1094368020746586}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 65112, "num_steps_trained": 5640900, "num_steps_sampled": 154038, "sample_time_ms": 10.138, "replay_time_ms": 17.114, "grad_time_ms": 20.931, "update_time_ms": 0.01, "opt_peak_throughput": 4777.629, "opt_samples": 100.0, "learner": {"av": {"mean_q": -22.176015853881836, "max_q": 29.44291877746582, "min_q": -88.72808837890625}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 154038, "episodes_total": 365, "training_iteration": 148, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-44-37", "timestamp": 1585777477, "time_this_iter_s": 16.400251865386963, "time_total_s": 3744.4934418201447, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff978054f28>", "on_episode_step": "<function on_episode_step at 0x7ff9780547b8>", "on_episode_end": "<function on_episode_end at 0x7ff978028b70>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff978028ea0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3744.4934418201447, "timesteps_since_restore": 154038, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 87.91666666666667, "ram_util_percent": 64.64999999999999}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.63749703666302, "episode_reward_min": -298.58075831887555, "episode_reward_mean": 13.097660905412186, "episode_len_mean": 428.77, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.73736018229766}, "policy_reward_max": {"av": 32.3490034268606}, "policy_reward_mean": {"av": 6.648558835234612}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.259768073802155, "avg_speed_min": 1.3313036254195314, "avg_speed_max": 9.906499337978444, "avg_rl_veh_arrival_mean": 218.8, "avg_rl_veh_arrival_min": 51.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.2837880823027037, "mean_processing_ms": 3.735058276456101, "mean_inference_ms": 1.1094385467329182}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 65445, "num_steps_trained": 5674200, "num_steps_sampled": 155038, "sample_time_ms": 12.555, "replay_time_ms": 19.284, "grad_time_ms": 24.463, "update_time_ms": 0.017, "opt_peak_throughput": 4087.868, "opt_samples": 100.0, "learner": {"av": {"mean_q": -22.320650100708008, "max_q": 27.4708309173584, "min_q": -87.84580993652344}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 155038, "episodes_total": 367, "training_iteration": 149, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-44-59", "timestamp": 1585777499, "time_this_iter_s": 22.799587965011597, "time_total_s": 3767.2930297851562, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f204d730>", "on_episode_step": "<function on_episode_step at 0x7ff9f204d400>", "on_episode_end": "<function on_episode_end at 0x7ff9f204dea0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f204d8c8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3767.2930297851562, "timesteps_since_restore": 155038, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 89.30000000000001, "ram_util_percent": 64.16875}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.63749703666302, "episode_reward_min": -298.58075831887555, "episode_reward_mean": 12.80156031774786, "episode_len_mean": 428.57, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.7330544104723}, "policy_reward_max": {"av": 32.3490034268606}, "policy_reward_mean": {"av": 6.498253968399933}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.269314056474671, "avg_speed_min": 1.3313036254195314, "avg_speed_max": 9.906499337978444, "avg_rl_veh_arrival_mean": 218.735, "avg_rl_veh_arrival_min": 51.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.28381655600066, "mean_processing_ms": 3.734913087084928, "mean_inference_ms": 1.1094596411194746}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 65731, "num_steps_trained": 5702800, "num_steps_sampled": 156185, "sample_time_ms": 215.747, "replay_time_ms": 18.092, "grad_time_ms": 24.667, "update_time_ms": 0.006, "opt_peak_throughput": 4054.03, "opt_samples": 100.0, "learner": {"av": {"mean_q": -21.74333953857422, "max_q": 25.07847023010254, "min_q": -96.86064147949219}}}, "timesteps_this_iter": 1147, "done": false, "timesteps_total": 156185, "episodes_total": 370, "training_iteration": 150, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-45-25", "timestamp": 1585777525, "time_this_iter_s": 25.630380868911743, "time_total_s": 3792.923410654068, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9780c4b70>", "on_episode_step": "<function on_episode_step at 0x7ff9780c49d8>", "on_episode_end": "<function on_episode_end at 0x7ff9780c47b8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9780c4048>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3792.923410654068, "timesteps_since_restore": 156185, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 89.9243243243243, "ram_util_percent": 64.58648648648646}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.63749703666302, "episode_reward_min": -298.58075831887555, "episode_reward_mean": 17.736956270353947, "episode_len_mean": 435.78, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.7285144356744}, "policy_reward_max": {"av": 32.358166503651}, "policy_reward_mean": {"av": 8.958058722400983}, "custom_metrics": {"num_ped_collisions_mean": 0.07, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.274912875688489, "avg_speed_min": 1.1205167755499523, "avg_speed_max": 9.906499337978444, "avg_rl_veh_arrival_mean": 217.46333333333337, "avg_rl_veh_arrival_min": 51.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.2839728837511295, "mean_processing_ms": 3.7345488365528197, "mean_inference_ms": 1.1095755935858977}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 66278, "num_steps_trained": 5757500, "num_steps_sampled": 157187, "sample_time_ms": 160.56, "replay_time_ms": 18.861, "grad_time_ms": 23.73, "update_time_ms": 0.006, "opt_peak_throughput": 4213.992, "opt_samples": 100.0, "learner": {"av": {"mean_q": -26.833786010742188, "max_q": 26.24888801574707, "min_q": -111.94384765625}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 157187, "episodes_total": 372, "training_iteration": 151, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-46-02", "timestamp": 1585777562, "time_this_iter_s": 36.83538818359375, "time_total_s": 3829.7587988376617, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff978054f28>", "on_episode_step": "<function on_episode_step at 0x7ff978054a60>", "on_episode_end": "<function on_episode_end at 0x7ff978054268>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa18fc3ea0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3829.7587988376617, "timesteps_since_restore": 157187, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 81.66153846153847, "ram_util_percent": 64.56538461538462}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.63749703666302, "episode_reward_min": -298.58075831887555, "episode_reward_mean": 18.062767870405104, "episode_len_mean": 435.78, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.7285144356744}, "policy_reward_max": {"av": 32.358166503651}, "policy_reward_mean": {"av": 9.076767774072916}, "custom_metrics": {"num_ped_collisions_mean": 0.07, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.273580189611566, "avg_speed_min": 1.1205167755499523, "avg_speed_max": 9.906499337978444, "avg_rl_veh_arrival_mean": 217.72333333333333, "avg_rl_veh_arrival_min": 51.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.284173551828126, "mean_processing_ms": 3.734152223036345, "mean_inference_ms": 1.109751054425067}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 66771, "num_steps_trained": 5806800, "num_steps_sampled": 158187, "sample_time_ms": 11.247, "replay_time_ms": 21.27, "grad_time_ms": 33.39, "update_time_ms": 0.006, "opt_peak_throughput": 2994.875, "opt_samples": 100.0, "learner": {"av": {"mean_q": -24.347761154174805, "max_q": 27.35087776184082, "min_q": -123.42526245117188}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 158187, "episodes_total": 374, "training_iteration": 152, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-46-36", "timestamp": 1585777596, "time_this_iter_s": 33.684744119644165, "time_total_s": 3863.443542957306, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9780c48c8>", "on_episode_step": "<function on_episode_step at 0x7ff978054950>", "on_episode_end": "<function on_episode_end at 0x7ffa18fd8d08>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa18fd8048>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3863.443542957306, "timesteps_since_restore": 158187, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 84.01875, "ram_util_percent": 64.66250000000001}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.63749703666302, "episode_reward_min": -298.0399152621963, "episode_reward_mean": 17.794937485646816, "episode_len_mean": 436.05, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.7285144356744}, "policy_reward_max": {"av": 32.358166503651}, "policy_reward_mean": {"av": 8.94217964102855}, "custom_metrics": {"num_ped_collisions_mean": 0.07, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.287922554080138, "avg_speed_min": 1.1205167755499523, "avg_speed_max": 9.906499337978444, "avg_rl_veh_arrival_mean": 217.95833333333331, "avg_rl_veh_arrival_min": 51.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.2845886554692636, "mean_processing_ms": 3.733838721803163, "mean_inference_ms": 1.1100406222812833}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 67190, "num_steps_trained": 5848700, "num_steps_sampled": 159305, "sample_time_ms": 193.328, "replay_time_ms": 17.199, "grad_time_ms": 33.429, "update_time_ms": 0.006, "opt_peak_throughput": 2991.397, "opt_samples": 100.0, "learner": {"av": {"mean_q": -20.934520721435547, "max_q": 26.52546501159668, "min_q": -106.79035949707031}}}, "timesteps_this_iter": 1118, "done": false, "timesteps_total": 159305, "episodes_total": 377, "training_iteration": 153, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-47-07", "timestamp": 1585777627, "time_this_iter_s": 30.851567029953003, "time_total_s": 3894.295109987259, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18fd80d0>", "on_episode_step": "<function on_episode_step at 0x7ff9f204d400>", "on_episode_end": "<function on_episode_end at 0x7ff9f204dea0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9f204d8c8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3894.295109987259, "timesteps_since_restore": 159305, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 87.9590909090909, "ram_util_percent": 64.8068181818182}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.63749703666302, "episode_reward_min": -298.0399152621963, "episode_reward_mean": 18.114854934743573, "episode_len_mean": 436.05, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.7285144356744}, "policy_reward_max": {"av": 32.358166503651}, "policy_reward_mean": {"av": 9.057427467371785}, "custom_metrics": {"num_ped_collisions_mean": 0.07, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.315985599875708, "avg_speed_min": 1.1205167755499523, "avg_speed_max": 9.906499337978444, "avg_rl_veh_arrival_mean": 215.36333333333334, "avg_rl_veh_arrival_min": 51.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.2848786785186705, "mean_processing_ms": 3.733592694001335, "mean_inference_ms": 1.110152955360502}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 67418, "num_steps_trained": 5871500, "num_steps_sampled": 160305, "sample_time_ms": 240.712, "replay_time_ms": 21.181, "grad_time_ms": 26.299, "update_time_ms": 0.006, "opt_peak_throughput": 3802.357, "opt_samples": 100.0, "learner": {"av": {"mean_q": -22.830825805664062, "max_q": 27.960376739501953, "min_q": -109.62206268310547}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 160305, "episodes_total": 379, "training_iteration": 154, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-47-25", "timestamp": 1585777645, "time_this_iter_s": 18.101351737976074, "time_total_s": 3912.396461725235, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9f2017840>", "on_episode_step": "<function on_episode_step at 0x7ff978028ea0>", "on_episode_end": "<function on_episode_end at 0x7ff9780288c8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9780289d8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3912.396461725235, "timesteps_since_restore": 160305, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 92.09230769230771, "ram_util_percent": 64.74615384615385}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.63749703666302, "episode_reward_min": -298.0399152621963, "episode_reward_mean": 18.74336961528777, "episode_len_mean": 436.05, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.7285144356744}, "policy_reward_max": {"av": 32.358166503651}, "policy_reward_mean": {"av": 9.278895849152358}, "custom_metrics": {"num_ped_collisions_mean": 0.07, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.3298331727648645, "avg_speed_min": 1.1205167755499523, "avg_speed_max": 9.906499337978444, "avg_rl_veh_arrival_mean": 214.90666666666667, "avg_rl_veh_arrival_min": 51.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.2852798734269264, "mean_processing_ms": 3.7332838310290732, "mean_inference_ms": 1.1102727519969688}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 67801, "num_steps_trained": 5909800, "num_steps_sampled": 161305, "sample_time_ms": 22.271, "replay_time_ms": 21.391, "grad_time_ms": 20.92, "update_time_ms": 0.028, "opt_peak_throughput": 4780.09, "opt_samples": 100.0, "learner": {"av": {"mean_q": -18.2335147857666, "max_q": 24.94308090209961, "min_q": -105.85731506347656}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 161305, "episodes_total": 381, "training_iteration": 155, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-47-52", "timestamp": 1585777672, "time_this_iter_s": 27.73370099067688, "time_total_s": 3940.130162715912, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9780c4bf8>", "on_episode_step": "<function on_episode_step at 0x7ff9780c4510>", "on_episode_end": "<function on_episode_end at 0x7ff9780c4488>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff998081a60>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3940.130162715912, "timesteps_since_restore": 161305, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 78.92999999999999, "ram_util_percent": 64.79249999999999}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.63749703666302, "episode_reward_min": -298.0399152621963, "episode_reward_mean": 19.060227985870952, "episode_len_mean": 436.05, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.7285144356744}, "policy_reward_max": {"av": 32.358166503651}, "policy_reward_mean": {"av": 9.389274869887169}, "custom_metrics": {"num_ped_collisions_mean": 0.07, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.319113292093203, "avg_speed_min": 1.1205167755499523, "avg_speed_max": 9.906499337978444, "avg_rl_veh_arrival_mean": 215.06333333333336, "avg_rl_veh_arrival_min": 51.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.285802311315521, "mean_processing_ms": 3.7330558274580823, "mean_inference_ms": 1.1104693143233129}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 68207, "num_steps_trained": 5950400, "num_steps_sampled": 162305, "sample_time_ms": 9.871, "replay_time_ms": 22.925, "grad_time_ms": 26.529, "update_time_ms": 0.011, "opt_peak_throughput": 3769.49, "opt_samples": 100.0, "learner": {"av": {"mean_q": -23.184019088745117, "max_q": 28.77683448791504, "min_q": -104.66752624511719}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 162305, "episodes_total": 383, "training_iteration": 156, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-48-22", "timestamp": 1585777702, "time_this_iter_s": 29.090720176696777, "time_total_s": 3969.2208828926086, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18fd8048>", "on_episode_step": "<function on_episode_step at 0x7ffa18fd8a60>", "on_episode_end": "<function on_episode_end at 0x7ffa18fd8378>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa18fd8598>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3969.2208828926086, "timesteps_since_restore": 162305, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 78.9829268292683, "ram_util_percent": 64.83902439024389}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.63749703666302, "episode_reward_min": -298.0399152621963, "episode_reward_mean": 22.70708610519697, "episode_len_mean": 439.47, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.6863997739959}, "policy_reward_max": {"av": 32.358166503651}, "policy_reward_mean": {"av": 11.130924561371065}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.325879864577486, "avg_speed_min": 1.1205167755499523, "avg_speed_max": 9.906499337978444, "avg_rl_veh_arrival_mean": 212.38000000000002, "avg_rl_veh_arrival_min": 51.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.286259350199688, "mean_processing_ms": 3.7326401680528845, "mean_inference_ms": 1.110639493359666}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 68566, "num_steps_trained": 5986300, "num_steps_sampled": 163305, "sample_time_ms": 14.795, "replay_time_ms": 18.536, "grad_time_ms": 25.744, "update_time_ms": 0.006, "opt_peak_throughput": 3884.345, "opt_samples": 100.0, "learner": {"av": {"mean_q": -24.521499633789062, "max_q": 27.539779663085938, "min_q": -146.178955078125}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 163305, "episodes_total": 385, "training_iteration": 157, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-48-50", "timestamp": 1585777730, "time_this_iter_s": 28.30916404724121, "time_total_s": 3997.53004693985, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff978054950>", "on_episode_step": "<function on_episode_step at 0x7ffa18f86158>", "on_episode_end": "<function on_episode_end at 0x7ffa18fd8510>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa18fd80d0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3997.53004693985, "timesteps_since_restore": 163305, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 83.5780487804878, "ram_util_percent": 64.99024390243902}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.63749703666302, "episode_reward_min": -297.38359134353124, "episode_reward_mean": 25.152703329064806, "episode_len_mean": 436.77, "episodes_this_iter": 4, "policy_reward_min": {"av": -299.6724826438609}, "policy_reward_max": {"av": 32.358166503651}, "policy_reward_mean": {"av": 12.576351664532401}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.381812079549567, "avg_speed_min": 1.1205167755499523, "avg_speed_max": 9.906499337978444, "avg_rl_veh_arrival_mean": 202.80500000000004, "avg_rl_veh_arrival_min": 47.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.287131101529032, "mean_processing_ms": 3.7320605965157525, "mean_inference_ms": 1.1109366374715892}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 68816, "num_steps_trained": 6011300, "num_steps_sampled": 164451, "sample_time_ms": 214.649, "replay_time_ms": 21.255, "grad_time_ms": 27.847, "update_time_ms": 0.006, "opt_peak_throughput": 3591.078, "opt_samples": 100.0, "learner": {"av": {"mean_q": -21.542314529418945, "max_q": 27.62162971496582, "min_q": -113.58992767333984}}}, "timesteps_this_iter": 1146, "done": false, "timesteps_total": 164451, "episodes_total": 389, "training_iteration": 158, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-49-14", "timestamp": 1585777754, "time_this_iter_s": 23.716657876968384, "time_total_s": 4021.2467048168182, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9780a5ae8>", "on_episode_step": "<function on_episode_step at 0x7ff9780a5378>", "on_episode_end": "<function on_episode_end at 0x7ff9780a5158>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9e8712d08>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4021.2467048168182, "timesteps_since_restore": 164451, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 83.3, "ram_util_percent": 65.03030303030303}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.63749703666302, "episode_reward_min": -299.8607751718358, "episode_reward_mean": 24.767973620588204, "episode_len_mean": 436.68, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.8607751718358}, "policy_reward_max": {"av": 32.358166503651}, "policy_reward_mean": {"av": 12.32237493561602}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.374199471582038, "avg_speed_min": 1.1205167755499523, "avg_speed_max": 9.906499337978444, "avg_rl_veh_arrival_mean": 207.1483333333333, "avg_rl_veh_arrival_min": 47.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.288186079074819, "mean_processing_ms": 3.731673789939939, "mean_inference_ms": 1.1113152297123257}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 69130, "num_steps_trained": 6042700, "num_steps_sampled": 165525, "sample_time_ms": 254.776, "replay_time_ms": 24.009, "grad_time_ms": 29.777, "update_time_ms": 0.006, "opt_peak_throughput": 3358.334, "opt_samples": 100.0, "learner": {"av": {"mean_q": -23.263296127319336, "max_q": 22.197938919067383, "min_q": -70.84991455078125}}}, "timesteps_this_iter": 1074, "done": false, "timesteps_total": 165525, "episodes_total": 392, "training_iteration": 159, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-49-43", "timestamp": 1585777783, "time_this_iter_s": 29.030359983444214, "time_total_s": 4050.2770648002625, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff978054f28>", "on_episode_step": "<function on_episode_step at 0x7ff998081400>", "on_episode_end": "<function on_episode_end at 0x7ff998081510>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff998081620>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4050.2770648002625, "timesteps_since_restore": 165525, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 85.24761904761905, "ram_util_percent": 65.02380952380952}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.63749703666302, "episode_reward_min": -299.8607751718358, "episode_reward_mean": 24.147631637930985, "episode_len_mean": 432.85, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.8607751718358}, "policy_reward_max": {"av": 32.358166503651}, "policy_reward_mean": {"av": 12.07381581896549}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.436852811887648, "avg_speed_min": 1.1205167755499523, "avg_speed_max": 9.906499337978444, "avg_rl_veh_arrival_mean": 204.2733333333333, "avg_rl_veh_arrival_min": 47.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.289299172584044, "mean_processing_ms": 3.7315435381765663, "mean_inference_ms": 1.1116948790707415}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 69385, "num_steps_trained": 6068200, "num_steps_sampled": 166642, "sample_time_ms": 255.543, "replay_time_ms": 23.03, "grad_time_ms": 30.103, "update_time_ms": 0.007, "opt_peak_throughput": 3321.934, "opt_samples": 100.0, "learner": {"av": {"mean_q": -25.104001998901367, "max_q": 28.332700729370117, "min_q": -94.83772277832031}}}, "timesteps_this_iter": 1117, "done": false, "timesteps_total": 166642, "episodes_total": 395, "training_iteration": 160, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-50-06", "timestamp": 1585777806, "time_this_iter_s": 22.796310901641846, "time_total_s": 4073.0733757019043, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff998081950>", "on_episode_step": "<function on_episode_step at 0x7ff998081378>", "on_episode_end": "<function on_episode_end at 0x7ff9980812f0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff998081488>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4073.0733757019043, "timesteps_since_restore": 166642, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 80.04545454545455, "ram_util_percent": 64.64848484848486}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.63749703666302, "episode_reward_min": -299.8607751718358, "episode_reward_mean": 23.826584622064562, "episode_len_mean": 432.85, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.8607751718358}, "policy_reward_max": {"av": 32.358166503651}, "policy_reward_mean": {"av": 11.973158101539983}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.417483475549971, "avg_speed_min": 1.1205167755499523, "avg_speed_max": 9.906499337978444, "avg_rl_veh_arrival_mean": 204.44666666666663, "avg_rl_veh_arrival_min": 47.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.290080247614108, "mean_processing_ms": 3.7314322660235164, "mean_inference_ms": 1.1119511047031876}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 69652, "num_steps_trained": 6094900, "num_steps_sampled": 167642, "sample_time_ms": 9.363, "replay_time_ms": 21.798, "grad_time_ms": 20.704, "update_time_ms": 0.006, "opt_peak_throughput": 4830.094, "opt_samples": 100.0, "learner": {"av": {"mean_q": -23.286767959594727, "max_q": 20.42450523376465, "min_q": -107.49070739746094}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 167642, "episodes_total": 397, "training_iteration": 161, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-50-29", "timestamp": 1585777829, "time_this_iter_s": 22.967241048812866, "time_total_s": 4096.040616750717, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9780a5840>", "on_episode_step": "<function on_episode_step at 0x7ff9780a5158>", "on_episode_end": "<function on_episode_end at 0x7ff9780a5f28>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9780a56a8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4096.040616750717, "timesteps_since_restore": 167642, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 85.925, "ram_util_percent": 64.875}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.63749703666302, "episode_reward_min": -299.8607751718358, "episode_reward_mean": 24.781909997862375, "episode_len_mean": 436.72, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.8607751718358}, "policy_reward_max": {"av": 32.358166503651}, "policy_reward_mean": {"av": 12.329308456647949}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.4318544698164235, "avg_speed_min": 1.1205167755499523, "avg_speed_max": 9.906499337978444, "avg_rl_veh_arrival_mean": 205.94166666666663, "avg_rl_veh_arrival_min": 47.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.290940495762412, "mean_processing_ms": 3.731257248570356, "mean_inference_ms": 1.1122417523156582}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 70046, "num_steps_trained": 6134300, "num_steps_sampled": 168642, "sample_time_ms": 196.712, "replay_time_ms": 20.493, "grad_time_ms": 29.65, "update_time_ms": 0.007, "opt_peak_throughput": 3372.657, "opt_samples": 100.0, "learner": {"av": {"mean_q": -23.8929443359375, "max_q": 24.206079483032227, "min_q": -137.89720153808594}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 168642, "episodes_total": 399, "training_iteration": 162, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-50-57", "timestamp": 1585777857, "time_this_iter_s": 28.61368989944458, "time_total_s": 4124.654306650162, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9780c4400>", "on_episode_step": "<function on_episode_step at 0x7ff9780c4950>", "on_episode_end": "<function on_episode_end at 0x7ff9780c4488>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9980810d0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4124.654306650162, "timesteps_since_restore": 168642, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 95.26341463414634, "ram_util_percent": 64.84634146341465}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.63749703666302, "episode_reward_min": -299.8607751718358, "episode_reward_mean": 24.79510564356351, "episode_len_mean": 436.72, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.8607751718358}, "policy_reward_max": {"av": 32.358166503651}, "policy_reward_mean": {"av": 12.335873454509207}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.3918443414134165, "avg_speed_min": 1.1205167755499523, "avg_speed_max": 9.906499337978444, "avg_rl_veh_arrival_mean": 206.95166666666665, "avg_rl_veh_arrival_min": 47.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.291911215614258, "mean_processing_ms": 3.7311474107638145, "mean_inference_ms": 1.1125836423139839}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 70233, "num_steps_trained": 6153000, "num_steps_sampled": 169653, "sample_time_ms": 233.7, "replay_time_ms": 20.093, "grad_time_ms": 25.051, "update_time_ms": 0.007, "opt_peak_throughput": 3991.838, "opt_samples": 100.0, "learner": {"av": {"mean_q": -26.15766143798828, "max_q": 22.513172149658203, "min_q": -96.62565612792969}}}, "timesteps_this_iter": 1011, "done": false, "timesteps_total": 169653, "episodes_total": 401, "training_iteration": 163, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-51-14", "timestamp": 1585777874, "time_this_iter_s": 16.132795095443726, "time_total_s": 4140.7871017456055, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18fd80d0>", "on_episode_step": "<function on_episode_step at 0x7ffa18fd86a8>", "on_episode_end": "<function on_episode_end at 0x7ffa18fd8d08>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ffa18fd88c8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4140.7871017456055, "timesteps_since_restore": 169653, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 87.55217391304348, "ram_util_percent": 64.8826086956522}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.63749703666302, "episode_reward_min": -299.8607751718358, "episode_reward_mean": 20.84746871682527, "episode_len_mean": 433.59, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.8607751718358}, "policy_reward_max": {"av": 32.358166503651}, "policy_reward_mean": {"av": 10.423734358412633}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.310930826824864, "avg_speed_min": 0.7090445832772659, "avg_speed_max": 9.906499337978444, "avg_rl_veh_arrival_mean": 213.395, "avg_rl_veh_arrival_min": 47.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.29370834876039, "mean_processing_ms": 3.7312149301157, "mean_inference_ms": 1.1133857375060456}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 70960, "num_steps_trained": 6225700, "num_steps_sampled": 170825, "sample_time_ms": 212.573, "replay_time_ms": 21.766, "grad_time_ms": 31.054, "update_time_ms": 0.006, "opt_peak_throughput": 3220.195, "opt_samples": 100.0, "learner": {"av": {"mean_q": -21.526348114013672, "max_q": 29.784584045410156, "min_q": -106.51095581054688}}}, "timesteps_this_iter": 1172, "done": false, "timesteps_total": 170825, "episodes_total": 404, "training_iteration": 164, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-52-04", "timestamp": 1585777924, "time_this_iter_s": 50.8054678440094, "time_total_s": 4191.592569589615, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9780a5950>", "on_episode_step": "<function on_episode_step at 0x7ff998081378>", "on_episode_end": "<function on_episode_end at 0x7ff9980810d0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff998081268>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4191.592569589615, "timesteps_since_restore": 170825, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 84.24657534246575, "ram_util_percent": 64.75890410958905}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.63749703666302, "episode_reward_min": -299.8607751718358, "episode_reward_mean": 22.790752749933596, "episode_len_mean": 437.65, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.8607751718358}, "policy_reward_max": {"av": 32.358166503651}, "policy_reward_mean": {"av": 11.33868296016597}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.312266584226812, "avg_speed_min": 0.7090445832772659, "avg_speed_max": 9.906499337978444, "avg_rl_veh_arrival_mean": 215.105, "avg_rl_veh_arrival_min": 47.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.2950315901205456, "mean_processing_ms": 3.7311779012217823, "mean_inference_ms": 1.114008501079704}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 71351, "num_steps_trained": 6264800, "num_steps_sampled": 171845, "sample_time_ms": 193.258, "replay_time_ms": 20.661, "grad_time_ms": 23.411, "update_time_ms": 0.019, "opt_peak_throughput": 4271.516, "opt_samples": 100.0, "learner": {"av": {"mean_q": -23.770009994506836, "max_q": 29.321393966674805, "min_q": -106.70953369140625}}}, "timesteps_this_iter": 1020, "done": false, "timesteps_total": 171845, "episodes_total": 406, "training_iteration": 165, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-52-34", "timestamp": 1585777954, "time_this_iter_s": 29.13221526145935, "time_total_s": 4220.724784851074, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18fd8a60>", "on_episode_step": "<function on_episode_step at 0x7ffa18fd8378>", "on_episode_end": "<function on_episode_end at 0x7ffa18fd88c8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9780c4840>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4220.724784851074, "timesteps_since_restore": 171845, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 85.42439024390244, "ram_util_percent": 64.58536585365853}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.63749703666302, "episode_reward_min": -299.8607751718358, "episode_reward_mean": 20.506358825892054, "episode_len_mean": 433.72, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.8607751718358}, "policy_reward_max": {"av": 32.358166503651}, "policy_reward_mean": {"av": 10.151662785095072}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.31170556994567, "avg_speed_min": 0.7090445832772659, "avg_speed_max": 9.906499337978444, "avg_rl_veh_arrival_mean": 211.76, "avg_rl_veh_arrival_min": 47.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.2970965925962163, "mean_processing_ms": 3.731403964797173, "mean_inference_ms": 1.1149034432916323}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 71570, "num_steps_trained": 6286700, "num_steps_sampled": 172935, "sample_time_ms": 233.011, "replay_time_ms": 21.148, "grad_time_ms": 22.803, "update_time_ms": 0.006, "opt_peak_throughput": 4385.48, "opt_samples": 100.0, "learner": {"av": {"mean_q": -22.127092361450195, "max_q": 27.659393310546875, "min_q": -102.41532135009766}}}, "timesteps_this_iter": 1090, "done": false, "timesteps_total": 172935, "episodes_total": 409, "training_iteration": 166, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-52-53", "timestamp": 1585777973, "time_this_iter_s": 19.18636989593506, "time_total_s": 4239.911154747009, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ffa18fc32f0>", "on_episode_step": "<function on_episode_step at 0x7ffa18fc3ae8>", "on_episode_end": "<function on_episode_end at 0x7ffa18fc3c80>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9780547b8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4239.911154747009, "timesteps_since_restore": 172935, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 77.78214285714286, "ram_util_percent": 64.29642857142856}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.63749703666302, "episode_reward_min": -299.8607751718358, "episode_reward_mean": 23.74587881705419, "episode_len_mean": 437.62, "episodes_this_iter": 2, "policy_reward_min": {"av": -299.8607751718358}, "policy_reward_max": {"av": 32.358166503651}, "policy_reward_mean": {"av": 11.755385552997124}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.36521152007069, "avg_speed_min": 0.7090445832772659, "avg_speed_max": 9.906499337978444, "avg_rl_veh_arrival_mean": 211.12333333333336, "avg_rl_veh_arrival_min": 47.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.29838365231373, "mean_processing_ms": 3.7314784062171658, "mean_inference_ms": 1.1153831812343875}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 71897, "num_steps_trained": 6319400, "num_steps_sampled": 173935, "sample_time_ms": 194.717, "replay_time_ms": 20.177, "grad_time_ms": 27.009, "update_time_ms": 0.006, "opt_peak_throughput": 3702.409, "opt_samples": 100.0, "learner": {"av": {"mean_q": -19.033031463623047, "max_q": 24.295150756835938, "min_q": -121.85869598388672}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 173935, "episodes_total": 411, "training_iteration": 167, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-53-17", "timestamp": 1585777997, "time_this_iter_s": 23.868976831436157, "time_total_s": 4263.780131578445, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9780c4510>", "on_episode_step": "<function on_episode_step at 0x7ff9780c4950>", "on_episode_end": "<function on_episode_end at 0x7ff9780c4730>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9780c4a60>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4263.780131578445, "timesteps_since_restore": 173935, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 83.94999999999999, "ram_util_percent": 63.8}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.63749703666302, "episode_reward_min": -299.8607751718358, "episode_reward_mean": 22.744102366891706, "episode_len_mean": 433.9, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.8607751718358}, "policy_reward_max": {"av": 32.358166503651}, "policy_reward_mean": {"av": 11.149069787692014}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.396322344777802, "avg_speed_min": 0.7090445832772659, "avg_speed_max": 9.906499337978444, "avg_rl_veh_arrival_mean": 209.13833333333332, "avg_rl_veh_arrival_min": 47.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.300375385714251, "mean_processing_ms": 3.7316764165435954, "mean_inference_ms": 1.1160986408783105}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 72197, "num_steps_trained": 6349400, "num_steps_sampled": 175044, "sample_time_ms": 217.573, "replay_time_ms": 19.872, "grad_time_ms": 23.977, "update_time_ms": 0.006, "opt_peak_throughput": 4170.607, "opt_samples": 100.0, "learner": {"av": {"mean_q": -20.41366958618164, "max_q": 24.643144607543945, "min_q": -99.89262390136719}}}, "timesteps_this_iter": 1109, "done": false, "timesteps_total": 175044, "episodes_total": 414, "training_iteration": 168, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-53-41", "timestamp": 1585778021, "time_this_iter_s": 24.093584775924683, "time_total_s": 4287.87371635437, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff9980810d0>", "on_episode_step": "<function on_episode_step at 0x7ff998081400>", "on_episode_end": "<function on_episode_end at 0x7ff998081840>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9980819d8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4287.87371635437, "timesteps_since_restore": 175044, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 81.05588235294118, "ram_util_percent": 64.84411764705882}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.63749703666302, "episode_reward_min": -299.8607751718358, "episode_reward_mean": 23.374602478626844, "episode_len_mean": 433.58, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.8607751718358}, "policy_reward_max": {"av": 32.37566780455816}, "policy_reward_mean": {"av": 11.346894407100407}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.443653761683356, "avg_speed_min": 0.7090445832772659, "avg_speed_max": 9.906499337978444, "avg_rl_veh_arrival_mean": 207.5716666666667, "avg_rl_veh_arrival_min": 47.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.3025196123319085, "mean_processing_ms": 3.7320370133328264, "mean_inference_ms": 1.1168539311290246}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 72555, "num_steps_trained": 6385200, "num_steps_sampled": 176154, "sample_time_ms": 233.917, "replay_time_ms": 19.875, "grad_time_ms": 29.536, "update_time_ms": 0.006, "opt_peak_throughput": 3385.755, "opt_samples": 100.0, "learner": {"av": {"mean_q": -19.94320297241211, "max_q": 22.647899627685547, "min_q": -96.2564468383789}}}, "timesteps_this_iter": 1110, "done": false, "timesteps_total": 176154, "episodes_total": 417, "training_iteration": 169, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-54-09", "timestamp": 1585778049, "time_this_iter_s": 28.224173069000244, "time_total_s": 4316.09788942337, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff99806fe18>", "on_episode_step": "<function on_episode_step at 0x7ff99806f9d8>", "on_episode_end": "<function on_episode_end at 0x7ff9e8712b70>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9780c4bf8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4316.09788942337, "timesteps_since_restore": 176154, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 75.18536585365854, "ram_util_percent": 64.69756097560975}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
{"episode_reward_max": 96.63749703666302, "episode_reward_min": -299.8607751718358, "episode_reward_mean": 25.981190944313667, "episode_len_mean": 437.61, "episodes_this_iter": 3, "policy_reward_min": {"av": -299.8607751718358}, "policy_reward_max": {"av": 32.37566780455816}, "policy_reward_mean": {"av": 12.673751680153009}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.496486483361992, "avg_speed_min": 0.7090445832772659, "avg_speed_max": 9.906499337978444, "avg_rl_veh_arrival_mean": 207.60666666666668, "avg_rl_veh_arrival_min": 47.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 3.304563414828737, "mean_processing_ms": 3.732217644696289, "mean_inference_ms": 1.1174660416981366}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 72824, "num_steps_trained": 6412100, "num_steps_sampled": 177276, "sample_time_ms": 245.932, "replay_time_ms": 21.681, "grad_time_ms": 37.79, "update_time_ms": 0.006, "opt_peak_throughput": 2646.188, "opt_samples": 100.0, "learner": {"av": {"mean_q": -23.63939666748047, "max_q": 23.877832412719727, "min_q": -115.60923767089844}}}, "timesteps_this_iter": 1122, "done": false, "timesteps_total": 177276, "episodes_total": 420, "training_iteration": 170, "experiment_id": "c3d63ec0a4bd41af8cec1cfeed28fe8c", "date": "2020-04-01_14-54-33", "timestamp": 1585778073, "time_this_iter_s": 23.033711194992065, "time_total_s": 4339.131600618362, "pid": 28293, "hostname": "MacBook-Pro.local", "node_ip": "192.168.0.13", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7ff998081d08>", "on_episode_step": "<function on_episode_step at 0x7ff998081950>", "on_episode_end": "<function on_episode_end at 0x7ff998081a60>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7ff9980816a8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 1e-05, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4339.131600618362, "timesteps_since_restore": 177276, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 83.01515151515152, "ram_util_percent": 64.76363636363637}, "num_healthy_workers": 0, "trial_id": "3bce91fa", "experiment_tag": "4_actor_lr=1e-05,critic_lr=1e-05,prioritized_replay=False"}
