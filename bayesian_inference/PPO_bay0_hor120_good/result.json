{"episode_reward_max": 0.3234500301038743, "episode_reward_min": -2.998642525241728, "episode_reward_mean": -1.93455739641652, "episode_len_mean": 488.95238095238096, "episodes_this_iter": 42, "policy_reward_min": {"av": -2.998642525241728}, "policy_reward_max": {"av": 0.3234500301038743}, "policy_reward_mean": {"av": -1.93455739641652}, "custom_metrics": {"num_ped_collisions_mean": 0.6666666666666666, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.023809523809523808, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.075534113930982, "avg_speed_min": 0.865163687556678, "avg_speed_max": 4.133044462202072, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 36.7627499010627, "mean_processing_ms": 3.0024096911665956, "mean_inference_ms": 0.5025810321711165}, "off_policy_estimator": {}, "info": {"num_steps_trained": 11264, "num_steps_sampled": 25044, "sample_time_ms": 77907.895, "load_time_ms": 55.632, "grad_time_ms": 5564.203, "update_time_ms": 957.097, "learner": {"av": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 0.006699019577354193, "policy_loss": -0.019513599574565887, "vf_loss": 0.0216125026345253, "vf_explained_var": 0.9271947741508484, "kl": 0.023000570014119148, "entropy": 1.434333324432373, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25044, "done": false, "timesteps_total": 25044, "episodes_total": 42, "training_iteration": 1, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-03-02", "timestamp": 1588816982, "time_this_iter_s": 84.53353643417358, "time_total_s": 84.53353643417358, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc729044400>", "on_episode_step": "<function on_episode_step at 0x7fc7246dac80>", "on_episode_end": "<function on_episode_end at 0x7fc7246daea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246da268>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7246da7b8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 84.53353643417358, "timesteps_since_restore": 25044, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 87.79586776859503, "ram_util_percent": 31.530578512396694}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.32353931654278795, "episode_reward_min": -2.998666477735245, "episode_reward_mean": -1.7579087191152734, "episode_len_mean": 548.0833333333334, "episodes_this_iter": 42, "policy_reward_min": {"av": -2.998666477735245}, "policy_reward_max": {"av": 0.32353931654278795}, "policy_reward_mean": {"av": -1.7579087191152734}, "custom_metrics": {"num_ped_collisions_mean": 0.6190476190476191, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.011904761904761904, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.0653967665438207, "avg_speed_min": 0.8434029462073588, "avg_speed_max": 4.133044462202072, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 36.45900469831982, "mean_processing_ms": 2.806357623773153, "mean_inference_ms": 0.4933478621654278}, "off_policy_estimator": {}, "info": {"num_steps_trained": 21632, "num_steps_sampled": 51731, "sample_time_ms": 74748.25, "load_time_ms": 29.546, "grad_time_ms": 5170.12, "update_time_ms": 481.482, "learner": {"av": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 9.999999747378752e-05, "total_loss": -0.006118979770690203, "policy_loss": -0.010624031536281109, "vf_loss": 0.0012529415544122458, "vf_explained_var": 0.9882468581199646, "kl": 0.010840366594493389, "entropy": 1.4283075332641602, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26687, "done": false, "timesteps_total": 51731, "episodes_total": 84, "training_iteration": 2, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-04-18", "timestamp": 1588817058, "time_this_iter_s": 76.38664126396179, "time_total_s": 160.92017769813538, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72903af28>", "on_episode_step": "<function on_episode_step at 0x7fc7246ecd90>", "on_episode_end": "<function on_episode_end at 0x7fc7246ecae8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72465fbf8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72461eae8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 160.92017769813538, "timesteps_since_restore": 51731, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 88.94220183486237, "ram_util_percent": 31.804587155963315}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.3236912478682603, "episode_reward_min": -2.998666477735245, "episode_reward_mean": -1.5447316488654064, "episode_len_mean": 618.35, "episodes_this_iter": 44, "policy_reward_min": {"av": -2.998666477735245}, "policy_reward_max": {"av": 0.3236912478682603}, "policy_reward_mean": {"av": -1.5447316488654064}, "custom_metrics": {"num_ped_collisions_mean": 0.56, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.0958698042193458, "avg_speed_min": 0.8434029462073588, "avg_speed_max": 4.170954405912726, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 36.18046974287964, "mean_processing_ms": 2.569172582046433, "mean_inference_ms": 0.4865643869790919}, "off_policy_estimator": {}, "info": {"num_steps_trained": 29056, "num_steps_sampled": 77940, "sample_time_ms": 70085.254, "load_time_ms": 20.404, "grad_time_ms": 4588.161, "update_time_ms": 322.733, "learner": {"av": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 9.999999747378752e-05, "total_loss": 0.008471510373055935, "policy_loss": -0.001503300154581666, "vf_loss": 0.009188576601445675, "vf_explained_var": 0.9691100120544434, "kl": 0.00262076617218554, "entropy": 1.4472718238830566, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26209, "done": false, "timesteps_total": 77940, "episodes_total": 128, "training_iteration": 3, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-05-23", "timestamp": 1588817123, "time_this_iter_s": 64.20291066169739, "time_total_s": 225.12308835983276, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246eca60>", "on_episode_step": "<function on_episode_step at 0x7fc72469b400>", "on_episode_end": "<function on_episode_end at 0x7fc72469be18>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72469b620>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7246dab70>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 225.12308835983276, "timesteps_since_restore": 77940, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 88.675, "ram_util_percent": 31.864130434782613}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.3236912478682603, "episode_reward_min": -2.998828680369761, "episode_reward_mean": -1.4397839215436035, "episode_len_mean": 649.04, "episodes_this_iter": 36, "policy_reward_min": {"av": -2.998828680369761}, "policy_reward_max": {"av": 0.3236912478682603}, "policy_reward_mean": {"av": -1.4397839215436035}, "custom_metrics": {"num_ped_collisions_mean": 0.53, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.24663872383049, "avg_speed_min": 0.9016158229690956, "avg_speed_max": 4.450204545805745, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 35.15323704206041, "mean_processing_ms": 2.5327746316504123, "mean_inference_ms": 0.45742512042487715}, "off_policy_estimator": {}, "info": {"num_steps_trained": 36096, "num_steps_sampled": 104845, "sample_time_ms": 67566.949, "load_time_ms": 15.822, "grad_time_ms": 4247.658, "update_time_ms": 243.301, "learner": {"av": {"cur_kl_coeff": 0.15000000596046448, "cur_lr": 9.999999747378752e-05, "total_loss": -0.004695763345807791, "policy_loss": -0.006844533607363701, "vf_loss": 0.0007269956404343247, "vf_explained_var": 0.9933357238769531, "kl": 0.009478511288762093, "entropy": 1.3824812173843384, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26905, "done": false, "timesteps_total": 104845, "episodes_total": 164, "training_iteration": 4, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-06-26", "timestamp": 1588817186, "time_this_iter_s": 63.257120847702026, "time_total_s": 288.3802092075348, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc729044400>", "on_episode_step": "<function on_episode_step at 0x7fc7246ecae8>", "on_episode_end": "<function on_episode_end at 0x7fc7246ecd90>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72461eae8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725972c80>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 288.3802092075348, "timesteps_since_restore": 104845, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 89.56888888888889, "ram_util_percent": 31.887777777777778}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.3237285521625347, "episode_reward_min": -2.998828680369761, "episode_reward_mean": -1.3168710316369827, "episode_len_mean": 680.75, "episodes_this_iter": 46, "policy_reward_min": {"av": -2.998828680369761}, "policy_reward_max": {"av": 0.3237285521625347}, "policy_reward_mean": {"av": -1.3168710316369827}, "custom_metrics": {"num_ped_collisions_mean": 0.49, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.517347136595528, "avg_speed_min": 1.1069485972399749, "avg_speed_max": 4.460133378920463, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 33.529217272148884, "mean_processing_ms": 2.4050790636807995, "mean_inference_ms": 0.4210951604659996}, "off_policy_estimator": {}, "info": {"num_steps_trained": 40448, "num_steps_sampled": 133955, "sample_time_ms": 64533.453, "load_time_ms": 12.987, "grad_time_ms": 3798.908, "update_time_ms": 195.937, "learner": {"av": {"cur_kl_coeff": 0.15000000596046448, "cur_lr": 9.999999747378752e-05, "total_loss": 0.04698831960558891, "policy_loss": -0.0028999503701925278, "vf_loss": 0.04784589260816574, "vf_explained_var": 0.9116339087486267, "kl": 0.013615842908620834, "entropy": 1.4766514301300049, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 29110, "done": false, "timesteps_total": 133955, "episodes_total": 210, "training_iteration": 5, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-07-21", "timestamp": 1588817241, "time_this_iter_s": 54.42320775985718, "time_total_s": 342.80341696739197, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246ec9d8>", "on_episode_step": "<function on_episode_step at 0x7fc72469be18>", "on_episode_end": "<function on_episode_end at 0x7fc72469b400>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246dab70>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725a0f7b8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 342.80341696739197, "timesteps_since_restore": 133955, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 87.98717948717949, "ram_util_percent": 31.896153846153858}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.3237285521625347, "episode_reward_min": -2.9987046763559277, "episode_reward_mean": -1.4291896060250722, "episode_len_mean": 641.81, "episodes_this_iter": 43, "policy_reward_min": {"av": -2.9987046763559277}, "policy_reward_max": {"av": 0.3237285521625347}, "policy_reward_mean": {"av": -1.4291896060250722}, "custom_metrics": {"num_ped_collisions_mean": 0.52, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.5942662692435148, "avg_speed_min": 1.4541218870452313, "avg_speed_max": 4.533965648972916, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.656052924207135, "mean_processing_ms": 2.3248701725385477, "mean_inference_ms": 0.3778977551671623}, "off_policy_estimator": {}, "info": {"num_steps_trained": 46080, "num_steps_sampled": 159043, "sample_time_ms": 62382.131, "load_time_ms": 11.143, "grad_time_ms": 3599.378, "update_time_ms": 164.238, "learner": {"av": {"cur_kl_coeff": 0.15000000596046448, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0032917307689785957, "policy_loss": -0.009724721312522888, "vf_loss": 0.011193666607141495, "vf_explained_var": 0.9774999022483826, "kl": 0.012151896953582764, "entropy": 1.4966200590133667, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 159043, "episodes_total": 253, "training_iteration": 6, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-08-15", "timestamp": 1588817295, "time_this_iter_s": 54.24581170082092, "time_total_s": 397.0492286682129, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72465fbf8>", "on_episode_step": "<function on_episode_step at 0x7fc7246ecd90>", "on_episode_end": "<function on_episode_end at 0x7fc7246ecae8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725972c80>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724682510>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 397.0492286682129, "timesteps_since_restore": 159043, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 88.64615384615385, "ram_util_percent": 31.89743589743591}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.32362769982946604, "episode_reward_min": -2.9987230652117374, "episode_reward_mean": -1.6287879875389855, "episode_len_mean": 577.99, "episodes_this_iter": 50, "policy_reward_min": {"av": -2.9987230652117374}, "policy_reward_max": {"av": 0.32362769982946604}, "policy_reward_mean": {"av": -1.6287879875389855}, "custom_metrics": {"num_ped_collisions_mean": 0.58, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.6139044810126855, "avg_speed_min": 2.5898946021893967, "avg_speed_max": 4.533965648972916, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 30.419695529995888, "mean_processing_ms": 2.350001986620321, "mean_inference_ms": 0.34986864590117717}, "off_policy_estimator": {}, "info": {"num_steps_trained": 51072, "num_steps_sampled": 186366, "sample_time_ms": 61010.154, "load_time_ms": 9.807, "grad_time_ms": 3412.907, "update_time_ms": 141.642, "learner": {"av": {"cur_kl_coeff": 0.15000000596046448, "cur_lr": 9.999999747378752e-05, "total_loss": 0.03463943675160408, "policy_loss": -0.0032901375088840723, "vf_loss": 0.03726976737380028, "vf_explained_var": 0.9357495307922363, "kl": 0.004398694261908531, "entropy": 1.4512710571289062, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27323, "done": false, "timesteps_total": 186366, "episodes_total": 303, "training_iteration": 7, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-09-10", "timestamp": 1588817350, "time_this_iter_s": 55.0924437046051, "time_total_s": 452.141672372818, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72461eae8>", "on_episode_step": "<function on_episode_step at 0x7fc72469b400>", "on_episode_end": "<function on_episode_end at 0x7fc72469be18>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725a0f7b8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724682158>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 452.141672372818, "timesteps_since_restore": 186366, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 87.87564102564102, "ram_util_percent": 31.90000000000001}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.32363985929361194, "episode_reward_min": -2.9987230652117374, "episode_reward_mean": -1.3096782611093982, "episode_len_mean": 671.16, "episodes_this_iter": 34, "policy_reward_min": {"av": -2.9987230652117374}, "policy_reward_max": {"av": 0.32363985929361194}, "policy_reward_mean": {"av": -1.3096782611093982}, "custom_metrics": {"num_ped_collisions_mean": 0.48, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.5806886642432727, "avg_speed_min": 2.320834315138227, "avg_speed_max": 4.533965648972916, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 29.957262498171364, "mean_processing_ms": 2.2948665864358, "mean_inference_ms": 0.3399501058988635}, "off_policy_estimator": {}, "info": {"num_steps_trained": 56832, "num_steps_sampled": 215340, "sample_time_ms": 60598.347, "load_time_ms": 8.808, "grad_time_ms": 3316.73, "update_time_ms": 124.781, "learner": {"av": {"cur_kl_coeff": 0.07500000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 0.010618277825415134, "policy_loss": -0.0038777305744588375, "vf_loss": 0.013840856961905956, "vf_explained_var": 0.8910176753997803, "kl": 0.008735339157283306, "entropy": 1.424298644065857, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28974, "done": false, "timesteps_total": 215340, "episodes_total": 337, "training_iteration": 8, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-10-11", "timestamp": 1588817411, "time_this_iter_s": 60.37915897369385, "time_total_s": 512.5208313465118, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc725a0ff28>", "on_episode_step": "<function on_episode_step at 0x7fc725a0fa60>", "on_episode_end": "<function on_episode_end at 0x7fc725a0fb70>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725a0fbf8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725972f28>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 512.5208313465118, "timesteps_since_restore": 215340, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 88.0712643678161, "ram_util_percent": 31.89885057471265}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.3236827859406147, "episode_reward_min": -2.998795453721819, "episode_reward_mean": -1.0976572227487302, "episode_len_mean": 743.24, "episodes_this_iter": 37, "policy_reward_min": {"av": -2.998795453721819}, "policy_reward_max": {"av": 0.3236827859406147}, "policy_reward_mean": {"av": -1.0976572227487302}, "custom_metrics": {"num_ped_collisions_mean": 0.42, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.6075174008302997, "avg_speed_min": 2.320834315138227, "avg_speed_max": 4.2775159936981995, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 29.37946649544992, "mean_processing_ms": 2.2568005721921627, "mean_inference_ms": 0.32691699990699996}, "off_policy_estimator": {}, "info": {"num_steps_trained": 61824, "num_steps_sampled": 246228, "sample_time_ms": 60238.073, "load_time_ms": 8.013, "grad_time_ms": 3203.066, "update_time_ms": 111.528, "learner": {"av": {"cur_kl_coeff": 0.07500000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": -0.010652127675712109, "policy_loss": -0.013252124190330505, "vf_loss": 0.0018097340362146497, "vf_explained_var": 0.9714785814285278, "kl": 0.010536817833781242, "entropy": 1.4725929498672485, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 30888, "done": false, "timesteps_total": 246228, "episodes_total": 374, "training_iteration": 9, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-11-10", "timestamp": 1588817470, "time_this_iter_s": 59.668641805648804, "time_total_s": 572.1894731521606, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc729044400>", "on_episode_step": "<function on_episode_step at 0x7fc725972730>", "on_episode_end": "<function on_episode_end at 0x7fc7259722f0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725972d08>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72469be18>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 572.1894731521606, "timesteps_since_restore": 246228, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 88.60352941176471, "ram_util_percent": 31.900000000000006}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.3236827859406147, "episode_reward_min": -2.998795453721819, "episode_reward_mean": -1.1843438675256084, "episode_len_mean": 721.63, "episodes_this_iter": 46, "policy_reward_min": {"av": -2.998795453721819}, "policy_reward_max": {"av": 0.3236827859406147}, "policy_reward_mean": {"av": -1.1843438675256084}, "custom_metrics": {"num_ped_collisions_mean": 0.45, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.693944853541444, "avg_speed_min": 2.320834315138227, "avg_speed_max": 4.230511966986243, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 28.540287439737753, "mean_processing_ms": 2.236661014754183, "mean_inference_ms": 0.30692967936977933}, "off_policy_estimator": {}, "info": {"num_steps_trained": 66560, "num_steps_sampled": 274153, "sample_time_ms": 59498.484, "load_time_ms": 7.367, "grad_time_ms": 3101.956, "update_time_ms": 100.938, "learner": {"av": {"cur_kl_coeff": 0.07500000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": -0.009243357926607132, "policy_loss": -0.010655001737177372, "vf_loss": 0.00030653103021904826, "vf_explained_var": 0.9994191527366638, "kl": 0.014734798111021519, "entropy": 1.490191102027893, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27925, "done": false, "timesteps_total": 274153, "episodes_total": 420, "training_iteration": 10, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-12-05", "timestamp": 1588817525, "time_this_iter_s": 55.053861141204834, "time_total_s": 627.2433342933655, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc725972ae8>", "on_episode_step": "<function on_episode_step at 0x7fc725972f28>", "on_episode_end": "<function on_episode_end at 0x7fc725a0f9d8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725a0f7b8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72469bea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 627.2433342933655, "timesteps_since_restore": 274153, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 88.78846153846156, "ram_util_percent": 31.90256410256411}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.3235756299227705, "episode_reward_min": -2.998693860560795, "episode_reward_mean": -1.4702400345651092, "episode_len_mean": 638.59, "episodes_this_iter": 48, "policy_reward_min": {"av": -2.998693860560795}, "policy_reward_max": {"av": 0.3235756299227705}, "policy_reward_mean": {"av": -1.4702400345651092}, "custom_metrics": {"num_ped_collisions_mean": 0.54, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.781202791595579, "avg_speed_min": 2.3670452126453227, "avg_speed_max": 4.38945144895234, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 27.835279222961418, "mean_processing_ms": 2.284032767902437, "mean_inference_ms": 0.29042301866926334}, "off_policy_estimator": {}, "info": {"num_steps_trained": 70784, "num_steps_sampled": 304798, "sample_time_ms": 57130.103, "load_time_ms": 2.016, "grad_time_ms": 2740.476, "update_time_ms": 5.753, "learner": {"av": {"cur_kl_coeff": 0.07500000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": -0.009051087312400341, "policy_loss": -0.012033349834382534, "vf_loss": 0.000523861963301897, "vf_explained_var": 0.9991859793663025, "kl": 0.03277862071990967, "entropy": 1.5192749500274658, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 30645, "done": false, "timesteps_total": 304798, "episodes_total": 468, "training_iteration": 11, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-13-02", "timestamp": 1588817582, "time_this_iter_s": 56.19208097457886, "time_total_s": 683.4354152679443, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc725e99ea0>", "on_episode_step": "<function on_episode_step at 0x7fc725972c80>", "on_episode_end": "<function on_episode_end at 0x7fc725972d08>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7259722f0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72469b8c8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 683.4354152679443, "timesteps_since_restore": 304798, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 86.64567901234568, "ram_util_percent": 31.900000000000002}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.32371784895833805, "episode_reward_min": -2.9986779861550623, "episode_reward_mean": -1.4495734510377474, "episode_len_mean": 642.2, "episodes_this_iter": 54, "policy_reward_min": {"av": -2.9986779861550623}, "policy_reward_max": {"av": 0.32371784895833805}, "policy_reward_mean": {"av": -1.4495734510377474}, "custom_metrics": {"num_ped_collisions_mean": 0.53, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.8612762070054085, "avg_speed_min": 2.9910566142769217, "avg_speed_max": 4.444312557374564, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 27.278241397231312, "mean_processing_ms": 2.2619154029456316, "mean_inference_ms": 0.27930710081842297}, "off_policy_estimator": {}, "info": {"num_steps_trained": 74624, "num_steps_sampled": 337659, "sample_time_ms": 55473.008, "load_time_ms": 1.827, "grad_time_ms": 2438.894, "update_time_ms": 5.725, "learner": {"av": {"cur_kl_coeff": 0.11249999701976776, "cur_lr": 9.999999747378752e-05, "total_loss": 0.03309883549809456, "policy_loss": -0.005478285253047943, "vf_loss": 0.036576129496097565, "vf_explained_var": 0.9623611569404602, "kl": 0.017786579206585884, "entropy": 1.525281548500061, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 32861, "done": false, "timesteps_total": 337659, "episodes_total": 522, "training_iteration": 12, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-13-59", "timestamp": 1588817639, "time_this_iter_s": 56.79774212837219, "time_total_s": 740.2331573963165, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc729044400>", "on_episode_step": "<function on_episode_step at 0x7fc72469b510>", "on_episode_end": "<function on_episode_end at 0x7fc725972ae8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725972f28>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72461eae8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 740.2331573963165, "timesteps_since_restore": 337659, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 88.05555555555556, "ram_util_percent": 31.900000000000002}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.32371784895833805, "episode_reward_min": -2.998696695372816, "episode_reward_mean": -1.4495533787959494, "episode_len_mean": 643.22, "episodes_this_iter": 43, "policy_reward_min": {"av": -2.998696695372816}, "policy_reward_max": {"av": 0.32371784895833805}, "policy_reward_mean": {"av": -1.4495533787959494}, "custom_metrics": {"num_ped_collisions_mean": 0.53, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.8709254211157407, "avg_speed_min": 2.8664832752375466, "avg_speed_max": 4.65652507375367, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 27.076368615447546, "mean_processing_ms": 2.1906940013233935, "mean_inference_ms": 0.2754440259725602}, "off_policy_estimator": {}, "info": {"num_steps_trained": 79488, "num_steps_sampled": 365884, "sample_time_ms": 54717.463, "load_time_ms": 1.781, "grad_time_ms": 2319.197, "update_time_ms": 5.728, "learner": {"av": {"cur_kl_coeff": 0.11249999701976776, "cur_lr": 9.999999747378752e-05, "total_loss": -0.008198648691177368, "policy_loss": -0.011456054635345936, "vf_loss": 0.0014491790207102895, "vf_explained_var": 0.9981142282485962, "kl": 0.016073130071163177, "entropy": 1.5244532823562622, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28225, "done": false, "timesteps_total": 365884, "episodes_total": 565, "training_iteration": 13, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-14-54", "timestamp": 1588817694, "time_this_iter_s": 55.45019769668579, "time_total_s": 795.6833550930023, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72469bea0>", "on_episode_step": "<function on_episode_step at 0x7fc72469b950>", "on_episode_end": "<function on_episode_end at 0x7fc72469b488>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725e99ea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72461ed90>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 795.6833550930023, "timesteps_since_restore": 365884, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 88.10886075949368, "ram_util_percent": 31.90000000000001}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.3237129804690349, "episode_reward_min": -2.998696695372816, "episode_reward_mean": -1.6487441725274834, "episode_len_mean": 587.45, "episodes_this_iter": 56, "policy_reward_min": {"av": -2.998696695372816}, "policy_reward_max": {"av": 0.3237129804690349}, "policy_reward_mean": {"av": -1.6487441725274834}, "custom_metrics": {"num_ped_collisions_mean": 0.59, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.7170282123485525, "avg_speed_min": 2.2910242998894352, "avg_speed_max": 4.65652507375367, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 26.825079045995036, "mean_processing_ms": 2.2092383858905977, "mean_inference_ms": 0.27042652119701655}, "off_policy_estimator": {}, "info": {"num_steps_trained": 83840, "num_steps_sampled": 395831, "sample_time_ms": 54075.098, "load_time_ms": 1.735, "grad_time_ms": 2196.246, "update_time_ms": 5.948, "learner": {"av": {"cur_kl_coeff": 0.11249999701976776, "cur_lr": 9.999999747378752e-05, "total_loss": 0.01676323264837265, "policy_loss": -0.015963038429617882, "vf_loss": 0.029992390424013138, "vf_explained_var": 0.9821093082427979, "kl": 0.024301130324602127, "entropy": 1.637170433998108, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 29947, "done": false, "timesteps_total": 395831, "episodes_total": 621, "training_iteration": 14, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-15-50", "timestamp": 1588817750, "time_this_iter_s": 55.60587763786316, "time_total_s": 851.2892327308655, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72903af28>", "on_episode_step": "<function on_episode_step at 0x7fc72465fbf8>", "on_episode_end": "<function on_episode_end at 0x7fc729044400>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72469b8c8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725972d90>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 851.2892327308655, "timesteps_since_restore": 395831, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 86.59113924050632, "ram_util_percent": 31.90000000000001}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.3237129804690349, "episode_reward_min": -2.9986287504327485, "episode_reward_mean": -1.4162233291584638, "episode_len_mean": 665.91, "episodes_this_iter": 35, "policy_reward_min": {"av": -2.9986287504327485}, "policy_reward_max": {"av": 0.3237129804690349}, "policy_reward_mean": {"av": -1.4162233291584638}, "custom_metrics": {"num_ped_collisions_mean": 0.52, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.641930315983124, "avg_speed_min": 1.7765138533338278, "avg_speed_max": 4.467010877546608, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 26.567974307705335, "mean_processing_ms": 2.226266483248023, "mean_inference_ms": 0.26495255463027423}, "off_policy_estimator": {}, "info": {"num_steps_trained": 88832, "num_steps_sampled": 427872, "sample_time_ms": 54661.562, "load_time_ms": 1.739, "grad_time_ms": 2224.891, "update_time_ms": 5.982, "learner": {"av": {"cur_kl_coeff": 0.16875000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 0.011632214300334454, "policy_loss": -0.00491007324308157, "vf_loss": 0.01474414300173521, "vf_explained_var": 0.983538031578064, "kl": 0.010655656456947327, "entropy": 1.5728775262832642, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 32041, "done": false, "timesteps_total": 427872, "episodes_total": 656, "training_iteration": 15, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-16-51", "timestamp": 1588817811, "time_this_iter_s": 60.57457733154297, "time_total_s": 911.8638100624084, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72465fe18>", "on_episode_step": "<function on_episode_step at 0x7fc72469b950>", "on_episode_end": "<function on_episode_end at 0x7fc72469bea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725e99ea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725a0fea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 911.8638100624084, "timesteps_since_restore": 427872, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 89.22643678160918, "ram_util_percent": 31.900000000000006}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.323709547184917, "episode_reward_min": -2.9986287504327485, "episode_reward_mean": -1.1172857451782898, "episode_len_mean": 773.22, "episodes_this_iter": 39, "policy_reward_min": {"av": -2.9986287504327485}, "policy_reward_max": {"av": 0.323709547184917}, "policy_reward_mean": {"av": -1.1172857451782898}, "custom_metrics": {"num_ped_collisions_mean": 0.43, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.468104224955314, "avg_speed_min": 1.4851762639821207, "avg_speed_max": 4.467010877546608, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 26.413199855406592, "mean_processing_ms": 2.1876987608672547, "mean_inference_ms": 0.2619462902124774}, "off_policy_estimator": {}, "info": {"num_steps_trained": 94848, "num_steps_sampled": 456912, "sample_time_ms": 55326.193, "load_time_ms": 1.746, "grad_time_ms": 2239.292, "update_time_ms": 6.135, "learner": {"av": {"cur_kl_coeff": 0.16875000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 0.1399131566286087, "policy_loss": -0.008132402785122395, "vf_loss": 0.14602990448474884, "vf_explained_var": 0.896550178527832, "kl": 0.011944741941988468, "entropy": 1.7556723356246948, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 29040, "done": false, "timesteps_total": 456912, "episodes_total": 695, "training_iteration": 16, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-17-52", "timestamp": 1588817872, "time_this_iter_s": 61.03828024864197, "time_total_s": 972.9020903110504, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72469b488>", "on_episode_step": "<function on_episode_step at 0x7fc72903af28>", "on_episode_end": "<function on_episode_end at 0x7fc725e9ee18>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc729044400>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725a0f9d8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 972.9020903110504, "timesteps_since_restore": 456912, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 89.55287356321841, "ram_util_percent": 31.902298850574716}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.3237162329035568, "episode_reward_min": -2.998540813296548, "episode_reward_mean": -0.984586788400807, "episode_len_mean": 827.97, "episodes_this_iter": 31, "policy_reward_min": {"av": -2.998540813296548}, "policy_reward_max": {"av": 0.3237162329035568}, "policy_reward_mean": {"av": -0.984586788400807}, "custom_metrics": {"num_ped_collisions_mean": 0.39, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.3353384127630057, "avg_speed_min": 1.385630686529361, "avg_speed_max": 4.568876537044126, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 26.449005308641247, "mean_processing_ms": 2.166308057339786, "mean_inference_ms": 0.2611247111936486}, "off_policy_estimator": {}, "info": {"num_steps_trained": 101120, "num_steps_sampled": 484452, "sample_time_ms": 55862.874, "load_time_ms": 1.762, "grad_time_ms": 2298.622, "update_time_ms": 6.053, "learner": {"av": {"cur_kl_coeff": 0.16875000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 0.15805159509181976, "policy_loss": -0.006354413460940123, "vf_loss": 0.16300679743289948, "vf_explained_var": 0.825293779373169, "kl": 0.008291542530059814, "entropy": 1.787208914756775, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27540, "done": false, "timesteps_total": 484452, "episodes_total": 726, "training_iteration": 17, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-18-53", "timestamp": 1588817933, "time_this_iter_s": 61.05122637748718, "time_total_s": 1033.9533166885376, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72465fea0>", "on_episode_step": "<function on_episode_step at 0x7fc72465fbf8>", "on_episode_end": "<function on_episode_end at 0x7fc72465fe18>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725e99ea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725a0f620>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1033.9533166885376, "timesteps_since_restore": 484452, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 89.35402298850573, "ram_util_percent": 31.904597701149427}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.3237162329035568, "episode_reward_min": -2.998540813296548, "episode_reward_mean": -1.0560052385005654, "episode_len_mean": 805.52, "episodes_this_iter": 28, "policy_reward_min": {"av": -2.998540813296548}, "policy_reward_max": {"av": 0.3237162329035568}, "policy_reward_mean": {"av": -1.0560052385005654}, "custom_metrics": {"num_ped_collisions_mean": 0.4, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.0137217994856917, "avg_speed_min": 1.150193609118976, "avg_speed_max": 4.568876537044126, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 26.622674836674232, "mean_processing_ms": 2.1231009365125306, "mean_inference_ms": 0.2650111705376712}, "off_policy_estimator": {}, "info": {"num_steps_trained": 110720, "num_steps_sampled": 509238, "sample_time_ms": 56714.43, "load_time_ms": 1.827, "grad_time_ms": 2473.574, "update_time_ms": 5.885, "learner": {"av": {"cur_kl_coeff": 0.16875000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 0.3902004361152649, "policy_loss": -0.0041892752051353455, "vf_loss": 0.39260241389274597, "vf_explained_var": 0.4294666647911072, "kl": 0.0105915367603302, "entropy": 1.8359102010726929, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 24786, "done": false, "timesteps_total": 509238, "episodes_total": 754, "training_iteration": 18, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-20-04", "timestamp": 1588818004, "time_this_iter_s": 70.64385533332825, "time_total_s": 1104.5971720218658, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72469b950>", "on_episode_step": "<function on_episode_step at 0x7fc72469bea0>", "on_episode_end": "<function on_episode_end at 0x7fc72469b488>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc729044400>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72461ed90>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1104.5971720218658, "timesteps_since_restore": 509238, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 90.73564356435642, "ram_util_percent": 31.949504950495047}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.3237277459634403, "episode_reward_min": -2.998407520547351, "episode_reward_mean": -0.8696316617959096, "episode_len_mean": 859.2, "episodes_this_iter": 28, "policy_reward_min": {"av": -2.998407520547351}, "policy_reward_max": {"av": 0.3237277459634403}, "policy_reward_mean": {"av": -0.8696316617959096}, "custom_metrics": {"num_ped_collisions_mean": 0.34, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.972305312696924, "avg_speed_min": 1.150193609118976, "avg_speed_max": 4.945403233492143, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 26.78807409784621, "mean_processing_ms": 2.097308777871773, "mean_inference_ms": 0.26861264612616736}, "off_policy_estimator": {}, "info": {"num_steps_trained": 117120, "num_steps_sampled": 537579, "sample_time_ms": 56936.943, "load_time_ms": 1.865, "grad_time_ms": 2537.438, "update_time_ms": 5.897, "learner": {"av": {"cur_kl_coeff": 0.16875000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 0.20191118121147156, "policy_loss": -0.000612040632404387, "vf_loss": 0.2016526609659195, "vf_explained_var": 0.552678644657135, "kl": 0.005158731248229742, "entropy": 1.773932933807373, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28341, "done": false, "timesteps_total": 537579, "episodes_total": 782, "training_iteration": 19, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-21-06", "timestamp": 1588818066, "time_this_iter_s": 62.533118724823, "time_total_s": 1167.1302907466888, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72903af28>", "on_episode_step": "<function on_episode_step at 0x7fc72465fbf8>", "on_episode_end": "<function on_episode_end at 0x7fc72465fea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725e99ea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72461eae8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1167.1302907466888, "timesteps_since_restore": 537579, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 88.94777777777777, "ram_util_percent": 31.98777777777778}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.3237277459634403, "episode_reward_min": -2.998178032507153, "episode_reward_mean": -0.7036258317377585, "episode_len_mean": 912.61, "episodes_this_iter": 32, "policy_reward_min": {"av": -2.998178032507153}, "policy_reward_max": {"av": 0.3237277459634403}, "policy_reward_mean": {"av": -0.7036258317377585}, "custom_metrics": {"num_ped_collisions_mean": 0.29, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.965151721920617, "avg_speed_min": 1.1231670417610178, "avg_speed_max": 4.986120402715068, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 27.05106833365227, "mean_processing_ms": 2.0658405086261693, "mean_inference_ms": 0.27390365285332896}, "off_policy_estimator": {}, "info": {"num_steps_trained": 124416, "num_steps_sampled": 566303, "sample_time_ms": 57948.133, "load_time_ms": 1.925, "grad_time_ms": 2651.668, "update_time_ms": 5.931, "learner": {"av": {"cur_kl_coeff": 0.16875000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 0.3352106213569641, "policy_loss": -0.00035284680780023336, "vf_loss": 0.33484023809432983, "vf_explained_var": 0.48123034834861755, "kl": 0.004285892937332392, "entropy": 1.8905757665634155, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28724, "done": false, "timesteps_total": 566303, "episodes_total": 814, "training_iteration": 20, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-22-13", "timestamp": 1588818133, "time_this_iter_s": 66.30900573730469, "time_total_s": 1233.4392964839935, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72465fe18>", "on_episode_step": "<function on_episode_step at 0x7fc725a0f510>", "on_episode_end": "<function on_episode_end at 0x7fc725a0f730>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725a0fd90>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725972730>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1233.4392964839935, "timesteps_since_restore": 566303, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 90.59787234042552, "ram_util_percent": 31.99042553191489}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.32375113065982586, "episode_reward_min": -2.9982593300726075, "episode_reward_mean": -0.6706387017650763, "episode_len_mean": 920.84, "episodes_this_iter": 29, "policy_reward_min": {"av": -2.9982593300726075}, "policy_reward_max": {"av": 0.32375113065982586}, "policy_reward_mean": {"av": -0.6706387017650763}, "custom_metrics": {"num_ped_collisions_mean": 0.28, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9216027232342374, "avg_speed_min": 1.1231670417610178, "avg_speed_max": 4.986120402715068, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 27.235798910217905, "mean_processing_ms": 2.0557026336862445, "mean_inference_ms": 0.27733457833577363}, "off_policy_estimator": {}, "info": {"num_steps_trained": 133376, "num_steps_sampled": 593605, "sample_time_ms": 59285.393, "load_time_ms": 1.954, "grad_time_ms": 2866.261, "update_time_ms": 5.993, "learner": {"av": {"cur_kl_coeff": 0.08437500149011612, "cur_lr": 9.999999747378752e-05, "total_loss": 0.27521905303001404, "policy_loss": -0.005782952066510916, "vf_loss": 0.2781315743923187, "vf_explained_var": 0.43310117721557617, "kl": 0.03402002900838852, "entropy": 1.8753485679626465, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27302, "done": false, "timesteps_total": 593605, "episodes_total": 843, "training_iteration": 21, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-23-25", "timestamp": 1588818205, "time_this_iter_s": 71.71335196495056, "time_total_s": 1305.152648448944, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc725e9ee18>", "on_episode_step": "<function on_episode_step at 0x7fc72465fbf8>", "on_episode_end": "<function on_episode_end at 0x7fc72903af28>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725e99ea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725972ea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1305.152648448944, "timesteps_since_restore": 593605, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 90.50776699029127, "ram_util_percent": 32.01067961165048}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.32375113065982586, "episode_reward_min": -2.9982593300726075, "episode_reward_mean": -0.4792025536940154, "episode_len_mean": 980.4, "episodes_this_iter": 21, "policy_reward_min": {"av": -2.9982593300726075}, "policy_reward_max": {"av": 0.32375113065982586}, "policy_reward_mean": {"av": -0.4792025536940154}, "custom_metrics": {"num_ped_collisions_mean": 0.23, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.946701115178199, "avg_speed_min": 1.1231670417610178, "avg_speed_max": 4.986120402715068, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 27.321003962056096, "mean_processing_ms": 2.049833206491832, "mean_inference_ms": 0.2784172966170816}, "off_policy_estimator": {}, "info": {"num_steps_trained": 141952, "num_steps_sampled": 619472, "sample_time_ms": 60263.189, "load_time_ms": 2.033, "grad_time_ms": 3082.028, "update_time_ms": 5.987, "learner": {"av": {"cur_kl_coeff": 0.12656250596046448, "cur_lr": 9.999999747378752e-05, "total_loss": 0.07551276683807373, "policy_loss": -0.0017261517932638526, "vf_loss": 0.07587262988090515, "vf_explained_var": 0.5670381784439087, "kl": 0.010795306414365768, "entropy": 1.9996991157531738, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25867, "done": false, "timesteps_total": 619472, "episodes_total": 864, "training_iteration": 22, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-24-33", "timestamp": 1588818273, "time_this_iter_s": 68.73442673683167, "time_total_s": 1373.8870751857758, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc725a0f730>", "on_episode_step": "<function on_episode_step at 0x7fc725a0f510>", "on_episode_end": "<function on_episode_end at 0x7fc72465fea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72465fe18>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72469bea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1373.8870751857758, "timesteps_since_restore": 619472, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 89.58469387755102, "ram_util_percent": 32.0}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.32375113065982586, "episode_reward_min": -2.9982593300726075, "episode_reward_mean": -0.30027163854459277, "episode_len_mean": 1033.23, "episodes_this_iter": 23, "policy_reward_min": {"av": -2.9982593300726075}, "policy_reward_max": {"av": 0.32375113065982586}, "policy_reward_mean": {"av": -0.30027163854459277}, "custom_metrics": {"num_ped_collisions_mean": 0.18, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.810907795166477, "avg_speed_min": 1.1231670417610178, "avg_speed_max": 4.986120402715068, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 27.554749836233917, "mean_processing_ms": 2.0308762499926205, "mean_inference_ms": 0.2827681928068539}, "off_policy_estimator": {}, "info": {"num_steps_trained": 151168, "num_steps_sampled": 646287, "sample_time_ms": 61684.1, "load_time_ms": 2.119, "grad_time_ms": 3281.039, "update_time_ms": 6.039, "learner": {"av": {"cur_kl_coeff": 0.12656250596046448, "cur_lr": 9.999999747378752e-05, "total_loss": 0.04719884321093559, "policy_loss": -0.00724019855260849, "vf_loss": 0.05041056498885155, "vf_explained_var": 0.5561502575874329, "kl": 0.03182992339134216, "entropy": 2.146181344985962, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26815, "done": false, "timesteps_total": 646287, "episodes_total": 887, "training_iteration": 23, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-25-45", "timestamp": 1588818345, "time_this_iter_s": 71.65138077735901, "time_total_s": 1445.5384559631348, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72465fbf8>", "on_episode_step": "<function on_episode_step at 0x7fc725e9ee18>", "on_episode_end": "<function on_episode_end at 0x7fc725e99ea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725972510>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72469be18>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1445.5384559631348, "timesteps_since_restore": 646287, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 91.46176470588236, "ram_util_percent": 32.0}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.32375113065982586, "episode_reward_min": -2.9983446490628842, "episode_reward_mean": -0.16751157742514167, "episode_len_mean": 1068.27, "episodes_this_iter": 23, "policy_reward_min": {"av": -2.9983446490628842}, "policy_reward_max": {"av": 0.32375113065982586}, "policy_reward_mean": {"av": -0.16751157742514167}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.683670644845422, "avg_speed_min": 1.0147239608904228, "avg_speed_max": 4.916843186130672, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 27.859211552537854, "mean_processing_ms": 2.004738928830176, "mean_inference_ms": 0.28890438408082775}, "off_policy_estimator": {}, "info": {"num_steps_trained": 161280, "num_steps_sampled": 672009, "sample_time_ms": 63270.571, "load_time_ms": 2.226, "grad_time_ms": 3542.429, "update_time_ms": 5.906, "learner": {"av": {"cur_kl_coeff": 0.18984374403953552, "cur_lr": 9.999999747378752e-05, "total_loss": 0.13029655814170837, "policy_loss": 0.0009118707966990769, "vf_loss": 0.12893140316009521, "vf_explained_var": 0.2411077916622162, "kl": 0.002387824235484004, "entropy": 2.1947312355041504, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25722, "done": false, "timesteps_total": 672009, "episodes_total": 910, "training_iteration": 24, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-26-59", "timestamp": 1588818419, "time_this_iter_s": 74.08436965942383, "time_total_s": 1519.6228256225586, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72903af28>", "on_episode_step": "<function on_episode_step at 0x7fc725a0f730>", "on_episode_end": "<function on_episode_end at 0x7fc72465fea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72465fe18>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72461eae8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1519.6228256225586, "timesteps_since_restore": 672009, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 90.95849056603774, "ram_util_percent": 32.0}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.32375113065982586, "episode_reward_min": -2.998592435934801, "episode_reward_mean": -0.0880212434833758, "episode_len_mean": 1094.49, "episodes_this_iter": 26, "policy_reward_min": {"av": -2.998592435934801}, "policy_reward_max": {"av": 0.32375113065982586}, "policy_reward_mean": {"av": -0.0880212434833758}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.6202066079964066, "avg_speed_min": 1.0147239608904228, "avg_speed_max": 4.916843186130672, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 28.098819323975004, "mean_processing_ms": 1.9863972124577207, "mean_inference_ms": 0.2933308893857853}, "off_policy_estimator": {}, "info": {"num_steps_trained": 168960, "num_steps_sampled": 698259, "sample_time_ms": 63624.279, "load_time_ms": 2.274, "grad_time_ms": 3663.711, "update_time_ms": 5.777, "learner": {"av": {"cur_kl_coeff": 0.09492187201976776, "cur_lr": 9.999999747378752e-05, "total_loss": 0.1953374445438385, "policy_loss": 0.00013668736210092902, "vf_loss": 0.1946840137243271, "vf_explained_var": 0.3545810282230377, "kl": 0.005444010719656944, "entropy": 2.1518616676330566, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26250, "done": false, "timesteps_total": 698259, "episodes_total": 936, "training_iteration": 25, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-28-05", "timestamp": 1588818485, "time_this_iter_s": 65.32383465766907, "time_total_s": 1584.9466602802277, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72465fbf8>", "on_episode_step": "<function on_episode_step at 0x7fc72469be18>", "on_episode_end": "<function on_episode_end at 0x7fc725e99ea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725a0f510>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72461ed90>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1584.9466602802277, "timesteps_since_restore": 698259, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 89.15376344086023, "ram_util_percent": 32.0}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.3236945311257834, "episode_reward_min": -2.998592435934801, "episode_reward_mean": -0.07534517526393057, "episode_len_mean": 1101.38, "episodes_this_iter": 24, "policy_reward_min": {"av": -2.998592435934801}, "policy_reward_max": {"av": 0.3236945311257834}, "policy_reward_mean": {"av": -0.07534517526393057}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.4986499126690465, "avg_speed_min": 1.0147239608904228, "avg_speed_max": 4.3453733843121185, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 28.40161444143902, "mean_processing_ms": 1.960106498371172, "mean_inference_ms": 0.29921264743059633}, "off_policy_estimator": {}, "info": {"num_steps_trained": 178688, "num_steps_sampled": 724862, "sample_time_ms": 64744.177, "load_time_ms": 2.333, "grad_time_ms": 3835.378, "update_time_ms": 5.705, "learner": {"av": {"cur_kl_coeff": 0.09492187201976776, "cur_lr": 9.999999747378752e-05, "total_loss": 0.14282606542110443, "policy_loss": -0.0018701538210734725, "vf_loss": 0.14418157935142517, "vf_explained_var": 0.28321704268455505, "kl": 0.00542165944352746, "entropy": 2.123293161392212, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26603, "done": false, "timesteps_total": 724862, "episodes_total": 960, "training_iteration": 26, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-29-19", "timestamp": 1588818559, "time_this_iter_s": 73.9544415473938, "time_total_s": 1658.9011018276215, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc725e9ee18>", "on_episode_step": "<function on_episode_step at 0x7fc72465fea0>", "on_episode_end": "<function on_episode_end at 0x7fc72465fe18>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72469b400>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725972840>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1658.9011018276215, "timesteps_since_restore": 724862, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 90.28301886792453, "ram_util_percent": 32.00094339622641}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.3236945311257834, "episode_reward_min": -2.998592435934801, "episode_reward_mean": -0.15457785265133095, "episode_len_mean": 1076.08, "episodes_this_iter": 24, "policy_reward_min": {"av": -2.998592435934801}, "policy_reward_max": {"av": 0.3236945311257834}, "policy_reward_mean": {"av": -0.15457785265133095}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.4705066937816498, "avg_speed_min": 1.0147239608904228, "avg_speed_max": 3.957895561689233, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 28.656701340535793, "mean_processing_ms": 1.9423432407920995, "mean_inference_ms": 0.30455062417350137}, "off_policy_estimator": {}, "info": {"num_steps_trained": 187648, "num_steps_sampled": 750661, "sample_time_ms": 65549.512, "load_time_ms": 2.382, "grad_time_ms": 3954.04, "update_time_ms": 5.724, "learner": {"av": {"cur_kl_coeff": 0.09492187201976776, "cur_lr": 9.999999747378752e-05, "total_loss": 0.06422407180070877, "policy_loss": -0.01019151508808136, "vf_loss": 0.07143960893154144, "vf_explained_var": 0.39844220876693726, "kl": 0.03135189041495323, "entropy": 2.2372729778289795, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25799, "done": false, "timesteps_total": 750661, "episodes_total": 984, "training_iteration": 27, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-30-29", "timestamp": 1588818629, "time_this_iter_s": 70.29300856590271, "time_total_s": 1729.1941103935242, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72903af28>", "on_episode_step": "<function on_episode_step at 0x7fc72465fbf8>", "on_episode_end": "<function on_episode_end at 0x7fc725e99ea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725972510>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725a0f730>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1729.1941103935242, "timesteps_since_restore": 750661, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 90.52399999999997, "ram_util_percent": 32.0}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.3236945311257834, "episode_reward_min": -2.998592435934801, "episode_reward_mean": -0.021667675357702497, "episode_len_mean": 1107.69, "episodes_this_iter": 21, "policy_reward_min": {"av": -2.998592435934801}, "policy_reward_max": {"av": 0.3236945311257834}, "policy_reward_mean": {"av": -0.021667675357702497}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.536424873977047, "avg_speed_min": 1.2088943732327506, "avg_speed_max": 4.191636046148785, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 28.81858579729455, "mean_processing_ms": 1.9298057279666438, "mean_inference_ms": 0.30779170066572836}, "off_policy_estimator": {}, "info": {"num_steps_trained": 197376, "num_steps_sampled": 775921, "sample_time_ms": 65629.008, "load_time_ms": 2.387, "grad_time_ms": 3958.328, "update_time_ms": 5.786, "learner": {"av": {"cur_kl_coeff": 0.14238281548023224, "cur_lr": 9.999999747378752e-05, "total_loss": 0.006862132344394922, "policy_loss": -0.0008584714960306883, "vf_loss": 0.007283683866262436, "vf_explained_var": 0.9348763823509216, "kl": 0.0030686475802212954, "entropy": 2.2421627044677734, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25260, "done": false, "timesteps_total": 775921, "episodes_total": 1005, "training_iteration": 28, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-31-41", "timestamp": 1588818701, "time_this_iter_s": 71.48301029205322, "time_total_s": 1800.6771206855774, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72465fea0>", "on_episode_step": "<function on_episode_step at 0x7fc72465fe18>", "on_episode_end": "<function on_episode_end at 0x7fc725972840>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725972a60>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725a0f6a8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1800.6771206855774, "timesteps_since_restore": 775921, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 90.6058823529412, "ram_util_percent": 32.0}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.32367740594022615, "episode_reward_min": -2.998592435934801, "episode_reward_mean": 0.07797411600141893, "episode_len_mean": 1133.18, "episodes_this_iter": 21, "policy_reward_min": {"av": -2.998592435934801}, "policy_reward_max": {"av": 0.32367740594022615}, "policy_reward_mean": {"av": 0.07797411600141893}, "custom_metrics": {"num_ped_collisions_mean": 0.07, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.4885634546143978, "avg_speed_min": 1.2088943732327506, "avg_speed_max": 4.191636046148785, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 29.02294754222346, "mean_processing_ms": 1.9115445915019753, "mean_inference_ms": 0.3122083558297098}, "off_policy_estimator": {}, "info": {"num_steps_trained": 208512, "num_steps_sampled": 801731, "sample_time_ms": 66933.501, "load_time_ms": 2.444, "grad_time_ms": 4172.237, "update_time_ms": 5.777, "learner": {"av": {"cur_kl_coeff": 0.07119140774011612, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0003518627490848303, "policy_loss": -0.003412153571844101, "vf_loss": 0.001626581302843988, "vf_explained_var": 0.8377681374549866, "kl": 0.020138783380389214, "entropy": 2.3270645141601562, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25810, "done": false, "timesteps_total": 801731, "episodes_total": 1026, "training_iteration": 29, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-32-59", "timestamp": 1588818779, "time_this_iter_s": 77.71790957450867, "time_total_s": 1878.395030260086, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc725e9ee18>", "on_episode_step": "<function on_episode_step at 0x7fc72903af28>", "on_episode_end": "<function on_episode_end at 0x7fc725e99ea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725972510>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725a0f950>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1878.395030260086, "timesteps_since_restore": 801731, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 90.56936936936937, "ram_util_percent": 32.0}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.32367740594022615, "episode_reward_min": -2.997709373281179, "episode_reward_mean": 0.07808079104660495, "episode_len_mean": 1136.86, "episodes_this_iter": 23, "policy_reward_min": {"av": -2.997709373281179}, "policy_reward_max": {"av": 0.32367740594022615}, "policy_reward_mean": {"av": 0.07808079104660495}, "custom_metrics": {"num_ped_collisions_mean": 0.07, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.4377245113707326, "avg_speed_min": 1.1667082194047385, "avg_speed_max": 4.191636046148785, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 29.245556675577337, "mean_processing_ms": 1.90511072781225, "mean_inference_ms": 0.3169370917311703}, "off_policy_estimator": {}, "info": {"num_steps_trained": 217728, "num_steps_sampled": 826713, "sample_time_ms": 67201.901, "load_time_ms": 2.467, "grad_time_ms": 4260.675, "update_time_ms": 5.834, "learner": {"av": {"cur_kl_coeff": 0.10678710788488388, "cur_lr": 9.999999747378752e-05, "total_loss": 0.03296930715441704, "policy_loss": 0.00014584491145797074, "vf_loss": 0.03239120915532112, "vf_explained_var": 0.8744823932647705, "kl": 0.004047787748277187, "entropy": 2.302919387817383, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 24982, "done": false, "timesteps_total": 826713, "episodes_total": 1049, "training_iteration": 30, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-34-09", "timestamp": 1588818849, "time_this_iter_s": 69.87738490104675, "time_total_s": 1948.2724151611328, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72469b8c8>", "on_episode_step": "<function on_episode_step at 0x7fc72465fbf8>", "on_episode_end": "<function on_episode_end at 0x7fc72465fea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72465fe18>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72461ed90>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1948.2724151611328, "timesteps_since_restore": 826713, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 88.75200000000002, "ram_util_percent": 32.0}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.32367740594022615, "episode_reward_min": -2.997709373281179, "episode_reward_mean": 0.12413008232529064, "episode_len_mean": 1154.91, "episodes_this_iter": 22, "policy_reward_min": {"av": -2.997709373281179}, "policy_reward_max": {"av": 0.32367740594022615}, "policy_reward_mean": {"av": 0.12413008232529064}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.4642891514727037, "avg_speed_min": 1.1667082194047385, "avg_speed_max": 4.214856198635348, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 29.43601033079176, "mean_processing_ms": 1.8913698893426505, "mean_inference_ms": 0.32104924332953727}, "off_policy_estimator": {}, "info": {"num_steps_trained": 225792, "num_steps_sampled": 852747, "sample_time_ms": 66702.429, "load_time_ms": 2.434, "grad_time_ms": 4219.181, "update_time_ms": 5.783, "learner": {"av": {"cur_kl_coeff": 0.05339355394244194, "cur_lr": 9.999999747378752e-05, "total_loss": 0.003348001977428794, "policy_loss": -0.0020858682692050934, "vf_loss": 0.004929982125759125, "vf_explained_var": 0.8654587864875793, "kl": 0.009437261149287224, "entropy": 2.270853281021118, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26034, "done": false, "timesteps_total": 852747, "episodes_total": 1071, "training_iteration": 31, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-35-15", "timestamp": 1588818915, "time_this_iter_s": 66.30169367790222, "time_total_s": 2014.574108839035, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72469b620>", "on_episode_step": "<function on_episode_step at 0x7fc725e9ee18>", "on_episode_end": "<function on_episode_end at 0x7fc725972510>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725e99ea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72461eae8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2014.574108839035, "timesteps_since_restore": 852747, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 88.33578947368419, "ram_util_percent": 32.003157894736844}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.32367740594022615, "episode_reward_min": -2.997709373281179, "episode_reward_mean": 0.13079942316801024, "episode_len_mean": 1154.94, "episodes_this_iter": 25, "policy_reward_min": {"av": -2.997709373281179}, "policy_reward_max": {"av": 0.32367740594022615}, "policy_reward_mean": {"av": 0.13079942316801024}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.6782216180817566, "avg_speed_min": 1.1667082194047385, "avg_speed_max": 4.475336387482777, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 29.605607751118068, "mean_processing_ms": 1.8714419453381772, "mean_inference_ms": 0.3248335645512689}, "off_policy_estimator": {}, "info": {"num_steps_trained": 234624, "num_steps_sampled": 881603, "sample_time_ms": 67100.959, "load_time_ms": 2.435, "grad_time_ms": 4231.871, "update_time_ms": 5.884, "learner": {"av": {"cur_kl_coeff": 0.05339355394244194, "cur_lr": 9.999999747378752e-05, "total_loss": -0.01476422417908907, "policy_loss": -0.02045910805463791, "vf_loss": 0.0028924832586199045, "vf_explained_var": 0.9577198624610901, "kl": 0.05248577892780304, "entropy": 2.31288480758667, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28856, "done": false, "timesteps_total": 881603, "episodes_total": 1096, "training_iteration": 32, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-36-28", "timestamp": 1588818988, "time_this_iter_s": 72.84697270393372, "time_total_s": 2087.4210815429688, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc729044400>", "on_episode_step": "<function on_episode_step at 0x7fc72465fbf8>", "on_episode_end": "<function on_episode_end at 0x7fc72465fe18>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725a0f7b8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725972e18>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2087.4210815429688, "timesteps_since_restore": 881603, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 90.22307692307693, "ram_util_percent": 32.0}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.3236598030044798, "episode_reward_min": -3.00014, "episode_reward_mean": -0.11275979871304653, "episode_len_mean": 1076.42, "episodes_this_iter": 33, "policy_reward_min": {"av": -3.00014}, "policy_reward_max": {"av": 0.3236598030044798}, "policy_reward_mean": {"av": -0.11275979871304653}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.0065364603890483, "avg_speed_min": 1.1667082194047385, "avg_speed_max": 5.029177376266953, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 29.747423824242873, "mean_processing_ms": 1.8563113530447743, "mean_inference_ms": 0.32786147949773387}, "off_policy_estimator": {}, "info": {"num_steps_trained": 241408, "num_steps_sampled": 910823, "sample_time_ms": 66598.373, "load_time_ms": 2.389, "grad_time_ms": 4119.967, "update_time_ms": 5.885, "learner": {"av": {"cur_kl_coeff": 0.08009032905101776, "cur_lr": 9.999999747378752e-05, "total_loss": 0.11466702818870544, "policy_loss": -0.015975050628185272, "vf_loss": 0.12889820337295532, "vf_explained_var": 0.6651873588562012, "kl": 0.021773764863610268, "entropy": 2.3274760246276855, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 29220, "done": false, "timesteps_total": 910823, "episodes_total": 1129, "training_iteration": 33, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-37-34", "timestamp": 1588819054, "time_this_iter_s": 65.5053436756134, "time_total_s": 2152.926425218582, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72903af28>", "on_episode_step": "<function on_episode_step at 0x7fc725e99ea0>", "on_episode_end": "<function on_episode_end at 0x7fc725a0fbf8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725a0fea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725972488>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2152.926425218582, "timesteps_since_restore": 910823, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 89.96666666666664, "ram_util_percent": 32.0}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.3236574629674389, "episode_reward_min": -3.00014, "episode_reward_mean": -0.10230483175590808, "episode_len_mean": 1060.48, "episodes_this_iter": 26, "policy_reward_min": {"av": -3.00014}, "policy_reward_max": {"av": 0.3236574629674389}, "policy_reward_mean": {"av": -0.10230483175590808}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.2338076433785505, "avg_speed_min": 1.2053915665047725, "avg_speed_max": 5.391342267030647, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 29.752852339818865, "mean_processing_ms": 1.8385413081599473, "mean_inference_ms": 0.3275592391352495}, "off_policy_estimator": {}, "info": {"num_steps_trained": 248832, "num_steps_sampled": 938806, "sample_time_ms": 65993.729, "load_time_ms": 2.314, "grad_time_ms": 3997.322, "update_time_ms": 5.988, "learner": {"av": {"cur_kl_coeff": 0.12013550102710724, "cur_lr": 9.999999747378752e-05, "total_loss": 0.021376894786953926, "policy_loss": -0.0031545718666166067, "vf_loss": 0.023534830659627914, "vf_explained_var": 0.5968106985092163, "kl": 0.008295961655676365, "entropy": 2.333245277404785, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27983, "done": false, "timesteps_total": 938806, "episodes_total": 1155, "training_iteration": 34, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-38-40", "timestamp": 1588819120, "time_this_iter_s": 66.81117653846741, "time_total_s": 2219.7376017570496, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc725a0f7b8>", "on_episode_step": "<function on_episode_step at 0x7fc72465fea0>", "on_episode_end": "<function on_episode_end at 0x7fc72465fbf8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72465fe18>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72469b8c8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2219.7376017570496, "timesteps_since_restore": 938806, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 89.32187499999999, "ram_util_percent": 32.02395833333334}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.3236574629674389, "episode_reward_min": -3.00055, "episode_reward_mean": -0.14802434225778593, "episode_len_mean": 1052.24, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.00055}, "policy_reward_max": {"av": 0.3236574629674389}, "policy_reward_mean": {"av": -0.14802434225778593}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.183254064637523, "avg_speed_min": 1.2053915665047725, "avg_speed_max": 5.391342267030647, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 29.803264357471445, "mean_processing_ms": 1.82783209851414, "mean_inference_ms": 0.32852211610748433}, "off_policy_estimator": {}, "info": {"num_steps_trained": 258048, "num_steps_sampled": 965774, "sample_time_ms": 66690.224, "load_time_ms": 2.343, "grad_time_ms": 4065.212, "update_time_ms": 6.053, "learner": {"av": {"cur_kl_coeff": 0.12013550102710724, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0014933707425370812, "policy_loss": -0.005873566027730703, "vf_loss": 0.0031957882456481457, "vf_explained_var": 0.9631678462028503, "kl": 0.009858932346105576, "entropy": 2.263446807861328, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26968, "done": false, "timesteps_total": 965774, "episodes_total": 1178, "training_iteration": 35, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-39-54", "timestamp": 1588819194, "time_this_iter_s": 72.96873998641968, "time_total_s": 2292.7063417434692, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc729044400>", "on_episode_step": "<function on_episode_step at 0x7fc725a0fea0>", "on_episode_end": "<function on_episode_end at 0x7fc725a0fbf8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725e99ea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72469b158>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2292.7063417434692, "timesteps_since_restore": 965774, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 90.63557692307691, "ram_util_percent": 32.07692307692309}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00055, "episode_reward_mean": -0.040136399999999996, "episode_len_mean": 1088.57, "episodes_this_iter": 25, "policy_reward_min": {"av": -3.00055}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.040136399999999996}, "custom_metrics": {"num_ped_collisions_mean": 0.07, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.1753271812810526, "avg_speed_min": 1.449675347268414, "avg_speed_max": 5.391342267030647, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 29.850124789110804, "mean_processing_ms": 1.819439802638295, "mean_inference_ms": 0.3294555443888567}, "off_policy_estimator": {}, "info": {"num_steps_trained": 266240, "num_steps_sampled": 994943, "sample_time_ms": 66447.953, "load_time_ms": 2.293, "grad_time_ms": 3994.011, "update_time_ms": 5.995, "learner": {"av": {"cur_kl_coeff": 0.12013550102710724, "cur_lr": 9.999999747378752e-05, "total_loss": -0.004115919582545757, "policy_loss": -0.006734867580235004, "vf_loss": 0.0008378711063414812, "vf_explained_var": 0.8413633108139038, "kl": 0.014825558289885521, "entropy": 2.339090585708618, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 29169, "done": false, "timesteps_total": 994943, "episodes_total": 1203, "training_iteration": 36, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-41-04", "timestamp": 1588819264, "time_this_iter_s": 70.81874918937683, "time_total_s": 2363.525090932846, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72903af28>", "on_episode_step": "<function on_episode_step at 0x7fc72465fbf8>", "on_episode_end": "<function on_episode_end at 0x7fc72465fea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72465fe18>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72461eae8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2363.525090932846, "timesteps_since_restore": 994943, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 90.27722772277225, "ram_util_percent": 32.08118811881188}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00055, "episode_reward_mean": 0.08986460000000002, "episode_len_mean": 1126.11, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.00055}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.08986460000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.1733846088014417, "avg_speed_min": 1.449675347268414, "avg_speed_max": 5.391342267030647, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 29.923896301505145, "mean_processing_ms": 1.803152723379061, "mean_inference_ms": 0.33067398975833767}, "off_policy_estimator": {}, "info": {"num_steps_trained": 273920, "num_steps_sampled": 1022643, "sample_time_ms": 66224.411, "load_time_ms": 2.272, "grad_time_ms": 3937.701, "update_time_ms": 5.959, "learner": {"av": {"cur_kl_coeff": 0.12013550102710724, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0025885121431201696, "policy_loss": -0.01065992284566164, "vf_loss": 0.01082681119441986, "vf_explained_var": 0.40681347250938416, "kl": 0.020157448947429657, "entropy": 2.3626527786254883, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27700, "done": false, "timesteps_total": 1022643, "episodes_total": 1226, "training_iteration": 37, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-42-12", "timestamp": 1588819332, "time_this_iter_s": 67.49345111846924, "time_total_s": 2431.0185420513153, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc725a0f7b8>", "on_episode_step": "<function on_episode_step at 0x7fc725a0fea0>", "on_episode_end": "<function on_episode_end at 0x7fc729044400>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725e99ea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72461ed90>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2431.0185420513153, "timesteps_since_restore": 1022643, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 90.74166666666667, "ram_util_percent": 32.09479166666667}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00055, "episode_reward_mean": 0.19237739999999998, "episode_len_mean": 1173.93, "episodes_this_iter": 25, "policy_reward_min": {"av": -3.00055}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.19237739999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.0440056594521483, "avg_speed_min": 1.5109211271648555, "avg_speed_max": 5.173575576769953, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 30.01926555187812, "mean_processing_ms": 1.7917049576146977, "mean_inference_ms": 0.33255099405409927}, "off_policy_estimator": {}, "info": {"num_steps_trained": 282368, "num_steps_sampled": 1051452, "sample_time_ms": 66275.922, "load_time_ms": 2.256, "grad_time_ms": 3877.974, "update_time_ms": 5.945, "learner": {"av": {"cur_kl_coeff": 0.18020324409008026, "cur_lr": 9.999999747378752e-05, "total_loss": -0.00041187566239386797, "policy_loss": -0.0026864747051149607, "vf_loss": 0.0013452637940645218, "vf_explained_var": 0.861037015914917, "kl": 0.005157141480594873, "entropy": 2.3314895629882812, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28809, "done": false, "timesteps_total": 1051452, "episodes_total": 1251, "training_iteration": 38, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-43-24", "timestamp": 1588819404, "time_this_iter_s": 71.39943552017212, "time_total_s": 2502.4179775714874, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc725e9ee18>", "on_episode_step": "<function on_episode_step at 0x7fc72465fbf8>", "on_episode_end": "<function on_episode_end at 0x7fc72465fe18>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72469b8c8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725972158>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2502.4179775714874, "timesteps_since_restore": 1051452, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 89.56470588235291, "ram_util_percent": 32.1}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00028, "episode_reward_mean": 0.17237860000000002, "episode_len_mean": 1173.31, "episodes_this_iter": 25, "policy_reward_min": {"av": -3.00028}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.17237860000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.117751126926009, "avg_speed_min": 1.4902639901857178, "avg_speed_max": 5.173575576769953, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 30.07756105163672, "mean_processing_ms": 1.779051353655384, "mean_inference_ms": 0.33344046255713977}, "off_policy_estimator": {}, "info": {"num_steps_trained": 290432, "num_steps_sampled": 1080217, "sample_time_ms": 65572.332, "load_time_ms": 2.201, "grad_time_ms": 3739.813, "update_time_ms": 5.963, "learner": {"av": {"cur_kl_coeff": 0.18020324409008026, "cur_lr": 9.999999747378752e-05, "total_loss": 0.02859741635620594, "policy_loss": -0.014603093266487122, "vf_loss": 0.04019884020090103, "vf_explained_var": 0.751854419708252, "kl": 0.01665710099041462, "entropy": 2.3351340293884277, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28765, "done": false, "timesteps_total": 1080217, "episodes_total": 1276, "training_iteration": 39, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-44-33", "timestamp": 1588819473, "time_this_iter_s": 69.30027937889099, "time_total_s": 2571.7182569503784, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72903af28>", "on_episode_step": "<function on_episode_step at 0x7fc72469b400>", "on_episode_end": "<function on_episode_end at 0x7fc72469b950>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725e99ea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725a0f6a8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2571.7182569503784, "timesteps_since_restore": 1080217, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 92.24949494949496, "ram_util_percent": 32.09696969696971}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00028, "episode_reward_mean": 0.1398893, "episode_len_mean": 1164.94, "episodes_this_iter": 22, "policy_reward_min": {"av": -3.00028}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1398893}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9730349852786766, "avg_speed_min": 1.467448876782013, "avg_speed_max": 5.173575576769953, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 30.13216931308186, "mean_processing_ms": 1.772567505292239, "mean_inference_ms": 0.3340480603055163}, "off_policy_estimator": {}, "info": {"num_steps_trained": 300928, "num_steps_sampled": 1106059, "sample_time_ms": 66196.524, "load_time_ms": 2.223, "grad_time_ms": 3794.591, "update_time_ms": 5.849, "learner": {"av": {"cur_kl_coeff": 0.18020324409008026, "cur_lr": 9.999999747378752e-05, "total_loss": 0.055662598460912704, "policy_loss": -0.007581671699881554, "vf_loss": 0.06100291758775711, "vf_explained_var": 0.18362738192081451, "kl": 0.012437875382602215, "entropy": 2.323601007461548, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25842, "done": false, "timesteps_total": 1106059, "episodes_total": 1298, "training_iteration": 40, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-45-50", "timestamp": 1588819550, "time_this_iter_s": 76.66669631004333, "time_total_s": 2648.3849532604218, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc729044400>", "on_episode_step": "<function on_episode_step at 0x7fc72465fbf8>", "on_episode_end": "<function on_episode_end at 0x7fc725e9ee18>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72469b8c8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725a0fc80>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2648.3849532604218, "timesteps_since_restore": 1106059, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 90.38636363636364, "ram_util_percent": 32.1}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00028, "episode_reward_mean": 0.1073977, "episode_len_mean": 1156.58, "episodes_this_iter": 26, "policy_reward_min": {"av": -3.00028}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1073977}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.8697535321295953, "avg_speed_min": 1.467448876782013, "avg_speed_max": 5.007863889062482, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 30.206615220310834, "mean_processing_ms": 1.7627433313137901, "mean_inference_ms": 0.3353599643420392}, "off_policy_estimator": {}, "info": {"num_steps_trained": 308864, "num_steps_sampled": 1134079, "sample_time_ms": 66361.664, "load_time_ms": 2.238, "grad_time_ms": 3790.685, "update_time_ms": 5.835, "learner": {"av": {"cur_kl_coeff": 0.18020324409008026, "cur_lr": 9.999999747378752e-05, "total_loss": 0.10072053968906403, "policy_loss": -0.002472460735589266, "vf_loss": 0.10208810120820999, "vf_explained_var": 0.13993017375469208, "kl": 0.006131250411272049, "entropy": 2.3411738872528076, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28020, "done": false, "timesteps_total": 1134079, "episodes_total": 1324, "training_iteration": 41, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-46-58", "timestamp": 1588819618, "time_this_iter_s": 67.91400527954102, "time_total_s": 2716.2989585399628, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72465fea0>", "on_episode_step": "<function on_episode_step at 0x7fc72469b400>", "on_episode_end": "<function on_episode_end at 0x7fc72903af28>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725e99ea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725a0fae8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2716.2989585399628, "timesteps_since_restore": 1134079, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 90.00721649484535, "ram_util_percent": 32.1}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00028, "episode_reward_mean": 0.0423985, "episode_len_mean": 1138.65, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.00028}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.0423985}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.8796299754722874, "avg_speed_min": 1.467448876782013, "avg_speed_max": 5.007863889062482, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 30.272110632105846, "mean_processing_ms": 1.756260593360738, "mean_inference_ms": 0.3365571682755201}, "off_policy_estimator": {}, "info": {"num_steps_trained": 317184, "num_steps_sampled": 1160940, "sample_time_ms": 65930.501, "load_time_ms": 2.232, "grad_time_ms": 3767.151, "update_time_ms": 5.749, "learner": {"av": {"cur_kl_coeff": 0.18020324409008026, "cur_lr": 9.999999747378752e-05, "total_loss": 0.10136989504098892, "policy_loss": -0.004012801218777895, "vf_loss": 0.10423236340284348, "vf_explained_var": 0.417795866727829, "kl": 0.0063835675828158855, "entropy": 2.456185817718506, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26861, "done": false, "timesteps_total": 1160940, "episodes_total": 1347, "training_iteration": 42, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-48-06", "timestamp": 1588819686, "time_this_iter_s": 68.2984402179718, "time_total_s": 2784.5973987579346, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72465fe18>", "on_episode_step": "<function on_episode_step at 0x7fc729044400>", "on_episode_end": "<function on_episode_end at 0x7fc72469b950>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72469b8c8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72461ed90>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2784.5973987579346, "timesteps_since_restore": 1160940, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 90.29793814432989, "ram_util_percent": 32.10000000000001}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0001599999999997, "episode_reward_mean": 0.0424006, "episode_len_mean": 1138.89, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.0001599999999997}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.0424006}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.7902524673349736, "avg_speed_min": 1.467448876782013, "avg_speed_max": 5.007863889062482, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 30.33159682803276, "mean_processing_ms": 1.7513947197753366, "mean_inference_ms": 0.33754724658441515}, "off_policy_estimator": {}, "info": {"num_steps_trained": 326016, "num_steps_sampled": 1187605, "sample_time_ms": 66395.425, "load_time_ms": 2.243, "grad_time_ms": 3860.762, "update_time_ms": 5.77, "learner": {"av": {"cur_kl_coeff": 0.18020324409008026, "cur_lr": 9.999999747378752e-05, "total_loss": 0.10554062575101852, "policy_loss": -0.0029086535796523094, "vf_loss": 0.10751084983348846, "vf_explained_var": 0.25769859552383423, "kl": 0.005207661539316177, "entropy": 2.3225314617156982, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26665, "done": false, "timesteps_total": 1187605, "episodes_total": 1370, "training_iteration": 43, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-49-17", "timestamp": 1588819757, "time_this_iter_s": 71.09098148345947, "time_total_s": 2855.688380241394, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc725e9ee18>", "on_episode_step": "<function on_episode_step at 0x7fc72465fbf8>", "on_episode_end": "<function on_episode_end at 0x7fc72465fea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725e99ea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72461eae8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2855.688380241394, "timesteps_since_restore": 1187605, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 89.68823529411763, "ram_util_percent": 32.1}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0001599999999997, "episode_reward_mean": 0.0748993, "episode_len_mean": 1147.26, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.0001599999999997}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.0748993}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9405878683487576, "avg_speed_min": 1.4824284122373672, "avg_speed_max": 4.802879811593959, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 30.368815545338638, "mean_processing_ms": 1.7439694212127173, "mean_inference_ms": 0.3381911590024033}, "off_policy_estimator": {}, "info": {"num_steps_trained": 333824, "num_steps_sampled": 1215727, "sample_time_ms": 66532.887, "load_time_ms": 2.267, "grad_time_ms": 3879.571, "update_time_ms": 5.775, "learner": {"av": {"cur_kl_coeff": 0.18020324409008026, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0007883580401539803, "policy_loss": -0.0025164561811834574, "vf_loss": 0.0007394030108116567, "vf_explained_var": 0.830878734588623, "kl": 0.005486564710736275, "entropy": 2.3658528327941895, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28122, "done": false, "timesteps_total": 1215727, "episodes_total": 1393, "training_iteration": 44, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-50-26", "timestamp": 1588819826, "time_this_iter_s": 68.37481498718262, "time_total_s": 2924.0631952285767, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72903af28>", "on_episode_step": "<function on_episode_step at 0x7fc725a0f9d8>", "on_episode_end": "<function on_episode_end at 0x7fc725a0fa60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725a0fc80>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725972e18>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2924.0631952285767, "timesteps_since_restore": 1215727, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 89.98969072164948, "ram_util_percent": 32.10000000000001}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0001599999999997, "episode_reward_mean": 0.054892800000000005, "episode_len_mean": 1145.79, "episodes_this_iter": 26, "policy_reward_min": {"av": -3.0001599999999997}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.054892800000000005}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.979950045500965, "avg_speed_min": 1.5045885004118513, "avg_speed_max": 4.545060303010388, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 30.419830133326005, "mean_processing_ms": 1.736103056675883, "mean_inference_ms": 0.33913027082403885}, "off_policy_estimator": {}, "info": {"num_steps_trained": 342016, "num_steps_sampled": 1243709, "sample_time_ms": 66253.155, "load_time_ms": 2.258, "grad_time_ms": 3836.436, "update_time_ms": 5.759, "learner": {"av": {"cur_kl_coeff": 0.18020324409008026, "cur_lr": 9.999999747378752e-05, "total_loss": -0.008541945368051529, "policy_loss": -0.013256222009658813, "vf_loss": 0.0033036821987479925, "vf_explained_var": 0.9045493602752686, "kl": 0.007827796041965485, "entropy": 2.3970065116882324, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27982, "done": false, "timesteps_total": 1243709, "episodes_total": 1419, "training_iteration": 45, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-51-36", "timestamp": 1588819896, "time_this_iter_s": 69.73931765556335, "time_total_s": 2993.80251288414, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72465fe18>", "on_episode_step": "<function on_episode_step at 0x7fc72465fbf8>", "on_episode_end": "<function on_episode_end at 0x7fc725e9ee18>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725e99ea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725972158>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2993.80251288414, "timesteps_since_restore": 1243709, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 88.91999999999999, "ram_util_percent": 32.1}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0001599999999997, "episode_reward_mean": 0.15240289999999998, "episode_len_mean": 1172.23, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.0001599999999997}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.15240289999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.9911202750328374, "avg_speed_min": 1.5045885004118513, "avg_speed_max": 4.49365503004678, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 30.469049472523274, "mean_processing_ms": 1.7271764930611826, "mean_inference_ms": 0.3399193070350212}, "off_policy_estimator": {}, "info": {"num_steps_trained": 350464, "num_steps_sampled": 1272522, "sample_time_ms": 66294.924, "load_time_ms": 2.281, "grad_time_ms": 3848.383, "update_time_ms": 5.773, "learner": {"av": {"cur_kl_coeff": 0.18020324409008026, "cur_lr": 9.999999747378752e-05, "total_loss": 0.00174722948577255, "policy_loss": -0.004415498580783606, "vf_loss": 0.005147983785718679, "vf_explained_var": 0.774730384349823, "kl": 0.005631104577332735, "entropy": 2.354357957839966, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28813, "done": false, "timesteps_total": 1272522, "episodes_total": 1442, "training_iteration": 46, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-52-47", "timestamp": 1588819967, "time_this_iter_s": 71.356121301651, "time_total_s": 3065.158634185791, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc729044400>", "on_episode_step": "<function on_episode_step at 0x7fc725a0fa60>", "on_episode_end": "<function on_episode_end at 0x7fc725a0f9d8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72903af28>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72469b8c8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3065.158634185791, "timesteps_since_restore": 1272522, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 91.871568627451, "ram_util_percent": 32.10196078431373}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0001299999999995, "episode_reward_mean": 0.2174081, "episode_len_mean": 1189.87, "episodes_this_iter": 20, "policy_reward_min": {"av": -3.0001299999999995}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.2174081}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.97830292245344, "avg_speed_min": 1.5045885004118513, "avg_speed_max": 4.478572213382393, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 30.53428821018156, "mean_processing_ms": 1.7204792612616808, "mean_inference_ms": 0.341378440780888}, "off_policy_estimator": {}, "info": {"num_steps_trained": 360064, "num_steps_sampled": 1298209, "sample_time_ms": 66597.974, "load_time_ms": 2.31, "grad_time_ms": 3935.3, "update_time_ms": 5.813, "learner": {"av": {"cur_kl_coeff": 0.18020324409008026, "cur_lr": 9.999999747378752e-05, "total_loss": -0.005814696196466684, "policy_loss": -0.007155024912208319, "vf_loss": 0.0004807415243703872, "vf_explained_var": 0.9019048810005188, "kl": 0.004770080558955669, "entropy": 2.2815299034118652, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25687, "done": false, "timesteps_total": 1298209, "episodes_total": 1462, "training_iteration": 47, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-53-59", "timestamp": 1588820039, "time_this_iter_s": 71.39391541481018, "time_total_s": 3136.552549600601, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72465fea0>", "on_episode_step": "<function on_episode_step at 0x7fc72465fe18>", "on_episode_end": "<function on_episode_end at 0x7fc725e99ea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725972950>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72469bea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3136.552549600601, "timesteps_since_restore": 1298209, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 90.43529411764703, "ram_util_percent": 32.1}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0001299999999995, "episode_reward_mean": 0.15240960000000003, "episode_len_mean": 1172.39, "episodes_this_iter": 26, "policy_reward_min": {"av": -3.0001299999999995}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.15240960000000003}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.8350074468991564, "avg_speed_min": 1.393132926765687, "avg_speed_max": 4.478572213382393, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 30.60908871568098, "mean_processing_ms": 1.7084998015506232, "mean_inference_ms": 0.34285889673798076}, "off_policy_estimator": {}, "info": {"num_steps_trained": 367744, "num_steps_sampled": 1325966, "sample_time_ms": 66162.683, "load_time_ms": 2.292, "grad_time_ms": 3902.729, "update_time_ms": 5.79, "learner": {"av": {"cur_kl_coeff": 0.09010162204504013, "cur_lr": 9.999999747378752e-05, "total_loss": 0.058029696345329285, "policy_loss": -0.010756952688097954, "vf_loss": 0.06672731041908264, "vf_explained_var": 0.6463955640792847, "kl": 0.022855672985315323, "entropy": 2.308037757873535, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27757, "done": false, "timesteps_total": 1325966, "episodes_total": 1488, "training_iteration": 48, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-55-05", "timestamp": 1588820105, "time_this_iter_s": 66.72060918807983, "time_total_s": 3203.273158788681, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72465fbf8>", "on_episode_step": "<function on_episode_step at 0x7fc725a0fa60>", "on_episode_end": "<function on_episode_end at 0x7fc729044400>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72903af28>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72461eae8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3203.273158788681, "timesteps_since_restore": 1325966, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 90.65789473684211, "ram_util_percent": 32.1}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0001, "episode_reward_mean": 0.1524174, "episode_len_mean": 1173.4, "episodes_this_iter": 25, "policy_reward_min": {"av": -3.0001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1524174}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.968883903863227, "avg_speed_min": 1.393132926765687, "avg_speed_max": 5.081176156429253, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 30.649580772480558, "mean_processing_ms": 1.702378527566832, "mean_inference_ms": 0.343468489024029}, "off_policy_estimator": {}, "info": {"num_steps_trained": 376064, "num_steps_sampled": 1354851, "sample_time_ms": 66246.685, "load_time_ms": 2.324, "grad_time_ms": 3914.97, "update_time_ms": 5.737, "learner": {"av": {"cur_kl_coeff": 0.1351524293422699, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0883205235004425, "policy_loss": -0.0022191533353179693, "vf_loss": 0.08990877121686935, "vf_explained_var": 0.4739256203174591, "kl": 0.004668045789003372, "entropy": 2.3819823265075684, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28885, "done": false, "timesteps_total": 1354851, "episodes_total": 1513, "training_iteration": 49, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-56-16", "timestamp": 1588820176, "time_this_iter_s": 70.2622275352478, "time_total_s": 3273.535386323929, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc725e9ee18>", "on_episode_step": "<function on_episode_step at 0x7fc72469bea0>", "on_episode_end": "<function on_episode_end at 0x7fc725e99ea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725a0f9d8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72461ed90>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3273.535386323929, "timesteps_since_restore": 1354851, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 91.162, "ram_util_percent": 32.1}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0001, "episode_reward_mean": 0.1524176, "episode_len_mean": 1173.4, "episodes_this_iter": 20, "policy_reward_min": {"av": -3.0001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1524176}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.919247055023967, "avg_speed_min": 1.393132926765687, "avg_speed_max": 5.081176156429253, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 30.70523071118916, "mean_processing_ms": 1.6941903892685928, "mean_inference_ms": 0.3447710398807983}, "off_policy_estimator": {}, "info": {"num_steps_trained": 385792, "num_steps_sampled": 1381276, "sample_time_ms": 65985.928, "load_time_ms": 2.323, "grad_time_ms": 3881.635, "update_time_ms": 5.852, "learner": {"av": {"cur_kl_coeff": 0.06757621467113495, "cur_lr": 9.999999747378752e-05, "total_loss": -0.004287993535399437, "policy_loss": -0.005748994182795286, "vf_loss": 0.0008005487616173923, "vf_explained_var": 0.8688455820083618, "kl": 0.009773466736078262, "entropy": 2.3735568523406982, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26425, "done": false, "timesteps_total": 1381276, "episodes_total": 1533, "training_iteration": 50, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-57-30", "timestamp": 1588820250, "time_this_iter_s": 73.72731900215149, "time_total_s": 3347.2627053260803, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72465fe18>", "on_episode_step": "<function on_episode_step at 0x7fc72465fbf8>", "on_episode_end": "<function on_episode_end at 0x7fc72903af28>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72469b620>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725972840>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3347.2627053260803, "timesteps_since_restore": 1381276, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 89.51981132075474, "ram_util_percent": 32.10000000000001}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0001, "episode_reward_mean": 0.1524216, "episode_len_mean": 1173.4, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.0001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1524216}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.9389811577154275, "avg_speed_min": 1.393132926765687, "avg_speed_max": 5.081176156429253, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 30.715267078453806, "mean_processing_ms": 1.692416221669636, "mean_inference_ms": 0.3445819047855875}, "off_policy_estimator": {}, "info": {"num_steps_trained": 393600, "num_steps_sampled": 1408076, "sample_time_ms": 65782.166, "load_time_ms": 2.328, "grad_time_ms": 3875.118, "update_time_ms": 6.017, "learner": {"av": {"cur_kl_coeff": 0.06757621467113495, "cur_lr": 9.999999747378752e-05, "total_loss": 0.000976712442934513, "policy_loss": 6.76308773108758e-05, "vf_loss": 0.0005292610148899257, "vf_explained_var": 0.8929644823074341, "kl": 0.00562058063223958, "entropy": 2.4071590900421143, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26800, "done": false, "timesteps_total": 1408076, "episodes_total": 1556, "training_iteration": 51, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-58-36", "timestamp": 1588820316, "time_this_iter_s": 65.81269526481628, "time_total_s": 3413.0754005908966, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72465fea0>", "on_episode_step": "<function on_episode_step at 0x7fc725e9ee18>", "on_episode_end": "<function on_episode_end at 0x7fc725e99ea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725972c80>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725a0fa60>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3413.0754005908966, "timesteps_since_restore": 1408076, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 91.64148936170211, "ram_util_percent": 32.1031914893617}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0001, "episode_reward_mean": 0.2174266, "episode_len_mean": 1190.88, "episodes_this_iter": 25, "policy_reward_min": {"av": -3.0001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.2174266}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.945336485784196, "avg_speed_min": 1.4853628087063613, "avg_speed_max": 5.081176156429253, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 30.744208215679507, "mean_processing_ms": 1.6845175826266734, "mean_inference_ms": 0.345129056029682}, "off_policy_estimator": {}, "info": {"num_steps_trained": 402816, "num_steps_sampled": 1436302, "sample_time_ms": 66292.775, "load_time_ms": 2.323, "grad_time_ms": 3914.793, "update_time_ms": 6.027, "learner": {"av": {"cur_kl_coeff": 0.06757621467113495, "cur_lr": 9.999999747378752e-05, "total_loss": -0.004157865419983864, "policy_loss": -0.00506957620382309, "vf_loss": 0.000515478546731174, "vf_explained_var": 0.8958339691162109, "kl": 0.005863512400537729, "entropy": 2.4216952323913574, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28226, "done": false, "timesteps_total": 1436302, "episodes_total": 1581, "training_iteration": 52, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_02-59-49", "timestamp": 1588820389, "time_this_iter_s": 73.8017258644104, "time_total_s": 3486.877126455307, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc729044400>", "on_episode_step": "<function on_episode_step at 0x7fc725a0fae8>", "on_episode_end": "<function on_episode_end at 0x7fc725a0f730>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725a0fea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7246ecae8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3486.877126455307, "timesteps_since_restore": 1436302, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 89.83047619047619, "ram_util_percent": 32.10000000000001}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00011, "episode_reward_mean": 0.1074239, "episode_len_mean": 1155.57, "episodes_this_iter": 26, "policy_reward_min": {"av": -3.00011}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1074239}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.914784924764781, "avg_speed_min": 1.470267457198212, "avg_speed_max": 5.265728634189573, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 30.796211923042716, "mean_processing_ms": 1.6783828649715453, "mean_inference_ms": 0.34602123252738154}, "off_policy_estimator": {}, "info": {"num_steps_trained": 410752, "num_steps_sampled": 1463244, "sample_time_ms": 65847.374, "load_time_ms": 2.349, "grad_time_ms": 3874.594, "update_time_ms": 6.026, "learner": {"av": {"cur_kl_coeff": 0.06757621467113495, "cur_lr": 9.999999747378752e-05, "total_loss": 0.17223212122917175, "policy_loss": -0.004357451107352972, "vf_loss": 0.17597168684005737, "vf_explained_var": 0.3966042697429657, "kl": 0.0091438302770257, "entropy": 2.417382001876831, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26942, "done": false, "timesteps_total": 1463244, "episodes_total": 1607, "training_iteration": 53, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-00-56", "timestamp": 1588820456, "time_this_iter_s": 66.23516511917114, "time_total_s": 3553.112291574478, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72469bea0>", "on_episode_step": "<function on_episode_step at 0x7fc725e99ea0>", "on_episode_end": "<function on_episode_end at 0x7fc725a0f6a8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725a0fa60>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7246ece18>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3553.112291574478, "timesteps_since_restore": 1463244, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 92.38085106382978, "ram_util_percent": 32.10212765957447}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00011, "episode_reward_mean": 0.10742099999999999, "episode_len_mean": 1155.57, "episodes_this_iter": 21, "policy_reward_min": {"av": -3.00011}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.10742099999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9091205886617884, "avg_speed_min": 1.470267457198212, "avg_speed_max": 5.265728634189573, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 30.823608162077534, "mean_processing_ms": 1.6736059711761333, "mean_inference_ms": 0.346419978709772}, "off_policy_estimator": {}, "info": {"num_steps_trained": 419328, "num_steps_sampled": 1489832, "sample_time_ms": 65925.427, "load_time_ms": 2.359, "grad_time_ms": 3911.824, "update_time_ms": 5.875, "learner": {"av": {"cur_kl_coeff": 0.06757621467113495, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0008871820173226297, "policy_loss": -0.0029537398368120193, "vf_loss": 0.0011085508158430457, "vf_explained_var": 0.8055254220962524, "kl": 0.014176689088344574, "entropy": 2.360137462615967, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26588, "done": false, "timesteps_total": 1489832, "episodes_total": 1628, "training_iteration": 54, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-02-05", "timestamp": 1588820525, "time_this_iter_s": 69.52649450302124, "time_total_s": 3622.6387860774994, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72465fea0>", "on_episode_step": "<function on_episode_step at 0x7fc725a0f730>", "on_episode_end": "<function on_episode_end at 0x7fc725a0fae8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725a0fea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7246dab70>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3622.6387860774994, "timesteps_since_restore": 1489832, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 89.06800000000001, "ram_util_percent": 32.1}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00011, "episode_reward_mean": 0.10742600000000001, "episode_len_mean": 1155.57, "episodes_this_iter": 26, "policy_reward_min": {"av": -3.00011}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.10742600000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.797683160936017, "avg_speed_min": 1.470267457198212, "avg_speed_max": 5.265728634189573, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 30.879496980927506, "mean_processing_ms": 1.6665901091342, "mean_inference_ms": 0.3474281869568421}, "off_policy_estimator": {}, "info": {"num_steps_trained": 428160, "num_steps_sampled": 1518686, "sample_time_ms": 66255.648, "load_time_ms": 2.356, "grad_time_ms": 3942.272, "update_time_ms": 5.821, "learner": {"av": {"cur_kl_coeff": 0.06757621467113495, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0014820365468040109, "policy_loss": -0.0029373890720307827, "vf_loss": 0.0006236519548110664, "vf_explained_var": 0.8849468231201172, "kl": 0.012307558208703995, "entropy": 2.3038387298583984, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28854, "done": false, "timesteps_total": 1518686, "episodes_total": 1654, "training_iteration": 55, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-03-19", "timestamp": 1588820599, "time_this_iter_s": 73.34671902656555, "time_total_s": 3695.985505104065, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc725e9ee18>", "on_episode_step": "<function on_episode_step at 0x7fc7246ece18>", "on_episode_end": "<function on_episode_end at 0x7fc7246ec9d8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246eca60>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725a0f7b8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3695.985505104065, "timesteps_since_restore": 1518686, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 90.89230769230768, "ram_util_percent": 32.150961538461544}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00011, "episode_reward_mean": 0.10741910000000003, "episode_len_mean": 1155.57, "episodes_this_iter": 21, "policy_reward_min": {"av": -3.00011}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.10741910000000003}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.901875597742416, "avg_speed_min": 1.470267457198212, "avg_speed_max": 5.265728634189573, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 30.9483381138594, "mean_processing_ms": 1.6618012596741578, "mean_inference_ms": 0.34899380523816703}, "off_policy_estimator": {}, "info": {"num_steps_trained": 436992, "num_steps_sampled": 1546058, "sample_time_ms": 66277.049, "load_time_ms": 2.34, "grad_time_ms": 3958.207, "update_time_ms": 5.829, "learner": {"av": {"cur_kl_coeff": 0.06757621467113495, "cur_lr": 9.999999747378752e-05, "total_loss": -0.024081747978925705, "policy_loss": -0.032037392258644104, "vf_loss": 0.0005080762202851474, "vf_explained_var": 0.9208762645721436, "kl": 0.11020994186401367, "entropy": 2.5384292602539062, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27372, "done": false, "timesteps_total": 1546058, "episodes_total": 1675, "training_iteration": 56, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-04-31", "timestamp": 1588820671, "time_this_iter_s": 71.7289879322052, "time_total_s": 3767.71449303627, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc725e99ea0>", "on_episode_step": "<function on_episode_step at 0x7fc72461e0d0>", "on_episode_end": "<function on_episode_end at 0x7fc72461e1e0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72461e6a8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725972c80>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3767.71449303627, "timesteps_since_restore": 1546058, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 89.79514563106795, "ram_util_percent": 32.16019417475728}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00004, "episode_reward_mean": 0.1849136, "episode_len_mean": 1181.57, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.00004}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1849136}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.7882124212342774, "avg_speed_min": 1.4938735257772588, "avg_speed_max": 5.006363593129032, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.00748181623238, "mean_processing_ms": 1.6530144356881444, "mean_inference_ms": 0.35035091398324786}, "off_policy_estimator": {}, "info": {"num_steps_trained": 446336, "num_steps_sampled": 1572839, "sample_time_ms": 66324.041, "load_time_ms": 2.314, "grad_time_ms": 3947.253, "update_time_ms": 5.867, "learner": {"av": {"cur_kl_coeff": 0.10136432945728302, "cur_lr": 9.999999747378752e-05, "total_loss": -0.00343706994317472, "policy_loss": -0.005034341476857662, "vf_loss": 0.0005790869472548366, "vf_explained_var": 0.9082823395729065, "kl": 0.010044805705547333, "entropy": 2.4592278003692627, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26781, "done": false, "timesteps_total": 1572839, "episodes_total": 1698, "training_iteration": 57, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-05-43", "timestamp": 1588820743, "time_this_iter_s": 71.75406527519226, "time_total_s": 3839.4685583114624, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72465fea0>", "on_episode_step": "<function on_episode_step at 0x7fc7246ec9d8>", "on_episode_end": "<function on_episode_end at 0x7fc7246ece18>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246ec8c8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725972d08>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3839.4685583114624, "timesteps_since_restore": 1572839, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 91.42254901960783, "ram_util_percent": 32.16568627450979}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": 0.24891, "episode_reward_mean": 0.2498912, "episode_len_mean": 1200.0, "episodes_this_iter": 21, "policy_reward_min": {"av": 0.24891}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.2498912}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.804448214019234, "avg_speed_min": 1.4723777571327514, "avg_speed_max": 4.560903000949756, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.032857737786365, "mean_processing_ms": 1.6512846457544788, "mean_inference_ms": 0.3508669556318775}, "off_policy_estimator": {}, "info": {"num_steps_trained": 453760, "num_steps_sampled": 1598553, "sample_time_ms": 66014.338, "load_time_ms": 2.312, "grad_time_ms": 3936.734, "update_time_ms": 5.952, "learner": {"av": {"cur_kl_coeff": 0.10136432945728302, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0008515320951119065, "policy_loss": -0.00047660156269557774, "vf_loss": 0.0005660621100105345, "vf_explained_var": 0.9056158661842346, "kl": 0.007518154103308916, "entropy": 2.646850824356079, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25714, "done": false, "timesteps_total": 1598553, "episodes_total": 1719, "training_iteration": 58, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-06-46", "timestamp": 1588820806, "time_this_iter_s": 63.51854395866394, "time_total_s": 3902.9871022701263, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246eca60>", "on_episode_step": "<function on_episode_step at 0x7fc72461e1e0>", "on_episode_end": "<function on_episode_end at 0x7fc72461e0d0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72461e6a8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72469be18>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3902.9871022701263, "timesteps_since_restore": 1598553, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 88.86703296703297, "ram_util_percent": 32.17912087912087}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": 0.24891, "episode_reward_mean": 0.2498897, "episode_len_mean": 1200.0, "episodes_this_iter": 22, "policy_reward_min": {"av": 0.24891}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.2498897}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.810585982285027, "avg_speed_min": 1.2677400068241127, "avg_speed_max": 4.434648509843693, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.067175908703238, "mean_processing_ms": 1.646151860854098, "mean_inference_ms": 0.3514898638890363}, "off_policy_estimator": {}, "info": {"num_steps_trained": 462336, "num_steps_sampled": 1625033, "sample_time_ms": 65909.641, "load_time_ms": 2.31, "grad_time_ms": 3946.272, "update_time_ms": 5.983, "learner": {"av": {"cur_kl_coeff": 0.10136432945728302, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0012916941195726395, "policy_loss": -0.0027965083718299866, "vf_loss": 0.0004519489884842187, "vf_explained_var": 0.9010862708091736, "kl": 0.010386938229203224, "entropy": 2.3058786392211914, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26480, "done": false, "timesteps_total": 1625033, "episodes_total": 1741, "training_iteration": 59, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-07-56", "timestamp": 1588820876, "time_this_iter_s": 69.31106877326965, "time_total_s": 3972.298171043396, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc729044400>", "on_episode_step": "<function on_episode_step at 0x7fc7246ece18>", "on_episode_end": "<function on_episode_end at 0x7fc7246ec9d8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725972d08>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7246daea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3972.298171043396, "timesteps_since_restore": 1625033, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 90.81616161616162, "ram_util_percent": 32.19494949494948}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00069, "episode_reward_mean": 0.21737849999999997, "episode_len_mean": 1192.76, "episodes_this_iter": 22, "policy_reward_min": {"av": -3.00069}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.21737849999999997}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.803669529558603, "avg_speed_min": 1.2571729763567379, "avg_speed_max": 4.3248219675871065, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.103927936245732, "mean_processing_ms": 1.6399803467349003, "mean_inference_ms": 0.3519917093851393}, "off_policy_estimator": {}, "info": {"num_steps_trained": 471808, "num_steps_sampled": 1651132, "sample_time_ms": 65673.655, "load_time_ms": 2.44, "grad_time_ms": 3937.594, "update_time_ms": 6.008, "learner": {"av": {"cur_kl_coeff": 0.10136432945728302, "cur_lr": 9.999999747378752e-05, "total_loss": -0.00031011353712528944, "policy_loss": -0.0033604493364691734, "vf_loss": 0.00268130493350327, "vf_explained_var": 0.9284826517105103, "kl": 0.0036406517028808594, "entropy": 2.2903096675872803, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26099, "done": false, "timesteps_total": 1651132, "episodes_total": 1763, "training_iteration": 60, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-09-07", "timestamp": 1588820947, "time_this_iter_s": 71.2825677394867, "time_total_s": 4043.5807387828827, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc725e99ea0>", "on_episode_step": "<function on_episode_step at 0x7fc72469b158>", "on_episode_end": "<function on_episode_end at 0x7fc72469b488>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72465fea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7259721e0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4043.5807387828827, "timesteps_since_restore": 1651132, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 90.85882352941175, "ram_util_percent": 32.19999999999998}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00069, "episode_reward_mean": 0.2173719, "episode_len_mean": 1192.76, "episodes_this_iter": 24, "policy_reward_min": {"av": -3.00069}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.2173719}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.844018995616085, "avg_speed_min": 1.2571729763567379, "avg_speed_max": 4.415954885089846, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.130351062803264, "mean_processing_ms": 1.6377355193434717, "mean_inference_ms": 0.3524005161592094}, "off_policy_estimator": {}, "info": {"num_steps_trained": 480000, "num_steps_sampled": 1679076, "sample_time_ms": 66014.682, "load_time_ms": 2.437, "grad_time_ms": 3953.662, "update_time_ms": 5.906, "learner": {"av": {"cur_kl_coeff": 0.05068216472864151, "cur_lr": 9.999999747378752e-05, "total_loss": 0.006313901394605637, "policy_loss": -0.0013969456776976585, "vf_loss": 0.0071479566395282745, "vf_explained_var": 0.7900031208992004, "kl": 0.01110626757144928, "entropy": 2.5737228393554688, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27944, "done": false, "timesteps_total": 1679076, "episodes_total": 1787, "training_iteration": 61, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-10-16", "timestamp": 1588821016, "time_this_iter_s": 69.38255763053894, "time_total_s": 4112.963296413422, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72469be18>", "on_episode_step": "<function on_episode_step at 0x7fc7246ece18>", "on_episode_end": "<function on_episode_end at 0x7fc7246ec9d8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725972d08>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725a0fc80>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4112.963296413422, "timesteps_since_restore": 1679076, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 89.91818181818182, "ram_util_percent": 32.20404040404039}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00069, "episode_reward_mean": 0.18485020000000002, "episode_len_mean": 1183.94, "episodes_this_iter": 24, "policy_reward_min": {"av": -3.00069}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.18485020000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.8825683683946917, "avg_speed_min": 1.2571729763567379, "avg_speed_max": 5.056788925092147, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.174970370856137, "mean_processing_ms": 1.6315922582139961, "mean_inference_ms": 0.35339750462026}, "off_policy_estimator": {}, "info": {"num_steps_trained": 487808, "num_steps_sampled": 1706755, "sample_time_ms": 65462.282, "load_time_ms": 2.431, "grad_time_ms": 3890.385, "update_time_ms": 6.009, "learner": {"av": {"cur_kl_coeff": 0.05068216472864151, "cur_lr": 9.999999747378752e-05, "total_loss": 0.04059057682752609, "policy_loss": -0.008207350037992, "vf_loss": 0.047790613025426865, "vf_explained_var": 0.5689458847045898, "kl": 0.01987512595951557, "entropy": 2.4946956634521484, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27679, "done": false, "timesteps_total": 1706755, "episodes_total": 1811, "training_iteration": 62, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-11-24", "timestamp": 1588821084, "time_this_iter_s": 67.64548540115356, "time_total_s": 4180.608781814575, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc729044400>", "on_episode_step": "<function on_episode_step at 0x7fc72469b488>", "on_episode_end": "<function on_episode_end at 0x7fc72469b158>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7259721e0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72461e378>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4180.608781814575, "timesteps_since_restore": 1706755, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 89.96458333333332, "ram_util_percent": 32.199999999999996}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00069, "episode_reward_mean": 0.1723537, "episode_len_mean": 1175.33, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.00069}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1723537}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.961988997044654, "avg_speed_min": 1.2571729763567379, "avg_speed_max": 5.056788925092147, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.16521691551786, "mean_processing_ms": 1.6277544027116482, "mean_inference_ms": 0.35295667393593405}, "off_policy_estimator": {}, "info": {"num_steps_trained": 495104, "num_steps_sampled": 1733581, "sample_time_ms": 65333.914, "load_time_ms": 2.406, "grad_time_ms": 3861.653, "update_time_ms": 5.989, "learner": {"av": {"cur_kl_coeff": 0.05068216472864151, "cur_lr": 9.999999747378752e-05, "total_loss": 0.004172959364950657, "policy_loss": -0.004570066463202238, "vf_loss": 0.007854459807276726, "vf_explained_var": 0.5790125727653503, "kl": 0.017532097175717354, "entropy": 2.4476003646850586, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26826, "done": false, "timesteps_total": 1733581, "episodes_total": 1834, "training_iteration": 63, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-12-29", "timestamp": 1588821149, "time_this_iter_s": 64.66313171386719, "time_total_s": 4245.271913528442, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72469b950>", "on_episode_step": "<function on_episode_step at 0x7fc7246ece18>", "on_episode_end": "<function on_episode_end at 0x7fc725a0fc80>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725a0f6a8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72461e9d8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4245.271913528442, "timesteps_since_restore": 1733581, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 88.90645161290321, "ram_util_percent": 32.197849462365575}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00025, "episode_reward_mean": 0.2048564, "episode_len_mean": 1182.57, "episodes_this_iter": 22, "policy_reward_min": {"av": -3.00025}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.2048564}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9959811336128177, "avg_speed_min": 1.4606693412477307, "avg_speed_max": 5.056788925092147, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.17688579796876, "mean_processing_ms": 1.625550473782534, "mean_inference_ms": 0.3531112351783468}, "off_policy_estimator": {}, "info": {"num_steps_trained": 502656, "num_steps_sampled": 1759811, "sample_time_ms": 64804.624, "load_time_ms": 2.376, "grad_time_ms": 3812.384, "update_time_ms": 6.009, "learner": {"av": {"cur_kl_coeff": 0.05068216472864151, "cur_lr": 9.999999747378752e-05, "total_loss": -0.01035595778375864, "policy_loss": -0.011967315338551998, "vf_loss": 0.00041602985584177077, "vf_explained_var": 0.9043807983398438, "kl": 0.02358481101691723, "entropy": 2.2411532402038574, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26230, "done": false, "timesteps_total": 1759811, "episodes_total": 1856, "training_iteration": 64, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-13-33", "timestamp": 1588821213, "time_this_iter_s": 63.740360260009766, "time_total_s": 4309.012273788452, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246ec9d8>", "on_episode_step": "<function on_episode_step at 0x7fc72469b488>", "on_episode_end": "<function on_episode_end at 0x7fc729044400>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7259721e0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724682d08>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4309.012273788452, "timesteps_since_restore": 1759811, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 91.35164835164834, "ram_util_percent": 32.19999999999999}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00025, "episode_reward_mean": 0.0748627, "episode_len_mean": 1142.65, "episodes_this_iter": 27, "policy_reward_min": {"av": -3.00025}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.0748627}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.95886134780593, "avg_speed_min": 1.4606693412477307, "avg_speed_max": 5.056788925092147, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.20017533481384, "mean_processing_ms": 1.6240532384134383, "mean_inference_ms": 0.35340937789636434}, "off_policy_estimator": {}, "info": {"num_steps_trained": 510976, "num_steps_sampled": 1787651, "sample_time_ms": 64504.845, "load_time_ms": 2.372, "grad_time_ms": 3787.505, "update_time_ms": 5.998, "learner": {"av": {"cur_kl_coeff": 0.07602324336767197, "cur_lr": 9.999999747378752e-05, "total_loss": 0.059503957629203796, "policy_loss": -0.0038858435582369566, "vf_loss": 0.0629827156662941, "vf_explained_var": 0.5387513637542725, "kl": 0.005354729946702719, "entropy": 2.405264139175415, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27840, "done": false, "timesteps_total": 1787651, "episodes_total": 1883, "training_iteration": 65, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-14-43", "timestamp": 1588821283, "time_this_iter_s": 70.09957981109619, "time_total_s": 4379.111853599548, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72465fea0>", "on_episode_step": "<function on_episode_step at 0x7fc72469b950>", "on_episode_end": "<function on_episode_end at 0x7fc72469be18>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72461e9d8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725a0fb70>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4379.111853599548, "timesteps_since_restore": 1787651, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 89.35300000000001, "ram_util_percent": 32.19999999999999}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00025, "episode_reward_mean": 0.042380400000000026, "episode_len_mean": 1133.23, "episodes_this_iter": 19, "policy_reward_min": {"av": -3.00025}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.042380400000000026}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.986518763590307, "avg_speed_min": 1.4735573347148019, "avg_speed_max": 5.056788925092147, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.206779324702108, "mean_processing_ms": 1.6221571558211492, "mean_inference_ms": 0.35351700876901815}, "off_policy_estimator": {}, "info": {"num_steps_trained": 520064, "num_steps_sampled": 1811863, "sample_time_ms": 64087.126, "load_time_ms": 2.408, "grad_time_ms": 3801.288, "update_time_ms": 5.942, "learner": {"av": {"cur_kl_coeff": 0.07602324336767197, "cur_lr": 9.999999747378752e-05, "total_loss": 0.03685925900936127, "policy_loss": -0.0016162884421646595, "vf_loss": 0.038060083985328674, "vf_explained_var": 0.3302116096019745, "kl": 0.005464985966682434, "entropy": 2.089428424835205, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 24212, "done": false, "timesteps_total": 1811863, "episodes_total": 1902, "training_iteration": 66, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-15-51", "timestamp": 1588821351, "time_this_iter_s": 67.69015550613403, "time_total_s": 4446.802009105682, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72469b158>", "on_episode_step": "<function on_episode_step at 0x7fc729044400>", "on_episode_end": "<function on_episode_end at 0x7fc725a0fea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725a0fae8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7259721e0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4446.802009105682, "timesteps_since_restore": 1811863, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 91.01340206185566, "ram_util_percent": 32.20103092783504}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00026, "episode_reward_mean": 0.022378300000000007, "episode_len_mean": 1132.42, "episodes_this_iter": 27, "policy_reward_min": {"av": -3.00026}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.022378300000000007}, "custom_metrics": {"num_ped_collisions_mean": 0.07, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.896335979449593, "avg_speed_min": 1.5820090952834178, "avg_speed_max": 4.3283346087166645, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.213075711321913, "mean_processing_ms": 1.6207503676664379, "mean_inference_ms": 0.35343347642708495}, "off_policy_estimator": {}, "info": {"num_steps_trained": 527232, "num_steps_sampled": 1840074, "sample_time_ms": 63528.984, "load_time_ms": 2.401, "grad_time_ms": 3701.765, "update_time_ms": 5.963, "learner": {"av": {"cur_kl_coeff": 0.07602324336767197, "cur_lr": 9.999999747378752e-05, "total_loss": 0.016492491587996483, "policy_loss": -0.009156747721135616, "vf_loss": 0.025035684928297997, "vf_explained_var": 0.8649421334266663, "kl": 0.008070570416748524, "entropy": 2.3715298175811768, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28211, "done": false, "timesteps_total": 1840074, "episodes_total": 1929, "training_iteration": 67, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-16-56", "timestamp": 1588821416, "time_this_iter_s": 65.17831993103027, "time_total_s": 4511.980329036713, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246daea0>", "on_episode_step": "<function on_episode_step at 0x7fc72469be18>", "on_episode_end": "<function on_episode_end at 0x7fc72469b950>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725a0fb70>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725972f28>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4511.980329036713, "timesteps_since_restore": 1840074, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 89.54516129032255, "ram_util_percent": 32.19999999999998}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00026, "episode_reward_mean": -0.010111999999999996, "episode_len_mean": 1122.69, "episodes_this_iter": 25, "policy_reward_min": {"av": -3.00026}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.010111999999999996}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.939570530915991, "avg_speed_min": 1.5820090952834178, "avg_speed_max": 4.3283346087166645, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.22801077968565, "mean_processing_ms": 1.6161896769456918, "mean_inference_ms": 0.3536476258968596}, "off_policy_estimator": {}, "info": {"num_steps_trained": 535296, "num_steps_sampled": 1869446, "sample_time_ms": 64235.652, "load_time_ms": 2.404, "grad_time_ms": 3729.192, "update_time_ms": 5.892, "learner": {"av": {"cur_kl_coeff": 0.07602324336767197, "cur_lr": 9.999999747378752e-05, "total_loss": 0.02938123792409897, "policy_loss": -0.00340742408297956, "vf_loss": 0.03245397284626961, "vf_explained_var": 0.40758761763572693, "kl": 0.004402420483529568, "entropy": 2.205653667449951, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 29372, "done": false, "timesteps_total": 1869446, "episodes_total": 1954, "training_iteration": 68, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-18-07", "timestamp": 1588821487, "time_this_iter_s": 70.85982155799866, "time_total_s": 4582.840150594711, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72461e9d8>", "on_episode_step": "<function on_episode_step at 0x7fc72469b158>", "on_episode_end": "<function on_episode_end at 0x7fc725a0fea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725a0fae8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724682510>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4582.840150594711, "timesteps_since_restore": 1869446, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 89.92574257425743, "ram_util_percent": 32.19999999999998}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00026, "episode_reward_mean": 0.0873866, "episode_len_mean": 1153.17, "episodes_this_iter": 24, "policy_reward_min": {"av": -3.00026}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.0873866}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.000354171994542, "avg_speed_min": 1.5421938527395687, "avg_speed_max": 5.266081131698326, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.240400971550603, "mean_processing_ms": 1.6121538543890126, "mean_inference_ms": 0.3540699606768784}, "off_policy_estimator": {}, "info": {"num_steps_trained": 543360, "num_steps_sampled": 1897529, "sample_time_ms": 64245.506, "load_time_ms": 2.402, "grad_time_ms": 3709.135, "update_time_ms": 5.874, "learner": {"av": {"cur_kl_coeff": 0.03801162168383598, "cur_lr": 9.999999747378752e-05, "total_loss": 0.018337639048695564, "policy_loss": -0.005830490496009588, "vf_loss": 0.02367456443607807, "vf_explained_var": 0.5822843909263611, "kl": 0.012984578497707844, "entropy": 2.281249761581421, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28083, "done": false, "timesteps_total": 1897529, "episodes_total": 1978, "training_iteration": 69, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-19-16", "timestamp": 1588821556, "time_this_iter_s": 69.20783829689026, "time_total_s": 4652.047988891602, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72469b488>", "on_episode_step": "<function on_episode_step at 0x7fc72469b950>", "on_episode_end": "<function on_episode_end at 0x7fc72469be18>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725972f28>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724682268>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4652.047988891602, "timesteps_since_restore": 1897529, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 89.0242424242424, "ram_util_percent": 32.19999999999999}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00026, "episode_reward_mean": 0.11989140000000001, "episode_len_mean": 1162.59, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.00026}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.11989140000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.0697101480138294, "avg_speed_min": 1.4438612254026784, "avg_speed_max": 5.355064830004644, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.218621200514303, "mean_processing_ms": 1.609953104633065, "mean_inference_ms": 0.3534356485004523}, "off_policy_estimator": {}, "info": {"num_steps_trained": 551296, "num_steps_sampled": 1924919, "sample_time_ms": 63952.785, "load_time_ms": 2.234, "grad_time_ms": 3637.558, "update_time_ms": 5.708, "learner": {"av": {"cur_kl_coeff": 0.03801162168383598, "cur_lr": 9.999999747378752e-05, "total_loss": 0.020427599549293518, "policy_loss": -0.005167386960238218, "vf_loss": 0.02514750510454178, "vf_explained_var": 0.35648342967033386, "kl": 0.011772033758461475, "entropy": 2.154513120651245, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27390, "done": false, "timesteps_total": 1924919, "episodes_total": 2001, "training_iteration": 70, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-20-24", "timestamp": 1588821624, "time_this_iter_s": 67.63554048538208, "time_total_s": 4719.683529376984, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246daea0>", "on_episode_step": "<function on_episode_step at 0x7fc724682510>", "on_episode_end": "<function on_episode_end at 0x7fc724682400>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc724682c80>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724682ea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4719.683529376984, "timesteps_since_restore": 1924919, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 90.57083333333333, "ram_util_percent": 32.199999999999996}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00028, "episode_reward_mean": 0.11990230000000002, "episode_len_mean": 1161.94, "episodes_this_iter": 24, "policy_reward_min": {"av": -3.00028}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.11990230000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.084191256385093, "avg_speed_min": 1.4438612254026784, "avg_speed_max": 5.355064830004644, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.236324299155143, "mean_processing_ms": 1.603339691699897, "mean_inference_ms": 0.35388677800905477}, "off_policy_estimator": {}, "info": {"num_steps_trained": 559104, "num_steps_sampled": 1952038, "sample_time_ms": 63713.958, "load_time_ms": 2.233, "grad_time_ms": 3620.386, "update_time_ms": 5.659, "learner": {"av": {"cur_kl_coeff": 0.03801162168383598, "cur_lr": 9.999999747378752e-05, "total_loss": 0.020867133513092995, "policy_loss": -0.0028998861089348793, "vf_loss": 0.023342790082097054, "vf_explained_var": 0.7411800026893616, "kl": 0.011160590685904026, "entropy": 2.275959014892578, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27119, "done": false, "timesteps_total": 1952038, "episodes_total": 2025, "training_iteration": 71, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-21-31", "timestamp": 1588821691, "time_this_iter_s": 66.82216668128967, "time_total_s": 4786.505696058273, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc729044400>", "on_episode_step": "<function on_episode_step at 0x7fc72469b950>", "on_episode_end": "<function on_episode_end at 0x7fc72469b488>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc724682268>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725972488>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4786.505696058273, "timesteps_since_restore": 1952038, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 89.92395833333335, "ram_util_percent": 32.20312499999999}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00028, "episode_reward_mean": 0.15239650000000002, "episode_len_mean": 1171.67, "episodes_this_iter": 22, "policy_reward_min": {"av": -3.00028}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.15239650000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.0867095528470037, "avg_speed_min": 1.4438612254026784, "avg_speed_max": 5.355064830004644, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.20964287911455, "mean_processing_ms": 1.6018643314596712, "mean_inference_ms": 0.3532761800818996}, "off_policy_estimator": {}, "info": {"num_steps_trained": 566656, "num_steps_sampled": 1978791, "sample_time_ms": 63457.805, "load_time_ms": 2.214, "grad_time_ms": 3606.716, "update_time_ms": 5.55, "learner": {"av": {"cur_kl_coeff": 0.03801162168383598, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0009420766727998853, "policy_loss": -0.000918869161978364, "vf_loss": 0.0013334885006770492, "vf_explained_var": 0.8229809999465942, "kl": 0.013876184821128845, "entropy": 2.1936697959899902, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26753, "done": false, "timesteps_total": 1978791, "episodes_total": 2047, "training_iteration": 72, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-22-36", "timestamp": 1588821756, "time_this_iter_s": 64.94553565979004, "time_total_s": 4851.451231718063, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72469b158>", "on_episode_step": "<function on_episode_step at 0x7fc724682400>", "on_episode_end": "<function on_episode_end at 0x7fc724682510>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc724682ea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72461eb70>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4851.451231718063, "timesteps_since_restore": 1978791, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 91.14673913043478, "ram_util_percent": 32.19999999999999}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00028, "episode_reward_mean": 0.18489329999999998, "episode_len_mean": 1181.11, "episodes_this_iter": 24, "policy_reward_min": {"av": -3.00028}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.18489329999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.016695014937745, "avg_speed_min": 1.4438612254026784, "avg_speed_max": 5.355064830004644, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.206001107184235, "mean_processing_ms": 1.5976089418232313, "mean_inference_ms": 0.35313015192067704}, "off_policy_estimator": {}, "info": {"num_steps_trained": 574208, "num_steps_sampled": 2006512, "sample_time_ms": 63470.888, "load_time_ms": 2.222, "grad_time_ms": 3616.285, "update_time_ms": 5.546, "learner": {"av": {"cur_kl_coeff": 0.03801162168383598, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0002768219565041363, "policy_loss": -0.0011416812194511294, "vf_loss": 0.00048075549420900643, "vf_explained_var": 0.9062514901161194, "kl": 0.010104863904416561, "entropy": 2.256040096282959, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27721, "done": false, "timesteps_total": 2006512, "episodes_total": 2071, "training_iteration": 73, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-23-41", "timestamp": 1588821821, "time_this_iter_s": 64.89022469520569, "time_total_s": 4916.341456413269, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc724682c80>", "on_episode_step": "<function on_episode_step at 0x7fc72469b488>", "on_episode_end": "<function on_episode_end at 0x7fc72469b950>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725972488>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72461e1e0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4916.341456413269, "timesteps_since_restore": 2006512, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 90.56451612903224, "ram_util_percent": 32.2032258064516}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00028, "episode_reward_mean": 0.1848878, "episode_len_mean": 1181.11, "episodes_this_iter": 22, "policy_reward_min": {"av": -3.00028}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1848878}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.0230765165357583, "avg_speed_min": 1.4438612254026784, "avg_speed_max": 5.355064830004644, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.218584323926297, "mean_processing_ms": 1.5948934929637164, "mean_inference_ms": 0.3532848123007173}, "off_policy_estimator": {}, "info": {"num_steps_trained": 583040, "num_steps_sampled": 2034317, "sample_time_ms": 64166.711, "load_time_ms": 2.238, "grad_time_ms": 3674.089, "update_time_ms": 5.511, "learner": {"av": {"cur_kl_coeff": 0.03801162168383598, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0026492790784686804, "policy_loss": -0.003392087761312723, "vf_loss": 0.0004416425945237279, "vf_explained_var": 0.9065800905227661, "kl": 0.007922998629510403, "entropy": 2.32317852973938, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27805, "done": false, "timesteps_total": 2034317, "episodes_total": 2093, "training_iteration": 74, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-24-52", "timestamp": 1588821892, "time_this_iter_s": 71.27712845802307, "time_total_s": 4987.618584871292, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc724682268>", "on_episode_step": "<function on_episode_step at 0x7fc724682510>", "on_episode_end": "<function on_episode_end at 0x7fc724682400>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc724682ea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7246c21e0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4987.618584871292, "timesteps_since_restore": 2034317, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 91.33235294117651, "ram_util_percent": 32.217647058823516}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00028, "episode_reward_mean": 0.21739739999999996, "episode_len_mean": 1191.42, "episodes_this_iter": 24, "policy_reward_min": {"av": -3.00028}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.21739739999999996}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.9724653304372395, "avg_speed_min": 1.546593757833614, "avg_speed_max": 5.02722853495356, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.2085668057923, "mean_processing_ms": 1.5913300098211405, "mean_inference_ms": 0.35296213061497395}, "off_policy_estimator": {}, "info": {"num_steps_trained": 590976, "num_steps_sampled": 2062228, "sample_time_ms": 63886.118, "load_time_ms": 2.25, "grad_time_ms": 3655.493, "update_time_ms": 5.561, "learner": {"av": {"cur_kl_coeff": 0.03801162168383598, "cur_lr": 9.999999747378752e-05, "total_loss": -0.00137255247682333, "policy_loss": -0.0021401585545390844, "vf_loss": 0.0005480188992805779, "vf_explained_var": 0.8979503512382507, "kl": 0.0057768383994698524, "entropy": 2.3271448612213135, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27911, "done": false, "timesteps_total": 2062228, "episodes_total": 2117, "training_iteration": 75, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-26-00", "timestamp": 1588821960, "time_this_iter_s": 67.10838294029236, "time_total_s": 5054.7269678115845, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72469be18>", "on_episode_step": "<function on_episode_step at 0x7fc72469b488>", "on_episode_end": "<function on_episode_end at 0x7fc725e99ea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725a0fb70>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725972488>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5054.7269678115845, "timesteps_since_restore": 2062228, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 91.09583333333335, "ram_util_percent": 32.26770833333334}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": 0.24913, "episode_reward_mean": 0.24989419999999998, "episode_len_mean": 1200.0, "episodes_this_iter": 20, "policy_reward_min": {"av": 0.24913}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.24989419999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.9795065658750253, "avg_speed_min": 1.546593757833614, "avg_speed_max": 5.02722853495356, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.215755254451636, "mean_processing_ms": 1.5900619482111638, "mean_inference_ms": 0.3530841586039353}, "off_policy_estimator": {}, "info": {"num_steps_trained": 599296, "num_steps_sampled": 2087410, "sample_time_ms": 63725.269, "load_time_ms": 2.206, "grad_time_ms": 3617.889, "update_time_ms": 5.649, "learner": {"av": {"cur_kl_coeff": 0.03801162168383598, "cur_lr": 9.999999747378752e-05, "total_loss": -0.011340757831931114, "policy_loss": -0.013243223540484905, "vf_loss": 0.00043882281170226634, "vf_explained_var": 0.9015856981277466, "kl": 0.03850520774722099, "entropy": 2.3908326625823975, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25182, "done": false, "timesteps_total": 2087410, "episodes_total": 2137, "training_iteration": 76, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-27-05", "timestamp": 1588822025, "time_this_iter_s": 65.70543956756592, "time_total_s": 5120.43240737915, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72469b158>", "on_episode_step": "<function on_episode_step at 0x7fc725a0fae8>", "on_episode_end": "<function on_episode_end at 0x7fc725a0f730>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725a0ff28>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725972ea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5120.43240737915, "timesteps_since_restore": 2087410, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 90.97849462365592, "ram_util_percent": 32.29247311827958}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": 0.24913, "episode_reward_mean": 0.2498964, "episode_len_mean": 1200.0, "episodes_this_iter": 20, "policy_reward_min": {"av": 0.24913}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.2498964}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.7999833256230784, "avg_speed_min": 1.5607344644870098, "avg_speed_max": 4.083395821149042, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.2564251923307, "mean_processing_ms": 1.5854578025557258, "mean_inference_ms": 0.35397348166586445}, "off_policy_estimator": {}, "info": {"num_steps_trained": 608512, "num_steps_sampled": 2111974, "sample_time_ms": 63982.639, "load_time_ms": 2.231, "grad_time_ms": 3708.988, "update_time_ms": 5.638, "learner": {"av": {"cur_kl_coeff": 0.057017434388399124, "cur_lr": 9.999999747378752e-05, "total_loss": -0.00043033561087213457, "policy_loss": -0.0014580392744392157, "vf_loss": 0.0005566913750953972, "vf_explained_var": 0.8853335976600647, "kl": 0.008260811679065228, "entropy": 2.416041135787964, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 24564, "done": false, "timesteps_total": 2111974, "episodes_total": 2157, "training_iteration": 77, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-28-14", "timestamp": 1588822094, "time_this_iter_s": 68.66359281539917, "time_total_s": 5189.09600019455, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72469b488>", "on_episode_step": "<function on_episode_step at 0x7fc72469be18>", "on_episode_end": "<function on_episode_end at 0x7fc725a0fea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725a0fb70>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724682620>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5189.09600019455, "timesteps_since_restore": 2111974, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 90.44747474747474, "ram_util_percent": 32.27979797979799}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00014, "episode_reward_mean": 0.2048833, "episode_len_mean": 1183.0, "episodes_this_iter": 25, "policy_reward_min": {"av": -3.00014}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.2048833}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.7632189227096786, "avg_speed_min": 1.4821927791637648, "avg_speed_max": 4.247477333199329, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.285981904675754, "mean_processing_ms": 1.5832082156578144, "mean_inference_ms": 0.3546326245467022}, "off_policy_estimator": {}, "info": {"num_steps_trained": 616832, "num_steps_sampled": 2138929, "sample_time_ms": 63708.847, "load_time_ms": 2.238, "grad_time_ms": 3720.664, "update_time_ms": 5.703, "learner": {"av": {"cur_kl_coeff": 0.057017434388399124, "cur_lr": 9.999999747378752e-05, "total_loss": 0.012868937104940414, "policy_loss": -0.009193077683448792, "vf_loss": 0.02084004506468773, "vf_explained_var": 0.7173327207565308, "kl": 0.02143150568008423, "entropy": 2.4264094829559326, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26955, "done": false, "timesteps_total": 2138929, "episodes_total": 2182, "training_iteration": 78, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-29-23", "timestamp": 1588822163, "time_this_iter_s": 68.23968434333801, "time_total_s": 5257.335684537888, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72469b950>", "on_episode_step": "<function on_episode_step at 0x7fc725a0f730>", "on_episode_end": "<function on_episode_end at 0x7fc725a0fae8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725972ea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7246ec8c8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5257.335684537888, "timesteps_since_restore": 2138929, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 90.41546391752577, "ram_util_percent": 32.29690721649485}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00024, "episode_reward_mean": 0.1073849, "episode_len_mean": 1155.41, "episodes_this_iter": 25, "policy_reward_min": {"av": -3.00024}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1073849}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.8034717091279173, "avg_speed_min": 1.4821927791637648, "avg_speed_max": 4.247477333199329, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.329796350083157, "mean_processing_ms": 1.5806340807953012, "mean_inference_ms": 0.3556765646339886}, "off_policy_estimator": {}, "info": {"num_steps_trained": 624000, "num_steps_sampled": 2165542, "sample_time_ms": 63128.767, "load_time_ms": 2.207, "grad_time_ms": 3677.034, "update_time_ms": 5.748, "learner": {"av": {"cur_kl_coeff": 0.08552615344524384, "cur_lr": 9.999999747378752e-05, "total_loss": 0.05543580278754234, "policy_loss": -0.003279270837083459, "vf_loss": 0.05821281671524048, "vf_explained_var": 0.778005063533783, "kl": 0.005872555077075958, "entropy": 2.342395305633545, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26613, "done": false, "timesteps_total": 2165542, "episodes_total": 2207, "training_iteration": 79, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-30-26", "timestamp": 1588822226, "time_this_iter_s": 62.97108745574951, "time_total_s": 5320.306771993637, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc725e99ea0>", "on_episode_step": "<function on_episode_step at 0x7fc725a0fea0>", "on_episode_end": "<function on_episode_end at 0x7fc72469be18>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc724682620>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7246c2400>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5320.306771993637, "timesteps_since_restore": 2165542, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 90.2011111111111, "ram_util_percent": 32.296666666666674}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00024, "episode_reward_mean": 0.10739280000000001, "episode_len_mean": 1155.41, "episodes_this_iter": 22, "policy_reward_min": {"av": -3.00024}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.10739280000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.818690323824144, "avg_speed_min": 1.4821927791637648, "avg_speed_max": 4.247477333199329, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.330289246590702, "mean_processing_ms": 1.578951965571694, "mean_inference_ms": 0.3557015234598417}, "off_policy_estimator": {}, "info": {"num_steps_trained": 631680, "num_steps_sampled": 2192552, "sample_time_ms": 62982.554, "load_time_ms": 2.202, "grad_time_ms": 3664.779, "update_time_ms": 5.829, "learner": {"av": {"cur_kl_coeff": 0.08552615344524384, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0025316900573670864, "policy_loss": -0.005021920893341303, "vf_loss": 0.0012472198577597737, "vf_explained_var": 0.754723846912384, "kl": 0.014533673413097858, "entropy": 2.2600698471069336, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27010, "done": false, "timesteps_total": 2192552, "episodes_total": 2229, "training_iteration": 80, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-31-32", "timestamp": 1588822292, "time_this_iter_s": 66.05178928375244, "time_total_s": 5386.3585612773895, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc724682950>", "on_episode_step": "<function on_episode_step at 0x7fc724682d08>", "on_episode_end": "<function on_episode_end at 0x7fc7246822f0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc724682378>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7246daea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5386.3585612773895, "timesteps_since_restore": 2192552, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 89.98404255319147, "ram_util_percent": 32.29787234042555}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00024, "episode_reward_mean": 0.10739439999999999, "episode_len_mean": 1155.41, "episodes_this_iter": 22, "policy_reward_min": {"av": -3.00024}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.10739439999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.928952700562168, "avg_speed_min": 1.4821927791637648, "avg_speed_max": 4.247477333199329, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.348682020076396, "mean_processing_ms": 1.5771616525600494, "mean_inference_ms": 0.35601329514802954}, "off_policy_estimator": {}, "info": {"num_steps_trained": 639488, "num_steps_sampled": 2219113, "sample_time_ms": 62870.289, "load_time_ms": 2.202, "grad_time_ms": 3665.415, "update_time_ms": 5.906, "learner": {"av": {"cur_kl_coeff": 0.08552615344524384, "cur_lr": 9.999999747378752e-05, "total_loss": -0.012974770739674568, "policy_loss": -0.015354892238974571, "vf_loss": 0.0006975108408369124, "vf_explained_var": 0.8687283992767334, "kl": 0.019673621281981468, "entropy": 2.2791268825531006, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26561, "done": false, "timesteps_total": 2219113, "episodes_total": 2251, "training_iteration": 81, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-32-38", "timestamp": 1588822358, "time_this_iter_s": 65.70908904075623, "time_total_s": 5452.067650318146, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc724682a60>", "on_episode_step": "<function on_episode_step at 0x7fc724682620>", "on_episode_end": "<function on_episode_end at 0x7fc724682268>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72469be18>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725972e18>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5452.067650318146, "timesteps_since_restore": 2219113, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 90.6531914893617, "ram_util_percent": 32.30106382978725}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00024, "episode_reward_mean": 0.15241059999999998, "episode_len_mean": 1172.41, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.00024}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.15241059999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.0179199206591085, "avg_speed_min": 1.4821927791637648, "avg_speed_max": 4.214481795931258, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.353330206449158, "mean_processing_ms": 1.574522873486589, "mean_inference_ms": 0.35620189276425024}, "off_policy_estimator": {}, "info": {"num_steps_trained": 647296, "num_steps_sampled": 2246178, "sample_time_ms": 63000.996, "load_time_ms": 2.213, "grad_time_ms": 3676.386, "update_time_ms": 6.024, "learner": {"av": {"cur_kl_coeff": 0.08552615344524384, "cur_lr": 9.999999747378752e-05, "total_loss": -0.00455253291875124, "policy_loss": -0.005757388658821583, "vf_loss": 0.0005517398822121322, "vf_explained_var": 0.8859315514564514, "kl": 0.007636471651494503, "entropy": 2.2685256004333496, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27065, "done": false, "timesteps_total": 2246178, "episodes_total": 2274, "training_iteration": 82, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-33-44", "timestamp": 1588822424, "time_this_iter_s": 66.36416053771973, "time_total_s": 5518.4318108558655, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc725e99ea0>", "on_episode_step": "<function on_episode_step at 0x7fc729044400>", "on_episode_end": "<function on_episode_end at 0x7fc72461e510>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72461e1e0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7259721e0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5518.4318108558655, "timesteps_since_restore": 2246178, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 90.0021052631579, "ram_util_percent": 32.30000000000002}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": 0.24945, "episode_reward_mean": 0.24992029999999998, "episode_len_mean": 1200.0, "episodes_this_iter": 21, "policy_reward_min": {"av": 0.24945}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.24992029999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.0566366255149267, "avg_speed_min": 1.6457061175204253, "avg_speed_max": 4.214481795931258, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.296943185551985, "mean_processing_ms": 1.5723936495270205, "mean_inference_ms": 0.3547729408123053}, "off_policy_estimator": {}, "info": {"num_steps_trained": 656384, "num_steps_sampled": 2272388, "sample_time_ms": 63557.231, "load_time_ms": 2.225, "grad_time_ms": 3749.005, "update_time_ms": 6.026, "learner": {"av": {"cur_kl_coeff": 0.08552615344524384, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0020781285129487514, "policy_loss": 0.0010366591159254313, "vf_loss": 0.0004348070942796767, "vf_explained_var": 0.8944942355155945, "kl": 0.007093287073075771, "entropy": 2.1560747623443604, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26210, "done": false, "timesteps_total": 2272388, "episodes_total": 2295, "training_iteration": 83, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-34-55", "timestamp": 1588822495, "time_this_iter_s": 71.1787121295929, "time_total_s": 5589.610522985458, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc725e9ee18>", "on_episode_step": "<function on_episode_step at 0x7fc724682620>", "on_episode_end": "<function on_episode_end at 0x7fc724682a60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72469be18>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725a0f7b8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5589.610522985458, "timesteps_since_restore": 2272388, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 90.01881188118811, "ram_util_percent": 32.30000000000002}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": 0.24943, "episode_reward_mean": 0.24992450000000002, "episode_len_mean": 1200.0, "episodes_this_iter": 23, "policy_reward_min": {"av": 0.24943}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.24992450000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.995303515106964, "avg_speed_min": 1.5847769362825268, "avg_speed_max": 4.214481795931258, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.332757700509656, "mean_processing_ms": 1.5682030747584133, "mean_inference_ms": 0.35554069033262414}, "off_policy_estimator": {}, "info": {"num_steps_trained": 665216, "num_steps_sampled": 2299368, "sample_time_ms": 63530.471, "load_time_ms": 2.247, "grad_time_ms": 3749.82, "update_time_ms": 6.135, "learner": {"av": {"cur_kl_coeff": 0.08552615344524384, "cur_lr": 9.999999747378752e-05, "total_loss": 7.700682908762246e-05, "policy_loss": -0.0010329745709896088, "vf_loss": 0.0004819548921659589, "vf_explained_var": 0.8974000215530396, "kl": 0.007343082223087549, "entropy": 2.2097315788269043, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26980, "done": false, "timesteps_total": 2299368, "episodes_total": 2318, "training_iteration": 84, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-36-06", "timestamp": 1588822566, "time_this_iter_s": 71.01849126815796, "time_total_s": 5660.629014253616, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc724682268>", "on_episode_step": "<function on_episode_step at 0x7fc72461e510>", "on_episode_end": "<function on_episode_end at 0x7fc729044400>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7259721e0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7246c2620>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5660.629014253616, "timesteps_since_restore": 2299368, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 89.47843137254903, "ram_util_percent": 32.30000000000002}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": 0.24943, "episode_reward_mean": 0.24992510000000004, "episode_len_mean": 1200.0, "episodes_this_iter": 22, "policy_reward_min": {"av": 0.24943}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.24992510000000004}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.008824993556666, "avg_speed_min": 1.5847769362825268, "avg_speed_max": 4.214481795931258, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.35291149099773, "mean_processing_ms": 1.5661110693717404, "mean_inference_ms": 0.35597707673189455}, "off_policy_estimator": {}, "info": {"num_steps_trained": 673280, "num_steps_sampled": 2325809, "sample_time_ms": 63517.131, "load_time_ms": 2.221, "grad_time_ms": 3754.946, "update_time_ms": 6.074, "learner": {"av": {"cur_kl_coeff": 0.08552615344524384, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0022219717502593994, "policy_loss": 0.0010834719287231565, "vf_loss": 0.0004068993148393929, "vf_explained_var": 0.9101754426956177, "kl": 0.008554165251553059, "entropy": 2.2132108211517334, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26441, "done": false, "timesteps_total": 2325809, "episodes_total": 2340, "training_iteration": 85, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-37-14", "timestamp": 1588822634, "time_this_iter_s": 67.02516055107117, "time_total_s": 5727.6541748046875, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72465fea0>", "on_episode_step": "<function on_episode_step at 0x7fc72461e1e0>", "on_episode_end": "<function on_episode_end at 0x7fc72461e0d0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72461e6a8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724682d08>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5727.6541748046875, "timesteps_since_restore": 2325809, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 89.84375, "ram_util_percent": 32.300000000000004}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": 0.24943, "episode_reward_mean": 0.24992709999999999, "episode_len_mean": 1200.0, "episodes_this_iter": 24, "policy_reward_min": {"av": 0.24943}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.24992709999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.041759125498549, "avg_speed_min": 1.5847769362825268, "avg_speed_max": 4.2985834648807115, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.369801489878213, "mean_processing_ms": 1.5647723076022624, "mean_inference_ms": 0.3563008558314984}, "off_policy_estimator": {}, "info": {"num_steps_trained": 681728, "num_steps_sampled": 2353914, "sample_time_ms": 63978.302, "load_time_ms": 2.251, "grad_time_ms": 3760.858, "update_time_ms": 5.995, "learner": {"av": {"cur_kl_coeff": 0.08552615344524384, "cur_lr": 9.999999747378752e-05, "total_loss": -0.00041059788782149553, "policy_loss": -0.0014009317383170128, "vf_loss": 0.0005387856508605182, "vf_explained_var": 0.8767646551132202, "kl": 0.0052796620875597, "entropy": 2.32198429107666, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28105, "done": false, "timesteps_total": 2353914, "episodes_total": 2364, "training_iteration": 86, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-38-24", "timestamp": 1588822704, "time_this_iter_s": 70.37611079216003, "time_total_s": 5798.0302855968475, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc725e99ea0>", "on_episode_step": "<function on_episode_step at 0x7fc729044400>", "on_episode_end": "<function on_episode_end at 0x7fc7246ec8c8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246ec9d8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724682620>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5798.0302855968475, "timesteps_since_restore": 2353914, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 90.83699999999997, "ram_util_percent": 32.302000000000014}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": 0.24888, "episode_reward_mean": 0.249908, "episode_len_mean": 1200.0, "episodes_this_iter": 25, "policy_reward_min": {"av": 0.24888}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.249908}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.1247344765776672, "avg_speed_min": 1.5847769362825268, "avg_speed_max": 4.2985834648807115, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.40053321767392, "mean_processing_ms": 1.561699626929527, "mean_inference_ms": 0.3569568439343711}, "off_policy_estimator": {}, "info": {"num_steps_trained": 689024, "num_steps_sampled": 2383529, "sample_time_ms": 63899.075, "load_time_ms": 2.215, "grad_time_ms": 3675.339, "update_time_ms": 5.923, "learner": {"av": {"cur_kl_coeff": 0.08552615344524384, "cur_lr": 9.999999747378752e-05, "total_loss": -0.00460161454975605, "policy_loss": -0.006067339796572924, "vf_loss": 0.0002859309606719762, "vf_explained_var": 0.9377399682998657, "kl": 0.013794558122754097, "entropy": 2.3558528423309326, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 29615, "done": false, "timesteps_total": 2383529, "episodes_total": 2389, "training_iteration": 87, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-39-31", "timestamp": 1588822771, "time_this_iter_s": 67.01333427429199, "time_total_s": 5865.0436198711395, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72461e510>", "on_episode_step": "<function on_episode_step at 0x7fc72461e0d0>", "on_episode_end": "<function on_episode_end at 0x7fc72461e1e0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc724682d08>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7259728c8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5865.0436198711395, "timesteps_since_restore": 2383529, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 92.12708333333335, "ram_util_percent": 32.300000000000004}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": 0.24888, "episode_reward_mean": 0.24989740000000005, "episode_len_mean": 1200.0, "episodes_this_iter": 19, "policy_reward_min": {"av": 0.24888}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.24989740000000005}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.1358119736185053, "avg_speed_min": 1.8792326115949212, "avg_speed_max": 4.2985834648807115, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.413411620136177, "mean_processing_ms": 1.5608556147225516, "mean_inference_ms": 0.35717028872407947}, "off_policy_estimator": {}, "info": {"num_steps_trained": 698112, "num_steps_sampled": 2408393, "sample_time_ms": 63895.29, "load_time_ms": 2.226, "grad_time_ms": 3711.333, "update_time_ms": 5.902, "learner": {"av": {"cur_kl_coeff": 0.08552615344524384, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0002807466371450573, "policy_loss": -0.0007773510296829045, "vf_loss": 0.0005264439387246966, "vf_explained_var": 0.887840747833252, "kl": 0.0062162792310118675, "entropy": 2.454857349395752, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 24864, "done": false, "timesteps_total": 2408393, "episodes_total": 2408, "training_iteration": 88, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-40-40", "timestamp": 1588822840, "time_this_iter_s": 68.56152844429016, "time_total_s": 5933.60514831543, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72461e6a8>", "on_episode_step": "<function on_episode_step at 0x7fc724682620>", "on_episode_end": "<function on_episode_end at 0x7fc724682a60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246827b8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7259722f0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5933.60514831543, "timesteps_since_restore": 2408393, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 91.1704081632653, "ram_util_percent": 32.30000000000001}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00027, "episode_reward_mean": 0.21736840000000004, "episode_len_mean": 1192.02, "episodes_this_iter": 26, "policy_reward_min": {"av": -3.00027}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.21736840000000004}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.17260771388024, "avg_speed_min": 1.3630211519745898, "avg_speed_max": 4.2985834648807115, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.42231198947859, "mean_processing_ms": 1.5569486402262438, "mean_inference_ms": 0.35728749577054103}, "off_policy_estimator": {}, "info": {"num_steps_trained": 705664, "num_steps_sampled": 2437176, "sample_time_ms": 64376.795, "load_time_ms": 2.221, "grad_time_ms": 3729.247, "update_time_ms": 5.948, "learner": {"av": {"cur_kl_coeff": 0.08552615344524384, "cur_lr": 9.999999747378752e-05, "total_loss": 0.021820027381181717, "policy_loss": 0.001404537120833993, "vf_loss": 0.020272526890039444, "vf_explained_var": 0.511110246181488, "kl": 0.0016715520760044456, "entropy": 2.433967351913452, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28783, "done": false, "timesteps_total": 2437176, "episodes_total": 2434, "training_iteration": 89, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-41-48", "timestamp": 1588822908, "time_this_iter_s": 67.96612763404846, "time_total_s": 6001.571275949478, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246daea0>", "on_episode_step": "<function on_episode_step at 0x7fc72461e0d0>", "on_episode_end": "<function on_episode_end at 0x7fc72461e510>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc724682d08>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7246c2840>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6001.571275949478, "timesteps_since_restore": 2437176, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 90.1443298969072, "ram_util_percent": 32.30000000000001}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00027, "episode_reward_mean": 0.21737629999999997, "episode_len_mean": 1192.02, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.00027}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.21737629999999997}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.2035568097072877, "avg_speed_min": 1.3630211519745898, "avg_speed_max": 4.2985834648807115, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.437120843708872, "mean_processing_ms": 1.555002881740166, "mean_inference_ms": 0.3575534771307285}, "off_policy_estimator": {}, "info": {"num_steps_trained": 714240, "num_steps_sampled": 2464754, "sample_time_ms": 64797.206, "load_time_ms": 2.235, "grad_time_ms": 3770.105, "update_time_ms": 5.935, "learner": {"av": {"cur_kl_coeff": 0.04276307672262192, "cur_lr": 9.999999747378752e-05, "total_loss": -0.004142845515161753, "policy_loss": -0.006081431172788143, "vf_loss": 0.0005901943659409881, "vf_explained_var": 0.8900555372238159, "kl": 0.0315316766500473, "entropy": 2.3417000770568848, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27578, "done": false, "timesteps_total": 2464754, "episodes_total": 2457, "training_iteration": 90, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-42-59", "timestamp": 1588822979, "time_this_iter_s": 70.66395735740662, "time_total_s": 6072.235233306885, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc729044400>", "on_episode_step": "<function on_episode_step at 0x7fc7246ecae8>", "on_episode_end": "<function on_episode_end at 0x7fc7246ecd90>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246ece18>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725a0f7b8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6072.235233306885, "timesteps_since_restore": 2464754, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 90.4049504950495, "ram_util_percent": 32.30000000000002}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00034, "episode_reward_mean": 0.1198773, "episode_len_mean": 1165.5, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.00034}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1198773}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.238414935334278, "avg_speed_min": 1.3630211519745898, "avg_speed_max": 5.281033853702982, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.458956816182482, "mean_processing_ms": 1.5501824553844943, "mean_inference_ms": 0.3579735559395285}, "off_policy_estimator": {}, "info": {"num_steps_trained": 721536, "num_steps_sampled": 2490920, "sample_time_ms": 64521.536, "load_time_ms": 2.214, "grad_time_ms": 3746.168, "update_time_ms": 6.004, "learner": {"av": {"cur_kl_coeff": 0.06414461135864258, "cur_lr": 9.999999747378752e-05, "total_loss": 0.05247139558196068, "policy_loss": -0.0029935436323285103, "vf_loss": 0.055029019713401794, "vf_explained_var": 0.8062487840652466, "kl": 0.006795819848775864, "entropy": 2.334477186203003, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26166, "done": false, "timesteps_total": 2490920, "episodes_total": 2480, "training_iteration": 91, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-44-01", "timestamp": 1588823041, "time_this_iter_s": 62.711456298828125, "time_total_s": 6134.946689605713, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246ec8c8>", "on_episode_step": "<function on_episode_step at 0x7fc725a0f730>", "on_episode_end": "<function on_episode_end at 0x7fc725a0fd90>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246daea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724682268>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6134.946689605713, "timesteps_since_restore": 2490920, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 90.89775280898876, "ram_util_percent": 32.303370786516865}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00034, "episode_reward_mean": 0.09489320000000001, "episode_len_mean": 1147.84, "episodes_this_iter": 24, "policy_reward_min": {"av": -3.00034}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.09489320000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.2148169593678655, "avg_speed_min": 1.3630211519745898, "avg_speed_max": 5.281033853702982, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.44207295872227, "mean_processing_ms": 1.5500027161632983, "mean_inference_ms": 0.3574533748925032}, "off_policy_estimator": {}, "info": {"num_steps_trained": 729856, "num_steps_sampled": 2517559, "sample_time_ms": 64640.451, "load_time_ms": 2.226, "grad_time_ms": 3770.409, "update_time_ms": 5.862, "learner": {"av": {"cur_kl_coeff": 0.06414461135864258, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0033561191521584988, "policy_loss": -0.015575744211673737, "vf_loss": 0.010231787338852882, "vf_explained_var": 0.6051118969917297, "kl": 0.030989957973361015, "entropy": 2.3539319038391113, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26639, "done": false, "timesteps_total": 2517559, "episodes_total": 2504, "training_iteration": 92, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-45-09", "timestamp": 1588823109, "time_this_iter_s": 67.79403710365295, "time_total_s": 6202.740726709366, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246ec9d8>", "on_episode_step": "<function on_episode_step at 0x7fc7246ecae8>", "on_episode_end": "<function on_episode_end at 0x7fc725a0fae8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725a0f7b8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725972598>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6202.740726709366, "timesteps_since_restore": 2517559, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 91.35360824742267, "ram_util_percent": 32.30000000000001}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00034, "episode_reward_mean": 0.0949138, "episode_len_mean": 1147.33, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.00034}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.0949138}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.1696162389967673, "avg_speed_min": 1.5004346777417228, "avg_speed_max": 5.281033853702982, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.44603232477227, "mean_processing_ms": 1.5483590086476908, "mean_inference_ms": 0.3573939509495587}, "off_policy_estimator": {}, "info": {"num_steps_trained": 737920, "num_steps_sampled": 2544050, "sample_time_ms": 64191.626, "load_time_ms": 2.189, "grad_time_ms": 3723.624, "update_time_ms": 5.841, "learner": {"av": {"cur_kl_coeff": 0.09621691703796387, "cur_lr": 9.999999747378752e-05, "total_loss": 0.006663359235972166, "policy_loss": 0.0003805801388807595, "vf_loss": 0.004708998370915651, "vf_explained_var": 0.9202921390533447, "kl": 0.016356583684682846, "entropy": 2.3615059852600098, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26491, "done": false, "timesteps_total": 2544050, "episodes_total": 2527, "training_iteration": 93, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-46-16", "timestamp": 1588823176, "time_this_iter_s": 66.22252082824707, "time_total_s": 6268.963247537613, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246ece18>", "on_episode_step": "<function on_episode_step at 0x7fc725a0fd90>", "on_episode_end": "<function on_episode_end at 0x7fc725a0f730>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc724682268>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7246c2620>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6268.963247537613, "timesteps_since_restore": 2544050, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 90.92947368421054, "ram_util_percent": 32.30000000000002}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00037, "episode_reward_mean": -0.03509549999999999, "episode_len_mean": 1111.99, "episodes_this_iter": 26, "policy_reward_min": {"av": -3.00037}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.03509549999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.045429423218889, "avg_speed_min": 1.387839971597688, "avg_speed_max": 5.281033853702982, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.491599048706124, "mean_processing_ms": 1.5478234352516649, "mean_inference_ms": 0.35843477327307594}, "off_policy_estimator": {}, "info": {"num_steps_trained": 747264, "num_steps_sampled": 2571562, "sample_time_ms": 64446.376, "load_time_ms": 2.177, "grad_time_ms": 3745.407, "update_time_ms": 5.775, "learner": {"av": {"cur_kl_coeff": 0.09621691703796387, "cur_lr": 9.999999747378752e-05, "total_loss": 0.027874473482370377, "policy_loss": -0.0036503933370113373, "vf_loss": 0.030993720516562462, "vf_explained_var": 0.9007734656333923, "kl": 0.005520328879356384, "entropy": 2.1156744956970215, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27512, "done": false, "timesteps_total": 2571562, "episodes_total": 2553, "training_iteration": 94, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-47-30", "timestamp": 1588823250, "time_this_iter_s": 73.7834198474884, "time_total_s": 6342.746667385101, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246daea0>", "on_episode_step": "<function on_episode_step at 0x7fc7246ecd90>", "on_episode_end": "<function on_episode_end at 0x7fc7246ecae8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725972598>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7246c2a60>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6342.746667385101, "timesteps_since_restore": 2571562, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 89.66571428571426, "ram_util_percent": 32.301904761904765}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00037, "episode_reward_mean": -0.002590200000000002, "episode_len_mean": 1121.5, "episodes_this_iter": 22, "policy_reward_min": {"av": -3.00037}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.002590200000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.07, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9386542076608895, "avg_speed_min": 1.387839971597688, "avg_speed_max": 5.281033853702982, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.491510556898046, "mean_processing_ms": 1.5474255377004553, "mean_inference_ms": 0.3583856807376219}, "off_policy_estimator": {}, "info": {"num_steps_trained": 756736, "num_steps_sampled": 2597520, "sample_time_ms": 64853.011, "load_time_ms": 2.201, "grad_time_ms": 3811.917, "update_time_ms": 5.841, "learner": {"av": {"cur_kl_coeff": 0.09621691703796387, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0011822124943137169, "policy_loss": -0.004430656787008047, "vf_loss": 0.0019246641313657165, "vf_explained_var": 0.9530768394470215, "kl": 0.013758308254182339, "entropy": 2.1544928550720215, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25958, "done": false, "timesteps_total": 2597520, "episodes_total": 2575, "training_iteration": 95, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-48-41", "timestamp": 1588823321, "time_this_iter_s": 71.75787281990051, "time_total_s": 6414.504540205002, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc725a0f7b8>", "on_episode_step": "<function on_episode_step at 0x7fc725a0fd90>", "on_episode_end": "<function on_episode_end at 0x7fc7246ece18>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc724682268>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72458c2f0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6414.504540205002, "timesteps_since_restore": 2597520, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 91.29509803921567, "ram_util_percent": 32.310784313725506}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00037, "episode_reward_mean": 0.054917600000000004, "episode_len_mean": 1147.69, "episodes_this_iter": 22, "policy_reward_min": {"av": -3.00037}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.054917600000000004}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.8845119601458595, "avg_speed_min": 1.387839971597688, "avg_speed_max": 4.774897476727103, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.51197624573364, "mean_processing_ms": 1.5445297961821671, "mean_inference_ms": 0.35884675166379254}, "off_policy_estimator": {}, "info": {"num_steps_trained": 765440, "num_steps_sampled": 2624143, "sample_time_ms": 64814.543, "load_time_ms": 2.194, "grad_time_ms": 3825.632, "update_time_ms": 6.028, "learner": {"av": {"cur_kl_coeff": 0.09621691703796387, "cur_lr": 9.999999747378752e-05, "total_loss": 4.390939466247801e-06, "policy_loss": -0.0015846001915633678, "vf_loss": 0.0006649603601545095, "vf_explained_var": 0.8607668876647949, "kl": 0.009603627026081085, "entropy": 2.135701894760132, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26623, "done": false, "timesteps_total": 2624143, "episodes_total": 2597, "training_iteration": 96, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-49-52", "timestamp": 1588823392, "time_this_iter_s": 70.13104772567749, "time_total_s": 6484.635587930679, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246c2a60>", "on_episode_step": "<function on_episode_step at 0x7fc7246c2b70>", "on_episode_end": "<function on_episode_end at 0x7fc7246c2840>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725972598>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7259728c8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6484.635587930679, "timesteps_since_restore": 2624143, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 89.77425742574258, "ram_util_percent": 32.35643564356437}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00037, "episode_reward_mean": 0.022420399999999997, "episode_len_mean": 1138.67, "episodes_this_iter": 22, "policy_reward_min": {"av": -3.00037}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.022420399999999997}, "custom_metrics": {"num_ped_collisions_mean": 0.07, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.861927150248466, "avg_speed_min": 1.387839971597688, "avg_speed_max": 4.774897476727103, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.554278873405373, "mean_processing_ms": 1.5430966991213824, "mean_inference_ms": 0.3597784429843206}, "off_policy_estimator": {}, "info": {"num_steps_trained": 773248, "num_steps_sampled": 2649621, "sample_time_ms": 64571.001, "load_time_ms": 2.2, "grad_time_ms": 3850.621, "update_time_ms": 6.093, "learner": {"av": {"cur_kl_coeff": 0.09621691703796387, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0195882897824049, "policy_loss": -0.003938758745789528, "vf_loss": 0.02299676463007927, "vf_explained_var": 0.8532067537307739, "kl": 0.005511359311640263, "entropy": 2.225064992904663, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25478, "done": false, "timesteps_total": 2649621, "episodes_total": 2619, "training_iteration": 97, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-50-57", "timestamp": 1588823457, "time_this_iter_s": 64.82918167114258, "time_total_s": 6549.464769601822, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc725972ea0>", "on_episode_step": "<function on_episode_step at 0x7fc725972158>", "on_episode_end": "<function on_episode_end at 0x7fc725972950>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246c2ae8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724682268>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6549.464769601822, "timesteps_since_restore": 2649621, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 89.33695652173911, "ram_util_percent": 32.36847826086956}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0007, "episode_reward_mean": 0.05492280000000001, "episode_len_mean": 1150.05, "episodes_this_iter": 22, "policy_reward_min": {"av": -3.0007}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.05492280000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.797868285771276, "avg_speed_min": 1.329464288015368, "avg_speed_max": 4.774897476727103, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.560696752058274, "mean_processing_ms": 1.5414022839920125, "mean_inference_ms": 0.3598510643259957}, "off_policy_estimator": {}, "info": {"num_steps_trained": 782336, "num_steps_sampled": 2674429, "sample_time_ms": 64515.865, "load_time_ms": 2.207, "grad_time_ms": 3848.11, "update_time_ms": 6.101, "learner": {"av": {"cur_kl_coeff": 0.09621691703796387, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0038787643425166607, "policy_loss": -0.002928555943071842, "vf_loss": 0.006252572406083345, "vf_explained_var": 0.8978179097175598, "kl": 0.005765595939010382, "entropy": 2.165071725845337, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 24808, "done": false, "timesteps_total": 2674429, "episodes_total": 2641, "training_iteration": 98, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-52-05", "timestamp": 1588823525, "time_this_iter_s": 67.98479580879211, "time_total_s": 6617.449565410614, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246c2b70>", "on_episode_step": "<function on_episode_step at 0x7fc725972d08>", "on_episode_end": "<function on_episode_end at 0x7fc725972598>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7259728c8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc729044400>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6617.449565410614, "timesteps_since_restore": 2674429, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 90.46804123711341, "ram_util_percent": 32.393814432989686}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0007, "episode_reward_mean": 0.1199303, "episode_len_mean": 1166.43, "episodes_this_iter": 24, "policy_reward_min": {"av": -3.0007}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1199303}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.845939292396997, "avg_speed_min": 1.329464288015368, "avg_speed_max": 4.250699879272432, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.538369528843965, "mean_processing_ms": 1.54095367320965, "mean_inference_ms": 0.359239920549484}, "off_policy_estimator": {}, "info": {"num_steps_trained": 791296, "num_steps_sampled": 2702239, "sample_time_ms": 64931.057, "load_time_ms": 2.243, "grad_time_ms": 3912.443, "update_time_ms": 5.994, "learner": {"av": {"cur_kl_coeff": 0.09621691703796387, "cur_lr": 9.999999747378752e-05, "total_loss": -0.02960270829498768, "policy_loss": -0.035682663321495056, "vf_loss": 0.0018782258266583085, "vf_explained_var": 0.9720640182495117, "kl": 0.043669361621141434, "entropy": 2.085923671722412, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27810, "done": false, "timesteps_total": 2702239, "episodes_total": 2665, "training_iteration": 99, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-53-18", "timestamp": 1588823598, "time_this_iter_s": 72.76074647903442, "time_total_s": 6690.210311889648, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246daea0>", "on_episode_step": "<function on_episode_step at 0x7fc725972950>", "on_episode_end": "<function on_episode_end at 0x7fc725972158>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc724682268>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725a0f730>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6690.210311889648, "timesteps_since_restore": 2702239, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 89.84615384615384, "ram_util_percent": 32.389423076923066}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0007, "episode_reward_mean": 0.1524222, "episode_len_mean": 1174.91, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.0007}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1524222}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.9368066052730115, "avg_speed_min": 1.329464288015368, "avg_speed_max": 4.164741846128997, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.601565625795583, "mean_processing_ms": 1.5386808777864462, "mean_inference_ms": 0.36076244895880466}, "off_policy_estimator": {}, "info": {"num_steps_trained": 799360, "num_steps_sampled": 2729647, "sample_time_ms": 64656.108, "load_time_ms": 2.22, "grad_time_ms": 3888.282, "update_time_ms": 6.047, "learner": {"av": {"cur_kl_coeff": 0.1443253755569458, "cur_lr": 9.999999747378752e-05, "total_loss": 0.02043018862605095, "policy_loss": -0.020440740510821342, "vf_loss": 0.03653964772820473, "vf_explained_var": 0.8533585071563721, "kl": 0.030010487884283066, "entropy": 2.30196213722229, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27408, "done": false, "timesteps_total": 2729647, "episodes_total": 2688, "training_iteration": 100, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-54-25", "timestamp": 1588823665, "time_this_iter_s": 67.67325234413147, "time_total_s": 6757.88356423378, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246c2ae8>", "on_episode_step": "<function on_episode_step at 0x7fc725972598>", "on_episode_end": "<function on_episode_end at 0x7fc725972d08>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc729044400>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725a0fb70>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6757.88356423378, "timesteps_since_restore": 2729647, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 90.85360824742267, "ram_util_percent": 32.397938144329885}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0007, "episode_reward_mean": 0.08741190000000001, "episode_len_mean": 1160.13, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.0007}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.08741190000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.920016585147291, "avg_speed_min": 1.2234388810524264, "avg_speed_max": 4.164741846128997, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.612230330969396, "mean_processing_ms": 1.5379932867477168, "mean_inference_ms": 0.36093934515660453}, "off_policy_estimator": {}, "info": {"num_steps_trained": 806784, "num_steps_sampled": 2755927, "sample_time_ms": 64717.007, "load_time_ms": 2.225, "grad_time_ms": 3893.799, "update_time_ms": 6.016, "learner": {"av": {"cur_kl_coeff": 0.2164880633354187, "cur_lr": 9.999999747378752e-05, "total_loss": 0.001454002340324223, "policy_loss": -0.005777258891612291, "vf_loss": 0.005815898068249226, "vf_explained_var": 0.956322968006134, "kl": 0.006537831854075193, "entropy": 2.2478601932525635, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26280, "done": false, "timesteps_total": 2755927, "episodes_total": 2711, "training_iteration": 101, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-55-29", "timestamp": 1588823729, "time_this_iter_s": 63.37546372413635, "time_total_s": 6821.259027957916, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246ece18>", "on_episode_step": "<function on_episode_step at 0x7fc7246ec8c8>", "on_episode_end": "<function on_episode_end at 0x7fc7246ec9d8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246ecae8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72461e620>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6821.259027957916, "timesteps_since_restore": 2755927, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 91.02888888888887, "ram_util_percent": 32.398888888888884}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00038, "episode_reward_mean": 0.1524079, "episode_len_mean": 1177.37, "episodes_this_iter": 22, "policy_reward_min": {"av": -3.00038}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1524079}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.0841993331262656, "avg_speed_min": 1.2234388810524264, "avg_speed_max": 4.167627453117379, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.59056867804108, "mean_processing_ms": 1.5361234860584012, "mean_inference_ms": 0.3603542481980111}, "off_policy_estimator": {}, "info": {"num_steps_trained": 814080, "num_steps_sampled": 2782939, "sample_time_ms": 64413.658, "load_time_ms": 2.21, "grad_time_ms": 3849.144, "update_time_ms": 6.074, "learner": {"av": {"cur_kl_coeff": 0.2164880633354187, "cur_lr": 9.999999747378752e-05, "total_loss": 0.01739884540438652, "policy_loss": -0.007664400152862072, "vf_loss": 0.022277338430285454, "vf_explained_var": 0.823687732219696, "kl": 0.012868627905845642, "entropy": 2.241884469985962, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27012, "done": false, "timesteps_total": 2782939, "episodes_total": 2733, "training_iteration": 102, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-56-33", "timestamp": 1588823793, "time_this_iter_s": 64.31558609008789, "time_total_s": 6885.574614048004, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246daea0>", "on_episode_step": "<function on_episode_step at 0x7fc72461ed90>", "on_episode_end": "<function on_episode_end at 0x7fc72461e0d0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72461e378>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7259729d8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6885.574614048004, "timesteps_since_restore": 2782939, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 89.70760869565218, "ram_util_percent": 32.39891304347826}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0006599999999994, "episode_reward_mean": 0.11989689999999997, "episode_len_mean": 1169.75, "episodes_this_iter": 24, "policy_reward_min": {"av": -3.0006599999999994}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.11989689999999997}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.0674506175903145, "avg_speed_min": 1.2234388810524264, "avg_speed_max": 4.167627453117379, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.62175609332558, "mean_processing_ms": 1.5360017124290346, "mean_inference_ms": 0.36112340186884007}, "off_policy_estimator": {}, "info": {"num_steps_trained": 823424, "num_steps_sampled": 2809758, "sample_time_ms": 65052.668, "load_time_ms": 2.249, "grad_time_ms": 3905.652, "update_time_ms": 6.084, "learner": {"av": {"cur_kl_coeff": 0.2164880633354187, "cur_lr": 9.999999747378752e-05, "total_loss": 0.005377706605941057, "policy_loss": 0.00043427394120953977, "vf_loss": 0.004744898993521929, "vf_explained_var": 0.8347285389900208, "kl": 0.000917054305318743, "entropy": 2.1833672523498535, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26819, "done": false, "timesteps_total": 2809758, "episodes_total": 2757, "training_iteration": 103, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-57-46", "timestamp": 1588823866, "time_this_iter_s": 73.17809534072876, "time_total_s": 6958.752709388733, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72461eb70>", "on_episode_step": "<function on_episode_step at 0x7fc72461eae8>", "on_episode_end": "<function on_episode_end at 0x7fc7246822f0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc724682ea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7246c2c80>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6958.752709388733, "timesteps_since_restore": 2809758, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 89.77714285714286, "ram_util_percent": 32.39999999999999}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0006599999999994, "episode_reward_mean": 0.11987980000000002, "episode_len_mean": 1169.75, "episodes_this_iter": 21, "policy_reward_min": {"av": -3.0006599999999994}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.11987980000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.085169688890693, "avg_speed_min": 1.2234388810524264, "avg_speed_max": 4.167627453117379, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.630526962453455, "mean_processing_ms": 1.5347754407145595, "mean_inference_ms": 0.36113641402538}, "off_policy_estimator": {}, "info": {"num_steps_trained": 831744, "num_steps_sampled": 2835941, "sample_time_ms": 64485.355, "load_time_ms": 2.26, "grad_time_ms": 3860.81, "update_time_ms": 6.13, "learner": {"av": {"cur_kl_coeff": 0.10824403166770935, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0009057659190148115, "policy_loss": -0.002653570845723152, "vf_loss": 0.000631911214441061, "vf_explained_var": 0.8745259642601013, "kl": 0.010309038683772087, "entropy": 2.149972438812256, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26183, "done": false, "timesteps_total": 2835941, "episodes_total": 2778, "training_iteration": 104, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_03-58-54", "timestamp": 1588823934, "time_this_iter_s": 67.66184830665588, "time_total_s": 7026.414557695389, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72461e620>", "on_episode_step": "<function on_episode_step at 0x7fc72461e0d0>", "on_episode_end": "<function on_episode_end at 0x7fc72461ed90>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7259729d8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725a0f488>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7026.414557695389, "timesteps_since_restore": 2835941, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 90.38958333333335, "ram_util_percent": 32.39999999999999}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0006599999999994, "episode_reward_mean": 0.1848972, "episode_len_mean": 1184.53, "episodes_this_iter": 22, "policy_reward_min": {"av": -3.0006599999999994}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1848972}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.0392638045998632, "avg_speed_min": 1.3037239785098331, "avg_speed_max": 4.167627453117379, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.62871686401198, "mean_processing_ms": 1.5326033195859412, "mean_inference_ms": 0.3611265445621427}, "off_policy_estimator": {}, "info": {"num_steps_trained": 840576, "num_steps_sampled": 2861532, "sample_time_ms": 64180.273, "load_time_ms": 2.265, "grad_time_ms": 3829.68, "update_time_ms": 6.091, "learner": {"av": {"cur_kl_coeff": 0.10824403166770935, "cur_lr": 9.999999747378752e-05, "total_loss": -0.001689621713012457, "policy_loss": -0.003237746423110366, "vf_loss": 0.0007423748029395938, "vf_explained_var": 0.8473286032676697, "kl": 0.007443838287144899, "entropy": 2.119490623474121, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25591, "done": false, "timesteps_total": 2861532, "episodes_total": 2800, "training_iteration": 105, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-00-03", "timestamp": 1588824003, "time_this_iter_s": 68.39499711990356, "time_total_s": 7094.809554815292, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72461e378>", "on_episode_step": "<function on_episode_step at 0x7fc72461eb70>", "on_episode_end": "<function on_episode_end at 0x7fc724682ea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246c2c80>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245960d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7094.809554815292, "timesteps_since_restore": 2861532, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 90.37448979591838, "ram_util_percent": 32.39999999999999}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0006599999999994, "episode_reward_mean": 0.21740410000000002, "episode_len_mean": 1192.38, "episodes_this_iter": 20, "policy_reward_min": {"av": -3.0006599999999994}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.21740410000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.015775688051328, "avg_speed_min": 1.3037239785098331, "avg_speed_max": 4.272261525581204, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.653624069880916, "mean_processing_ms": 1.5313985074399017, "mean_inference_ms": 0.36165937646776636}, "off_policy_estimator": {}, "info": {"num_steps_trained": 848512, "num_steps_sampled": 2886354, "sample_time_ms": 63573.005, "load_time_ms": 2.239, "grad_time_ms": 3793.363, "update_time_ms": 5.909, "learner": {"av": {"cur_kl_coeff": 0.10824403166770935, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0011568181216716766, "policy_loss": -0.002842020010575652, "vf_loss": 0.000618113437667489, "vf_explained_var": 0.87493896484375, "kl": 0.009858193807303905, "entropy": 2.044541835784912, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 24822, "done": false, "timesteps_total": 2886354, "episodes_total": 2820, "training_iteration": 106, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-01-07", "timestamp": 1588824067, "time_this_iter_s": 63.69305491447449, "time_total_s": 7158.502609729767, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc725a0fd08>", "on_episode_step": "<function on_episode_step at 0x7fc725a0f6a8>", "on_episode_end": "<function on_episode_end at 0x7fc725a0fd90>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725a0fae8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7246c2840>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7158.502609729767, "timesteps_since_restore": 2886354, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 90.65494505494505, "ram_util_percent": 32.402197802197804}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": 0.2496, "episode_reward_mean": 0.2499083, "episode_len_mean": 1200.0, "episodes_this_iter": 22, "policy_reward_min": {"av": 0.2496}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.2499083}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.1162038733756985, "avg_speed_min": 1.8237805866499743, "avg_speed_max": 5.506304627076599, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.65451579742622, "mean_processing_ms": 1.5296926292356483, "mean_inference_ms": 0.36157141920669567}, "off_policy_estimator": {}, "info": {"num_steps_trained": 855552, "num_steps_sampled": 2913366, "sample_time_ms": 63441.12, "load_time_ms": 2.235, "grad_time_ms": 3756.347, "update_time_ms": 5.866, "learner": {"av": {"cur_kl_coeff": 0.10824403166770935, "cur_lr": 9.999999747378752e-05, "total_loss": 0.00014631748490501195, "policy_loss": -0.0013578543439507484, "vf_loss": 0.0005708346143364906, "vf_explained_var": 0.8751075267791748, "kl": 0.008622518740594387, "entropy": 2.1099836826324463, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27012, "done": false, "timesteps_total": 2913366, "episodes_total": 2842, "training_iteration": 107, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-02-10", "timestamp": 1588824130, "time_this_iter_s": 63.13977074623108, "time_total_s": 7221.642380475998, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc725a0f488>", "on_episode_step": "<function on_episode_step at 0x7fc7246c2b70>", "on_episode_end": "<function on_episode_end at 0x7fc7246c2d08>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246c2c80>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72461eb70>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7221.642380475998, "timesteps_since_restore": 2913366, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 90.71222222222221, "ram_util_percent": 32.39999999999999}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0006399999999998, "episode_reward_mean": 0.21741219999999997, "episode_len_mean": 1192.63, "episodes_this_iter": 25, "policy_reward_min": {"av": -3.0006399999999998}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.21741219999999997}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.076852906104727, "avg_speed_min": 1.2334571244307289, "avg_speed_max": 5.506304627076599, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.658674350896035, "mean_processing_ms": 1.5281728119391096, "mean_inference_ms": 0.36153558585346446}, "off_policy_estimator": {}, "info": {"num_steps_trained": 863104, "num_steps_sampled": 2940292, "sample_time_ms": 63262.271, "load_time_ms": 2.215, "grad_time_ms": 3688.493, "update_time_ms": 5.836, "learner": {"av": {"cur_kl_coeff": 0.10824403166770935, "cur_lr": 9.999999747378752e-05, "total_loss": -0.00546612124890089, "policy_loss": -0.00845174677670002, "vf_loss": 0.002217927947640419, "vf_explained_var": 0.9728889465332031, "kl": 0.007092262618243694, "entropy": 2.354079246520996, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26926, "done": false, "timesteps_total": 2940292, "episodes_total": 2867, "training_iteration": 108, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-03-15", "timestamp": 1588824195, "time_this_iter_s": 65.51753783226013, "time_total_s": 7287.159918308258, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72465fea0>", "on_episode_step": "<function on_episode_step at 0x7fc725a0fd90>", "on_episode_end": "<function on_episode_end at 0x7fc725a0f6a8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246daea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72461e0d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7287.159918308258, "timesteps_since_restore": 2940292, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 90.43723404255317, "ram_util_percent": 32.4}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0006399999999998, "episode_reward_mean": 0.21741549999999996, "episode_len_mean": 1192.63, "episodes_this_iter": 21, "policy_reward_min": {"av": -3.0006399999999998}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.21741549999999996}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.1405072746345586, "avg_speed_min": 1.2334571244307289, "avg_speed_max": 5.506304627076599, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.65253994253858, "mean_processing_ms": 1.5273270762417102, "mean_inference_ms": 0.36130845718692994}, "off_policy_estimator": {}, "info": {"num_steps_trained": 871680, "num_steps_sampled": 2966893, "sample_time_ms": 62874.414, "load_time_ms": 2.226, "grad_time_ms": 3672.604, "update_time_ms": 5.906, "learner": {"av": {"cur_kl_coeff": 0.10824403166770935, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0022090512793511152, "policy_loss": -0.003188611473888159, "vf_loss": 0.0006119668832980096, "vf_explained_var": 0.9281954169273376, "kl": 0.003395989304408431, "entropy": 2.212805986404419, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26601, "done": false, "timesteps_total": 2966893, "episodes_total": 2888, "training_iteration": 109, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-04-24", "timestamp": 1588824264, "time_this_iter_s": 68.72368359565735, "time_total_s": 7355.883601903915, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc725a0fae8>", "on_episode_step": "<function on_episode_step at 0x7fc7246c2d08>", "on_episode_end": "<function on_episode_end at 0x7fc7246c2b70>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246c2c80>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724682268>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7355.883601903915, "timesteps_since_restore": 2966893, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 91.66224489795918, "ram_util_percent": 32.39999999999999}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0006399999999998, "episode_reward_mean": 0.2174096, "episode_len_mean": 1192.63, "episodes_this_iter": 24, "policy_reward_min": {"av": -3.0006399999999998}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.2174096}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.1799384911595103, "avg_speed_min": 1.2334571244307289, "avg_speed_max": 5.506304627076599, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.68801875957986, "mean_processing_ms": 1.5246159642349455, "mean_inference_ms": 0.362021060737433}, "off_policy_estimator": {}, "info": {"num_steps_trained": 879872, "num_steps_sampled": 2995429, "sample_time_ms": 63018.219, "load_time_ms": 2.237, "grad_time_ms": 3679.141, "update_time_ms": 5.909, "learner": {"av": {"cur_kl_coeff": 0.054122015833854675, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0003585387021303177, "policy_loss": -0.00204519834369421, "vf_loss": 0.0005221982137300074, "vf_explained_var": 0.8844578266143799, "kl": 0.02151544950902462, "entropy": 2.1835408210754395, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28536, "done": false, "timesteps_total": 2995429, "episodes_total": 2912, "training_iteration": 110, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-05-33", "timestamp": 1588824333, "time_this_iter_s": 69.1766312122345, "time_total_s": 7425.06023311615, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246ec8c8>", "on_episode_step": "<function on_episode_step at 0x7fc725a0f6a8>", "on_episode_end": "<function on_episode_end at 0x7fc725a0fd90>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72461e0d0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245962f0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7425.06023311615, "timesteps_since_restore": 2995429, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 92.30408163265304, "ram_util_percent": 32.39999999999999}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0006399999999998, "episode_reward_mean": 0.21740930000000003, "episode_len_mean": 1192.63, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.0006399999999998}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.21740930000000003}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.1770577422428143, "avg_speed_min": 1.2334571244307289, "avg_speed_max": 4.2444262277683835, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.68094872266957, "mean_processing_ms": 1.5234972040337964, "mean_inference_ms": 0.361929131652975}, "off_policy_estimator": {}, "info": {"num_steps_trained": 887424, "num_steps_sampled": 3023235, "sample_time_ms": 63244.891, "load_time_ms": 2.224, "grad_time_ms": 3686.041, "update_time_ms": 5.822, "learner": {"av": {"cur_kl_coeff": 0.08118302375078201, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0004902450600638986, "policy_loss": -0.0003855727263726294, "vf_loss": 0.00040289683965966105, "vf_explained_var": 0.9070924520492554, "kl": 0.005825339816510677, "entropy": 2.3517730236053467, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27806, "done": false, "timesteps_total": 3023235, "episodes_total": 2935, "training_iteration": 111, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-06-39", "timestamp": 1588824399, "time_this_iter_s": 65.710205078125, "time_total_s": 7490.770438194275, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc724682268>", "on_episode_step": "<function on_episode_step at 0x7fc724682730>", "on_episode_end": "<function on_episode_end at 0x7fc7246822f0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc724682950>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7246c2e18>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7490.770438194275, "timesteps_since_restore": 3023235, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 90.80744680851065, "ram_util_percent": 32.40212765957447}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0006399999999998, "episode_reward_mean": 0.21741529999999998, "episode_len_mean": 1192.63, "episodes_this_iter": 25, "policy_reward_min": {"av": -3.0006399999999998}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.21741529999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.196892162259596, "avg_speed_min": 1.2334571244307289, "avg_speed_max": 4.22511478782153, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.664527238568002, "mean_processing_ms": 1.5202494219390703, "mean_inference_ms": 0.3614176891944138}, "off_policy_estimator": {}, "info": {"num_steps_trained": 895616, "num_steps_sampled": 3052069, "sample_time_ms": 63711.652, "load_time_ms": 2.25, "grad_time_ms": 3726.262, "update_time_ms": 5.797, "learner": {"av": {"cur_kl_coeff": 0.08118302375078201, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0013546282425522804, "policy_loss": -0.003040436189621687, "vf_loss": 0.0006392579525709152, "vf_explained_var": 0.8721421957015991, "kl": 0.01289121899753809, "entropy": 2.1968421936035156, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28834, "done": false, "timesteps_total": 3052069, "episodes_total": 2960, "training_iteration": 112, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-07-49", "timestamp": 1588824469, "time_this_iter_s": 69.38494944572449, "time_total_s": 7560.155387639999, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72465fea0>", "on_episode_step": "<function on_episode_step at 0x7fc7246c2a60>", "on_episode_end": "<function on_episode_end at 0x7fc7246c2f28>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246c2bf8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7259727b8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7560.155387639999, "timesteps_since_restore": 3052069, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 91.75050505050505, "ram_util_percent": 32.39999999999999}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": 0.24921, "episode_reward_mean": 0.2499182, "episode_len_mean": 1200.0, "episodes_this_iter": 24, "policy_reward_min": {"av": 0.24921}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.2499182}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.2665078172842237, "avg_speed_min": 1.7593834483632114, "avg_speed_max": 4.24730760286649, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.69823370126804, "mean_processing_ms": 1.5181951279042551, "mean_inference_ms": 0.36209082585009156}, "off_policy_estimator": {}, "info": {"num_steps_trained": 904832, "num_steps_sampled": 3081417, "sample_time_ms": 63863.606, "load_time_ms": 2.257, "grad_time_ms": 3719.191, "update_time_ms": 5.816, "learner": {"av": {"cur_kl_coeff": 0.08118302375078201, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0007713850936852396, "policy_loss": -0.0009930820669978857, "vf_loss": 0.0007678306428715587, "vf_explained_var": 0.8458201289176941, "kl": 0.01227642223238945, "entropy": 2.1849374771118164, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 29348, "done": false, "timesteps_total": 3081417, "episodes_total": 2984, "training_iteration": 113, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-09-04", "timestamp": 1588824544, "time_this_iter_s": 74.62751507759094, "time_total_s": 7634.78290271759, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72461e0d0>", "on_episode_step": "<function on_episode_step at 0x7fc7246822f0>", "on_episode_end": "<function on_episode_end at 0x7fc724682730>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246c2e18>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245966a8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7634.78290271759, "timesteps_since_restore": 3081417, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 91.37570093457944, "ram_util_percent": 32.39999999999999}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": 0.24921, "episode_reward_mean": 0.24990819999999997, "episode_len_mean": 1200.0, "episodes_this_iter": 23, "policy_reward_min": {"av": 0.24921}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.24990819999999997}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.2700781013679063, "avg_speed_min": 1.8095717843991537, "avg_speed_max": 4.289656057009952, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.67754709229653, "mean_processing_ms": 1.5170234362316406, "mean_inference_ms": 0.3617388672562056}, "off_policy_estimator": {}, "info": {"num_steps_trained": 912256, "num_steps_sampled": 3108447, "sample_time_ms": 63680.433, "load_time_ms": 2.245, "grad_time_ms": 3678.615, "update_time_ms": 5.742, "learner": {"av": {"cur_kl_coeff": 0.08118302375078201, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0020461687818169594, "policy_loss": -0.0034554654266685247, "vf_loss": 0.0005845031701028347, "vf_explained_var": 0.8972729444503784, "kl": 0.010159707628190517, "entropy": 2.6510848999023438, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27030, "done": false, "timesteps_total": 3108447, "episodes_total": 3007, "training_iteration": 114, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-10-09", "timestamp": 1588824609, "time_this_iter_s": 65.42375445365906, "time_total_s": 7700.206657171249, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc724682950>", "on_episode_step": "<function on_episode_step at 0x7fc7246c2f28>", "on_episode_end": "<function on_episode_end at 0x7fc7246c2a60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7259727b8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724596ea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7700.206657171249, "timesteps_since_restore": 3108447, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 90.28387096774193, "ram_util_percent": 32.40537634408602}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": 0.24944, "episode_reward_mean": 0.2499124, "episode_len_mean": 1200.0, "episodes_this_iter": 22, "policy_reward_min": {"av": 0.24944}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.2499124}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.2979653082836955, "avg_speed_min": 1.8344926854419483, "avg_speed_max": 4.290390650862476, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.67368741445557, "mean_processing_ms": 1.5164725741057863, "mean_inference_ms": 0.36148767371196044}, "off_policy_estimator": {}, "info": {"num_steps_trained": 920192, "num_steps_sampled": 3135823, "sample_time_ms": 63690.914, "load_time_ms": 2.22, "grad_time_ms": 3637.237, "update_time_ms": 5.795, "learner": {"av": {"cur_kl_coeff": 0.08118302375078201, "cur_lr": 9.999999747378752e-05, "total_loss": 0.015765385702252388, "policy_loss": -0.00558057613670826, "vf_loss": 0.020639050751924515, "vf_explained_var": 0.4609455466270447, "kl": 0.008707575500011444, "entropy": 2.6108837127685547, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27376, "done": false, "timesteps_total": 3135823, "episodes_total": 3029, "training_iteration": 115, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-11-17", "timestamp": 1588824677, "time_this_iter_s": 68.08633732795715, "time_total_s": 7768.2929944992065, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246822f0>", "on_episode_step": "<function on_episode_step at 0x7fc72461e0d0>", "on_episode_end": "<function on_episode_end at 0x7fc7246c2bf8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246c2e18>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245f5730>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7768.2929944992065, "timesteps_since_restore": 3135823, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 89.54795918367346, "ram_util_percent": 32.416326530612245}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": 0.24884, "episode_reward_mean": 0.24987559999999998, "episode_len_mean": 1200.0, "episodes_this_iter": 23, "policy_reward_min": {"av": 0.24884}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.24987559999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.298557282782903, "avg_speed_min": 1.8344926854419483, "avg_speed_max": 4.290390650862476, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.695617724726922, "mean_processing_ms": 1.5146657217742245, "mean_inference_ms": 0.36199858006771374}, "off_policy_estimator": {}, "info": {"num_steps_trained": 928000, "num_steps_sampled": 3163466, "sample_time_ms": 64081.219, "load_time_ms": 2.267, "grad_time_ms": 3632.569, "update_time_ms": 5.81, "learner": {"av": {"cur_kl_coeff": 0.08118302375078201, "cur_lr": 9.999999747378752e-05, "total_loss": 0.008620400913059711, "policy_loss": -0.010151895694434643, "vf_loss": 0.01741114817559719, "vf_explained_var": 0.6390303373336792, "kl": 0.01676642708480358, "entropy": 2.7654130458831787, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27643, "done": false, "timesteps_total": 3163466, "episodes_total": 3052, "training_iteration": 116, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-12-25", "timestamp": 1588824745, "time_this_iter_s": 67.54943323135376, "time_total_s": 7835.84242773056, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246ece18>", "on_episode_step": "<function on_episode_step at 0x7fc724596ea0>", "on_episode_end": "<function on_episode_end at 0x7fc724596950>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245968c8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724596620>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7835.84242773056, "timesteps_since_restore": 3163466, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 90.4375, "ram_util_percent": 32.449999999999996}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": 0.24884, "episode_reward_mean": 0.2498666, "episode_len_mean": 1200.0, "episodes_this_iter": 24, "policy_reward_min": {"av": 0.24884}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.2498666}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.398560616551275, "avg_speed_min": 1.924085515648316, "avg_speed_max": 4.374132026835026, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.697660614126644, "mean_processing_ms": 1.5132621377895616, "mean_inference_ms": 0.36195665905178176}, "off_policy_estimator": {}, "info": {"num_steps_trained": 935168, "num_steps_sampled": 3192019, "sample_time_ms": 64267.762, "load_time_ms": 2.283, "grad_time_ms": 3638.175, "update_time_ms": 5.903, "learner": {"av": {"cur_kl_coeff": 0.08118302375078201, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0018723165849223733, "policy_loss": -0.004192894324660301, "vf_loss": 0.0006827664910815656, "vf_explained_var": 0.8717730641365051, "kl": 0.020174305886030197, "entropy": 2.447056531906128, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28553, "done": false, "timesteps_total": 3192019, "episodes_total": 3076, "training_iteration": 117, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-13-30", "timestamp": 1588824810, "time_this_iter_s": 65.06185793876648, "time_total_s": 7900.904285669327, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246ec8c8>", "on_episode_step": "<function on_episode_step at 0x7fc724596510>", "on_episode_end": "<function on_episode_end at 0x7fc724596730>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245962f0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7259721e0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7900.904285669327, "timesteps_since_restore": 3192019, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 90.79677419354837, "ram_util_percent": 32.48064516129032}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00088, "episode_reward_mean": 0.21736629999999998, "episode_len_mean": 1192.81, "episodes_this_iter": 24, "policy_reward_min": {"av": -3.00088}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.21736629999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.2943640978780557, "avg_speed_min": 1.211975014443317, "avg_speed_max": 4.374132026835026, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.70212995378246, "mean_processing_ms": 1.5122940712708348, "mean_inference_ms": 0.3620420048165996}, "off_policy_estimator": {}, "info": {"num_steps_trained": 944000, "num_steps_sampled": 3219730, "sample_time_ms": 64735.119, "load_time_ms": 2.292, "grad_time_ms": 3695.895, "update_time_ms": 5.904, "learner": {"av": {"cur_kl_coeff": 0.12177453935146332, "cur_lr": 9.999999747378752e-05, "total_loss": 0.07732423394918442, "policy_loss": -0.0015790745383128524, "vf_loss": 0.0785389244556427, "vf_explained_var": 0.6680038571357727, "kl": 0.0029921745881438255, "entropy": 2.6529126167297363, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27711, "done": false, "timesteps_total": 3219730, "episodes_total": 3100, "training_iteration": 118, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-14-41", "timestamp": 1588824881, "time_this_iter_s": 70.76869297027588, "time_total_s": 7971.672978639603, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246daea0>", "on_episode_step": "<function on_episode_step at 0x7fc724596950>", "on_episode_end": "<function on_episode_end at 0x7fc724596ea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc724596620>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7246c2ea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7971.672978639603, "timesteps_since_restore": 3219730, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 91.33168316831681, "ram_util_percent": 32.495049504950494}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00088, "episode_reward_mean": 0.1848381, "episode_len_mean": 1184.93, "episodes_this_iter": 22, "policy_reward_min": {"av": -3.00088}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1848381}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.1885298652808522, "avg_speed_min": 1.211975014443317, "avg_speed_max": 4.374132026835026, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.690372803979063, "mean_processing_ms": 1.5102154516694872, "mean_inference_ms": 0.36171461655880804}, "off_policy_estimator": {}, "info": {"num_steps_trained": 952960, "num_steps_sampled": 3245946, "sample_time_ms": 64825.339, "load_time_ms": 2.285, "grad_time_ms": 3710.891, "update_time_ms": 5.963, "learner": {"av": {"cur_kl_coeff": 0.06088726967573166, "cur_lr": 9.999999747378752e-05, "total_loss": 0.09363045543432236, "policy_loss": 0.0011681135511025786, "vf_loss": 0.09228352457284927, "vf_explained_var": 0.5134099125862122, "kl": 0.002936774864792824, "entropy": 3.1984353065490723, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26216, "done": false, "timesteps_total": 3245946, "episodes_total": 3122, "training_iteration": 119, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-15-51", "timestamp": 1588824951, "time_this_iter_s": 69.77659773826599, "time_total_s": 8041.449576377869, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc724596598>", "on_episode_step": "<function on_episode_step at 0x7fc724596730>", "on_episode_end": "<function on_episode_end at 0x7fc724596510>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725a0f7b8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7246c21e0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8041.449576377869, "timesteps_since_restore": 3245946, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 90.09099999999997, "ram_util_percent": 32.494}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00088, "episode_reward_mean": 0.15233049999999998, "episode_len_mean": 1177.88, "episodes_this_iter": 21, "policy_reward_min": {"av": -3.00088}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.15233049999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.073877373851409, "avg_speed_min": 1.206984898450186, "avg_speed_max": 4.374132026835026, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.71489686145128, "mean_processing_ms": 1.5092467817617856, "mean_inference_ms": 0.3622221131762292}, "off_policy_estimator": {}, "info": {"num_steps_trained": 961664, "num_steps_sampled": 3270998, "sample_time_ms": 64609.546, "load_time_ms": 2.312, "grad_time_ms": 3733.003, "update_time_ms": 5.918, "learner": {"av": {"cur_kl_coeff": 0.03044363483786583, "cur_lr": 9.999999747378752e-05, "total_loss": 0.02187165804207325, "policy_loss": 0.002513735555112362, "vf_loss": 0.019188325852155685, "vf_explained_var": 0.7584421634674072, "kl": 0.00557080889120698, "entropy": 2.5670249462127686, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25052, "done": false, "timesteps_total": 3270998, "episodes_total": 3143, "training_iteration": 120, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-16-58", "timestamp": 1588825018, "time_this_iter_s": 67.23984694480896, "time_total_s": 8108.689423322678, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7245968c8>", "on_episode_step": "<function on_episode_step at 0x7fc724596ea0>", "on_episode_end": "<function on_episode_end at 0x7fc724596950>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc724596620>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245f5950>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8108.689423322678, "timesteps_since_restore": 3270998, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 91.51770833333335, "ram_util_percent": 32.49791666666667}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0009099999999997, "episode_reward_mean": 0.0873255, "episode_len_mean": 1163.14, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.0009099999999997}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.0873255}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.962562018265177, "avg_speed_min": 1.206984898450186, "avg_speed_max": 4.313583416196089, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.69600997915584, "mean_processing_ms": 1.5086745761452571, "mean_inference_ms": 0.3617617628542349}, "off_policy_estimator": {}, "info": {"num_steps_trained": 969600, "num_steps_sampled": 3297156, "sample_time_ms": 64649.474, "load_time_ms": 2.339, "grad_time_ms": 3749.968, "update_time_ms": 5.885, "learner": {"av": {"cur_kl_coeff": 0.03044363483786583, "cur_lr": 9.999999747378752e-05, "total_loss": 0.01675259694457054, "policy_loss": -0.008508856408298016, "vf_loss": 0.024847600609064102, "vf_explained_var": 0.8402583003044128, "kl": 0.013594020158052444, "entropy": 2.7327487468719482, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26158, "done": false, "timesteps_total": 3297156, "episodes_total": 3166, "training_iteration": 121, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-18-04", "timestamp": 1588825084, "time_this_iter_s": 66.27916359901428, "time_total_s": 8174.968586921692, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246daea0>", "on_episode_step": "<function on_episode_step at 0x7fc724682268>", "on_episode_end": "<function on_episode_end at 0x7fc7246822f0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246c21e0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7246ec8c8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8174.968586921692, "timesteps_since_restore": 3297156, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 89.38936170212764, "ram_util_percent": 32.501063829787235}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0009099999999997, "episode_reward_mean": 0.11983979999999997, "episode_len_mean": 1170.33, "episodes_this_iter": 22, "policy_reward_min": {"av": -3.0009099999999997}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.11983979999999997}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.963055476837854, "avg_speed_min": 1.206984898450186, "avg_speed_max": 4.3591405703819595, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.67701510123983, "mean_processing_ms": 1.507475935574601, "mean_inference_ms": 0.36120718486624187}, "off_policy_estimator": {}, "info": {"num_steps_trained": 977280, "num_steps_sampled": 3323356, "sample_time_ms": 64274.92, "load_time_ms": 2.323, "grad_time_ms": 3725.969, "update_time_ms": 5.852, "learner": {"av": {"cur_kl_coeff": 0.03044363483786583, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0040321070700883865, "policy_loss": -0.005152187775820494, "vf_loss": 0.0006019975990056992, "vf_explained_var": 0.8713327646255493, "kl": 0.017017697915434837, "entropy": 2.25053071975708, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26200, "done": false, "timesteps_total": 3323356, "episodes_total": 3188, "training_iteration": 122, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-19-10", "timestamp": 1588825150, "time_this_iter_s": 65.39823603630066, "time_total_s": 8240.366822957993, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc724682ea0>", "on_episode_step": "<function on_episode_step at 0x7fc725a0fd90>", "on_episode_end": "<function on_episode_end at 0x7fc7246ece18>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246c2c80>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724596f28>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8240.366822957993, "timesteps_since_restore": 3323356, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 89.13936170212764, "ram_util_percent": 32.49787234042553}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0009099999999997, "episode_reward_mean": 0.10734480000000002, "episode_len_mean": 1161.54, "episodes_this_iter": 25, "policy_reward_min": {"av": -3.0009099999999997}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.10734480000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.915643263350278, "avg_speed_min": 1.206984898450186, "avg_speed_max": 4.3591405703819595, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.718995463054743, "mean_processing_ms": 1.5071557589305369, "mean_inference_ms": 0.36229292344059516}, "off_policy_estimator": {}, "info": {"num_steps_trained": 987392, "num_steps_sampled": 3351857, "sample_time_ms": 64619.16, "load_time_ms": 2.355, "grad_time_ms": 3767.594, "update_time_ms": 5.799, "learner": {"av": {"cur_kl_coeff": 0.03044363483786583, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0162388663738966, "policy_loss": -0.021454665809869766, "vf_loss": 0.00374843692407012, "vf_explained_var": 0.7025778889656067, "kl": 0.04819942265748978, "entropy": 2.0241408348083496, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28501, "done": false, "timesteps_total": 3351857, "episodes_total": 3213, "training_iteration": 123, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-20-29", "timestamp": 1588825229, "time_this_iter_s": 78.48620295524597, "time_total_s": 8318.853025913239, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72465fea0>", "on_episode_step": "<function on_episode_step at 0x7fc7246822f0>", "on_episode_end": "<function on_episode_end at 0x7fc724682268>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246ec8c8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725972d90>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8318.853025913239, "timesteps_since_restore": 3351857, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 89.74642857142858, "ram_util_percent": 32.5}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0009099999999997, "episode_reward_mean": 0.17237769999999997, "episode_len_mean": 1176.47, "episodes_this_iter": 22, "policy_reward_min": {"av": -3.0009099999999997}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.17237769999999997}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.0774695156443967, "avg_speed_min": 1.228528410289789, "avg_speed_max": 4.3591405703819595, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.725112625395496, "mean_processing_ms": 1.5055913784504633, "mean_inference_ms": 0.3622627394128019}, "off_policy_estimator": {}, "info": {"num_steps_trained": 995456, "num_steps_sampled": 3378654, "sample_time_ms": 64742.6, "load_time_ms": 2.355, "grad_time_ms": 3796.025, "update_time_ms": 5.825, "learner": {"av": {"cur_kl_coeff": 0.045665450394153595, "cur_lr": 9.999999747378752e-05, "total_loss": 0.007361262571066618, "policy_loss": -0.0015603196807205677, "vf_loss": 0.008202235214412212, "vf_explained_var": 0.8862219452857971, "kl": 0.015752533450722694, "entropy": 2.827575922012329, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26797, "done": false, "timesteps_total": 3378654, "episodes_total": 3235, "training_iteration": 124, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-21-36", "timestamp": 1588825296, "time_this_iter_s": 66.94244122505188, "time_total_s": 8385.79546713829, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc725a0fd90>", "on_episode_step": "<function on_episode_step at 0x7fc724682ea0>", "on_episode_end": "<function on_episode_end at 0x7fc7246c21e0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246c2c80>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc725972ae8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8385.79546713829, "timesteps_since_restore": 3378654, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 91.98631578947368, "ram_util_percent": 32.5}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -1.00021, "episode_reward_mean": 0.2374004, "episode_len_mean": 1191.21, "episodes_this_iter": 25, "policy_reward_min": {"av": -1.00021}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.2374004}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.16371422672386, "avg_speed_min": 1.795858313773237, "avg_speed_max": 4.672834448558057, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.746251022408774, "mean_processing_ms": 1.5045910321515243, "mean_inference_ms": 0.36282279427220404}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1003264, "num_steps_sampled": 3407505, "sample_time_ms": 64881.401, "load_time_ms": 2.364, "grad_time_ms": 3793.411, "update_time_ms": 5.866, "learner": {"av": {"cur_kl_coeff": 0.045665450394153595, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0024932632222771645, "policy_loss": 0.001708117313683033, "vf_loss": 0.0005681908805854619, "vf_explained_var": 0.884236752986908, "kl": 0.004751014057546854, "entropy": 2.66032338142395, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28851, "done": false, "timesteps_total": 3407505, "episodes_total": 3260, "training_iteration": 125, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-22-45", "timestamp": 1588825365, "time_this_iter_s": 69.44912981987, "time_total_s": 8455.24459695816, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc724682730>", "on_episode_step": "<function on_episode_step at 0x7fc72465fea0>", "on_episode_end": "<function on_episode_end at 0x7fc7246ece18>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246ec8c8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7259729d8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8455.24459695816, "timesteps_since_restore": 3407505, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 91.66767676767677, "ram_util_percent": 32.5}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -1.00021, "episode_reward_mean": 0.23740090000000003, "episode_len_mean": 1191.21, "episodes_this_iter": 22, "policy_reward_min": {"av": -1.00021}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.23740090000000003}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.153230882895904, "avg_speed_min": 1.795858313773237, "avg_speed_max": 5.181512734701893, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.765129888076125, "mean_processing_ms": 1.5057726995678622, "mean_inference_ms": 0.3632950480494668}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1011584, "num_steps_sampled": 3434089, "sample_time_ms": 64824.835, "load_time_ms": 2.483, "grad_time_ms": 3818.766, "update_time_ms": 5.811, "learner": {"av": {"cur_kl_coeff": 0.022832725197076797, "cur_lr": 9.999999747378752e-05, "total_loss": -0.005407579708844423, "policy_loss": -0.006422157399356365, "vf_loss": 0.000599659513682127, "vf_explained_var": 0.8644309043884277, "kl": 0.018172206357121468, "entropy": 2.7591440677642822, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26584, "done": false, "timesteps_total": 3434089, "episodes_total": 3282, "training_iteration": 126, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-23-53", "timestamp": 1588825433, "time_this_iter_s": 67.23741507530212, "time_total_s": 8522.482012033463, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72461e378>", "on_episode_step": "<function on_episode_step at 0x7fc72461e510>", "on_episode_end": "<function on_episode_end at 0x7fc72461eae8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72461eb70>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724596598>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8522.482012033463, "timesteps_since_restore": 3434089, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 90.99479166666667, "ram_util_percent": 32.50208333333333}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": 0.24886, "episode_reward_mean": 0.2498806, "episode_len_mean": 1200.0, "episodes_this_iter": 23, "policy_reward_min": {"av": 0.24886}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.2498806}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.2616671942267828, "avg_speed_min": 1.795858313773237, "avg_speed_max": 5.181512734701893, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.7423207214256, "mean_processing_ms": 1.5030510854314896, "mean_inference_ms": 0.3626327986758153}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1018880, "num_steps_sampled": 3462252, "sample_time_ms": 64908.52, "load_time_ms": 2.553, "grad_time_ms": 3825.642, "update_time_ms": 5.858, "learner": {"av": {"cur_kl_coeff": 0.022832725197076797, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0003989042015746236, "policy_loss": -0.00127547443844378, "vf_loss": 0.0005187438800930977, "vf_explained_var": 0.9044182300567627, "kl": 0.015671687200665474, "entropy": 2.841249942779541, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28163, "done": false, "timesteps_total": 3462252, "episodes_total": 3305, "training_iteration": 127, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-24-59", "timestamp": 1588825499, "time_this_iter_s": 65.96932554244995, "time_total_s": 8588.451337575912, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72461e1e0>", "on_episode_step": "<function on_episode_step at 0x7fc7246ece18>", "on_episode_end": "<function on_episode_end at 0x7fc72465fea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7259729d8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7246c2d90>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8588.451337575912, "timesteps_since_restore": 3462252, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 89.6221052631579, "ram_util_percent": 32.5}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": 0.24884, "episode_reward_mean": 0.24988120000000003, "episode_len_mean": 1200.0, "episodes_this_iter": 21, "policy_reward_min": {"av": 0.24884}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.24988120000000003}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.259729254408634, "avg_speed_min": 1.933063595685379, "avg_speed_max": 5.181512734701893, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.745268637315068, "mean_processing_ms": 1.5023724020321498, "mean_inference_ms": 0.36261621020458096}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1027456, "num_steps_sampled": 3488707, "sample_time_ms": 64702.803, "load_time_ms": 2.54, "grad_time_ms": 3814.749, "update_time_ms": 5.858, "learner": {"av": {"cur_kl_coeff": 0.022832725197076797, "cur_lr": 9.999999747378752e-05, "total_loss": -0.005634662229567766, "policy_loss": -0.00807453878223896, "vf_loss": 0.0008186674676835537, "vf_explained_var": 0.8323997259140015, "kl": 0.07100381702184677, "entropy": 2.540461301803589, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26455, "done": false, "timesteps_total": 3488707, "episodes_total": 3326, "training_iteration": 128, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-26-07", "timestamp": 1588825567, "time_this_iter_s": 68.60198497772217, "time_total_s": 8657.053322553635, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246ec8c8>", "on_episode_step": "<function on_episode_step at 0x7fc72461eae8>", "on_episode_end": "<function on_episode_end at 0x7fc72461e510>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72461ed90>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7246c2e18>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8657.053322553635, "timesteps_since_restore": 3488707, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 91.19285714285714, "ram_util_percent": 32.5}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": 0.24884, "episode_reward_mean": 0.24987699999999996, "episode_len_mean": 1200.0, "episodes_this_iter": 25, "policy_reward_min": {"av": 0.24884}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.24987699999999996}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.2304298403567793, "avg_speed_min": 1.933063595685379, "avg_speed_max": 5.181512734701893, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.748478461572404, "mean_processing_ms": 1.5033818367887037, "mean_inference_ms": 0.3628281727452977}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1035136, "num_steps_sampled": 3516859, "sample_time_ms": 64588.152, "load_time_ms": 2.528, "grad_time_ms": 3758.449, "update_time_ms": 5.764, "learner": {"av": {"cur_kl_coeff": 0.034249089658260345, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0005050924955867231, "policy_loss": -0.0003873544337693602, "vf_loss": 0.0006652710726484656, "vf_explained_var": 0.8770204186439514, "kl": 0.006632976233959198, "entropy": 2.8126251697540283, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28152, "done": false, "timesteps_total": 3516859, "episodes_total": 3351, "training_iteration": 129, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-27-15", "timestamp": 1588825635, "time_this_iter_s": 68.06558179855347, "time_total_s": 8725.118904352188, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246ece18>", "on_episode_step": "<function on_episode_step at 0x7fc72461eb70>", "on_episode_end": "<function on_episode_end at 0x7fc72461e1e0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7259729d8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245f5b70>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8725.118904352188, "timesteps_since_restore": 3516859, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 90.27216494845362, "ram_util_percent": 32.5}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00078, "episode_reward_mean": 0.2173639, "episode_len_mean": 1192.1, "episodes_this_iter": 24, "policy_reward_min": {"av": -3.00078}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.2173639}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.256161492406154, "avg_speed_min": 1.4407495063787388, "avg_speed_max": 4.970033466520304, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.73619592698217, "mean_processing_ms": 1.5004717506355143, "mean_inference_ms": 0.3625335419426672}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1042560, "num_steps_sampled": 3545064, "sample_time_ms": 64548.092, "load_time_ms": 2.484, "grad_time_ms": 3702.366, "update_time_ms": 5.843, "learner": {"av": {"cur_kl_coeff": 0.034249089658260345, "cur_lr": 9.999999747378752e-05, "total_loss": 0.02423161454498768, "policy_loss": 3.4638327633729205e-05, "vf_loss": 0.023810822516679764, "vf_explained_var": 0.13310620188713074, "kl": 0.011274797841906548, "entropy": 3.311244010925293, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28205, "done": false, "timesteps_total": 3545064, "episodes_total": 3375, "training_iteration": 130, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-28-22", "timestamp": 1588825702, "time_this_iter_s": 66.27807831764221, "time_total_s": 8791.39698266983, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72465fea0>", "on_episode_step": "<function on_episode_step at 0x7fc72461e510>", "on_episode_end": "<function on_episode_end at 0x7fc72461eae8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246c2e18>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245f5d90>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8791.39698266983, "timesteps_since_restore": 3545064, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 90.80851063829789, "ram_util_percent": 32.5}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00078, "episode_reward_mean": 0.18483609999999998, "episode_len_mean": 1184.63, "episodes_this_iter": 26, "policy_reward_min": {"av": -3.00078}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.18483609999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.2622277654358145, "avg_speed_min": 1.3055190119962123, "avg_speed_max": 4.970033466520304, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.743072399943667, "mean_processing_ms": 1.4999361415319745, "mean_inference_ms": 0.3625937182031175}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1049344, "num_steps_sampled": 3574339, "sample_time_ms": 64488.535, "load_time_ms": 2.466, "grad_time_ms": 3649.965, "update_time_ms": 5.914, "learner": {"av": {"cur_kl_coeff": 0.034249089658260345, "cur_lr": 9.999999747378752e-05, "total_loss": 0.03560914099216461, "policy_loss": -0.00011943013669224456, "vf_loss": 0.035475119948387146, "vf_explained_var": 0.7461833357810974, "kl": 0.007400328293442726, "entropy": 3.756101608276367, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 29275, "done": false, "timesteps_total": 3574339, "episodes_total": 3401, "training_iteration": 131, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-29-27", "timestamp": 1588825767, "time_this_iter_s": 65.15899968147278, "time_total_s": 8856.555982351303, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc724682ea0>", "on_episode_step": "<function on_episode_step at 0x7fc7246822f0>", "on_episode_end": "<function on_episode_end at 0x7fc724682730>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245966a8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72461e1e0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8856.555982351303, "timesteps_since_restore": 3574339, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 89.05268817204302, "ram_util_percent": 32.50215053763441}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00078, "episode_reward_mean": 0.18484280000000003, "episode_len_mean": 1184.63, "episodes_this_iter": 21, "policy_reward_min": {"av": -3.00078}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.18484280000000003}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.3157587453605566, "avg_speed_min": 1.3055190119962123, "avg_speed_max": 4.970033466520304, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.735981736208245, "mean_processing_ms": 1.498560670135638, "mean_inference_ms": 0.3624715274190306}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1058048, "num_steps_sampled": 3601956, "sample_time_ms": 64915.453, "load_time_ms": 2.5, "grad_time_ms": 3697.847, "update_time_ms": 6.04, "learner": {"av": {"cur_kl_coeff": 0.034249089658260345, "cur_lr": 9.999999747378752e-05, "total_loss": 0.00280372379347682, "policy_loss": -0.0005545032909139991, "vf_loss": 0.003077972214668989, "vf_explained_var": 0.689812421798706, "kl": 0.008182908408343792, "entropy": 3.2570078372955322, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27617, "done": false, "timesteps_total": 3601956, "episodes_total": 3422, "training_iteration": 132, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-30-37", "timestamp": 1588825837, "time_this_iter_s": 70.14776158332825, "time_total_s": 8926.703743934631, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc725a0fd90>", "on_episode_step": "<function on_episode_step at 0x7fc72461e510>", "on_episode_end": "<function on_episode_end at 0x7fc72461eb70>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72465fea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7246c2bf8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8926.703743934631, "timesteps_since_restore": 3601956, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 90.85742574257424, "ram_util_percent": 32.5}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00078, "episode_reward_mean": 0.18480229999999997, "episode_len_mean": 1184.63, "episodes_this_iter": 26, "policy_reward_min": {"av": -3.00078}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.18480229999999997}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.3339232684943316, "avg_speed_min": 1.3055190119962123, "avg_speed_max": 4.445324309476967, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.73153914566501, "mean_processing_ms": 1.496261549912353, "mean_inference_ms": 0.3623270135452809}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1064704, "num_steps_sampled": 3631340, "sample_time_ms": 63658.565, "load_time_ms": 2.418, "grad_time_ms": 3542.611, "update_time_ms": 6.06, "learner": {"av": {"cur_kl_coeff": 0.034249089658260345, "cur_lr": 9.999999747378752e-05, "total_loss": -0.005024441052228212, "policy_loss": -0.006232232786715031, "vf_loss": 0.0003827046894002706, "vf_explained_var": 0.9206975102424622, "kl": 0.024090729653835297, "entropy": 3.385885715484619, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 29384, "done": false, "timesteps_total": 3631340, "episodes_total": 3448, "training_iteration": 133, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-31-42", "timestamp": 1588825902, "time_this_iter_s": 64.36395382881165, "time_total_s": 8991.067697763443, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72461eae8>", "on_episode_step": "<function on_episode_step at 0x7fc7246822f0>", "on_episode_end": "<function on_episode_end at 0x7fc724682ea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc724682730>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7246c2d08>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8991.067697763443, "timesteps_since_restore": 3631340, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 90.1619565217391, "ram_util_percent": 32.5}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00078, "episode_reward_mean": 0.21732819999999997, "episode_len_mean": 1192.53, "episodes_this_iter": 22, "policy_reward_min": {"av": -3.00078}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.21732819999999997}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.3166775875148056, "avg_speed_min": 1.3055190119962123, "avg_speed_max": 4.445324309476967, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.71769124845337, "mean_processing_ms": 1.4961199182206235, "mean_inference_ms": 0.36198976706573405}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1073920, "num_steps_sampled": 3658556, "sample_time_ms": 64227.911, "load_time_ms": 2.441, "grad_time_ms": 3595.206, "update_time_ms": 6.104, "learner": {"av": {"cur_kl_coeff": 0.05137363448739052, "cur_lr": 9.999999747378752e-05, "total_loss": 0.00249759154394269, "policy_loss": 0.0012689437717199326, "vf_loss": 0.0006602396024391055, "vf_explained_var": 0.8606707453727722, "kl": 0.011064122430980206, "entropy": 2.3219337463378906, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27216, "done": false, "timesteps_total": 3658556, "episodes_total": 3470, "training_iteration": 134, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-32-55", "timestamp": 1588825975, "time_this_iter_s": 73.16287326812744, "time_total_s": 9064.23057103157, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc724682268>", "on_episode_step": "<function on_episode_step at 0x7fc72461e510>", "on_episode_end": "<function on_episode_end at 0x7fc725a0fd90>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72465fea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7246c2b70>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9064.23057103157, "timesteps_since_restore": 3658556, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 89.67403846153844, "ram_util_percent": 32.50769230769231}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -1.0002300000000002, "episode_reward_mean": 0.2248562, "episode_len_mean": 1182.11, "episodes_this_iter": 24, "policy_reward_min": {"av": -1.0002300000000002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.2248562}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.2627609139683558, "avg_speed_min": 1.7847664498100306, "avg_speed_max": 4.500245217293351, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.719978013755146, "mean_processing_ms": 1.494872298336279, "mean_inference_ms": 0.3620764265073474}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1082752, "num_steps_sampled": 3685772, "sample_time_ms": 64278.808, "load_time_ms": 2.446, "grad_time_ms": 3640.934, "update_time_ms": 6.017, "learner": {"av": {"cur_kl_coeff": 0.05137363448739052, "cur_lr": 9.999999747378752e-05, "total_loss": 0.004967270419001579, "policy_loss": -0.004738477058708668, "vf_loss": 0.008887849748134613, "vf_explained_var": 0.6238439679145813, "kl": 0.015920646488666534, "entropy": 2.3184690475463867, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27216, "done": false, "timesteps_total": 3685772, "episodes_total": 3494, "training_iteration": 135, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-34-06", "timestamp": 1588826046, "time_this_iter_s": 70.4148302078247, "time_total_s": 9134.645401239395, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72461eb70>", "on_episode_step": "<function on_episode_step at 0x7fc724682ea0>", "on_episode_end": "<function on_episode_end at 0x7fc7246822f0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc724682730>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724552620>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9134.645401239395, "timesteps_since_restore": 3685772, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 91.14653465346534, "ram_util_percent": 32.50693069306931}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -1.0002900000000001, "episode_reward_mean": 0.2123688, "episode_len_mean": 1173.43, "episodes_this_iter": 23, "policy_reward_min": {"av": -1.0002900000000001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.2123688}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.276910375544112, "avg_speed_min": 2.019108436586271, "avg_speed_max": 4.500245217293351, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.731628420672585, "mean_processing_ms": 1.494358668698937, "mean_inference_ms": 0.362245429489588}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1090048, "num_steps_sampled": 3712877, "sample_time_ms": 64063.185, "load_time_ms": 2.278, "grad_time_ms": 3591.038, "update_time_ms": 6.106, "learner": {"av": {"cur_kl_coeff": 0.05137363448739052, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0007852862472645938, "policy_loss": -0.008907437324523926, "vf_loss": 0.008705848827958107, "vf_explained_var": 0.5279954075813293, "kl": 0.019209709018468857, "entropy": 2.9711198806762695, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27105, "done": false, "timesteps_total": 3712877, "episodes_total": 3517, "training_iteration": 136, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-35-10", "timestamp": 1588826110, "time_this_iter_s": 64.58145499229431, "time_total_s": 9199.22685623169, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246c2c80>", "on_episode_step": "<function on_episode_step at 0x7fc7246c2d08>", "on_episode_end": "<function on_episode_end at 0x7fc7246c2d90>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246c2a60>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724596e18>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9199.22685623169, "timesteps_since_restore": 3712877, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 90.42173913043477, "ram_util_percent": 32.5195652173913}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -1.0002900000000001, "episode_reward_mean": 0.21239510000000003, "episode_len_mean": 1173.43, "episodes_this_iter": 23, "policy_reward_min": {"av": -1.0002900000000001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.21239510000000003}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.318386434815568, "avg_speed_min": 2.195858504671773, "avg_speed_max": 4.500245217293351, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.733367104574636, "mean_processing_ms": 1.4931937704615195, "mean_inference_ms": 0.36236163685515377}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1096832, "num_steps_sampled": 3740261, "sample_time_ms": 63807.751, "load_time_ms": 2.19, "grad_time_ms": 3568.144, "update_time_ms": 5.968, "learner": {"av": {"cur_kl_coeff": 0.05137363448739052, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0018477721605449915, "policy_loss": -0.005131310783326626, "vf_loss": 0.002647839719429612, "vf_explained_var": 0.9700078964233398, "kl": 0.012374025769531727, "entropy": 3.787652015686035, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27384, "done": false, "timesteps_total": 3740261, "episodes_total": 3540, "training_iteration": 137, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-36-14", "timestamp": 1588826174, "time_this_iter_s": 63.1829469203949, "time_total_s": 9262.409803152084, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246c21e0>", "on_episode_step": "<function on_episode_step at 0x7fc725972510>", "on_episode_end": "<function on_episode_end at 0x7fc7245966a8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc724596510>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245f5d90>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9262.409803152084, "timesteps_since_restore": 3740261, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 89.26333333333334, "ram_util_percent": 32.55222222222222}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00054, "episode_reward_mean": 0.17986879999999997, "episode_len_mean": 1166.05, "episodes_this_iter": 24, "policy_reward_min": {"av": -3.00054}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.17986879999999997}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.333705569793037, "avg_speed_min": 1.287599143049123, "avg_speed_max": 4.500245217293351, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.74411905095167, "mean_processing_ms": 1.4925114799082173, "mean_inference_ms": 0.3624964804884283}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1103616, "num_steps_sampled": 3767798, "sample_time_ms": 63345.537, "load_time_ms": 2.171, "grad_time_ms": 3485.897, "update_time_ms": 6.03, "learner": {"av": {"cur_kl_coeff": 0.05137363448739052, "cur_lr": 9.999999747378752e-05, "total_loss": 0.10081698000431061, "policy_loss": 0.0071252877824008465, "vf_loss": 0.09240613877773285, "vf_explained_var": 0.6430636048316956, "kl": 0.025023235008120537, "entropy": 2.73187255859375, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27537, "done": false, "timesteps_total": 3767798, "episodes_total": 3564, "training_iteration": 138, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-37-17", "timestamp": 1588826237, "time_this_iter_s": 63.1592493057251, "time_total_s": 9325.56905245781, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246c2ea0>", "on_episode_step": "<function on_episode_step at 0x7fc7246c2d90>", "on_episode_end": "<function on_episode_end at 0x7fc7246c2d08>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc724596e18>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724598400>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9325.56905245781, "timesteps_since_restore": 3767798, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 89.68444444444444, "ram_util_percent": 32.583333333333336}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00054, "episode_reward_mean": 0.1923629, "episode_len_mean": 1174.98, "episodes_this_iter": 21, "policy_reward_min": {"av": -3.00054}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1923629}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.257637829522609, "avg_speed_min": 1.287599143049123, "avg_speed_max": 4.428769105127699, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.73579504233643, "mean_processing_ms": 1.4918345607032708, "mean_inference_ms": 0.36238319392736784}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1113472, "num_steps_sampled": 3794168, "sample_time_ms": 63868.628, "load_time_ms": 2.185, "grad_time_ms": 3583.971, "update_time_ms": 6.068, "learner": {"av": {"cur_kl_coeff": 0.07706045359373093, "cur_lr": 9.999999747378752e-05, "total_loss": 0.004517856519669294, "policy_loss": -0.004251324571669102, "vf_loss": 0.00697859562933445, "vf_explained_var": 0.7142593860626221, "kl": 0.023236095905303955, "entropy": 2.2249081134796143, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26370, "done": false, "timesteps_total": 3794168, "episodes_total": 3585, "training_iteration": 139, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-38-31", "timestamp": 1588826311, "time_this_iter_s": 74.27804279327393, "time_total_s": 9399.847095251083, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246c2a60>", "on_episode_step": "<function on_episode_step at 0x7fc725972730>", "on_episode_end": "<function on_episode_end at 0x7fc725972510>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245f5d90>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724598620>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9399.847095251083, "timesteps_since_restore": 3794168, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 91.07924528301886, "ram_util_percent": 32.59150943396227}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0009099999999997, "episode_reward_mean": 0.15984980000000001, "episode_len_mean": 1168.26, "episodes_this_iter": 22, "policy_reward_min": {"av": -3.0009099999999997}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.15984980000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.2584105589783867, "avg_speed_min": 1.2299120294855237, "avg_speed_max": 4.474050188287598, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.710405406074372, "mean_processing_ms": 1.489883674451861, "mean_inference_ms": 0.36172740358820143}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1121280, "num_steps_sampled": 3819083, "sample_time_ms": 63530.473, "load_time_ms": 2.219, "grad_time_ms": 3601.426, "update_time_ms": 5.988, "learner": {"av": {"cur_kl_coeff": 0.11559067666530609, "cur_lr": 9.999999747378752e-05, "total_loss": -0.01401858776807785, "policy_loss": -0.025509826838970184, "vf_loss": 0.005710924975574017, "vf_explained_var": 0.945198655128479, "kl": 0.05000672861933708, "entropy": 3.0647594928741455, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 24915, "done": false, "timesteps_total": 3819083, "episodes_total": 3607, "training_iteration": 140, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-39-34", "timestamp": 1588826374, "time_this_iter_s": 63.07233023643494, "time_total_s": 9462.919425487518, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246c2ea0>", "on_episode_step": "<function on_episode_step at 0x7fc7245966a8>", "on_episode_end": "<function on_episode_end at 0x7fc724596510>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc724596e18>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724598840>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9462.919425487518, "timesteps_since_restore": 3819083, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 90.85777777777777, "ram_util_percent": 32.59777777777778}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0009099999999997, "episode_reward_mean": 0.1598376, "episode_len_mean": 1168.26, "episodes_this_iter": 25, "policy_reward_min": {"av": -3.0009099999999997}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1598376}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.165630027343976, "avg_speed_min": 1.2299120294855237, "avg_speed_max": 4.474050188287598, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.723827053294194, "mean_processing_ms": 1.4883800730849626, "mean_inference_ms": 0.3621185700760419}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1128704, "num_steps_sampled": 3846740, "sample_time_ms": 63474.83, "load_time_ms": 2.222, "grad_time_ms": 3631.106, "update_time_ms": 5.95, "learner": {"av": {"cur_kl_coeff": 0.17338600754737854, "cur_lr": 9.999999747378752e-05, "total_loss": -0.012290569953620434, "policy_loss": -0.018516456708312035, "vf_loss": 0.00104722217656672, "vf_explained_var": 0.8658491373062134, "kl": 0.029867829754948616, "entropy": 2.7971725463867188, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27657, "done": false, "timesteps_total": 3846740, "episodes_total": 3632, "training_iteration": 141, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-40-39", "timestamp": 1588826439, "time_this_iter_s": 64.90085101127625, "time_total_s": 9527.820276498795, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246c2d90>", "on_episode_step": "<function on_episode_step at 0x7fc7246c2d08>", "on_episode_end": "<function on_episode_end at 0x7fc7246c2a60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245f5d90>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724682ea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9527.820276498795, "timesteps_since_restore": 3846740, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 90.60967741935485, "ram_util_percent": 32.601075268817205}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0009099999999997, "episode_reward_mean": 0.1273514, "episode_len_mean": 1159.39, "episodes_this_iter": 22, "policy_reward_min": {"av": -3.0009099999999997}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1273514}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.070345750991331, "avg_speed_min": 1.2299120294855237, "avg_speed_max": 4.474050188287598, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.707571866522844, "mean_processing_ms": 1.48821048311666, "mean_inference_ms": 0.361652796165761}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1137280, "num_steps_sampled": 3873382, "sample_time_ms": 63410.535, "load_time_ms": 2.211, "grad_time_ms": 3625.118, "update_time_ms": 5.834, "learner": {"av": {"cur_kl_coeff": 0.260079026222229, "cur_lr": 9.999999747378752e-05, "total_loss": -0.016104528680443764, "policy_loss": -0.021947424858808517, "vf_loss": 0.0006477584829553962, "vf_explained_var": 0.979417622089386, "kl": 0.019975215196609497, "entropy": 2.842311143875122, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26642, "done": false, "timesteps_total": 3873382, "episodes_total": 3654, "training_iteration": 142, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-41-49", "timestamp": 1588826509, "time_this_iter_s": 69.44442701339722, "time_total_s": 9597.264703512192, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc725972730>", "on_episode_step": "<function on_episode_step at 0x7fc7245f5ae8>", "on_episode_end": "<function on_episode_end at 0x7fc7245f5048>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245f59d8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7246c2840>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9597.264703512192, "timesteps_since_restore": 3873382, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 90.45252525252525, "ram_util_percent": 32.597979797979804}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0009099999999997, "episode_reward_mean": 0.15982770000000002, "episode_len_mean": 1166.77, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.0009099999999997}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.15982770000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.1869417020783755, "avg_speed_min": 1.2299120294855237, "avg_speed_max": 4.474050188287598, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.71363979193128, "mean_processing_ms": 1.4878133438496133, "mean_inference_ms": 0.3618923552595721}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1144576, "num_steps_sampled": 3900622, "sample_time_ms": 63415.96, "load_time_ms": 2.226, "grad_time_ms": 3652.51, "update_time_ms": 5.841, "learner": {"av": {"cur_kl_coeff": 0.260079026222229, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0036462668795138597, "policy_loss": 0.0005996034014970064, "vf_loss": 0.0021928108762949705, "vf_explained_var": 0.7648727297782898, "kl": 0.0032830394338816404, "entropy": 3.427125930786133, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27240, "done": false, "timesteps_total": 3900622, "episodes_total": 3677, "training_iteration": 143, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-42-54", "timestamp": 1588826574, "time_this_iter_s": 64.69208717346191, "time_total_s": 9661.956790685654, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc725972510>", "on_episode_step": "<function on_episode_step at 0x7fc724682ea0>", "on_episode_end": "<function on_episode_end at 0x7fc724682268>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246822f0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72461eae8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9661.956790685654, "timesteps_since_restore": 3900622, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 88.88172043010752, "ram_util_percent": 32.5989247311828}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00024, "episode_reward_mean": 0.217337, "episode_len_mean": 1191.13, "episodes_this_iter": 27, "policy_reward_min": {"av": -3.00024}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.217337}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.135459099638477, "avg_speed_min": 1.8028204671104728, "avg_speed_max": 4.277825651591701, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.717936784213908, "mean_processing_ms": 1.4873682804515969, "mean_inference_ms": 0.3619655505027826}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1152384, "num_steps_sampled": 3931060, "sample_time_ms": 63261.344, "load_time_ms": 2.293, "grad_time_ms": 3589.521, "update_time_ms": 5.858, "learner": {"av": {"cur_kl_coeff": 0.1300395131111145, "cur_lr": 9.999999747378752e-05, "total_loss": 0.007537758443504572, "policy_loss": -0.0008456037612631917, "vf_loss": 0.00825757160782814, "vf_explained_var": 0.8674739003181458, "kl": 0.0009673332097008824, "entropy": 3.11739182472229, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 30438, "done": false, "timesteps_total": 3931060, "episodes_total": 3704, "training_iteration": 144, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-44-05", "timestamp": 1588826645, "time_this_iter_s": 70.98689675331116, "time_total_s": 9732.943687438965, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7245f5d90>", "on_episode_step": "<function on_episode_step at 0x7fc7245f5048>", "on_episode_end": "<function on_episode_end at 0x7fc7245f5ae8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246c2840>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245c5620>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9732.943687438965, "timesteps_since_restore": 3931060, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 90.08217821782178, "ram_util_percent": 32.6}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00024, "episode_reward_mean": 0.21735190000000004, "episode_len_mean": 1191.13, "episodes_this_iter": 20, "policy_reward_min": {"av": -3.00024}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.21735190000000004}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.091459069879868, "avg_speed_min": 1.8028204671104728, "avg_speed_max": 4.277825651591701, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.725026484912817, "mean_processing_ms": 1.486602192957802, "mean_inference_ms": 0.36203178425584837}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1162624, "num_steps_sampled": 3957196, "sample_time_ms": 63675.879, "load_time_ms": 2.328, "grad_time_ms": 3652.306, "update_time_ms": 5.909, "learner": {"av": {"cur_kl_coeff": 0.06501975655555725, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0010958255734294653, "policy_loss": 4.120115045225248e-05, "vf_loss": 0.000538021617103368, "vf_explained_var": 0.8583620190620422, "kl": 0.00794529914855957, "entropy": 2.2790896892547607, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26136, "done": false, "timesteps_total": 3957196, "episodes_total": 3724, "training_iteration": 145, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-45-20", "timestamp": 1588826720, "time_this_iter_s": 75.18852496147156, "time_total_s": 9808.132212400436, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7245f59d8>", "on_episode_step": "<function on_episode_step at 0x7fc724682268>", "on_episode_end": "<function on_episode_end at 0x7fc724682ea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725972510>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245c5840>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9808.132212400436, "timesteps_since_restore": 3957196, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 91.4906542056075, "ram_util_percent": 32.60000000000001}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00025, "episode_reward_mean": 0.1848433, "episode_len_mean": 1181.88, "episodes_this_iter": 24, "policy_reward_min": {"av": -3.00025}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1848433}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.056383866395131, "avg_speed_min": 1.8028204671104728, "avg_speed_max": 4.277825651591701, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.724283915567607, "mean_processing_ms": 1.4866380895668345, "mean_inference_ms": 0.3620181246434758}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1170816, "num_steps_sampled": 3984530, "sample_time_ms": 64059.667, "load_time_ms": 2.33, "grad_time_ms": 3692.501, "update_time_ms": 5.829, "learner": {"av": {"cur_kl_coeff": 0.06501975655555725, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0053762830793857574, "policy_loss": -0.0038371726404875517, "vf_loss": 0.00851072371006012, "vf_explained_var": 0.8424053192138672, "kl": 0.010807977057993412, "entropy": 2.9014577865600586, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27334, "done": false, "timesteps_total": 3984530, "episodes_total": 3748, "training_iteration": 146, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-46-29", "timestamp": 1588826789, "time_this_iter_s": 68.8207654953003, "time_total_s": 9876.952977895737, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7245f5a60>", "on_episode_step": "<function on_episode_step at 0x7fc7245f5048>", "on_episode_end": "<function on_episode_end at 0x7fc7245f5d90>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246c2840>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245c5a60>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9876.952977895737, "timesteps_since_restore": 3984530, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 89.17878787878787, "ram_util_percent": 32.60202020202021}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00025, "episode_reward_mean": 0.15235900000000002, "episode_len_mean": 1170.59, "episodes_this_iter": 26, "policy_reward_min": {"av": -3.00025}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.15235900000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.1113602532627294, "avg_speed_min": 1.849971645164843, "avg_speed_max": 4.207598913086825, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.745749488629134, "mean_processing_ms": 1.4863656118005772, "mean_inference_ms": 0.36241923283683847}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1178112, "num_steps_sampled": 4013119, "sample_time_ms": 64290.112, "load_time_ms": 2.334, "grad_time_ms": 3715.019, "update_time_ms": 5.892, "learner": {"av": {"cur_kl_coeff": 0.06501975655555725, "cur_lr": 9.999999747378752e-05, "total_loss": 0.014555934816598892, "policy_loss": -0.004153784830123186, "vf_loss": 0.01829804666340351, "vf_explained_var": 0.7857223153114319, "kl": 0.006331547163426876, "entropy": 3.466630458831787, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28589, "done": false, "timesteps_total": 4013119, "episodes_total": 3774, "training_iteration": 147, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-47-35", "timestamp": 1588826855, "time_this_iter_s": 65.71374273300171, "time_total_s": 9942.666720628738, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72465fea0>", "on_episode_step": "<function on_episode_step at 0x7fc724682ea0>", "on_episode_end": "<function on_episode_end at 0x7fc724682268>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc724682730>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7246c2a60>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9942.666720628738, "timesteps_since_restore": 4013119, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 91.66344086021502, "ram_util_percent": 32.6}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00025, "episode_reward_mean": 0.1523523, "episode_len_mean": 1170.59, "episodes_this_iter": 22, "policy_reward_min": {"av": -3.00025}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1523523}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.1966119356871077, "avg_speed_min": 1.849971645164843, "avg_speed_max": 4.319969477035279, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.744250521765398, "mean_processing_ms": 1.4872962386478732, "mean_inference_ms": 0.3623404565882218}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1185664, "num_steps_sampled": 4040887, "sample_time_ms": 64597.122, "load_time_ms": 2.34, "grad_time_ms": 3750.522, "update_time_ms": 5.962, "learner": {"av": {"cur_kl_coeff": 0.06501975655555725, "cur_lr": 9.999999747378752e-05, "total_loss": -0.004054140765219927, "policy_loss": -0.0073762196116149426, "vf_loss": 0.0024328012950718403, "vf_explained_var": 0.73223876953125, "kl": 0.013677037321031094, "entropy": 3.785167694091797, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27768, "done": false, "timesteps_total": 4040887, "episodes_total": 3796, "training_iteration": 148, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-48-41", "timestamp": 1588826921, "time_this_iter_s": 66.58347916603088, "time_total_s": 10009.25019979477, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246822f0>", "on_episode_step": "<function on_episode_step at 0x7fc7246c2bf8>", "on_episode_end": "<function on_episode_end at 0x7fc7246c2c80>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246c2840>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245f5d90>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10009.25019979477, "timesteps_since_restore": 4040887, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 90.7421052631579, "ram_util_percent": 32.6}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00025, "episode_reward_mean": 0.1523442, "episode_len_mean": 1170.59, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.00025}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1523442}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.1583067726558873, "avg_speed_min": 2.0617181020379225, "avg_speed_max": 4.319969477035279, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.73198089323854, "mean_processing_ms": 1.4866580794611561, "mean_inference_ms": 0.3620547473411252}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1194240, "num_steps_sampled": 4067696, "sample_time_ms": 64234.137, "load_time_ms": 2.323, "grad_time_ms": 3693.68, "update_time_ms": 5.895, "learner": {"av": {"cur_kl_coeff": 0.06501975655555725, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0025442384649068117, "policy_loss": 0.0005764969391748309, "vf_loss": 0.0017494454514235258, "vf_explained_var": 0.9258968234062195, "kl": 0.0033573880791664124, "entropy": 2.8706212043762207, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26809, "done": false, "timesteps_total": 4067696, "episodes_total": 3819, "training_iteration": 149, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-49-52", "timestamp": 1588826992, "time_this_iter_s": 70.07876229286194, "time_total_s": 10079.328962087631, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc724682268>", "on_episode_step": "<function on_episode_step at 0x7fc724682ea0>", "on_episode_end": "<function on_episode_end at 0x7fc7246c2d08>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246c2a60>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245f59d8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10079.328962087631, "timesteps_since_restore": 4067696, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 89.419801980198, "ram_util_percent": 32.6}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0001399999999996, "episode_reward_mean": 0.18483070000000004, "episode_len_mean": 1179.84, "episodes_this_iter": 19, "policy_reward_min": {"av": -3.0001399999999996}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.18483070000000004}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.225799664112945, "avg_speed_min": 2.1098254968435866, "avg_speed_max": 4.392913059141456, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.734323389636355, "mean_processing_ms": 1.48537412833292, "mean_inference_ms": 0.36210545272884526}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1202304, "num_steps_sampled": 4092296, "sample_time_ms": 64289.25, "load_time_ms": 2.298, "grad_time_ms": 3705.708, "update_time_ms": 5.858, "learner": {"av": {"cur_kl_coeff": 0.032509878277778625, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0004910812713205814, "policy_loss": -0.0020524244755506516, "vf_loss": 0.0022092964500188828, "vf_explained_var": 0.7395216226577759, "kl": 0.01028013788163662, "entropy": 3.3652474880218506, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 24600, "done": false, "timesteps_total": 4092296, "episodes_total": 3838, "training_iteration": 150, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-50-56", "timestamp": 1588827056, "time_this_iter_s": 63.74222755432129, "time_total_s": 10143.071189641953, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc725a0fd90>", "on_episode_step": "<function on_episode_step at 0x7fc7246c2c80>", "on_episode_end": "<function on_episode_end at 0x7fc7246c2bf8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246c2840>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245c5158>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10143.071189641953, "timesteps_since_restore": 4092296, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 90.61208791208792, "ram_util_percent": 32.6}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00004, "episode_reward_mean": 0.21731820000000002, "episode_len_mean": 1189.49, "episodes_this_iter": 25, "policy_reward_min": {"av": -3.00004}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.21731820000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.1605266794520976, "avg_speed_min": 2.1098254968435866, "avg_speed_max": 4.392913059141456, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.726455461205788, "mean_processing_ms": 1.4831718510208127, "mean_inference_ms": 0.36183350617867155}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1209856, "num_steps_sampled": 4120259, "sample_time_ms": 64502.937, "load_time_ms": 2.308, "grad_time_ms": 3711.094, "update_time_ms": 5.962, "learner": {"av": {"cur_kl_coeff": 0.032509878277778625, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0002481136762071401, "policy_loss": -0.0009728309232741594, "vf_loss": 0.0005885314894840121, "vf_explained_var": 0.8690769672393799, "kl": 0.004189153201878071, "entropy": 2.917874813079834, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27963, "done": false, "timesteps_total": 4120259, "episodes_total": 3863, "training_iteration": 151, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-52-03", "timestamp": 1588827123, "time_this_iter_s": 67.09166121482849, "time_total_s": 10210.162850856781, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc724682730>", "on_episode_step": "<function on_episode_step at 0x7fc7246822f0>", "on_episode_end": "<function on_episode_end at 0x7fc724682ea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245f59d8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245c58c8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10210.162850856781, "timesteps_since_restore": 4120259, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 90.72736842105263, "ram_util_percent": 32.602105263157895}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -1.0009700000000001, "episode_reward_mean": 0.23729829999999996, "episode_len_mean": 1193.13, "episodes_this_iter": 22, "policy_reward_min": {"av": -1.0009700000000001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.23729829999999996}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.0450879476891743, "avg_speed_min": 2.2692699328850026, "avg_speed_max": 4.392913059141456, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.738978343400063, "mean_processing_ms": 1.4832645321158693, "mean_inference_ms": 0.36220915771983414}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1219328, "num_steps_sampled": 4147419, "sample_time_ms": 64851.819, "load_time_ms": 2.323, "grad_time_ms": 3750.583, "update_time_ms": 5.97, "learner": {"av": {"cur_kl_coeff": 0.016254939138889313, "cur_lr": 9.999999747378752e-05, "total_loss": -0.007587146013975143, "policy_loss": -0.011434492655098438, "vf_loss": 0.0032934125047177076, "vf_explained_var": 0.761286735534668, "kl": 0.034077756106853485, "entropy": 3.469881296157837, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27160, "done": false, "timesteps_total": 4147419, "episodes_total": 3885, "training_iteration": 152, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-53-16", "timestamp": 1588827196, "time_this_iter_s": 73.32823872566223, "time_total_s": 10283.491089582443, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7245c5c80>", "on_episode_step": "<function on_episode_step at 0x7fc7245c5950>", "on_episode_end": "<function on_episode_end at 0x7fc7245c5400>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245c5a60>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72461e0d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10283.491089582443, "timesteps_since_restore": 4147419, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 91.29047619047617, "ram_util_percent": 32.60000000000001}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00024, "episode_reward_mean": 0.20481390000000002, "episode_len_mean": 1183.75, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.00024}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.20481390000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.0072028373942765, "avg_speed_min": 2.1878348806930616, "avg_speed_max": 4.392913059141456, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.75263319021891, "mean_processing_ms": 1.4828463680734862, "mean_inference_ms": 0.362442855848116}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1227008, "num_steps_sampled": 4173452, "sample_time_ms": 64838.072, "load_time_ms": 2.331, "grad_time_ms": 3767.573, "update_time_ms": 6.035, "learner": {"av": {"cur_kl_coeff": 0.02438240870833397, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0015463855816051364, "policy_loss": -0.002881839405745268, "vf_loss": 0.0007388788508251309, "vf_explained_var": 0.974402666091919, "kl": 0.02446747198700905, "entropy": 3.1445412635803223, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26033, "done": false, "timesteps_total": 4173452, "episodes_total": 3908, "training_iteration": 153, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-54-21", "timestamp": 1588827261, "time_this_iter_s": 64.72572875022888, "time_total_s": 10348.216818332672, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc724682730>", "on_episode_step": "<function on_episode_step at 0x7fc7245c5620>", "on_episode_end": "<function on_episode_end at 0x7fc7245c59d8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245c58c8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245f5048>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10348.216818332672, "timesteps_since_restore": 4173452, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 90.82826086956523, "ram_util_percent": 32.6}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00024, "episode_reward_mean": 0.2048058, "episode_len_mean": 1183.75, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.00024}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.2048058}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.0787964059965516, "avg_speed_min": 2.1878348806930616, "avg_speed_max": 4.2583757551877275, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.756738879461835, "mean_processing_ms": 1.4814430527398337, "mean_inference_ms": 0.3623873632476445}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1234432, "num_steps_sampled": 4201232, "sample_time_ms": 64350.373, "load_time_ms": 2.313, "grad_time_ms": 3749.978, "update_time_ms": 6.018, "learner": {"av": {"cur_kl_coeff": 0.036573611199855804, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0010262003634124994, "policy_loss": 0.00014768425899092108, "vf_loss": 0.0004968532593920827, "vf_explained_var": 0.8988624215126038, "kl": 0.010435497388243675, "entropy": 3.1596734523773193, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27780, "done": false, "timesteps_total": 4201232, "episodes_total": 3931, "training_iteration": 154, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-55-27", "timestamp": 1588827327, "time_this_iter_s": 65.93409609794617, "time_total_s": 10414.150914430618, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246822f0>", "on_episode_step": "<function on_episode_step at 0x7fc725972730>", "on_episode_end": "<function on_episode_end at 0x7fc725972510>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245c5a60>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7246c2d08>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10414.150914430618, "timesteps_since_restore": 4201232, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 89.02421052631578, "ram_util_percent": 32.6}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00024, "episode_reward_mean": 0.17230689999999999, "episode_len_mean": 1173.8, "episodes_this_iter": 21, "policy_reward_min": {"av": -3.00024}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.17230689999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.087575425627524, "avg_speed_min": 2.1878348806930616, "avg_speed_max": 4.398425334307203, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.762828873572015, "mean_processing_ms": 1.4814349434269576, "mean_inference_ms": 0.36261396919948913}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1242368, "num_steps_sampled": 4225857, "sample_time_ms": 63293.425, "load_time_ms": 2.264, "grad_time_ms": 3644.028, "update_time_ms": 5.952, "learner": {"av": {"cur_kl_coeff": 0.036573611199855804, "cur_lr": 9.999999747378752e-05, "total_loss": -0.01811734028160572, "policy_loss": -0.01973753236234188, "vf_loss": 0.0005714464350603521, "vf_explained_var": 0.9437752962112427, "kl": 0.028674935922026634, "entropy": 2.9391496181488037, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 24625, "done": false, "timesteps_total": 4225857, "episodes_total": 3952, "training_iteration": 155, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-56-31", "timestamp": 1588827391, "time_this_iter_s": 63.55846905708313, "time_total_s": 10477.709383487701, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72461e0d0>", "on_episode_step": "<function on_episode_step at 0x7fc7245c59d8>", "on_episode_end": "<function on_episode_end at 0x7fc7245c5620>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245f5048>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724574488>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10477.709383487701, "timesteps_since_restore": 4225857, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 91.61, "ram_util_percent": 32.60222222222223}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00024, "episode_reward_mean": 0.15230680000000002, "episode_len_mean": 1172.15, "episodes_this_iter": 25, "policy_reward_min": {"av": -3.00024}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.15230680000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.137767481130465, "avg_speed_min": 1.591824738008949, "avg_speed_max": 4.398425334307203, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.76326672219471, "mean_processing_ms": 1.479685319900612, "mean_inference_ms": 0.36259674757983007}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1249664, "num_steps_sampled": 4254249, "sample_time_ms": 63083.89, "load_time_ms": 2.273, "grad_time_ms": 3603.044, "update_time_ms": 6.044, "learner": {"av": {"cur_kl_coeff": 0.05486041679978371, "cur_lr": 9.999999747378752e-05, "total_loss": -0.011080892756581306, "policy_loss": -0.024070115759968758, "vf_loss": 0.010383199900388718, "vf_explained_var": 0.8159821629524231, "kl": 0.047502752393484116, "entropy": 3.2251501083374023, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28392, "done": false, "timesteps_total": 4254249, "episodes_total": 3977, "training_iteration": 156, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-57-37", "timestamp": 1588827457, "time_this_iter_s": 66.31644892692566, "time_total_s": 10544.025832414627, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc724682ea0>", "on_episode_step": "<function on_episode_step at 0x7fc725972510>", "on_episode_end": "<function on_episode_end at 0x7fc725972730>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246c2d08>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724574c80>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10544.025832414627, "timesteps_since_restore": 4254249, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 89.7442105263158, "ram_util_percent": 32.62526315789473}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00024, "episode_reward_mean": 0.05480410000000001, "episode_len_mean": 1141.0, "episodes_this_iter": 28, "policy_reward_min": {"av": -3.00024}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.05480410000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.234586639285018, "avg_speed_min": 1.591824738008949, "avg_speed_max": 4.398425334307203, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.755937433760757, "mean_processing_ms": 1.4795854954696122, "mean_inference_ms": 0.36235526506388566}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1256576, "num_steps_sampled": 4282364, "sample_time_ms": 62982.286, "load_time_ms": 2.263, "grad_time_ms": 3587.79, "update_time_ms": 6.0, "learner": {"av": {"cur_kl_coeff": 0.08229062706232071, "cur_lr": 9.999999747378752e-05, "total_loss": 0.02497309446334839, "policy_loss": -0.006677957717329264, "vf_loss": 0.03079257719218731, "vf_explained_var": 0.6252610087394714, "kl": 0.010432325303554535, "entropy": 4.134296417236328, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28115, "done": false, "timesteps_total": 4282364, "episodes_total": 4005, "training_iteration": 157, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-58-42", "timestamp": 1588827522, "time_this_iter_s": 64.54422545433044, "time_total_s": 10608.570057868958, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246c2ea0>", "on_episode_step": "<function on_episode_step at 0x7fc7246c2400>", "on_episode_end": "<function on_episode_end at 0x7fc7246c2a60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246c2d90>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724596ea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10608.570057868958, "timesteps_since_restore": 4282364, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 90.12499999999999, "ram_util_percent": 32.62934782608695}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00024, "episode_reward_mean": -0.33519419999999994, "episode_len_mean": 1019.25, "episodes_this_iter": 32, "policy_reward_min": {"av": -3.00024}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.33519419999999994}, "custom_metrics": {"num_ped_collisions_mean": 0.18, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.286946632877488, "avg_speed_min": 1.591824738008949, "avg_speed_max": 4.396335717459202, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.71287176297434, "mean_processing_ms": 1.4808947981788925, "mean_inference_ms": 0.361389221698585}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1262976, "num_steps_sampled": 4309692, "sample_time_ms": 62524.387, "load_time_ms": 2.255, "grad_time_ms": 3536.02, "update_time_ms": 5.94, "learner": {"av": {"cur_kl_coeff": 0.08229062706232071, "cur_lr": 9.999999747378752e-05, "total_loss": 0.032879218459129333, "policy_loss": -0.0029386759269982576, "vf_loss": 0.03523940220475197, "vf_explained_var": 0.9206033945083618, "kl": 0.0070299203507602215, "entropy": 3.809471368789673, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27328, "done": false, "timesteps_total": 4309692, "episodes_total": 4037, "training_iteration": 158, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_04-59-43", "timestamp": 1588827583, "time_this_iter_s": 61.486767292022705, "time_total_s": 10670.05682516098, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246c21e0>", "on_episode_step": "<function on_episode_step at 0x7fc7246c2f28>", "on_episode_end": "<function on_episode_end at 0x7fc7246c2d08>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245966a8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245c5950>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10670.05682516098, "timesteps_since_restore": 4309692, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 87.88295454545454, "ram_util_percent": 32.660227272727276}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00024, "episode_reward_mean": -0.5301953, "episode_len_mean": 958.77, "episodes_this_iter": 32, "policy_reward_min": {"av": -3.00024}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.5301953}, "custom_metrics": {"num_ped_collisions_mean": 0.24, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.381012020633486, "avg_speed_min": 1.591824738008949, "avg_speed_max": 4.362280307713994, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.68484615003079, "mean_processing_ms": 1.481212250776287, "mean_inference_ms": 0.36084615493692496}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1269120, "num_steps_sampled": 4339364, "sample_time_ms": 61913.461, "load_time_ms": 2.236, "grad_time_ms": 3422.812, "update_time_ms": 6.052, "learner": {"av": {"cur_kl_coeff": 0.08229062706232071, "cur_lr": 9.999999747378752e-05, "total_loss": 0.04878896474838257, "policy_loss": -0.003821205347776413, "vf_loss": 0.05162936449050903, "vf_explained_var": 0.8909395337104797, "kl": 0.011918865144252777, "entropy": 3.799375534057617, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 29672, "done": false, "timesteps_total": 4339364, "episodes_total": 4069, "training_iteration": 159, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-00-46", "timestamp": 1588827646, "time_this_iter_s": 62.837977170944214, "time_total_s": 10732.894802331924, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc725972510>", "on_episode_step": "<function on_episode_step at 0x7fc7246c2a60>", "on_episode_end": "<function on_episode_end at 0x7fc7246c2400>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246c2620>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245c51e0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10732.894802331924, "timesteps_since_restore": 4339364, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 90.68333333333334, "ram_util_percent": 32.68}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0004, "episode_reward_mean": -0.8351679, "episode_len_mean": 857.22, "episodes_this_iter": 33, "policy_reward_min": {"av": -3.0004}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.8351679}, "custom_metrics": {"num_ped_collisions_mean": 0.33, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.419178657064468, "avg_speed_min": 2.062613327970033, "avg_speed_max": 4.362280307713994, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.662340760367073, "mean_processing_ms": 1.484979626044946, "mean_inference_ms": 0.3602852202643726}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1275776, "num_steps_sampled": 4365856, "sample_time_ms": 61725.082, "load_time_ms": 2.222, "grad_time_ms": 3356.679, "update_time_ms": 6.041, "learner": {"av": {"cur_kl_coeff": 0.08229062706232071, "cur_lr": 9.999999747378752e-05, "total_loss": 0.040268443524837494, "policy_loss": -0.0060484036803245544, "vf_loss": 0.045679740607738495, "vf_explained_var": 0.9269081354141235, "kl": 0.007742195390164852, "entropy": 4.14406156539917, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26492, "done": false, "timesteps_total": 4365856, "episodes_total": 4102, "training_iteration": 160, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-01-48", "timestamp": 1588827708, "time_this_iter_s": 61.19620633125305, "time_total_s": 10794.091008663177, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246c2d90>", "on_episode_step": "<function on_episode_step at 0x7fc7246c2f28>", "on_episode_end": "<function on_episode_end at 0x7fc7246c21e0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245966a8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72461ed90>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10794.091008663177, "timesteps_since_restore": 4365856, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 88.95287356321838, "ram_util_percent": 32.69195402298849}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0005, "episode_reward_mean": -0.7701739999999999, "episode_len_mean": 880.74, "episodes_this_iter": 30, "policy_reward_min": {"av": -3.0005}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.7701739999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.31, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.3471214482816634, "avg_speed_min": 1.760567185574323, "avg_speed_max": 4.358950692949657, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.66677725040982, "mean_processing_ms": 1.485513397725087, "mean_inference_ms": 0.36054543952641166}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1283712, "num_steps_sampled": 4393719, "sample_time_ms": 61854.856, "load_time_ms": 2.218, "grad_time_ms": 3372.435, "update_time_ms": 5.918, "learner": {"av": {"cur_kl_coeff": 0.08229062706232071, "cur_lr": 9.999999747378752e-05, "total_loss": 0.030754612758755684, "policy_loss": -0.006643169093877077, "vf_loss": 0.03567639738321304, "vf_explained_var": 0.9104844331741333, "kl": 0.02091832458972931, "entropy": 3.303131580352783, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27863, "done": false, "timesteps_total": 4393719, "episodes_total": 4132, "training_iteration": 161, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-02-56", "timestamp": 1588827776, "time_this_iter_s": 68.54611420631409, "time_total_s": 10862.637122869492, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246c2d08>", "on_episode_step": "<function on_episode_step at 0x7fc7246c2400>", "on_episode_end": "<function on_episode_end at 0x7fc7246c2a60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245c51e0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724574c80>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10862.637122869492, "timesteps_since_restore": 4393719, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 89.36326530612246, "ram_util_percent": 32.70102040816325}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0005, "episode_reward_mean": -0.6401705999999998, "episode_len_mean": 922.42, "episodes_this_iter": 25, "policy_reward_min": {"av": -3.0005}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.6401705999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.27, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.320949938682428, "avg_speed_min": 1.760567185574323, "avg_speed_max": 4.358950692949657, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.678005573815426, "mean_processing_ms": 1.4844882224012113, "mean_inference_ms": 0.3609286425121933}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1291264, "num_steps_sampled": 4421413, "sample_time_ms": 61232.77, "load_time_ms": 2.195, "grad_time_ms": 3285.632, "update_time_ms": 5.975, "learner": {"av": {"cur_kl_coeff": 0.12343594431877136, "cur_lr": 9.999999747378752e-05, "total_loss": 0.06763338297605515, "policy_loss": -0.01281871646642685, "vf_loss": 0.07836075127124786, "vf_explained_var": 0.6909416317939758, "kl": 0.016942808404564857, "entropy": 3.5226049423217773, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27694, "done": false, "timesteps_total": 4421413, "episodes_total": 4157, "training_iteration": 162, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-04-03", "timestamp": 1588827843, "time_this_iter_s": 66.24013113975525, "time_total_s": 10928.877254009247, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72461e1e0>", "on_episode_step": "<function on_episode_step at 0x7fc72461e378>", "on_episode_end": "<function on_episode_end at 0x7fc7246ec8c8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246ece18>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245c56a8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10928.877254009247, "timesteps_since_restore": 4421413, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 90.17368421052632, "ram_util_percent": 32.69894736842103}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0005, "episode_reward_mean": -0.7251540999999999, "episode_len_mean": 902.27, "episodes_this_iter": 34, "policy_reward_min": {"av": -3.0005}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.7251540999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.3, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.2739047382930524, "avg_speed_min": 1.5631724849598077, "avg_speed_max": 4.358950692949657, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.66011705425925, "mean_processing_ms": 1.486557539295072, "mean_inference_ms": 0.36053887745033747}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1297664, "num_steps_sampled": 4448228, "sample_time_ms": 60791.6, "load_time_ms": 2.169, "grad_time_ms": 3228.802, "update_time_ms": 5.975, "learner": {"av": {"cur_kl_coeff": 0.12343594431877136, "cur_lr": 9.999999747378752e-05, "total_loss": 0.011537696234881878, "policy_loss": -0.013803733512759209, "vf_loss": 0.02335856482386589, "vf_explained_var": 0.9410697221755981, "kl": 0.016063936054706573, "entropy": 3.543867588043213, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26815, "done": false, "timesteps_total": 4448228, "episodes_total": 4191, "training_iteration": 163, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-05-03", "timestamp": 1588827903, "time_this_iter_s": 59.745598554611206, "time_total_s": 10988.622852563858, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72461e0d0>", "on_episode_step": "<function on_episode_step at 0x7fc7245c57b8>", "on_episode_end": "<function on_episode_end at 0x7fc7245c5c80>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245c51e0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7246c2620>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10988.622852563858, "timesteps_since_restore": 4448228, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 90.03647058823529, "ram_util_percent": 32.69999999999998}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0005, "episode_reward_mean": -0.660157, "episode_len_mean": 921.6, "episodes_this_iter": 30, "policy_reward_min": {"av": -3.0005}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.660157}, "custom_metrics": {"num_ped_collisions_mean": 0.28, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.2957647465508177, "avg_speed_min": 1.5631724849598077, "avg_speed_max": 4.301696945077521, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.665593321179152, "mean_processing_ms": 1.4860360038975702, "mean_inference_ms": 0.36088572184691836}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1304576, "num_steps_sampled": 4475567, "sample_time_ms": 60572.393, "load_time_ms": 2.246, "grad_time_ms": 3204.95, "update_time_ms": 6.053, "learner": {"av": {"cur_kl_coeff": 0.12343594431877136, "cur_lr": 9.999999747378752e-05, "total_loss": 0.02173774130642414, "policy_loss": -0.0015252039302140474, "vf_loss": 0.022138550877571106, "vf_explained_var": 0.9409756064414978, "kl": 0.009109114296734333, "entropy": 4.174162864685059, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27339, "done": false, "timesteps_total": 4475567, "episodes_total": 4221, "training_iteration": 164, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-06-06", "timestamp": 1588827966, "time_this_iter_s": 63.505748987197876, "time_total_s": 11052.128601551056, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72461ed90>", "on_episode_step": "<function on_episode_step at 0x7fc7246ec8c8>", "on_episode_end": "<function on_episode_end at 0x7fc7246ece18>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245c5730>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245966a8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11052.128601551056, "timesteps_since_restore": 4475567, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 88.29340659340659, "ram_util_percent": 32.69999999999999}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0003299999999995, "episode_reward_mean": -0.8551563, "episode_len_mean": 858.6, "episodes_this_iter": 35, "policy_reward_min": {"av": -3.0003299999999995}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.8551563}, "custom_metrics": {"num_ped_collisions_mean": 0.34, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.3726987500256587, "avg_speed_min": 1.5631724849598077, "avg_speed_max": 4.301696945077521, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.648072808546512, "mean_processing_ms": 1.489964336085984, "mean_inference_ms": 0.36058046962186047}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1310592, "num_steps_sampled": 4503829, "sample_time_ms": 60344.127, "load_time_ms": 2.211, "grad_time_ms": 3119.824, "update_time_ms": 6.134, "learner": {"av": {"cur_kl_coeff": 0.12343594431877136, "cur_lr": 9.999999747378752e-05, "total_loss": 0.047624919563531876, "policy_loss": -0.0012090104864910245, "vf_loss": 0.047854576259851456, "vf_explained_var": 0.9245808124542236, "kl": 0.007934064604341984, "entropy": 3.621044635772705, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28262, "done": false, "timesteps_total": 4503829, "episodes_total": 4256, "training_iteration": 165, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-07-07", "timestamp": 1588828027, "time_this_iter_s": 60.424869775772095, "time_total_s": 11112.553471326828, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72461e378>", "on_episode_step": "<function on_episode_step at 0x7fc7246c2400>", "on_episode_end": "<function on_episode_end at 0x7fc7246c2a60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246c2d08>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245968c8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11112.553471326828, "timesteps_since_restore": 4503829, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 89.60000000000001, "ram_util_percent": 32.69651162790696}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0003299999999995, "episode_reward_mean": -0.8226567, "episode_len_mean": 867.38, "episodes_this_iter": 30, "policy_reward_min": {"av": -3.0003299999999995}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.8226567}, "custom_metrics": {"num_ped_collisions_mean": 0.33, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.4522064312343956, "avg_speed_min": 1.7389386777255624, "avg_speed_max": 4.301696945077521, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.657255586668445, "mean_processing_ms": 1.4901286716817665, "mean_inference_ms": 0.36089277558471444}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1317888, "num_steps_sampled": 4532028, "sample_time_ms": 60295.225, "load_time_ms": 2.204, "grad_time_ms": 3120.121, "update_time_ms": 6.111, "learner": {"av": {"cur_kl_coeff": 0.12343594431877136, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0379190593957901, "policy_loss": -0.0029329867102205753, "vf_loss": 0.03998934105038643, "vf_explained_var": 0.8837926983833313, "kl": 0.006989074405282736, "entropy": 3.902560234069824, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28199, "done": false, "timesteps_total": 4532028, "episodes_total": 4286, "training_iteration": 166, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-08-13", "timestamp": 1588828093, "time_this_iter_s": 65.83000016212463, "time_total_s": 11178.383471488953, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246c2620>", "on_episode_step": "<function on_episode_step at 0x7fc72461e1e0>", "on_episode_end": "<function on_episode_end at 0x7fc72461ed90>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245c5730>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245741e0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11178.383471488953, "timesteps_since_restore": 4532028, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 89.02234042553192, "ram_util_percent": 32.701063829787216}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00038, "episode_reward_mean": -0.8551546999999999, "episode_len_mean": 857.66, "episodes_this_iter": 34, "policy_reward_min": {"av": -3.00038}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.8551546999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.34, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.4694325464808884, "avg_speed_min": 1.7389386777255624, "avg_speed_max": 4.261003594288581, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.585517941050412, "mean_processing_ms": 1.4924113332472546, "mean_inference_ms": 0.3593651854980349}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1324160, "num_steps_sampled": 4560744, "sample_time_ms": 60099.15, "load_time_ms": 2.212, "grad_time_ms": 3088.872, "update_time_ms": 6.088, "learner": {"av": {"cur_kl_coeff": 0.12343594431877136, "cur_lr": 9.999999747378752e-05, "total_loss": 0.02706265263259411, "policy_loss": -0.0007316048140637577, "vf_loss": 0.026877611875534058, "vf_explained_var": 0.9480728507041931, "kl": 0.007426106836646795, "entropy": 4.032701015472412, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28716, "done": false, "timesteps_total": 4560744, "episodes_total": 4320, "training_iteration": 167, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-09-15", "timestamp": 1588828155, "time_this_iter_s": 62.27122402191162, "time_total_s": 11240.654695510864, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246ece18>", "on_episode_step": "<function on_episode_step at 0x7fc7245f5d90>", "on_episode_end": "<function on_episode_end at 0x7fc7246c2d08>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246c2a60>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245966a8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11240.654695510864, "timesteps_since_restore": 4560744, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 88.3932584269663, "ram_util_percent": 32.69999999999999}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00038, "episode_reward_mean": -0.8226592, "episode_len_mean": 867.81, "episodes_this_iter": 32, "policy_reward_min": {"av": -3.00038}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.8226592}, "custom_metrics": {"num_ped_collisions_mean": 0.33, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.422444250242112, "avg_speed_min": 1.8814595645604908, "avg_speed_max": 4.3621126787713145, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.51565293286008, "mean_processing_ms": 1.4930549621348177, "mean_inference_ms": 0.3578183913113262}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1331200, "num_steps_sampled": 4588999, "sample_time_ms": 60413.126, "load_time_ms": 2.221, "grad_time_ms": 3116.406, "update_time_ms": 6.013, "learner": {"av": {"cur_kl_coeff": 0.12343594431877136, "cur_lr": 9.999999747378752e-05, "total_loss": 0.020770974457263947, "policy_loss": -0.0006580320186913013, "vf_loss": 0.02102002501487732, "vf_explained_var": 0.9398778676986694, "kl": 0.003313313238322735, "entropy": 4.1192626953125, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28255, "done": false, "timesteps_total": 4588999, "episodes_total": 4352, "training_iteration": 168, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-10-20", "timestamp": 1588828220, "time_this_iter_s": 64.9008309841156, "time_total_s": 11305.55552649498, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246ec8c8>", "on_episode_step": "<function on_episode_step at 0x7fc724596e18>", "on_episode_end": "<function on_episode_end at 0x7fc724596950>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246c2620>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245c50d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11305.55552649498, "timesteps_since_restore": 4588999, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 88.66774193548386, "ram_util_percent": 32.69999999999998}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00038, "episode_reward_mean": -0.8226794, "episode_len_mean": 869.34, "episodes_this_iter": 30, "policy_reward_min": {"av": -3.00038}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.8226794}, "custom_metrics": {"num_ped_collisions_mean": 0.33, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.3518621209882618, "avg_speed_min": 1.8035013894146281, "avg_speed_max": 4.3621126787713145, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.489954774448023, "mean_processing_ms": 1.494000429882081, "mean_inference_ms": 0.35721303258251497}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1338368, "num_steps_sampled": 4615905, "sample_time_ms": 60512.829, "load_time_ms": 2.224, "grad_time_ms": 3163.597, "update_time_ms": 5.907, "learner": {"av": {"cur_kl_coeff": 0.06171797215938568, "cur_lr": 9.999999747378752e-05, "total_loss": 0.03786758333444595, "policy_loss": -0.005678433459252119, "vf_loss": 0.04268207028508186, "vf_explained_var": 0.9198842644691467, "kl": 0.013998284935951233, "entropy": 3.656484365463257, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26906, "done": false, "timesteps_total": 4615905, "episodes_total": 4382, "training_iteration": 169, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-11-24", "timestamp": 1588828284, "time_this_iter_s": 64.3063735961914, "time_total_s": 11369.861900091171, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7245f50d0>", "on_episode_step": "<function on_episode_step at 0x7fc7245f5d90>", "on_episode_end": "<function on_episode_end at 0x7fc724596d90>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245966a8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724574840>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11369.861900091171, "timesteps_since_restore": 4615905, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 90.44891304347827, "ram_util_percent": 32.69999999999999}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00026, "episode_reward_mean": -0.7901562, "episode_len_mean": 879.52, "episodes_this_iter": 34, "policy_reward_min": {"av": -3.00026}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.7901562}, "custom_metrics": {"num_ped_collisions_mean": 0.32, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.240975855958396, "avg_speed_min": 1.8035013894146281, "avg_speed_max": 4.365027891682567, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.52000753033596, "mean_processing_ms": 1.495164598533149, "mean_inference_ms": 0.3579062552062417}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1345536, "num_steps_sampled": 4643087, "sample_time_ms": 60749.986, "load_time_ms": 2.234, "grad_time_ms": 3187.641, "update_time_ms": 5.985, "learner": {"av": {"cur_kl_coeff": 0.06171797215938568, "cur_lr": 9.999999747378752e-05, "total_loss": 0.06317384541034698, "policy_loss": -0.0015702731907367706, "vf_loss": 0.06416873633861542, "vf_explained_var": 0.8684859275817871, "kl": 0.009322904981672764, "entropy": 3.0496623516082764, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27182, "done": false, "timesteps_total": 4643087, "episodes_total": 4416, "training_iteration": 170, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-12-28", "timestamp": 1588828348, "time_this_iter_s": 63.81033802032471, "time_total_s": 11433.672238111496, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246c2d08>", "on_episode_step": "<function on_episode_step at 0x7fc724596950>", "on_episode_end": "<function on_episode_end at 0x7fc724596e18>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72465fea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724574a60>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11433.672238111496, "timesteps_since_restore": 4643087, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 90.84835164835165, "ram_util_percent": 32.69999999999999}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00026, "episode_reward_mean": -0.9526382000000001, "episode_len_mean": 826.96, "episodes_this_iter": 35, "policy_reward_min": {"av": -3.00026}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.9526382000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.37, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.2852062840512404, "avg_speed_min": 1.8035013894146281, "avg_speed_max": 4.365027891682567, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.543228626483806, "mean_processing_ms": 1.4981158329055972, "mean_inference_ms": 0.3584553352520507}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1353472, "num_steps_sampled": 4671176, "sample_time_ms": 60747.66, "load_time_ms": 2.236, "grad_time_ms": 3188.439, "update_time_ms": 6.01, "learner": {"av": {"cur_kl_coeff": 0.06171797215938568, "cur_lr": 9.999999747378752e-05, "total_loss": 0.02310146391391754, "policy_loss": -0.0012302949326112866, "vf_loss": 0.02391437254846096, "vf_explained_var": 0.9304454326629639, "kl": 0.006762702018022537, "entropy": 3.318138360977173, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28089, "done": false, "timesteps_total": 4671176, "episodes_total": 4451, "training_iteration": 171, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-13-37", "timestamp": 1588828417, "time_this_iter_s": 68.53118968009949, "time_total_s": 11502.203427791595, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246c2a60>", "on_episode_step": "<function on_episode_step at 0x7fc7245f50d0>", "on_episode_end": "<function on_episode_end at 0x7fc724596d90>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245966a8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72456c378>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11502.203427791595, "timesteps_since_restore": 4671176, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 89.12142857142857, "ram_util_percent": 32.70204081632652}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00027, "episode_reward_mean": -0.9851194, "episode_len_mean": 816.36, "episodes_this_iter": 34, "policy_reward_min": {"av": -3.00027}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.9851194}, "custom_metrics": {"num_ped_collisions_mean": 0.38, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.3491088873117043, "avg_speed_min": 1.6008757102810411, "avg_speed_max": 4.20349175648695, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.538020744797564, "mean_processing_ms": 1.5019394833217492, "mean_inference_ms": 0.35858372088691076}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1359616, "num_steps_sampled": 4699074, "sample_time_ms": 60240.913, "load_time_ms": 2.222, "grad_time_ms": 3123.7, "update_time_ms": 6.035, "learner": {"av": {"cur_kl_coeff": 0.06171797215938568, "cur_lr": 9.999999747378752e-05, "total_loss": 0.033371683210134506, "policy_loss": -0.0007382500916719437, "vf_loss": 0.03333873674273491, "vf_explained_var": 0.9493902325630188, "kl": 0.012495403178036213, "entropy": 3.8998138904571533, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27898, "done": false, "timesteps_total": 4699074, "episodes_total": 4485, "training_iteration": 172, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-14-38", "timestamp": 1588828478, "time_this_iter_s": 60.52527141571045, "time_total_s": 11562.728699207306, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7245f5d90>", "on_episode_step": "<function on_episode_step at 0x7fc724574bf8>", "on_episode_end": "<function on_episode_end at 0x7fc7245741e0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc724574c80>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245c5048>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11562.728699207306, "timesteps_since_restore": 4699074, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 89.05930232558141, "ram_util_percent": 32.69999999999998}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00027, "episode_reward_mean": -0.8226517, "episode_len_mean": 865.7, "episodes_this_iter": 27, "policy_reward_min": {"av": -3.00027}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.8226517}, "custom_metrics": {"num_ped_collisions_mean": 0.33, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.4702777065786945, "avg_speed_min": 1.6008757102810411, "avg_speed_max": 4.20349175648695, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.54803222554848, "mean_processing_ms": 1.503160317067788, "mean_inference_ms": 0.3587800680105763}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1365888, "num_steps_sampled": 4727012, "sample_time_ms": 60369.306, "load_time_ms": 2.217, "grad_time_ms": 3117.207, "update_time_ms": 5.978, "learner": {"av": {"cur_kl_coeff": 0.06171797215938568, "cur_lr": 9.999999747378752e-05, "total_loss": 0.00028915240545757115, "policy_loss": -0.007622959092259407, "vf_loss": 0.004679470788687468, "vf_explained_var": 0.9721499085426331, "kl": 0.05237770080566406, "entropy": 4.230438709259033, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27938, "done": false, "timesteps_total": 4727012, "episodes_total": 4512, "training_iteration": 173, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-15-39", "timestamp": 1588828539, "time_this_iter_s": 60.96410036087036, "time_total_s": 11623.692799568176, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72465fea0>", "on_episode_step": "<function on_episode_step at 0x7fc7245c5730>", "on_episode_end": "<function on_episode_end at 0x7fc7245c5620>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245c58c8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245966a8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11623.692799568176, "timesteps_since_restore": 4727012, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 89.19310344827586, "ram_util_percent": 32.69999999999998}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00027, "episode_reward_mean": -0.5626821999999999, "episode_len_mean": 946.81, "episodes_this_iter": 31, "policy_reward_min": {"av": -3.00027}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.5626821999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.25, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.5530448647849706, "avg_speed_min": 1.6008757102810411, "avg_speed_max": 4.20349175648695, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.49490577472095, "mean_processing_ms": 1.5027696497645104, "mean_inference_ms": 0.35764363292870605}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1371776, "num_steps_sampled": 4757716, "sample_time_ms": 60375.585, "load_time_ms": 2.027, "grad_time_ms": 3070.173, "update_time_ms": 5.903, "learner": {"av": {"cur_kl_coeff": 0.09257695823907852, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0047026160173118114, "policy_loss": -0.004523697309195995, "vf_loss": 0.008729905821383, "vf_explained_var": 0.8114646673202515, "kl": 0.005362090654671192, "entropy": 3.82051944732666, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 30704, "done": false, "timesteps_total": 4757716, "episodes_total": 4543, "training_iteration": 174, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-16-42", "timestamp": 1588828602, "time_this_iter_s": 63.094706773757935, "time_total_s": 11686.787506341934, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc724574a60>", "on_episode_step": "<function on_episode_step at 0x7fc7245741e0>", "on_episode_end": "<function on_episode_end at 0x7fc724574bf8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245c5048>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7246c2f28>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11686.787506341934, "timesteps_since_restore": 4757716, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 89.24666666666667, "ram_util_percent": 32.69999999999999}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00021, "episode_reward_mean": -0.2701683, "episode_len_mean": 1036.67, "episodes_this_iter": 24, "policy_reward_min": {"av": -3.00021}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.2701683}, "custom_metrics": {"num_ped_collisions_mean": 0.16, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.453871875545697, "avg_speed_min": 1.9165137766287712, "avg_speed_max": 4.194514257152212, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.479252050479644, "mean_processing_ms": 1.5008014540360113, "mean_inference_ms": 0.3574194113809923}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1380864, "num_steps_sampled": 4787462, "sample_time_ms": 61750.855, "load_time_ms": 2.104, "grad_time_ms": 3207.995, "update_time_ms": 5.882, "learner": {"av": {"cur_kl_coeff": 0.09257695823907852, "cur_lr": 9.999999747378752e-05, "total_loss": 0.002407768974080682, "policy_loss": -0.0002451334148645401, "vf_loss": 0.0012738901423290372, "vf_explained_var": 0.7933357357978821, "kl": 0.014895845204591751, "entropy": 2.95869779586792, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 29746, "done": false, "timesteps_total": 4787462, "episodes_total": 4567, "training_iteration": 175, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-17-57", "timestamp": 1588828677, "time_this_iter_s": 75.55650162696838, "time_total_s": 11762.344007968903, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc724574c80>", "on_episode_step": "<function on_episode_step at 0x7fc7245c5620>", "on_episode_end": "<function on_episode_end at 0x7fc7245c5730>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245966a8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72456c950>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11762.344007968903, "timesteps_since_restore": 4787462, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 89.96574074074076, "ram_util_percent": 32.69999999999999}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00021, "episode_reward_mean": -0.2701711, "episode_len_mean": 1035.42, "episodes_this_iter": 24, "policy_reward_min": {"av": -3.00021}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.2701711}, "custom_metrics": {"num_ped_collisions_mean": 0.16, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.4451038621245833, "avg_speed_min": 1.6601466041826807, "avg_speed_max": 4.88484260829202, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.433572657006213, "mean_processing_ms": 1.4998902723504732, "mean_inference_ms": 0.35646004949334914}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1388416, "num_steps_sampled": 4812345, "sample_time_ms": 61346.324, "load_time_ms": 2.113, "grad_time_ms": 3220.555, "update_time_ms": 5.812, "learner": {"av": {"cur_kl_coeff": 0.09257695823907852, "cur_lr": 9.999999747378752e-05, "total_loss": 0.007030136417597532, "policy_loss": -0.008192958310246468, "vf_loss": 0.014414972625672817, "vf_explained_var": 0.8038288950920105, "kl": 0.008729171939194202, "entropy": 3.560605049133301, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 24883, "done": false, "timesteps_total": 4812345, "episodes_total": 4591, "training_iteration": 176, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-18-59", "timestamp": 1588828739, "time_this_iter_s": 61.910287618637085, "time_total_s": 11824.25429558754, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7245c58c8>", "on_episode_step": "<function on_episode_step at 0x7fc724574bf8>", "on_episode_end": "<function on_episode_end at 0x7fc7245741e0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246c2f28>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72456cb70>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11824.25429558754, "timesteps_since_restore": 4812345, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 90.11123595505619, "ram_util_percent": 32.70449438202247}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0001299999999995, "episode_reward_mean": -0.10765799999999998, "episode_len_mean": 1086.18, "episodes_this_iter": 26, "policy_reward_min": {"av": -3.0001299999999995}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.10765799999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.328044489722488, "avg_speed_min": 1.6601466041826807, "avg_speed_max": 4.88484260829202, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.4139335391961, "mean_processing_ms": 1.4988676292903356, "mean_inference_ms": 0.35607121903416256}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1394688, "num_steps_sampled": 4840456, "sample_time_ms": 61174.98, "load_time_ms": 2.108, "grad_time_ms": 3219.582, "update_time_ms": 5.862, "learner": {"av": {"cur_kl_coeff": 0.09257695823907852, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0014432630268856883, "policy_loss": -0.0030116867274045944, "vf_loss": 0.003961016424000263, "vf_explained_var": 0.6060466170310974, "kl": 0.005335353314876556, "entropy": 3.2005200386047363, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28111, "done": false, "timesteps_total": 4840456, "episodes_total": 4617, "training_iteration": 177, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-20-00", "timestamp": 1588828800, "time_this_iter_s": 60.54812288284302, "time_total_s": 11884.802418470383, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72461ed90>", "on_episode_step": "<function on_episode_step at 0x7fc7246c2ea0>", "on_episode_end": "<function on_episode_end at 0x7fc725972510>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725972730>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245740d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11884.802418470383, "timesteps_since_restore": 4840456, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 90.90930232558141, "ram_util_percent": 32.754651162790694}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00037, "episode_reward_mean": -0.335149, "episode_len_mean": 1016.97, "episodes_this_iter": 31, "policy_reward_min": {"av": -3.00037}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.335149}, "custom_metrics": {"num_ped_collisions_mean": 0.18, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.1259086960522904, "avg_speed_min": 1.5986548999878452, "avg_speed_max": 4.88484260829202, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.409181029134288, "mean_processing_ms": 1.4988201676438064, "mean_inference_ms": 0.3558938894918815}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1403520, "num_steps_sampled": 4866735, "sample_time_ms": 61551.177, "load_time_ms": 2.138, "grad_time_ms": 3301.596, "update_time_ms": 5.867, "learner": {"av": {"cur_kl_coeff": 0.09257695823907852, "cur_lr": 9.999999747378752e-05, "total_loss": 0.014956468716263771, "policy_loss": -0.01051386073231697, "vf_loss": 0.024578703567385674, "vf_explained_var": 0.9463406801223755, "kl": 0.009631174616515636, "entropy": 3.411149740219116, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26279, "done": false, "timesteps_total": 4866735, "episodes_total": 4648, "training_iteration": 178, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-21-10", "timestamp": 1588828870, "time_this_iter_s": 69.48342704772949, "time_total_s": 11954.285845518112, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72461e0d0>", "on_episode_step": "<function on_episode_step at 0x7fc724596510>", "on_episode_end": "<function on_episode_end at 0x7fc724596f28>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc724682ea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724574950>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 11954.285845518112, "timesteps_since_restore": 4866735, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 89.98989898989899, "ram_util_percent": 32.75151515151514}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00037, "episode_reward_mean": -0.5301606, "episode_len_mean": 955.55, "episodes_this_iter": 28, "policy_reward_min": {"av": -3.00037}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.5301606}, "custom_metrics": {"num_ped_collisions_mean": 0.24, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.0500797043901993, "avg_speed_min": 1.587136576263667, "avg_speed_max": 4.212945267869632, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.42018305117954, "mean_processing_ms": 1.4990955421622005, "mean_inference_ms": 0.35615479320676036}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1411712, "num_steps_sampled": 4892102, "sample_time_ms": 61738.001, "load_time_ms": 2.179, "grad_time_ms": 3347.592, "update_time_ms": 5.923, "learner": {"av": {"cur_kl_coeff": 0.09257695823907852, "cur_lr": 9.999999747378752e-05, "total_loss": 0.014561858959496021, "policy_loss": -0.0003049850929528475, "vf_loss": 0.014260438270866871, "vf_explained_var": 0.9284367561340332, "kl": 0.006550298072397709, "entropy": 3.4084208011627197, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25367, "done": false, "timesteps_total": 4892102, "episodes_total": 4676, "training_iteration": 179, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-22-16", "timestamp": 1588828936, "time_this_iter_s": 66.63605189323425, "time_total_s": 12020.921897411346, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7245968c8>", "on_episode_step": "<function on_episode_step at 0x7fc72461ed90>", "on_episode_end": "<function on_episode_end at 0x7fc725972510>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725972730>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245c5268>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12020.921897411346, "timesteps_since_restore": 4892102, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 89.83473684210526, "ram_util_percent": 32.77578947368422}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00037, "episode_reward_mean": -0.5626593999999998, "episode_len_mean": 945.49, "episodes_this_iter": 28, "policy_reward_min": {"av": -3.00037}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.5626593999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.25, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.981011191368319, "avg_speed_min": 1.587136576263667, "avg_speed_max": 4.212945267869632, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.444505000209688, "mean_processing_ms": 1.4997139109674833, "mean_inference_ms": 0.35661815391817325}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1418752, "num_steps_sampled": 4919712, "sample_time_ms": 61779.666, "load_time_ms": 2.172, "grad_time_ms": 3341.428, "update_time_ms": 5.851, "learner": {"av": {"cur_kl_coeff": 0.09257695823907852, "cur_lr": 9.999999747378752e-05, "total_loss": 0.01713106781244278, "policy_loss": -0.0024337642826139927, "vf_loss": 0.018546927720308304, "vf_explained_var": 0.837398886680603, "kl": 0.010995243676006794, "entropy": 3.696232557296753, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27610, "done": false, "timesteps_total": 4919712, "episodes_total": 4704, "training_iteration": 180, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-23-21", "timestamp": 1588829001, "time_this_iter_s": 64.16348576545715, "time_total_s": 12085.085383176804, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72461e1e0>", "on_episode_step": "<function on_episode_step at 0x7fc724574950>", "on_episode_end": "<function on_episode_end at 0x7fc724574840>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc724574bf8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245c5a60>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12085.085383176804, "timesteps_since_restore": 4919712, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 89.2445652173913, "ram_util_percent": 32.78043478260871}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00037, "episode_reward_mean": -0.5301775, "episode_len_mean": 955.75, "episodes_this_iter": 26, "policy_reward_min": {"av": -3.00037}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.5301775}, "custom_metrics": {"num_ped_collisions_mean": 0.24, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.0635449076295442, "avg_speed_min": 1.587136576263667, "avg_speed_max": 4.408808619999241, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.428688038210204, "mean_processing_ms": 1.503131189946683, "mean_inference_ms": 0.35616446072660496}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1425792, "num_steps_sampled": 4948275, "sample_time_ms": 61548.62, "load_time_ms": 2.176, "grad_time_ms": 3300.721, "update_time_ms": 5.888, "learner": {"av": {"cur_kl_coeff": 0.09257695823907852, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0024707030970603228, "policy_loss": -0.008889212273061275, "vf_loss": 0.004666192922741175, "vf_explained_var": 0.8929028511047363, "kl": 0.01892820931971073, "entropy": 3.7348785400390625, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28563, "done": false, "timesteps_total": 4948275, "episodes_total": 4730, "training_iteration": 181, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-24-27", "timestamp": 1588829067, "time_this_iter_s": 65.81409430503845, "time_total_s": 12150.899477481842, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc724596f28>", "on_episode_step": "<function on_episode_step at 0x7fc7245968c8>", "on_episode_end": "<function on_episode_end at 0x7fc725972510>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725972730>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72456cd90>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12150.899477481842, "timesteps_since_restore": 4948275, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 90.61170212765957, "ram_util_percent": 32.792553191489375}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00021, "episode_reward_mean": -0.33516619999999997, "episode_len_mean": 1015.64, "episodes_this_iter": 32, "policy_reward_min": {"av": -3.00021}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.33516619999999997}, "custom_metrics": {"num_ped_collisions_mean": 0.18, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.054570550643328, "avg_speed_min": 1.6186597869871384, "avg_speed_max": 4.408808619999241, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.42913931231742, "mean_processing_ms": 1.5037970935061094, "mean_inference_ms": 0.3562865438797641}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1433728, "num_steps_sampled": 4977091, "sample_time_ms": 62353.862, "load_time_ms": 2.17, "grad_time_ms": 3382.713, "update_time_ms": 5.882, "learner": {"av": {"cur_kl_coeff": 0.09257695823907852, "cur_lr": 9.999999747378752e-05, "total_loss": 0.013250952586531639, "policy_loss": 0.002131543355062604, "vf_loss": 0.010542110539972782, "vf_explained_var": 0.9427861571311951, "kl": 0.006235871464014053, "entropy": 3.1433908939361572, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28816, "done": false, "timesteps_total": 4977091, "episodes_total": 4762, "training_iteration": 182, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-25-36", "timestamp": 1588829136, "time_this_iter_s": 69.39737510681152, "time_total_s": 12220.296852588654, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72461ed90>", "on_episode_step": "<function on_episode_step at 0x7fc7245c5a60>", "on_episode_end": "<function on_episode_end at 0x7fc7245c50d0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245c59d8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245c5620>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12220.296852588654, "timesteps_since_restore": 4977091, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 89.72525252525251, "ram_util_percent": 32.794949494949506}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00021, "episode_reward_mean": -0.2376654, "episode_len_mean": 1046.87, "episodes_this_iter": 22, "policy_reward_min": {"av": -3.00021}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.2376654}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.0675435304290817, "avg_speed_min": 1.6186597869871384, "avg_speed_max": 4.408808619999241, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.41124881096649, "mean_processing_ms": 1.5047557659481567, "mean_inference_ms": 0.3558645890044118}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1443072, "num_steps_sampled": 5004048, "sample_time_ms": 63385.104, "load_time_ms": 2.214, "grad_time_ms": 3522.677, "update_time_ms": 5.919, "learner": {"av": {"cur_kl_coeff": 0.09257695823907852, "cur_lr": 9.999999747378752e-05, "total_loss": 0.00637283967807889, "policy_loss": -0.0034203720279037952, "vf_loss": 0.009041178971529007, "vf_explained_var": 0.7509704232215881, "kl": 0.008123327046632767, "entropy": 3.2043957710266113, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26957, "done": false, "timesteps_total": 5004048, "episodes_total": 4784, "training_iteration": 183, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-26-49", "timestamp": 1588829209, "time_this_iter_s": 72.67645478248596, "time_total_s": 12292.97330737114, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72461e0d0>", "on_episode_step": "<function on_episode_step at 0x7fc7245c51e0>", "on_episode_end": "<function on_episode_end at 0x7fc725972510>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725972730>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724574840>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12292.97330737114, "timesteps_since_restore": 5004048, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 90.0701923076923, "ram_util_percent": 32.800000000000004}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00021, "episode_reward_mean": -0.17265060000000002, "episode_len_mean": 1067.59, "episodes_this_iter": 25, "policy_reward_min": {"av": -3.00021}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.17265060000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.13, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.9747648817839165, "avg_speed_min": 1.5308541918311043, "avg_speed_max": 4.408808619999241, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.41703401211651, "mean_processing_ms": 1.5059110675018466, "mean_inference_ms": 0.3559573703445581}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1451776, "num_steps_sampled": 5032927, "sample_time_ms": 64169.907, "load_time_ms": 2.265, "grad_time_ms": 3649.784, "update_time_ms": 5.881, "learner": {"av": {"cur_kl_coeff": 0.09257695823907852, "cur_lr": 9.999999747378752e-05, "total_loss": 0.00347529212012887, "policy_loss": -0.0023356275632977486, "vf_loss": 0.0051332321017980576, "vf_explained_var": 0.8103459477424622, "kl": 0.007320230361074209, "entropy": 3.0240635871887207, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28879, "done": false, "timesteps_total": 5032927, "episodes_total": 4809, "training_iteration": 184, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-28-01", "timestamp": 1588829281, "time_this_iter_s": 72.21381330490112, "time_total_s": 12365.18712067604, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7245c5c80>", "on_episode_step": "<function on_episode_step at 0x7fc7245c50d0>", "on_episode_end": "<function on_episode_end at 0x7fc7245c5a60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245c5620>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7246c2400>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12365.18712067604, "timesteps_since_restore": 5032927, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 90.97184466019414, "ram_util_percent": 32.79902912621361}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0002, "episode_reward_mean": -0.14015439999999996, "episode_len_mean": 1077.99, "episodes_this_iter": 25, "policy_reward_min": {"av": -3.0002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.14015439999999996}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.9572156179879068, "avg_speed_min": 1.4583644400579512, "avg_speed_max": 4.2474086617820195, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.408766436197766, "mean_processing_ms": 1.5043889034659197, "mean_inference_ms": 0.3558453589468955}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1459072, "num_steps_sampled": 5059841, "sample_time_ms": 63125.161, "load_time_ms": 2.204, "grad_time_ms": 3569.323, "update_time_ms": 5.819, "learner": {"av": {"cur_kl_coeff": 0.09257695823907852, "cur_lr": 9.999999747378752e-05, "total_loss": 0.002343101892620325, "policy_loss": -0.0028184084221720695, "vf_loss": 0.004737766459584236, "vf_explained_var": 0.9260331392288208, "kl": 0.00457720598205924, "entropy": 3.7100777626037598, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26914, "done": false, "timesteps_total": 5059841, "episodes_total": 4834, "training_iteration": 185, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-29-06", "timestamp": 1588829346, "time_this_iter_s": 64.30250906944275, "time_total_s": 12429.489629745483, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7245c59d8>", "on_episode_step": "<function on_episode_step at 0x7fc72461e0d0>", "on_episode_end": "<function on_episode_end at 0x7fc725972510>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725972730>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72456c9d8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12429.489629745483, "timesteps_since_restore": 5059841, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 90.34565217391305, "ram_util_percent": 32.80000000000001}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0002, "episode_reward_mean": -0.07517609999999998, "episode_len_mean": 1098.3, "episodes_this_iter": 28, "policy_reward_min": {"av": -3.0002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.07517609999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.993127643842736, "avg_speed_min": 1.4583644400579512, "avg_speed_max": 4.2474086617820195, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.423418221531858, "mean_processing_ms": 1.5026912859956432, "mean_inference_ms": 0.35611085413365323}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1465984, "num_steps_sampled": 5087903, "sample_time_ms": 63346.042, "load_time_ms": 2.275, "grad_time_ms": 3540.663, "update_time_ms": 5.946, "learner": {"av": {"cur_kl_coeff": 0.04628847911953926, "cur_lr": 9.999999747378752e-05, "total_loss": 0.011121788062155247, "policy_loss": -0.0006430883076973259, "vf_loss": 0.011405311524868011, "vf_explained_var": 0.8582687973976135, "kl": 0.007767864968627691, "entropy": 3.320077657699585, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28062, "done": false, "timesteps_total": 5087903, "episodes_total": 4862, "training_iteration": 186, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-30-10", "timestamp": 1588829410, "time_this_iter_s": 63.83441400527954, "time_total_s": 12493.324043750763, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72461e1e0>", "on_episode_step": "<function on_episode_step at 0x7fc7245c5a60>", "on_episode_end": "<function on_episode_end at 0x7fc7245c50d0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc724574c80>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72456c730>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12493.324043750763, "timesteps_since_restore": 5087903, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 89.63076923076922, "ram_util_percent": 32.80109890109891}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00024, "episode_reward_mean": -0.2701664, "episode_len_mean": 1038.0, "episodes_this_iter": 31, "policy_reward_min": {"av": -3.00024}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.2701664}, "custom_metrics": {"num_ped_collisions_mean": 0.16, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.9910154449007313, "avg_speed_min": 1.4583644400579512, "avg_speed_max": 4.2474086617820195, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.425302166823617, "mean_processing_ms": 1.5004020276360388, "mean_inference_ms": 0.3562690086390055}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1474176, "num_steps_sampled": 5116606, "sample_time_ms": 64178.168, "load_time_ms": 2.307, "grad_time_ms": 3629.309, "update_time_ms": 5.92, "learner": {"av": {"cur_kl_coeff": 0.04628847911953926, "cur_lr": 9.999999747378752e-05, "total_loss": 0.028487738221883774, "policy_loss": -0.0034502572380006313, "vf_loss": 0.03123324364423752, "vf_explained_var": 0.8838058114051819, "kl": 0.015225203707814217, "entropy": 3.3821802139282227, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28703, "done": false, "timesteps_total": 5116606, "episodes_total": 4893, "training_iteration": 187, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-31-19", "timestamp": 1588829479, "time_this_iter_s": 69.75654101371765, "time_total_s": 12563.08058476448, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7245968c8>", "on_episode_step": "<function on_episode_step at 0x7fc724596510>", "on_episode_end": "<function on_episode_end at 0x7fc7245966a8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc724596950>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245f50d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12563.08058476448, "timesteps_since_restore": 5116606, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 90.01900000000002, "ram_util_percent": 32.80000000000001}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00072, "episode_reward_mean": -0.36767740000000004, "episode_len_mean": 1009.84, "episodes_this_iter": 27, "policy_reward_min": {"av": -3.00072}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.36767740000000004}, "custom_metrics": {"num_ped_collisions_mean": 0.19, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.066317373752708, "avg_speed_min": 1.3740899946020155, "avg_speed_max": 4.172697684518106, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.415077873860145, "mean_processing_ms": 1.502178125558846, "mean_inference_ms": 0.35601638415935805}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1481600, "num_steps_sampled": 5144451, "sample_time_ms": 63848.688, "load_time_ms": 2.267, "grad_time_ms": 3564.544, "update_time_ms": 6.017, "learner": {"av": {"cur_kl_coeff": 0.04628847911953926, "cur_lr": 9.999999747378752e-05, "total_loss": 0.012465001083910465, "policy_loss": -0.003087233519181609, "vf_loss": 0.015184855088591576, "vf_explained_var": 0.9312539100646973, "kl": 0.0079367496073246, "entropy": 4.156039237976074, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27845, "done": false, "timesteps_total": 5144451, "episodes_total": 4920, "training_iteration": 188, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-32-25", "timestamp": 1588829545, "time_this_iter_s": 65.54130792617798, "time_total_s": 12628.621892690659, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246c2620>", "on_episode_step": "<function on_episode_step at 0x7fc72461e1e0>", "on_episode_end": "<function on_episode_end at 0x7fc72461ed90>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc724574c80>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245c5950>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12628.621892690659, "timesteps_since_restore": 5144451, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 89.8989247311828, "ram_util_percent": 32.80000000000002}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00072, "episode_reward_mean": -0.367688, "episode_len_mean": 1009.92, "episodes_this_iter": 27, "policy_reward_min": {"av": -3.00072}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.367688}, "custom_metrics": {"num_ped_collisions_mean": 0.19, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.115376056525077, "avg_speed_min": 1.3740899946020155, "avg_speed_max": 4.22120489761738, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.404821517189315, "mean_processing_ms": 1.5018261940184734, "mean_inference_ms": 0.35595288339710796}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1488768, "num_steps_sampled": 5173275, "sample_time_ms": 63814.749, "load_time_ms": 2.232, "grad_time_ms": 3518.096, "update_time_ms": 5.967, "learner": {"av": {"cur_kl_coeff": 0.04628847911953926, "cur_lr": 9.999999747378752e-05, "total_loss": 0.013555904850363731, "policy_loss": 0.002066804561764002, "vf_loss": 0.01109948568046093, "vf_explained_var": 0.857686460018158, "kl": 0.008417082019150257, "entropy": 4.03769063949585, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28824, "done": false, "timesteps_total": 5173275, "episodes_total": 4947, "training_iteration": 189, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-33-31", "timestamp": 1588829611, "time_this_iter_s": 65.83078789710999, "time_total_s": 12694.452680587769, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7245f5d90>", "on_episode_step": "<function on_episode_step at 0x7fc72465fea0>", "on_episode_end": "<function on_episode_end at 0x7fc7245740d0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc724574840>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245c59d8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12694.452680587769, "timesteps_since_restore": 5173275, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 89.06595744680853, "ram_util_percent": 32.80000000000002}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00072, "episode_reward_mean": -0.40019070000000007, "episode_len_mean": 1002.54, "episodes_this_iter": 24, "policy_reward_min": {"av": -3.00072}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.40019070000000007}, "custom_metrics": {"num_ped_collisions_mean": 0.2, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.1010715143861347, "avg_speed_min": 1.3740899946020155, "avg_speed_max": 4.22120489761738, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.386817491812877, "mean_processing_ms": 1.5021807329620314, "mean_inference_ms": 0.35559578187944735}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1497600, "num_steps_sampled": 5198768, "sample_time_ms": 64143.924, "load_time_ms": 2.269, "grad_time_ms": 3601.025, "update_time_ms": 5.965, "learner": {"av": {"cur_kl_coeff": 0.04628847911953926, "cur_lr": 9.999999747378752e-05, "total_loss": 0.07792865484952927, "policy_loss": -0.0005053543136455119, "vf_loss": 0.07779131084680557, "vf_explained_var": 0.73211270570755, "kl": 0.013884356245398521, "entropy": 3.1273856163024902, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25493, "done": false, "timesteps_total": 5198768, "episodes_total": 4971, "training_iteration": 190, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-34-39", "timestamp": 1588829679, "time_this_iter_s": 68.28597974777222, "time_total_s": 12762.73866033554, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246c2a60>", "on_episode_step": "<function on_episode_step at 0x7fc72461ed90>", "on_episode_end": "<function on_episode_end at 0x7fc72461e1e0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245c5950>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724532048>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12762.73866033554, "timesteps_since_restore": 5198768, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 91.07857142857144, "ram_util_percent": 32.801020408163275}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00072, "episode_reward_mean": -0.3026714, "episode_len_mean": 1033.27, "episodes_this_iter": 26, "policy_reward_min": {"av": -3.00072}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.3026714}, "custom_metrics": {"num_ped_collisions_mean": 0.17, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.023536960864015, "avg_speed_min": 1.3740899946020155, "avg_speed_max": 4.252060747841479, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.371837558739703, "mean_processing_ms": 1.5040996929168995, "mean_inference_ms": 0.3552461999077221}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1505280, "num_steps_sampled": 5225379, "sample_time_ms": 64040.41, "load_time_ms": 2.276, "grad_time_ms": 3630.199, "update_time_ms": 5.924, "learner": {"av": {"cur_kl_coeff": 0.04628847911953926, "cur_lr": 9.999999747378752e-05, "total_loss": 0.034211695194244385, "policy_loss": -0.0015060430159792304, "vf_loss": 0.035188134759664536, "vf_explained_var": 0.7474637627601624, "kl": 0.011441483162343502, "entropy": 2.8398234844207764, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26611, "done": false, "timesteps_total": 5225379, "episodes_total": 4997, "training_iteration": 191, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-35-45", "timestamp": 1588829745, "time_this_iter_s": 65.06997680664062, "time_total_s": 12827.808637142181, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7245f50d0>", "on_episode_step": "<function on_episode_step at 0x7fc724574c80>", "on_episode_end": "<function on_episode_end at 0x7fc724574840>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245c59d8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724532268>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12827.808637142181, "timesteps_since_restore": 5225379, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 89.7021505376344, "ram_util_percent": 32.80322580645163}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0002099999999996, "episode_reward_mean": -0.2376516, "episode_len_mean": 1051.59, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.0002099999999996}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.2376516}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.974810184774404, "avg_speed_min": 1.4470745069283908, "avg_speed_max": 4.264347145329299, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.37963087988516, "mean_processing_ms": 1.5046392606345307, "mean_inference_ms": 0.3554265480444403}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1513472, "num_steps_sampled": 5251777, "sample_time_ms": 63822.067, "load_time_ms": 2.267, "grad_time_ms": 3643.474, "update_time_ms": 5.885, "learner": {"av": {"cur_kl_coeff": 0.04628847911953926, "cur_lr": 9.999999747378752e-05, "total_loss": 0.012429708614945412, "policy_loss": -0.004797912202775478, "vf_loss": 0.015359409153461456, "vf_explained_var": 0.8210816979408264, "kl": 0.0403602197766304, "entropy": 3.319209098815918, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26398, "done": false, "timesteps_total": 5251777, "episodes_total": 5020, "training_iteration": 192, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-36-52", "timestamp": 1588829812, "time_this_iter_s": 67.34635806083679, "time_total_s": 12895.154995203018, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7245f5d90>", "on_episode_step": "<function on_episode_step at 0x7fc7245749d8>", "on_episode_end": "<function on_episode_end at 0x7fc724574bf8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245740d0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245c5268>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12895.154995203018, "timesteps_since_restore": 5251777, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 90.79895833333335, "ram_util_percent": 32.800000000000004}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0002099999999996, "episode_reward_mean": -0.1401218, "episode_len_mean": 1082.32, "episodes_this_iter": 20, "policy_reward_min": {"av": -3.0002099999999996}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.1401218}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.932693298101344, "avg_speed_min": 1.4470745069283908, "avg_speed_max": 4.377687351368141, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.401571222792963, "mean_processing_ms": 1.5038281270646467, "mean_inference_ms": 0.3558440276170114}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1521408, "num_steps_sampled": 5276808, "sample_time_ms": 63127.586, "load_time_ms": 2.244, "grad_time_ms": 3578.451, "update_time_ms": 5.858, "learner": {"av": {"cur_kl_coeff": 0.06943271309137344, "cur_lr": 9.999999747378752e-05, "total_loss": 9.369261533720419e-05, "policy_loss": -0.0013522093649953604, "vf_loss": 0.0006791545310989022, "vf_explained_var": 0.8401790857315063, "kl": 0.011043010279536247, "entropy": 2.6040217876434326, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25031, "done": false, "timesteps_total": 5276808, "episodes_total": 5040, "training_iteration": 193, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-37-57", "timestamp": 1588829877, "time_this_iter_s": 65.0806450843811, "time_total_s": 12960.2356402874, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc724574b70>", "on_episode_step": "<function on_episode_step at 0x7fc724574c80>", "on_episode_end": "<function on_episode_end at 0x7fc724574840>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245c59d8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72456c378>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 12960.2356402874, "timesteps_since_restore": 5276808, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 90.21182795698925, "ram_util_percent": 32.848387096774196}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0002099999999996, "episode_reward_mean": -0.010104300000000005, "episode_len_mean": 1122.01, "episodes_this_iter": 27, "policy_reward_min": {"av": -3.0002099999999996}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.010104300000000005}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.7467956464557157, "avg_speed_min": 1.4470745069283908, "avg_speed_max": 4.377687351368141, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.420321840725705, "mean_processing_ms": 1.5027902026474664, "mean_inference_ms": 0.35637703290299766}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1530496, "num_steps_sampled": 5304986, "sample_time_ms": 63210.487, "load_time_ms": 2.26, "grad_time_ms": 3596.206, "update_time_ms": 5.894, "learner": {"av": {"cur_kl_coeff": 0.06943271309137344, "cur_lr": 9.999999747378752e-05, "total_loss": 0.001898167422041297, "policy_loss": -0.001809448003768921, "vf_loss": 0.003020065138116479, "vf_explained_var": 0.804231584072113, "kl": 0.009902413003146648, "entropy": 2.9847664833068848, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28178, "done": false, "timesteps_total": 5304986, "episodes_total": 5067, "training_iteration": 194, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-39-11", "timestamp": 1588829951, "time_this_iter_s": 73.2211046218872, "time_total_s": 13033.456744909286, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7245f50d0>", "on_episode_step": "<function on_episode_step at 0x7fc724574bf8>", "on_episode_end": "<function on_episode_end at 0x7fc7245749d8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245740d0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72456c620>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13033.456744909286, "timesteps_since_restore": 5304986, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 91.34903846153846, "ram_util_percent": 32.86826923076922}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0002099999999996, "episode_reward_mean": 0.022392000000000013, "episode_len_mean": 1131.32, "episodes_this_iter": 22, "policy_reward_min": {"av": -3.0002099999999996}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.022392000000000013}, "custom_metrics": {"num_ped_collisions_mean": 0.07, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.6566169033549745, "avg_speed_min": 1.543846154550009, "avg_speed_max": 4.377687351368141, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.43409164567061, "mean_processing_ms": 1.502012710579773, "mean_inference_ms": 0.35670255185332084}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1540736, "num_steps_sampled": 5330827, "sample_time_ms": 64124.902, "load_time_ms": 2.492, "grad_time_ms": 3732.148, "update_time_ms": 6.041, "learner": {"av": {"cur_kl_coeff": 0.06943271309137344, "cur_lr": 9.999999747378752e-05, "total_loss": 0.04307518154382706, "policy_loss": -0.01216117013245821, "vf_loss": 0.051284708082675934, "vf_explained_var": 0.2808881103992462, "kl": 0.05691325664520264, "entropy": 3.3535327911376953, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25841, "done": false, "timesteps_total": 5330827, "episodes_total": 5089, "training_iteration": 195, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-40-25", "timestamp": 1588830025, "time_this_iter_s": 74.81076240539551, "time_total_s": 13108.267507314682, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72465fea0>", "on_episode_step": "<function on_episode_step at 0x7fc724574c80>", "on_episode_end": "<function on_episode_end at 0x7fc724574b70>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245c59d8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72456ce18>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13108.267507314682, "timesteps_since_restore": 5330827, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 91.37009345794395, "ram_util_percent": 32.89999999999999}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00023, "episode_reward_mean": 0.05485989999999998, "episode_len_mean": 1140.6, "episodes_this_iter": 28, "policy_reward_min": {"av": -3.00023}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.05485989999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.771192895231647, "avg_speed_min": 1.5763501924217904, "avg_speed_max": 4.778460271551781, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.44257413923947, "mean_processing_ms": 1.5002838720486762, "mean_inference_ms": 0.3568782479312675}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1547008, "num_steps_sampled": 5360839, "sample_time_ms": 64109.631, "load_time_ms": 2.399, "grad_time_ms": 3704.299, "update_time_ms": 5.98, "learner": {"av": {"cur_kl_coeff": 0.10414907336235046, "cur_lr": 9.999999747378752e-05, "total_loss": -0.00644732266664505, "policy_loss": -0.009243471547961235, "vf_loss": 0.0011845306726172566, "vf_explained_var": 0.9908878803253174, "kl": 0.015474164858460426, "entropy": 4.50204610824585, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 30012, "done": false, "timesteps_total": 5360839, "episodes_total": 5117, "training_iteration": 196, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-41-29", "timestamp": 1588830089, "time_this_iter_s": 63.40132927894592, "time_total_s": 13171.668836593628, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc724574840>", "on_episode_step": "<function on_episode_step at 0x7fc7245749d8>", "on_episode_end": "<function on_episode_end at 0x7fc724574bf8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245740d0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724532a60>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13171.668836593628, "timesteps_since_restore": 5360839, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 90.53076923076924, "ram_util_percent": 32.9010989010989}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00023, "episode_reward_mean": -0.0426687, "episode_len_mean": 1110.06, "episodes_this_iter": 27, "policy_reward_min": {"av": -3.00023}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.0426687}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.85036516914333, "avg_speed_min": 1.5763501924217904, "avg_speed_max": 4.778460271551781, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.42046896389755, "mean_processing_ms": 1.500658996103414, "mean_inference_ms": 0.3565165916976592}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1554304, "num_steps_sampled": 5389599, "sample_time_ms": 63841.835, "load_time_ms": 2.363, "grad_time_ms": 3662.323, "update_time_ms": 5.963, "learner": {"av": {"cur_kl_coeff": 0.10414907336235046, "cur_lr": 9.999999747378752e-05, "total_loss": 0.009999649599194527, "policy_loss": -0.0030060389544814825, "vf_loss": 0.012459349818527699, "vf_explained_var": 0.8845096826553345, "kl": 0.005245757754892111, "entropy": 3.657999038696289, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28760, "done": false, "timesteps_total": 5389599, "episodes_total": 5144, "training_iteration": 197, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-42-36", "timestamp": 1588830156, "time_this_iter_s": 66.6583354473114, "time_total_s": 13238.32717204094, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7245f5d90>", "on_episode_step": "<function on_episode_step at 0x7fc72461e0d0>", "on_episode_end": "<function on_episode_end at 0x7fc72461e1e0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72461ed90>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72456c6a8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13238.32717204094, "timesteps_since_restore": 5389599, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 91.19263157894736, "ram_util_percent": 32.898947368421055}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00023, "episode_reward_mean": -0.10767620000000001, "episode_len_mean": 1091.16, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.00023}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.10767620000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.969068961537048, "avg_speed_min": 1.5071119214510968, "avg_speed_max": 4.778460271551781, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.427844224271656, "mean_processing_ms": 1.5005954405705162, "mean_inference_ms": 0.3564928535034243}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1562752, "num_steps_sampled": 5415517, "sample_time_ms": 63972.638, "load_time_ms": 2.391, "grad_time_ms": 3709.136, "update_time_ms": 5.878, "learner": {"av": {"cur_kl_coeff": 0.10414907336235046, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0003221775114070624, "policy_loss": -0.013133805245161057, "vf_loss": 0.01180887222290039, "vf_explained_var": 0.7019592523574829, "kl": 0.01581493392586708, "entropy": 3.39775013923645, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25918, "done": false, "timesteps_total": 5415517, "episodes_total": 5167, "training_iteration": 198, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-43-43", "timestamp": 1588830223, "time_this_iter_s": 67.31672716140747, "time_total_s": 13305.643899202347, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7245f50d0>", "on_episode_step": "<function on_episode_step at 0x7fc72456c378>", "on_episode_end": "<function on_episode_end at 0x7fc72456ce18>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72456cb70>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245c5488>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13305.643899202347, "timesteps_since_restore": 5415517, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 89.94062500000001, "ram_util_percent": 32.89999999999999}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00023, "episode_reward_mean": -0.1401832, "episode_len_mean": 1082.37, "episodes_this_iter": 24, "policy_reward_min": {"av": -3.00023}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.1401832}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.0887405449665106, "avg_speed_min": 1.3931552098006867, "avg_speed_max": 4.778460271551781, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.41112275763721, "mean_processing_ms": 1.5002777308045279, "mean_inference_ms": 0.35608945748983095}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1570816, "num_steps_sampled": 5442066, "sample_time_ms": 63976.293, "load_time_ms": 2.404, "grad_time_ms": 3750.229, "update_time_ms": 5.93, "learner": {"av": {"cur_kl_coeff": 0.10414907336235046, "cur_lr": 9.999999747378752e-05, "total_loss": 0.12206097692251205, "policy_loss": 0.0005170658114366233, "vf_loss": 0.12015880644321442, "vf_explained_var": 0.6632145643234253, "kl": 0.01329922303557396, "entropy": 3.060504674911499, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26549, "done": false, "timesteps_total": 5442066, "episodes_total": 5191, "training_iteration": 199, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-44-50", "timestamp": 1588830290, "time_this_iter_s": 66.27887439727783, "time_total_s": 13371.922773599625, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72461e1e0>", "on_episode_step": "<function on_episode_step at 0x7fc72461e0d0>", "on_episode_end": "<function on_episode_end at 0x7fc72456cd90>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72456c6a8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245326a8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13371.922773599625, "timesteps_since_restore": 5442066, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 91.41578947368421, "ram_util_percent": 32.9}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00023, "episode_reward_mean": -0.14015770000000002, "episode_len_mean": 1083.23, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.00023}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.14015770000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.982241966886286, "avg_speed_min": 1.3931552098006867, "avg_speed_max": 4.334747861653837, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.4436094392559, "mean_processing_ms": 1.499482198110684, "mean_inference_ms": 0.35676102997284587}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1578752, "num_steps_sampled": 5467722, "sample_time_ms": 63677.678, "load_time_ms": 2.389, "grad_time_ms": 3708.771, "update_time_ms": 5.994, "learner": {"av": {"cur_kl_coeff": 0.10414907336235046, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0410740040242672, "policy_loss": -0.001925977529026568, "vf_loss": 0.04228430241346359, "vf_explained_var": 0.665117621421814, "kl": 0.006871659308671951, "entropy": 3.6698193550109863, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25656, "done": false, "timesteps_total": 5467722, "episodes_total": 5214, "training_iteration": 200, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-45-54", "timestamp": 1588830354, "time_this_iter_s": 64.8848044872284, "time_total_s": 13436.807578086853, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7245968c8>", "on_episode_step": "<function on_episode_step at 0x7fc72456ce18>", "on_episode_end": "<function on_episode_end at 0x7fc72456c378>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72456cb70>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724532268>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13436.807578086853, "timesteps_since_restore": 5467722, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 92.00978260869564, "ram_util_percent": 32.9}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00023, "episode_reward_mean": -0.07513439999999998, "episode_len_mean": 1103.42, "episodes_this_iter": 21, "policy_reward_min": {"av": -3.00023}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.07513439999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.8157236193985953, "avg_speed_min": 1.3931552098006867, "avg_speed_max": 4.334747861653837, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.45326893129376, "mean_processing_ms": 1.499428211922894, "mean_inference_ms": 0.356982013751395}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1586944, "num_steps_sampled": 5492990, "sample_time_ms": 63670.661, "load_time_ms": 2.383, "grad_time_ms": 3733.422, "update_time_ms": 6.027, "learner": {"av": {"cur_kl_coeff": 0.10414907336235046, "cur_lr": 9.999999747378752e-05, "total_loss": 0.002436087466776371, "policy_loss": -5.462486296892166e-05, "vf_loss": 0.0014970675110816956, "vf_explained_var": 0.7721261978149414, "kl": 0.009540596976876259, "entropy": 2.8588552474975586, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25268, "done": false, "timesteps_total": 5492990, "episodes_total": 5235, "training_iteration": 201, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-47-00", "timestamp": 1588830420, "time_this_iter_s": 65.2466356754303, "time_total_s": 13502.054213762283, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7245f50d0>", "on_episode_step": "<function on_episode_step at 0x7fc72461e1e0>", "on_episode_end": "<function on_episode_end at 0x7fc72456cd90>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72456c6a8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724532c80>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13502.054213762283, "timesteps_since_restore": 5492990, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 90.39893617021275, "ram_util_percent": 32.90212765957447}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00023, "episode_reward_mean": -0.010129599999999996, "episode_len_mean": 1124.33, "episodes_this_iter": 22, "policy_reward_min": {"av": -3.00023}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.010129599999999996}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.819458215355301, "avg_speed_min": 1.3931552098006867, "avg_speed_max": 4.334747861653837, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.461680779038875, "mean_processing_ms": 1.49804327109562, "mean_inference_ms": 0.3572697906851174}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1595136, "num_steps_sampled": 5519009, "sample_time_ms": 63477.757, "load_time_ms": 2.389, "grad_time_ms": 3731.585, "update_time_ms": 5.974, "learner": {"av": {"cur_kl_coeff": 0.10414907336235046, "cur_lr": 9.999999747378752e-05, "total_loss": 0.01869978755712509, "policy_loss": -0.0002544289454817772, "vf_loss": 0.01822546124458313, "vf_explained_var": 0.6933914422988892, "kl": 0.006997275166213512, "entropy": 3.034691572189331, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26019, "done": false, "timesteps_total": 5519009, "episodes_total": 5257, "training_iteration": 202, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-48-05", "timestamp": 1588830485, "time_this_iter_s": 65.3981204032898, "time_total_s": 13567.452334165573, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72461e0d0>", "on_episode_step": "<function on_episode_step at 0x7fc7245c5048>", "on_episode_end": "<function on_episode_end at 0x7fc7245c5510>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245c5598>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7246c2620>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13567.452334165573, "timesteps_since_restore": 5519009, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 91.47634408602148, "ram_util_percent": 32.9}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0001599999999997, "episode_reward_mean": 0.15238, "episode_len_mean": 1170.96, "episodes_this_iter": 24, "policy_reward_min": {"av": -3.0001599999999997}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.15238}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.7166932611723436, "avg_speed_min": 1.523924961414499, "avg_speed_max": 5.122850134029118, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.464532271862154, "mean_processing_ms": 1.4981749421822854, "mean_inference_ms": 0.3572792157801528}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1603712, "num_steps_sampled": 5545977, "sample_time_ms": 63836.782, "load_time_ms": 2.412, "grad_time_ms": 3762.086, "update_time_ms": 6.017, "learner": {"av": {"cur_kl_coeff": 0.10414907336235046, "cur_lr": 9.999999747378752e-05, "total_loss": 0.001650066813454032, "policy_loss": -0.00018418196123093367, "vf_loss": 0.0007410130347125232, "vf_explained_var": 0.8602416515350342, "kl": 0.010496830567717552, "entropy": 2.9473860263824463, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26968, "done": false, "timesteps_total": 5545977, "episodes_total": 5281, "training_iteration": 203, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-49-14", "timestamp": 1588830554, "time_this_iter_s": 68.97659087181091, "time_total_s": 13636.428925037384, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72461ed90>", "on_episode_step": "<function on_episode_step at 0x7fc7245c5268>", "on_episode_end": "<function on_episode_end at 0x7fc7245c5a60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245c51e0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245749d8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13636.428925037384, "timesteps_since_restore": 5545977, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 90.85918367346939, "ram_util_percent": 32.89999999999999}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0001599999999997, "episode_reward_mean": 0.1848903, "episode_len_mean": 1181.14, "episodes_this_iter": 20, "policy_reward_min": {"av": -3.0001599999999997}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1848903}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.7897967646461392, "avg_speed_min": 1.523924961414499, "avg_speed_max": 5.122850134029118, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.46657330284792, "mean_processing_ms": 1.4981608150057797, "mean_inference_ms": 0.35740870822361787}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1611648, "num_steps_sampled": 5571567, "sample_time_ms": 63007.106, "load_time_ms": 2.404, "grad_time_ms": 3710.094, "update_time_ms": 5.936, "learner": {"av": {"cur_kl_coeff": 0.10414907336235046, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0012878273846581578, "policy_loss": -5.799940481665544e-05, "vf_loss": 0.000727425271179527, "vf_explained_var": 0.8403623700141907, "kl": 0.005937656853348017, "entropy": 3.1559998989105225, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25590, "done": false, "timesteps_total": 5571567, "episodes_total": 5301, "training_iteration": 204, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-50-19", "timestamp": 1588830619, "time_this_iter_s": 64.40314245223999, "time_total_s": 13700.832067489624, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7245f50d0>", "on_episode_step": "<function on_episode_step at 0x7fc7245c5510>", "on_episode_end": "<function on_episode_end at 0x7fc7245c5048>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246c2620>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245326a8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13700.832067489624, "timesteps_since_restore": 5571567, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 91.12826086956521, "ram_util_percent": 32.9}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00015, "episode_reward_mean": 0.1723882, "episode_len_mean": 1170.11, "episodes_this_iter": 29, "policy_reward_min": {"av": -3.00015}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1723882}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9089075247775305, "avg_speed_min": 1.5491557183269054, "avg_speed_max": 5.122850134029118, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.469828312271726, "mean_processing_ms": 1.4965481011497328, "mean_inference_ms": 0.35742216785055975}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1618304, "num_steps_sampled": 5601532, "sample_time_ms": 62186.532, "load_time_ms": 2.173, "grad_time_ms": 3544.176, "update_time_ms": 5.855, "learner": {"av": {"cur_kl_coeff": 0.10414907336235046, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0064568789675831795, "policy_loss": -0.0104592926800251, "vf_loss": 0.0029072645120322704, "vf_explained_var": 0.9401336312294006, "kl": 0.010515216737985611, "entropy": 3.622166156768799, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 29965, "done": false, "timesteps_total": 5601532, "episodes_total": 5330, "training_iteration": 205, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-51-24", "timestamp": 1588830684, "time_this_iter_s": 64.94237160682678, "time_total_s": 13765.77443909645, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7245c5598>", "on_episode_step": "<function on_episode_step at 0x7fc7245c5a60>", "on_episode_end": "<function on_episode_end at 0x7fc7245c5268>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245c5950>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724532d90>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13765.77443909645, "timesteps_since_restore": 5601532, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 89.65806451612902, "ram_util_percent": 32.9}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00015, "episode_reward_mean": 0.13987790000000003, "episode_len_mean": 1159.66, "episodes_this_iter": 21, "policy_reward_min": {"av": -3.00015}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.13987790000000003}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.022608915497796, "avg_speed_min": 1.5491557183269054, "avg_speed_max": 5.122850134029118, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.457869740114578, "mean_processing_ms": 1.4974666965856005, "mean_inference_ms": 0.35712805151396504}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1626624, "num_steps_sampled": 5627979, "sample_time_ms": 62500.073, "load_time_ms": 2.185, "grad_time_ms": 3637.121, "update_time_ms": 5.864, "learner": {"av": {"cur_kl_coeff": 0.10414907336235046, "cur_lr": 9.999999747378752e-05, "total_loss": 0.00017876441415864974, "policy_loss": -0.0011858479119837284, "vf_loss": 0.0005860547535121441, "vf_explained_var": 0.9075279831886292, "kl": 0.007475392427295446, "entropy": 3.644322395324707, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26447, "done": false, "timesteps_total": 5627979, "episodes_total": 5351, "training_iteration": 206, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-52-32", "timestamp": 1588830752, "time_this_iter_s": 67.46686434745789, "time_total_s": 13833.241303443909, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72461e1e0>", "on_episode_step": "<function on_episode_step at 0x7fc7245c5510>", "on_episode_end": "<function on_episode_end at 0x7fc7245f50d0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246c2620>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7244cb8c8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13833.241303443909, "timesteps_since_restore": 5627979, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 90.73958333333333, "ram_util_percent": 32.90208333333333}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0002, "episode_reward_mean": 0.13986890000000002, "episode_len_mean": 1161.32, "episodes_this_iter": 24, "policy_reward_min": {"av": -3.0002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.13986890000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.013449032693618, "avg_speed_min": 1.5633055048579823, "avg_speed_max": 4.3675970712693895, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.460943571801096, "mean_processing_ms": 1.4970243147234055, "mean_inference_ms": 0.3570136461953359}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1634560, "num_steps_sampled": 5655388, "sample_time_ms": 62620.561, "load_time_ms": 2.204, "grad_time_ms": 3667.499, "update_time_ms": 5.828, "learner": {"av": {"cur_kl_coeff": 0.10414907336235046, "cur_lr": 9.999999747378752e-05, "total_loss": 0.002827701158821583, "policy_loss": -0.0039217667654156685, "vf_loss": 0.006006950978189707, "vf_explained_var": 0.7129246592521667, "kl": 0.007129358593374491, "entropy": 3.1324429512023926, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27409, "done": false, "timesteps_total": 5655388, "episodes_total": 5375, "training_iteration": 207, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-53-40", "timestamp": 1588830820, "time_this_iter_s": 68.16695737838745, "time_total_s": 13901.408260822296, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc725972510>", "on_episode_step": "<function on_episode_step at 0x7fc7245749d8>", "on_episode_end": "<function on_episode_end at 0x7fc724574bf8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc724574c80>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72456c620>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13901.408260822296, "timesteps_since_restore": 5655388, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 89.21530612244898, "ram_util_percent": 32.89999999999999}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0002, "episode_reward_mean": 0.1398588, "episode_len_mean": 1161.32, "episodes_this_iter": 21, "policy_reward_min": {"av": -3.0002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1398588}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.088595099198382, "avg_speed_min": 1.5633055048579823, "avg_speed_max": 4.305046185477577, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.470535403088, "mean_processing_ms": 1.495779606439581, "mean_inference_ms": 0.35724682434963506}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1642368, "num_steps_sampled": 5681726, "sample_time_ms": 62410.632, "load_time_ms": 2.189, "grad_time_ms": 3637.891, "update_time_ms": 5.845, "learner": {"av": {"cur_kl_coeff": 0.10414907336235046, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0005788989365100861, "policy_loss": -0.0007571653695777059, "vf_loss": 0.0004957711789757013, "vf_explained_var": 0.8775659799575806, "kl": 0.008068157359957695, "entropy": 2.934525489807129, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26338, "done": false, "timesteps_total": 5681726, "episodes_total": 5396, "training_iteration": 208, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-54-45", "timestamp": 1588830885, "time_this_iter_s": 64.92099142074585, "time_total_s": 13966.329252243042, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc725972730>", "on_episode_step": "<function on_episode_step at 0x7fc72461e1e0>", "on_episode_end": "<function on_episode_end at 0x7fc72456ca60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246c2620>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245c5268>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 13966.329252243042, "timesteps_since_restore": 5681726, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 91.42934782608695, "ram_util_percent": 32.9}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0002, "episode_reward_mean": 0.1723662, "episode_len_mean": 1171.15, "episodes_this_iter": 25, "policy_reward_min": {"av": -3.0002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1723662}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.0057967254643305, "avg_speed_min": 1.5633055048579823, "avg_speed_max": 4.317068930891758, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.453624582618982, "mean_processing_ms": 1.4956626658450078, "mean_inference_ms": 0.35692680499280544}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1650560, "num_steps_sampled": 5710095, "sample_time_ms": 62808.173, "load_time_ms": 2.192, "grad_time_ms": 3644.997, "update_time_ms": 5.849, "learner": {"av": {"cur_kl_coeff": 0.10414907336235046, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0019549336284399033, "policy_loss": -0.004141724668443203, "vf_loss": 0.0005770419957116246, "vf_explained_var": 0.8653355836868286, "kl": 0.015456205233931541, "entropy": 3.13649320602417, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28369, "done": false, "timesteps_total": 5710095, "episodes_total": 5421, "training_iteration": 209, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-55-55", "timestamp": 1588830955, "time_this_iter_s": 70.32582998275757, "time_total_s": 14036.6550822258, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7245f50d0>", "on_episode_step": "<function on_episode_step at 0x7fc724574bf8>", "on_episode_end": "<function on_episode_end at 0x7fc7245749d8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72456c620>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245328c8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14036.6550822258, "timesteps_since_restore": 5710095, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 89.50594059405937, "ram_util_percent": 32.9}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0002, "episode_reward_mean": 0.18486160000000001, "episode_len_mean": 1181.1, "episodes_this_iter": 20, "policy_reward_min": {"av": -3.0002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.18486160000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.9808123953487864, "avg_speed_min": 1.5776003061643444, "avg_speed_max": 4.317068930891758, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.46369429408314, "mean_processing_ms": 1.4947864113673004, "mean_inference_ms": 0.3570424538074593}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1659520, "num_steps_sampled": 5735465, "sample_time_ms": 63172.111, "load_time_ms": 2.207, "grad_time_ms": 3690.915, "update_time_ms": 5.793, "learner": {"av": {"cur_kl_coeff": 0.10414907336235046, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0003004124737344682, "policy_loss": -0.0013523445231840014, "vf_loss": 0.0008406319539062679, "vf_explained_var": 0.8597997426986694, "kl": 0.00779773760586977, "entropy": 3.47611665725708, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25370, "done": false, "timesteps_total": 5735465, "episodes_total": 5441, "training_iteration": 210, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-57-04", "timestamp": 1588831024, "time_this_iter_s": 68.98322939872742, "time_total_s": 14105.638311624527, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72465fea0>", "on_episode_step": "<function on_episode_step at 0x7fc72456ca60>", "on_episode_end": "<function on_episode_end at 0x7fc72461e1e0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245c5268>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724532ae8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14105.638311624527, "timesteps_since_restore": 5735465, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 91.19285714285716, "ram_util_percent": 32.89999999999999}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0002, "episode_reward_mean": 0.2048787, "episode_len_mean": 1182.71, "episodes_this_iter": 26, "policy_reward_min": {"av": -3.0002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.2048787}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.003489014883455, "avg_speed_min": 1.4882993342356523, "avg_speed_max": 4.612201439333806, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.467675379980776, "mean_processing_ms": 1.4940773754185313, "mean_inference_ms": 0.35716218050788995}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1667328, "num_steps_sampled": 5764621, "sample_time_ms": 63560.447, "load_time_ms": 2.207, "grad_time_ms": 3672.848, "update_time_ms": 5.741, "learner": {"av": {"cur_kl_coeff": 0.10414907336235046, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0025595040060579777, "policy_loss": -0.015428968705236912, "vf_loss": 0.010183718055486679, "vf_explained_var": 0.4203775227069855, "kl": 0.025787465274333954, "entropy": 3.284358263015747, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 29156, "done": false, "timesteps_total": 5764621, "episodes_total": 5467, "training_iteration": 211, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-58-13", "timestamp": 1588831093, "time_this_iter_s": 68.94891500473022, "time_total_s": 14174.587226629257, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246c2620>", "on_episode_step": "<function on_episode_step at 0x7fc724574bf8>", "on_episode_end": "<function on_episode_end at 0x7fc7245f50d0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72456c620>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7244cc158>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14174.587226629257, "timesteps_since_restore": 5764621, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 89.85252525252525, "ram_util_percent": 32.901010101010094}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -1.0002300000000002, "episode_reward_mean": 0.2373721, "episode_len_mean": 1191.16, "episodes_this_iter": 23, "policy_reward_min": {"av": -1.0002300000000002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.2373721}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9504626128561777, "avg_speed_min": 1.4882993342356523, "avg_speed_max": 4.612201439333806, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.477605245982783, "mean_processing_ms": 1.4942702783236828, "mean_inference_ms": 0.35744561179975903}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1676160, "num_steps_sampled": 5792187, "sample_time_ms": 64178.21, "load_time_ms": 2.233, "grad_time_ms": 3704.244, "update_time_ms": 5.753, "learner": {"av": {"cur_kl_coeff": 0.1562236100435257, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0019538605120033026, "policy_loss": 8.626589988125488e-05, "vf_loss": 0.0007786987698636949, "vf_explained_var": 0.84123694896698, "kl": 0.006970131769776344, "entropy": 3.0933921337127686, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27566, "done": false, "timesteps_total": 5792187, "episodes_total": 5490, "training_iteration": 212, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_05-59-25", "timestamp": 1588831165, "time_this_iter_s": 71.89052867889404, "time_total_s": 14246.477755308151, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc725972730>", "on_episode_step": "<function on_episode_step at 0x7fc724574c80>", "on_episode_end": "<function on_episode_end at 0x7fc7245749d8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc724574840>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245c58c8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14246.477755308151, "timesteps_since_restore": 5792187, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 90.3883495145631, "ram_util_percent": 32.9}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -1.0002300000000002, "episode_reward_mean": 0.23735620000000002, "episode_len_mean": 1191.16, "episodes_this_iter": 22, "policy_reward_min": {"av": -1.0002300000000002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.23735620000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.921771335722477, "avg_speed_min": 1.4882993342356523, "avg_speed_max": 4.612201439333806, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.514060102078812, "mean_processing_ms": 1.4927544988251815, "mean_inference_ms": 0.35813141257890907}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1684480, "num_steps_sampled": 5819478, "sample_time_ms": 64177.451, "load_time_ms": 2.216, "grad_time_ms": 3692.303, "update_time_ms": 5.722, "learner": {"av": {"cur_kl_coeff": 0.1562236100435257, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0011559838894754648, "policy_loss": -0.001470239250920713, "vf_loss": 0.0007971571758389473, "vf_explained_var": 0.8626655340194702, "kl": 0.011708002537488937, "entropy": 3.340604066848755, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27291, "done": false, "timesteps_total": 5819478, "episodes_total": 5512, "training_iteration": 213, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_06-00-34", "timestamp": 1588831234, "time_this_iter_s": 68.8498842716217, "time_total_s": 14315.327639579773, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc725972510>", "on_episode_step": "<function on_episode_step at 0x7fc7246c2620>", "on_episode_end": "<function on_episode_end at 0x7fc7245f50d0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245c5950>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72456cae8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14315.327639579773, "timesteps_since_restore": 5819478, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 91.78367346938776, "ram_util_percent": 32.89999999999999}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0002, "episode_reward_mean": 0.1723686, "episode_len_mean": 1173.96, "episodes_this_iter": 25, "policy_reward_min": {"av": -3.0002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1723686}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9369057397544305, "avg_speed_min": 1.4882993342356523, "avg_speed_max": 4.612201439333806, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.504409769905916, "mean_processing_ms": 1.492874796828317, "mean_inference_ms": 0.35789732914945815}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1691264, "num_steps_sampled": 5846684, "sample_time_ms": 64025.754, "load_time_ms": 2.174, "grad_time_ms": 3638.661, "update_time_ms": 5.855, "learner": {"av": {"cur_kl_coeff": 0.1562236100435257, "cur_lr": 9.999999747378752e-05, "total_loss": 0.03336985781788826, "policy_loss": -0.00374094326980412, "vf_loss": 0.036365099251270294, "vf_explained_var": 0.8274956345558167, "kl": 0.004773276392370462, "entropy": 3.5215487480163574, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27206, "done": false, "timesteps_total": 5846684, "episodes_total": 5537, "training_iteration": 214, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_06-01-37", "timestamp": 1588831297, "time_this_iter_s": 62.35110640525818, "time_total_s": 14377.678745985031, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc724574bf8>", "on_episode_step": "<function on_episode_step at 0x7fc7245749d8>", "on_episode_end": "<function on_episode_end at 0x7fc724574c80>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245c58c8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724532c80>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14377.678745985031, "timesteps_since_restore": 5846684, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 88.86516853932584, "ram_util_percent": 32.89999999999999}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0002, "episode_reward_mean": 0.11986310000000001, "episode_len_mean": 1165.01, "episodes_this_iter": 22, "policy_reward_min": {"av": -3.0002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.11986310000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.9202208154353246, "avg_speed_min": 1.4882993342356523, "avg_speed_max": 4.470023446091084, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.504753139063062, "mean_processing_ms": 1.491586176339676, "mean_inference_ms": 0.3579227203403328}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1699456, "num_steps_sampled": 5872285, "sample_time_ms": 64108.994, "load_time_ms": 2.184, "grad_time_ms": 3709.772, "update_time_ms": 5.826, "learner": {"av": {"cur_kl_coeff": 0.07811180502176285, "cur_lr": 9.999999747378752e-05, "total_loss": 0.06758725643157959, "policy_loss": -0.003880564123392105, "vf_loss": 0.07097279280424118, "vf_explained_var": 0.5849288105964661, "kl": 0.0063374899327754974, "entropy": 3.2500476837158203, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25601, "done": false, "timesteps_total": 5872285, "episodes_total": 5559, "training_iteration": 215, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_06-02-43", "timestamp": 1588831363, "time_this_iter_s": 66.48465347290039, "time_total_s": 14444.163399457932, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc724574840>", "on_episode_step": "<function on_episode_step at 0x7fc7246c2620>", "on_episode_end": "<function on_episode_end at 0x7fc7245c5950>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245c5268>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724532e18>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14444.163399457932, "timesteps_since_restore": 5872285, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 89.65578947368424, "ram_util_percent": 32.9}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0002, "episode_reward_mean": 0.11986860000000002, "episode_len_mean": 1165.01, "episodes_this_iter": 22, "policy_reward_min": {"av": -3.0002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.11986860000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.8400960834275875, "avg_speed_min": 1.4947696618278397, "avg_speed_max": 4.27562142534677, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.51782545705834, "mean_processing_ms": 1.4906390093081954, "mean_inference_ms": 0.35818345760378717}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1707904, "num_steps_sampled": 5899183, "sample_time_ms": 64244.607, "load_time_ms": 2.198, "grad_time_ms": 3714.116, "update_time_ms": 5.777, "learner": {"av": {"cur_kl_coeff": 0.07811180502176285, "cur_lr": 9.999999747378752e-05, "total_loss": -0.006784302182495594, "policy_loss": -0.0098990174010396, "vf_loss": 0.0011649720836430788, "vf_explained_var": 0.8103247880935669, "kl": 0.02496090531349182, "entropy": 2.953866481781006, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26898, "done": false, "timesteps_total": 5899183, "episodes_total": 5581, "training_iteration": 216, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_06-03-52", "timestamp": 1588831432, "time_this_iter_s": 68.8664026260376, "time_total_s": 14513.02980208397, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7245f50d0>", "on_episode_step": "<function on_episode_step at 0x7fc7245749d8>", "on_episode_end": "<function on_episode_end at 0x7fc724574bf8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245c58c8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7244cc950>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14513.02980208397, "timesteps_since_restore": 5899183, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 89.64081632653061, "ram_util_percent": 32.90408163265305}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0002, "episode_reward_mean": 0.1198618, "episode_len_mean": 1165.01, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.0002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1198618}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.847247389053007, "avg_speed_min": 1.4947696618278397, "avg_speed_max": 4.27562142534677, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.488532001463028, "mean_processing_ms": 1.4913349633807385, "mean_inference_ms": 0.357572557622982}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1716480, "num_steps_sampled": 5926104, "sample_time_ms": 64362.008, "load_time_ms": 2.195, "grad_time_ms": 3743.769, "update_time_ms": 5.771, "learner": {"av": {"cur_kl_coeff": 0.11716771125793457, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0006690194131806493, "policy_loss": -0.0008992502698674798, "vf_loss": 0.0006678987992927432, "vf_explained_var": 0.8353366255760193, "kl": 0.007684484124183655, "entropy": 3.186554431915283, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26921, "done": false, "timesteps_total": 5926104, "episodes_total": 5604, "training_iteration": 217, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_06-05-02", "timestamp": 1588831502, "time_this_iter_s": 69.63744258880615, "time_total_s": 14582.667244672775, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7244cb8c8>", "on_episode_step": "<function on_episode_step at 0x7fc72461e0d0>", "on_episode_end": "<function on_episode_end at 0x7fc72456cae8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72456c6a8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245f5d90>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14582.667244672775, "timesteps_since_restore": 5926104, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 89.27799999999999, "ram_util_percent": 32.9}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0002, "episode_reward_mean": 0.11985300000000003, "episode_len_mean": 1165.01, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.0002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.11985300000000003}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.8148512996052837, "avg_speed_min": 1.4947696618278397, "avg_speed_max": 4.27562142534677, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.494042683116426, "mean_processing_ms": 1.491441581740247, "mean_inference_ms": 0.3577294138050941}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1725184, "num_steps_sampled": 5953280, "sample_time_ms": 64780.32, "load_time_ms": 2.207, "grad_time_ms": 3804.632, "update_time_ms": 5.686, "learner": {"av": {"cur_kl_coeff": 0.11716771125793457, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0004769106744788587, "policy_loss": -0.002245711162686348, "vf_loss": 0.0007753218524158001, "vf_explained_var": 0.8391274809837341, "kl": 0.00847910437732935, "entropy": 3.199234962463379, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27176, "done": false, "timesteps_total": 5953280, "episodes_total": 5627, "training_iteration": 218, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_06-06-12", "timestamp": 1588831572, "time_this_iter_s": 69.712961435318, "time_total_s": 14652.380206108093, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72461ed90>", "on_episode_step": "<function on_episode_step at 0x7fc7245749d8>", "on_episode_end": "<function on_episode_end at 0x7fc724574bf8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245c58c8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7246c2620>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14652.380206108093, "timesteps_since_restore": 5953280, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 91.97575757575758, "ram_util_percent": 32.91515151515151}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00006, "episode_reward_mean": 0.18485, "episode_len_mean": 1182.21, "episodes_this_iter": 22, "policy_reward_min": {"av": -3.00006}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.18485}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.816655163400239, "avg_speed_min": 1.5651186394271097, "avg_speed_max": 4.211012808855039, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.499321172108807, "mean_processing_ms": 1.4907528174089273, "mean_inference_ms": 0.35791833051493915}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1733760, "num_steps_sampled": 5979766, "sample_time_ms": 64557.865, "load_time_ms": 2.21, "grad_time_ms": 3821.752, "update_time_ms": 5.676, "learner": {"av": {"cur_kl_coeff": 0.11716771125793457, "cur_lr": 9.999999747378752e-05, "total_loss": 0.002304801484569907, "policy_loss": 0.0008479571552015841, "vf_loss": 0.0007651111227460206, "vf_explained_var": 0.8475916981697083, "kl": 0.005903787445276976, "entropy": 3.116267442703247, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26486, "done": false, "timesteps_total": 5979766, "episodes_total": 5649, "training_iteration": 219, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_06-07-20", "timestamp": 1588831640, "time_this_iter_s": 68.27225065231323, "time_total_s": 14720.652456760406, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72456cae8>", "on_episode_step": "<function on_episode_step at 0x7fc72461e0d0>", "on_episode_end": "<function on_episode_end at 0x7fc7245f50d0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245f5d90>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724532950>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14720.652456760406, "timesteps_since_restore": 5979766, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 90.95102040816326, "ram_util_percent": 32.974489795918366}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": 0.2491, "episode_reward_mean": 0.24985670000000001, "episode_len_mean": 1200.0, "episodes_this_iter": 24, "policy_reward_min": {"av": 0.2491}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.24985670000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.6969516992433675, "avg_speed_min": 1.5651186394271097, "avg_speed_max": 4.211012808855039, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.51726797896133, "mean_processing_ms": 1.490935817500796, "mean_inference_ms": 0.35832799590156433}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1742848, "num_steps_sampled": 6008103, "sample_time_ms": 64991.374, "load_time_ms": 2.212, "grad_time_ms": 3827.572, "update_time_ms": 5.807, "learner": {"av": {"cur_kl_coeff": 0.11716771125793457, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0013244672445580363, "policy_loss": -0.0005968056502752006, "vf_loss": 0.0007124593830667436, "vf_explained_var": 0.8587239980697632, "kl": 0.010316969826817513, "entropy": 3.1027588844299316, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28337, "done": false, "timesteps_total": 6008103, "episodes_total": 5673, "training_iteration": 220, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_06-08-34", "timestamp": 1588831714, "time_this_iter_s": 73.37785458564758, "time_total_s": 14794.030311346054, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72456c6a8>", "on_episode_step": "<function on_episode_step at 0x7fc7245749d8>", "on_episode_end": "<function on_episode_end at 0x7fc7246c2620>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246c2a60>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724532d90>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14794.030311346054, "timesteps_since_restore": 6008103, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 91.58942307692307, "ram_util_percent": 32.98557692307692}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": 0.24921, "episode_reward_mean": 0.24984549999999994, "episode_len_mean": 1200.0, "episodes_this_iter": 24, "policy_reward_min": {"av": 0.24921}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.24984549999999994}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.822965758262306, "avg_speed_min": 1.5651186394271097, "avg_speed_max": 4.254187660760454, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.536387300267624, "mean_processing_ms": 1.4895817574935888, "mean_inference_ms": 0.3586956653915206}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1751296, "num_steps_sampled": 6037001, "sample_time_ms": 65274.58, "load_time_ms": 2.222, "grad_time_ms": 3855.425, "update_time_ms": 5.807, "learner": {"av": {"cur_kl_coeff": 0.11716771125793457, "cur_lr": 9.999999747378752e-05, "total_loss": -0.00018910583457909524, "policy_loss": -0.0016586187994107604, "vf_loss": 0.0006517214933410287, "vf_explained_var": 0.8701828122138977, "kl": 0.006979643367230892, "entropy": 2.9078903198242188, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28898, "done": false, "timesteps_total": 6037001, "episodes_total": 5697, "training_iteration": 221, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_06-09-46", "timestamp": 1588831786, "time_this_iter_s": 72.05940461158752, "time_total_s": 14866.089715957642, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc724574bf8>", "on_episode_step": "<function on_episode_step at 0x7fc72456cae8>", "on_episode_end": "<function on_episode_end at 0x7fc7245f50d0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245f5d90>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7244fe1e0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14866.089715957642, "timesteps_since_restore": 6037001, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 90.40873786407768, "ram_util_percent": 32.99417475728155}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": 0.24922, "episode_reward_mean": 0.24987109999999998, "episode_len_mean": 1200.0, "episodes_this_iter": 22, "policy_reward_min": {"av": 0.24922}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.24987109999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.8252921999199816, "avg_speed_min": 1.5651186394271097, "avg_speed_max": 4.366226363408882, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.549335298999164, "mean_processing_ms": 1.4886467526285956, "mean_inference_ms": 0.35894808700574365}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1759360, "num_steps_sampled": 6063713, "sample_time_ms": 64744.015, "load_time_ms": 2.199, "grad_time_ms": 3818.554, "update_time_ms": 5.825, "learner": {"av": {"cur_kl_coeff": 0.11716771125793457, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0004541926027741283, "policy_loss": -0.0008985712192952633, "vf_loss": 0.0006464215693995357, "vf_explained_var": 0.890245258808136, "kl": 0.006028468254953623, "entropy": 3.2111783027648926, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26712, "done": false, "timesteps_total": 6063713, "episodes_total": 5719, "training_iteration": 222, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_06-10-52", "timestamp": 1588831852, "time_this_iter_s": 66.21567463874817, "time_total_s": 14932.30539059639, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72461e1e0>", "on_episode_step": "<function on_episode_step at 0x7fc72461e0d0>", "on_episode_end": "<function on_episode_end at 0x7fc72461ed90>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7244cb8c8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245c5268>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14932.30539059639, "timesteps_since_restore": 6063713, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 91.40315789473684, "ram_util_percent": 32.99368421052631}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": 0.24922, "episode_reward_mean": 0.24986739999999996, "episode_len_mean": 1200.0, "episodes_this_iter": 24, "policy_reward_min": {"av": 0.24922}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.24986739999999996}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.9853692045475952, "avg_speed_min": 1.5822721623344222, "avg_speed_max": 4.410079973362408, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.552795329134366, "mean_processing_ms": 1.488065282861935, "mean_inference_ms": 0.35911950025971934}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1766528, "num_steps_sampled": 6092494, "sample_time_ms": 64456.261, "load_time_ms": 2.185, "grad_time_ms": 3764.686, "update_time_ms": 5.825, "learner": {"av": {"cur_kl_coeff": 0.11716771125793457, "cur_lr": 9.999999747378752e-05, "total_loss": -6.050935894563736e-07, "policy_loss": -0.0017870701849460602, "vf_loss": 0.0008742491481825709, "vf_explained_var": 0.8579014539718628, "kl": 0.00778556615114212, "entropy": 3.094024658203125, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28781, "done": false, "timesteps_total": 6092494, "episodes_total": 5743, "training_iteration": 223, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_06-11-58", "timestamp": 1588831918, "time_this_iter_s": 65.43316555023193, "time_total_s": 14997.738556146622, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7244cc950>", "on_episode_step": "<function on_episode_step at 0x7fc7245f50d0>", "on_episode_end": "<function on_episode_end at 0x7fc7245f5d90>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245c5378>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724574c80>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 14997.738556146622, "timesteps_since_restore": 6092494, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 91.70860215053762, "ram_util_percent": 32.994623655913976}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -1.00017, "episode_reward_mean": 0.23735620000000002, "episode_len_mean": 1191.17, "episodes_this_iter": 22, "policy_reward_min": {"av": -1.00017}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.23735620000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.98232179703725, "avg_speed_min": 1.5822721623344222, "avg_speed_max": 4.410079973362408, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.546939995226026, "mean_processing_ms": 1.488350702333625, "mean_inference_ms": 0.35886805580423553}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1775488, "num_steps_sampled": 6118197, "sample_time_ms": 65053.179, "load_time_ms": 2.223, "grad_time_ms": 3864.698, "update_time_ms": 5.73, "learner": {"av": {"cur_kl_coeff": 0.11716771125793457, "cur_lr": 9.999999747378752e-05, "total_loss": -0.009480118751525879, "policy_loss": -0.01637381874024868, "vf_loss": 0.00454467348754406, "vf_explained_var": 0.6881442070007324, "kl": 0.020048391073942184, "entropy": 3.296114921569824, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25703, "done": false, "timesteps_total": 6118197, "episodes_total": 5765, "training_iteration": 224, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_06-13-07", "timestamp": 1588831987, "time_this_iter_s": 69.3201961517334, "time_total_s": 15067.058752298355, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7244cc158>", "on_episode_step": "<function on_episode_step at 0x7fc72461ed90>", "on_episode_end": "<function on_episode_end at 0x7fc72461e0d0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245c5268>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724532b70>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 15067.058752298355, "timesteps_since_restore": 6118197, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 91.22424242424243, "ram_util_percent": 33.0}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -1.00017, "episode_reward_mean": 0.23735700000000004, "episode_len_mean": 1191.17, "episodes_this_iter": 24, "policy_reward_min": {"av": -1.00017}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.23735700000000004}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.989040866555454, "avg_speed_min": 1.5822721623344222, "avg_speed_max": 4.921955127843592, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.53335050109205, "mean_processing_ms": 1.4874886641467424, "mean_inference_ms": 0.3586332902556347}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1783424, "num_steps_sampled": 6146433, "sample_time_ms": 65287.384, "load_time_ms": 2.237, "grad_time_ms": 3851.391, "update_time_ms": 5.891, "learner": {"av": {"cur_kl_coeff": 0.17575156688690186, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0005814715404994786, "policy_loss": -0.0015762998955324292, "vf_loss": 0.0009187992545776069, "vf_explained_var": 0.8165851831436157, "kl": 0.007049568463116884, "entropy": 3.2443361282348633, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28236, "done": false, "timesteps_total": 6146433, "episodes_total": 5789, "training_iteration": 225, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_06-14-16", "timestamp": 1588832056, "time_this_iter_s": 68.69647479057312, "time_total_s": 15135.755227088928, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72456cae8>", "on_episode_step": "<function on_episode_step at 0x7fc7245f50d0>", "on_episode_end": "<function on_episode_end at 0x7fc724574c80>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245740d0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724532ae8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 15135.755227088928, "timesteps_since_restore": 6146433, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 89.86938775510203, "ram_util_percent": 33.0}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -1.00017, "episode_reward_mean": 0.2373645, "episode_len_mean": 1191.17, "episodes_this_iter": 22, "policy_reward_min": {"av": -1.00017}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.2373645}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9089986680350477, "avg_speed_min": 1.5822721623344222, "avg_speed_max": 4.921955127843592, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.54018210689624, "mean_processing_ms": 1.48660001356448, "mean_inference_ms": 0.35877387644301256}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1792512, "num_steps_sampled": 6172845, "sample_time_ms": 65413.689, "load_time_ms": 2.252, "grad_time_ms": 3881.942, "update_time_ms": 5.937, "learner": {"av": {"cur_kl_coeff": 0.17575156688690186, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0006961547769606113, "policy_loss": -0.0007355594425462186, "vf_loss": 0.0005616677226498723, "vf_explained_var": 0.8680780529975891, "kl": 0.00495042884722352, "entropy": 2.791877269744873, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26412, "done": false, "timesteps_total": 6172845, "episodes_total": 5811, "training_iteration": 226, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_06-15-27", "timestamp": 1588832127, "time_this_iter_s": 70.43482899665833, "time_total_s": 15206.190056085587, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7244cb8c8>", "on_episode_step": "<function on_episode_step at 0x7fc72461ed90>", "on_episode_end": "<function on_episode_end at 0x7fc7244cc158>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245c5268>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7244fe9d8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 15206.190056085587, "timesteps_since_restore": 6172845, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 91.53168316831682, "ram_util_percent": 33.0019801980198}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -1.00017, "episode_reward_mean": 0.23735779999999998, "episode_len_mean": 1191.17, "episodes_this_iter": 22, "policy_reward_min": {"av": -1.00017}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.23735779999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.910319656088562, "avg_speed_min": 1.3320826956999028, "avg_speed_max": 4.921955127843592, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.5312414425227, "mean_processing_ms": 1.4858071310189158, "mean_inference_ms": 0.3585193948828138}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1800192, "num_steps_sampled": 6200856, "sample_time_ms": 65123.136, "load_time_ms": 2.249, "grad_time_ms": 3839.404, "update_time_ms": 5.921, "learner": {"av": {"cur_kl_coeff": 0.08787578344345093, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0008126066531985998, "policy_loss": -0.0020081803668290377, "vf_loss": 0.0005315284361131489, "vf_explained_var": 0.8782302141189575, "kl": 0.007556600496172905, "entropy": 3.3266220092773438, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28011, "done": false, "timesteps_total": 6200856, "episodes_total": 5833, "training_iteration": 227, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_06-16-33", "timestamp": 1588832193, "time_this_iter_s": 66.30627179145813, "time_total_s": 15272.496327877045, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7244cc950>", "on_episode_step": "<function on_episode_step at 0x7fc72461e0d0>", "on_episode_end": "<function on_episode_end at 0x7fc72461e1e0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc725972510>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245c5488>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 15272.496327877045, "timesteps_since_restore": 6200856, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 90.86315789473684, "ram_util_percent": 32.99894736842106}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": 0.2492, "episode_reward_mean": 0.24987350000000003, "episode_len_mean": 1200.0, "episodes_this_iter": 22, "policy_reward_min": {"av": 0.2492}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.24987350000000003}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.8574474812931108, "avg_speed_min": 1.3320826956999028, "avg_speed_max": 4.921955127843592, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.530592168528592, "mean_processing_ms": 1.4860335310179076, "mean_inference_ms": 0.35849408851618647}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1808640, "num_steps_sampled": 6226245, "sample_time_ms": 64878.778, "load_time_ms": 2.269, "grad_time_ms": 3807.749, "update_time_ms": 5.959, "learner": {"av": {"cur_kl_coeff": 0.08787578344345093, "cur_lr": 9.999999747378752e-05, "total_loss": 1.1358522897353396e-05, "policy_loss": -0.0012399976840242743, "vf_loss": 0.0005802888772450387, "vf_explained_var": 0.8517492413520813, "kl": 0.007636510767042637, "entropy": 2.869107484817505, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25389, "done": false, "timesteps_total": 6226245, "episodes_total": 5855, "training_iteration": 228, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_06-17-40", "timestamp": 1588832260, "time_this_iter_s": 66.95260071754456, "time_total_s": 15339.44892859459, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246c2620>", "on_episode_step": "<function on_episode_step at 0x7fc7244cb8c8>", "on_episode_end": "<function on_episode_end at 0x7fc7244cc158>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245c5268>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245f50d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 15339.44892859459, "timesteps_since_restore": 6226245, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 90.67473684210525, "ram_util_percent": 33.0}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": 0.24931, "episode_reward_mean": 0.24987730000000002, "episode_len_mean": 1200.0, "episodes_this_iter": 23, "policy_reward_min": {"av": 0.24931}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.24987730000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.913729298046582, "avg_speed_min": 1.3320826956999028, "avg_speed_max": 4.921955127843592, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.554701989314417, "mean_processing_ms": 1.484923000096361, "mean_inference_ms": 0.35913900407848637}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1815808, "num_steps_sampled": 6253492, "sample_time_ms": 64543.362, "load_time_ms": 2.251, "grad_time_ms": 3742.246, "update_time_ms": 5.962, "learner": {"av": {"cur_kl_coeff": 0.08787578344345093, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0005862499820068479, "policy_loss": -0.0008874514023773372, "vf_loss": 0.0005231504328548908, "vf_explained_var": 0.8832286596298218, "kl": 0.010816981084644794, "entropy": 3.106106996536255, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27247, "done": false, "timesteps_total": 6253492, "episodes_total": 5878, "training_iteration": 229, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_06-18-44", "timestamp": 1588832324, "time_this_iter_s": 64.26273345947266, "time_total_s": 15403.711662054062, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246c2a60>", "on_episode_step": "<function on_episode_step at 0x7fc72461e1e0>", "on_episode_end": "<function on_episode_end at 0x7fc72461e0d0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245c5488>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724532bf8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 15403.711662054062, "timesteps_since_restore": 6253492, "iterations_since_restore": 229, "perf": {"cpu_util_percent": 88.88152173913043, "ram_util_percent": 33.0}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": 0.24931, "episode_reward_mean": 0.2498835, "episode_len_mean": 1200.0, "episodes_this_iter": 23, "policy_reward_min": {"av": 0.24931}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.2498835}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.9321390536596765, "avg_speed_min": 1.3320826956999028, "avg_speed_max": 4.538032501517648, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.550430146699426, "mean_processing_ms": 1.4849981043506892, "mean_inference_ms": 0.35900226953808184}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1823616, "num_steps_sampled": 6280658, "sample_time_ms": 63939.228, "load_time_ms": 2.232, "grad_time_ms": 3685.937, "update_time_ms": 5.9, "learner": {"av": {"cur_kl_coeff": 0.08787578344345093, "cur_lr": 9.999999747378752e-05, "total_loss": -0.009700668044388294, "policy_loss": -0.011767271906137466, "vf_loss": 0.0004664862062782049, "vf_explained_var": 0.9058734178543091, "kl": 0.018208876252174377, "entropy": 3.224134683609009, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27166, "done": false, "timesteps_total": 6280658, "episodes_total": 5901, "training_iteration": 230, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_06-19-51", "timestamp": 1588832391, "time_this_iter_s": 66.77262997627258, "time_total_s": 15470.484292030334, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc725972510>", "on_episode_step": "<function on_episode_step at 0x7fc7244cb8c8>", "on_episode_end": "<function on_episode_end at 0x7fc7245f50d0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245f5d90>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724532950>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 15470.484292030334, "timesteps_since_restore": 6280658, "iterations_since_restore": 230, "perf": {"cpu_util_percent": 90.61052631578947, "ram_util_percent": 33.0}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00045, "episode_reward_mean": 0.1398784, "episode_len_mean": 1165.67, "episodes_this_iter": 28, "policy_reward_min": {"av": -3.00045}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1398784}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.971432775436268, "avg_speed_min": 1.491147915376294, "avg_speed_max": 4.650381474337519, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.566368093603252, "mean_processing_ms": 1.4837997293997265, "mean_inference_ms": 0.35941936709906175}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1832448, "num_steps_sampled": 6310534, "sample_time_ms": 64128.297, "load_time_ms": 2.245, "grad_time_ms": 3704.974, "update_time_ms": 5.959, "learner": {"av": {"cur_kl_coeff": 0.08787578344345093, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0798252522945404, "policy_loss": -0.012251944281160831, "vf_loss": 0.08989699184894562, "vf_explained_var": 0.6062040328979492, "kl": 0.024810027331113815, "entropy": 3.1744308471679688, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 29876, "done": false, "timesteps_total": 6310534, "episodes_total": 5929, "training_iteration": 231, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_06-21-05", "timestamp": 1588832465, "time_this_iter_s": 74.14112257957458, "time_total_s": 15544.625414609909, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72461ed90>", "on_episode_step": "<function on_episode_step at 0x7fc72461e1e0>", "on_episode_end": "<function on_episode_end at 0x7fc7246c2a60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245c5488>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724499268>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 15544.625414609909, "timesteps_since_restore": 6310534, "iterations_since_restore": 231, "perf": {"cpu_util_percent": 90.08396226415095, "ram_util_percent": 33.00188679245283}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00045, "episode_reward_mean": 0.1073678, "episode_len_mean": 1157.11, "episodes_this_iter": 22, "policy_reward_min": {"av": -3.00045}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1073678}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9552343939327845, "avg_speed_min": 1.491147915376294, "avg_speed_max": 4.699569875758988, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.568531541101294, "mean_processing_ms": 1.4827635959734755, "mean_inference_ms": 0.35946629775210837}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1841536, "num_steps_sampled": 6337143, "sample_time_ms": 64588.157, "load_time_ms": 2.27, "grad_time_ms": 3752.106, "update_time_ms": 5.979, "learner": {"av": {"cur_kl_coeff": 0.1318136751651764, "cur_lr": 9.999999747378752e-05, "total_loss": 0.044014640152454376, "policy_loss": -0.0032411026768386364, "vf_loss": 0.04596400260925293, "vf_explained_var": 0.3423347473144531, "kl": 0.009799716994166374, "entropy": 3.3325910568237305, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26609, "done": false, "timesteps_total": 6337143, "episodes_total": 5951, "training_iteration": 232, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_06-22-17", "timestamp": 1588832537, "time_this_iter_s": 71.28633093833923, "time_total_s": 15615.911745548248, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7245740d0>", "on_episode_step": "<function on_episode_step at 0x7fc724574c80>", "on_episode_end": "<function on_episode_end at 0x7fc724574bf8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc724574b70>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72456c620>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 15615.911745548248, "timesteps_since_restore": 6337143, "iterations_since_restore": 232, "perf": {"cpu_util_percent": 90.33431372549022, "ram_util_percent": 33.0}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00045, "episode_reward_mean": 0.06987880000000002, "episode_len_mean": 1131.23, "episodes_this_iter": 27, "policy_reward_min": {"av": -3.00045}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.06987880000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.91584628416222, "avg_speed_min": 1.491147915376294, "avg_speed_max": 4.699569875758988, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.56623438762477, "mean_processing_ms": 1.481897608148262, "mean_inference_ms": 0.3592657571107054}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1849856, "num_steps_sampled": 6365597, "sample_time_ms": 65047.106, "load_time_ms": 2.296, "grad_time_ms": 3807.315, "update_time_ms": 6.034, "learner": {"av": {"cur_kl_coeff": 0.1318136751651764, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0018925396725535393, "policy_loss": -0.01226037461310625, "vf_loss": 0.011417310684919357, "vf_explained_var": 0.6959874033927917, "kl": 0.020753566175699234, "entropy": 3.024003028869629, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28454, "done": false, "timesteps_total": 6365597, "episodes_total": 5978, "training_iteration": 233, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_06-23-28", "timestamp": 1588832608, "time_this_iter_s": 70.57594704627991, "time_total_s": 15686.487692594528, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7245749d8>", "on_episode_step": "<function on_episode_step at 0x7fc72461ed90>", "on_episode_end": "<function on_episode_end at 0x7fc7246c2a60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245c5488>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245f50d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 15686.487692594528, "timesteps_since_restore": 6365597, "iterations_since_restore": 233, "perf": {"cpu_util_percent": 91.57425742574256, "ram_util_percent": 33.0}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00045, "episode_reward_mean": 0.004888600000000023, "episode_len_mean": 1112.3, "episodes_this_iter": 21, "policy_reward_min": {"av": -3.00045}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.004888600000000023}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.832209217452416, "avg_speed_min": 1.491147915376294, "avg_speed_max": 4.699569875758988, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.57227265547333, "mean_processing_ms": 1.4826506980406122, "mean_inference_ms": 0.35933748367729473}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1859712, "num_steps_sampled": 6390847, "sample_time_ms": 65410.271, "load_time_ms": 2.438, "grad_time_ms": 3848.742, "update_time_ms": 6.026, "learner": {"av": {"cur_kl_coeff": 0.1977205127477646, "cur_lr": 9.999999747378752e-05, "total_loss": -0.008310741744935513, "policy_loss": -0.011383439414203167, "vf_loss": 0.0018320662202313542, "vf_explained_var": 0.9755789041519165, "kl": 0.0062746573239564896, "entropy": 2.963762044906616, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25250, "done": false, "timesteps_total": 6390847, "episodes_total": 5999, "training_iteration": 234, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_06-24-41", "timestamp": 1588832681, "time_this_iter_s": 73.36696815490723, "time_total_s": 15759.854660749435, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72461e1e0>", "on_episode_step": "<function on_episode_step at 0x7fc724574bf8>", "on_episode_end": "<function on_episode_end at 0x7fc724574c80>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72456c620>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724532510>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 15759.854660749435, "timesteps_since_restore": 6390847, "iterations_since_restore": 234, "perf": {"cpu_util_percent": 90.14423076923077, "ram_util_percent": 33.0}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00018, "episode_reward_mean": 0.10238939999999999, "episode_len_mean": 1137.82, "episodes_this_iter": 26, "policy_reward_min": {"av": -3.00018}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.10238939999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.935154122520812, "avg_speed_min": 1.517205903455248, "avg_speed_max": 4.894382526740649, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.58979219544696, "mean_processing_ms": 1.4825767863624477, "mean_inference_ms": 0.3597720275237084}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1865984, "num_steps_sampled": 6419731, "sample_time_ms": 64897.137, "load_time_ms": 2.408, "grad_time_ms": 3774.281, "update_time_ms": 5.846, "learner": {"av": {"cur_kl_coeff": 0.1977205127477646, "cur_lr": 9.999999747378752e-05, "total_loss": 0.005807905923575163, "policy_loss": -0.007482651621103287, "vf_loss": 0.010345402173697948, "vf_explained_var": 0.5292010307312012, "kl": 0.014895549975335598, "entropy": 3.6877636909484863, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28884, "done": false, "timesteps_total": 6419731, "episodes_total": 6025, "training_iteration": 235, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_06-25-44", "timestamp": 1588832744, "time_this_iter_s": 62.817439794540405, "time_total_s": 15822.672100543976, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc724574b70>", "on_episode_step": "<function on_episode_step at 0x7fc72461ed90>", "on_episode_end": "<function on_episode_end at 0x7fc7245f50d0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245f5d90>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724532d90>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 15822.672100543976, "timesteps_since_restore": 6419731, "iterations_since_restore": 235, "perf": {"cpu_util_percent": 89.55888888888889, "ram_util_percent": 33.0}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00015, "episode_reward_mean": 0.1023907, "episode_len_mean": 1137.65, "episodes_this_iter": 22, "policy_reward_min": {"av": -3.00015}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1023907}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9089009516874262, "avg_speed_min": 1.517205903455248, "avg_speed_max": 4.894382526740649, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.581730382525055, "mean_processing_ms": 1.4829437007338555, "mean_inference_ms": 0.3595648764666406}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1876352, "num_steps_sampled": 6446760, "sample_time_ms": 65572.857, "load_time_ms": 2.429, "grad_time_ms": 3830.611, "update_time_ms": 5.903, "learner": {"av": {"cur_kl_coeff": 0.1977205127477646, "cur_lr": 9.999999747378752e-05, "total_loss": 0.005553169175982475, "policy_loss": -0.0023137053940445185, "vf_loss": 0.0072259968146681786, "vf_explained_var": 0.9306612610816956, "kl": 0.003241328988224268, "entropy": 3.005333423614502, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27029, "done": false, "timesteps_total": 6446760, "episodes_total": 6047, "training_iteration": 236, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_06-27-02", "timestamp": 1588832822, "time_this_iter_s": 77.7572090625763, "time_total_s": 15900.429309606552, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246c2a60>", "on_episode_step": "<function on_episode_step at 0x7fc72461e0d0>", "on_episode_end": "<function on_episode_end at 0x7fc72461e1e0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72456c620>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724499a60>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 15900.429309606552, "timesteps_since_restore": 6446760, "iterations_since_restore": 236, "perf": {"cpu_util_percent": 90.15405405405404, "ram_util_percent": 33.002702702702706}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00015, "episode_reward_mean": 0.1273846, "episode_len_mean": 1154.8, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.00015}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1273846}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.7651680356785038, "avg_speed_min": 1.5466565031997326, "avg_speed_max": 4.894382526740649, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.585771508652755, "mean_processing_ms": 1.4832620018201945, "mean_inference_ms": 0.35975350860110994}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1884544, "num_steps_sampled": 6473536, "sample_time_ms": 65681.183, "load_time_ms": 2.44, "grad_time_ms": 3858.032, "update_time_ms": 6.15, "learner": {"av": {"cur_kl_coeff": 0.0988602563738823, "cur_lr": 9.999999747378752e-05, "total_loss": -0.007528368383646011, "policy_loss": -0.010389178991317749, "vf_loss": 0.0011711802799254656, "vf_explained_var": 0.9115240573883057, "kl": 0.017091073095798492, "entropy": 3.580439567565918, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26776, "done": false, "timesteps_total": 6473536, "episodes_total": 6070, "training_iteration": 237, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_06-28-10", "timestamp": 1588832890, "time_this_iter_s": 67.66564440727234, "time_total_s": 15968.094954013824, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc724574bf8>", "on_episode_step": "<function on_episode_step at 0x7fc7245749d8>", "on_episode_end": "<function on_episode_end at 0x7fc7245740d0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7244fe1e0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245c5a60>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 15968.094954013824, "timesteps_since_restore": 6473536, "iterations_since_restore": 237, "perf": {"cpu_util_percent": 89.37216494845359, "ram_util_percent": 33.01030927835052}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.0000699999999996, "episode_reward_mean": 0.1723666, "episode_len_mean": 1172.25, "episodes_this_iter": 26, "policy_reward_min": {"av": -3.0000699999999996}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1723666}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9866547491266, "avg_speed_min": 1.5837563799400745, "avg_speed_max": 4.894382526740649, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.57498880308279, "mean_processing_ms": 1.48223681424832, "mean_inference_ms": 0.35946012140363764}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1891584, "num_steps_sampled": 6503108, "sample_time_ms": 65708.402, "load_time_ms": 2.404, "grad_time_ms": 3793.507, "update_time_ms": 6.181, "learner": {"av": {"cur_kl_coeff": 0.0988602563738823, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0009495397680439055, "policy_loss": -0.0007594602066092193, "vf_loss": 0.000703123165294528, "vf_explained_var": 0.9244304299354553, "kl": 0.01017472892999649, "entropy": 3.2708981037139893, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 29572, "done": false, "timesteps_total": 6503108, "episodes_total": 6096, "training_iteration": 238, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_06-29-16", "timestamp": 1588832956, "time_this_iter_s": 66.57959628105164, "time_total_s": 16034.674550294876, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7244cb8c8>", "on_episode_step": "<function on_episode_step at 0x7fc72456c620>", "on_episode_end": "<function on_episode_end at 0x7fc7245c5620>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245c57b8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72461ed90>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 16034.674550294876, "timesteps_since_restore": 6503108, "iterations_since_restore": 238, "perf": {"cpu_util_percent": 89.89263157894734, "ram_util_percent": 33.00526315789474}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00019, "episode_reward_mean": 0.1523652, "episode_len_mean": 1172.52, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.00019}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1523652}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.8494479396829395, "avg_speed_min": 1.5271643150743965, "avg_speed_max": 4.71427117666182, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.57746463807812, "mean_processing_ms": 1.4817784455180254, "mean_inference_ms": 0.3594938978414367}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1900928, "num_steps_sampled": 6530684, "sample_time_ms": 66492.625, "load_time_ms": 2.495, "grad_time_ms": 3893.761, "update_time_ms": 6.26, "learner": {"av": {"cur_kl_coeff": 0.0988602563738823, "cur_lr": 9.999999747378752e-05, "total_loss": -0.008128405548632145, "policy_loss": -0.010782563127577305, "vf_loss": 0.0015850106719881296, "vf_explained_var": 0.9513275027275085, "kl": 0.010814758948981762, "entropy": 3.106722593307495, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27576, "done": false, "timesteps_total": 6530684, "episodes_total": 6119, "training_iteration": 239, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_06-30-29", "timestamp": 1588833029, "time_this_iter_s": 73.11003875732422, "time_total_s": 16107.7845890522, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7246c2a60>", "on_episode_step": "<function on_episode_step at 0x7fc7245740d0>", "on_episode_end": "<function on_episode_end at 0x7fc7245749d8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245c5a60>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724532ea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 16107.7845890522, "timesteps_since_restore": 6530684, "iterations_since_restore": 239, "perf": {"cpu_util_percent": 91.98653846153849, "ram_util_percent": 33.06826923076924}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00019, "episode_reward_mean": 0.1723764, "episode_len_mean": 1172.36, "episodes_this_iter": 25, "policy_reward_min": {"av": -3.00019}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1723764}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.0358810969121044, "avg_speed_min": 1.5271643150743965, "avg_speed_max": 4.71427117666182, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.56479914200699, "mean_processing_ms": 1.4817151088900982, "mean_inference_ms": 0.3591930334158211}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1907584, "num_steps_sampled": 6559154, "sample_time_ms": 66220.723, "load_time_ms": 2.484, "grad_time_ms": 3840.347, "update_time_ms": 6.243, "learner": {"av": {"cur_kl_coeff": 0.0988602563738823, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0017291703261435032, "policy_loss": -0.008553599938750267, "vf_loss": 0.008776436559855938, "vf_explained_var": 0.5110336542129517, "kl": 0.01523700449615717, "entropy": 3.4066364765167236, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28470, "done": false, "timesteps_total": 6559154, "episodes_total": 6144, "training_iteration": 240, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_06-31-33", "timestamp": 1588833093, "time_this_iter_s": 63.51909804344177, "time_total_s": 16171.303687095642, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc724574c80>", "on_episode_step": "<function on_episode_step at 0x7fc72461ed90>", "on_episode_end": "<function on_episode_end at 0x7fc72461e0d0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72461e1e0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724532bf8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 16171.303687095642, "timesteps_since_restore": 6559154, "iterations_since_restore": 240, "perf": {"cpu_util_percent": 89.9043956043956, "ram_util_percent": 33.080219780219785}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00019, "episode_reward_mean": 0.1723893, "episode_len_mean": 1172.36, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.00019}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1723893}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.0236204384084755, "avg_speed_min": 1.4561769402049627, "avg_speed_max": 4.71427117666182, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.572924728477425, "mean_processing_ms": 1.4804832217464408, "mean_inference_ms": 0.3593990590258357}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1917184, "num_steps_sampled": 6586788, "sample_time_ms": 66259.485, "load_time_ms": 2.494, "grad_time_ms": 3875.731, "update_time_ms": 6.248, "learner": {"av": {"cur_kl_coeff": 0.0988602563738823, "cur_lr": 9.999999747378752e-05, "total_loss": -0.004123573657125235, "policy_loss": -0.0061387354508042336, "vf_loss": 0.000941847451031208, "vf_explained_var": 0.8194959759712219, "kl": 0.01085689663887024, "entropy": 3.0919346809387207, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27634, "done": false, "timesteps_total": 6586788, "episodes_total": 6167, "training_iteration": 241, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_06-32-48", "timestamp": 1588833168, "time_this_iter_s": 74.88349890708923, "time_total_s": 16246.187186002731, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc72456c620>", "on_episode_step": "<function on_episode_step at 0x7fc7245740d0>", "on_episode_end": "<function on_episode_end at 0x7fc7246c2a60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245c5a60>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7244ac2f0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 16246.187186002731, "timesteps_since_restore": 6586788, "iterations_since_restore": 241, "perf": {"cpu_util_percent": 90.26542056074767, "ram_util_percent": 33.08971962616823}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00019, "episode_reward_mean": 0.20488390000000004, "episode_len_mean": 1182.57, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.00019}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.20488390000000004}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.907296070785745, "avg_speed_min": 1.4561769402049627, "avg_speed_max": 4.5566388374075695, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.564179549075753, "mean_processing_ms": 1.480463944069315, "mean_inference_ms": 0.35917188319750276}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1925632, "num_steps_sampled": 6614211, "sample_time_ms": 66174.835, "load_time_ms": 2.485, "grad_time_ms": 3847.319, "update_time_ms": 6.262, "learner": {"av": {"cur_kl_coeff": 0.0988602563738823, "cur_lr": 9.999999747378752e-05, "total_loss": 0.00034089319524355233, "policy_loss": -0.001181244384497404, "vf_loss": 0.0006989790126681328, "vf_explained_var": 0.8514149188995361, "kl": 0.008326455950737, "entropy": 3.061676025390625, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 27423, "done": false, "timesteps_total": 6614211, "episodes_total": 6190, "training_iteration": 242, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_06-33-58", "timestamp": 1588833238, "time_this_iter_s": 70.15580439567566, "time_total_s": 16316.342990398407, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7245f50d0>", "on_episode_step": "<function on_episode_step at 0x7fc724499268>", "on_episode_end": "<function on_episode_end at 0x7fc7244cb8c8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245749d8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7246c2620>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 16316.342990398407, "timesteps_since_restore": 6614211, "iterations_since_restore": 242, "perf": {"cpu_util_percent": 90.649, "ram_util_percent": 33.091}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00019, "episode_reward_mean": 0.20487909999999998, "episode_len_mean": 1182.57, "episodes_this_iter": 22, "policy_reward_min": {"av": -3.00019}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.20487909999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.8745509965080784, "avg_speed_min": 1.4561769402049627, "avg_speed_max": 4.5865970436988555, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.587750287579844, "mean_processing_ms": 1.4799731320794738, "mean_inference_ms": 0.3598130835174272}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1934592, "num_steps_sampled": 6641124, "sample_time_ms": 66151.853, "load_time_ms": 2.496, "grad_time_ms": 3876.319, "update_time_ms": 6.2, "learner": {"av": {"cur_kl_coeff": 0.0988602563738823, "cur_lr": 9.999999747378752e-05, "total_loss": -0.001528517110273242, "policy_loss": -0.00418564397841692, "vf_loss": 0.001923915697261691, "vf_explained_var": 0.7236192226409912, "kl": 0.007416658103466034, "entropy": 3.058009147644043, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26913, "done": false, "timesteps_total": 6641124, "episodes_total": 6212, "training_iteration": 243, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_06-35-09", "timestamp": 1588833309, "time_this_iter_s": 70.63479995727539, "time_total_s": 16386.977790355682, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7245f5d90>", "on_episode_step": "<function on_episode_step at 0x7fc72456c620>", "on_episode_end": "<function on_episode_end at 0x7fc7246c2a60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245c5a60>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72461e0d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 16386.977790355682, "timesteps_since_restore": 6641124, "iterations_since_restore": 243, "perf": {"cpu_util_percent": 91.41584158415841, "ram_util_percent": 33.099009900990104}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -1.00013, "episode_reward_mean": 0.23737909999999998, "episode_len_mean": 1191.11, "episodes_this_iter": 22, "policy_reward_min": {"av": -1.00013}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.23737909999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.880665258143269, "avg_speed_min": 1.4561769402049627, "avg_speed_max": 4.821616951986922, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.597652365732273, "mean_processing_ms": 1.4799696731038328, "mean_inference_ms": 0.3600547101761918}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1941888, "num_steps_sampled": 6667926, "sample_time_ms": 65310.282, "load_time_ms": 2.33, "grad_time_ms": 3759.248, "update_time_ms": 6.235, "learner": {"av": {"cur_kl_coeff": 0.0988602563738823, "cur_lr": 9.999999747378752e-05, "total_loss": 0.00015443550364580005, "policy_loss": -0.00124982965644449, "vf_loss": 0.0005961590795777738, "vf_explained_var": 0.8805480003356934, "kl": 0.008174220100045204, "entropy": 3.10514235496521, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26802, "done": false, "timesteps_total": 6667926, "episodes_total": 6234, "training_iteration": 244, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_06-36-13", "timestamp": 1588833373, "time_this_iter_s": 63.77987885475159, "time_total_s": 16450.757669210434, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7244cb8c8>", "on_episode_step": "<function on_episode_step at 0x7fc724499a60>", "on_episode_end": "<function on_episode_end at 0x7fc724499268>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246c2620>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724532e18>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 16450.757669210434, "timesteps_since_restore": 6667926, "iterations_since_restore": 244, "perf": {"cpu_util_percent": 90.20439560439561, "ram_util_percent": 33.0956043956044}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00022, "episode_reward_mean": 0.2173781, "episode_len_mean": 1191.95, "episodes_this_iter": 25, "policy_reward_min": {"av": -3.00022}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.2173781}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.9183612375526673, "avg_speed_min": 1.4003812435660303, "avg_speed_max": 4.821616951986922, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.602972076061143, "mean_processing_ms": 1.479728509280667, "mean_inference_ms": 0.3602320536985907}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1949824, "num_steps_sampled": 6696770, "sample_time_ms": 65916.818, "load_time_ms": 2.362, "grad_time_ms": 3836.83, "update_time_ms": 6.263, "learner": {"av": {"cur_kl_coeff": 0.0988602563738823, "cur_lr": 9.999999747378752e-05, "total_loss": 0.000111790192022454, "policy_loss": -0.003346975427120924, "vf_loss": 0.002947683911770582, "vf_explained_var": 0.8994296789169312, "kl": 0.005169746000319719, "entropy": 3.043285846710205, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28844, "done": false, "timesteps_total": 6696770, "episodes_total": 6259, "training_iteration": 245, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_06-37-23", "timestamp": 1588833443, "time_this_iter_s": 69.65948462486267, "time_total_s": 16520.417153835297, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7245740d0>", "on_episode_step": "<function on_episode_step at 0x7fc72456c620>", "on_episode_end": "<function on_episode_end at 0x7fc72461e0d0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72461e1e0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724532950>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 16520.417153835297, "timesteps_since_restore": 6696770, "iterations_since_restore": 245, "perf": {"cpu_util_percent": 89.178, "ram_util_percent": 33.1}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00022, "episode_reward_mean": 0.21739170000000002, "episode_len_mean": 1191.95, "episodes_this_iter": 22, "policy_reward_min": {"av": -3.00022}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.21739170000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.927203068811309, "avg_speed_min": 1.4003812435660303, "avg_speed_max": 4.821616951986922, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.6109522062412, "mean_processing_ms": 1.4783494532761403, "mean_inference_ms": 0.3603244638146077}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1958400, "num_steps_sampled": 6723150, "sample_time_ms": 65163.258, "load_time_ms": 2.337, "grad_time_ms": 3754.51, "update_time_ms": 6.213, "learner": {"av": {"cur_kl_coeff": 0.0988602563738823, "cur_lr": 9.999999747378752e-05, "total_loss": -0.002362695289775729, "policy_loss": -0.0037943979259580374, "vf_loss": 0.0006147669046185911, "vf_explained_var": 0.8667915463447571, "kl": 0.008263551630079746, "entropy": 2.7785418033599854, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26380, "done": false, "timesteps_total": 6723150, "episodes_total": 6281, "training_iteration": 246, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_06-38-32", "timestamp": 1588833512, "time_this_iter_s": 69.39698839187622, "time_total_s": 16589.814142227173, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc724499a60>", "on_episode_step": "<function on_episode_step at 0x7fc7244cb8c8>", "on_episode_end": "<function on_episode_end at 0x7fc7246c2a60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246c2620>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7244acae8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 16589.814142227173, "timesteps_since_restore": 6723150, "iterations_since_restore": 246, "perf": {"cpu_util_percent": 90.99292929292929, "ram_util_percent": 33.10202020202021}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00022, "episode_reward_mean": 0.21739750000000002, "episode_len_mean": 1191.95, "episodes_this_iter": 20, "policy_reward_min": {"av": -3.00022}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.21739750000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.0172918255399828, "avg_speed_min": 1.4003812435660303, "avg_speed_max": 4.821616951986922, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.61320375888847, "mean_processing_ms": 1.478182013684637, "mean_inference_ms": 0.3604609641312554}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1966592, "num_steps_sampled": 6748742, "sample_time_ms": 64958.278, "load_time_ms": 2.32, "grad_time_ms": 3750.688, "update_time_ms": 6.056, "learner": {"av": {"cur_kl_coeff": 0.0988602563738823, "cur_lr": 9.999999747378752e-05, "total_loss": -0.0010914448648691177, "policy_loss": -0.0027768665459007025, "vf_loss": 0.0007688278565183282, "vf_explained_var": 0.8386423587799072, "kl": 0.009271597489714622, "entropy": 2.9485063552856445, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25592, "done": false, "timesteps_total": 6748742, "episodes_total": 6301, "training_iteration": 247, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_06-39-38", "timestamp": 1588833578, "time_this_iter_s": 65.57834124565125, "time_total_s": 16655.392483472824, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7245f50d0>", "on_episode_step": "<function on_episode_step at 0x7fc725972730>", "on_episode_end": "<function on_episode_end at 0x7fc7245749d8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc724574bf8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc7245c5488>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 16655.392483472824, "timesteps_since_restore": 6748742, "iterations_since_restore": 247, "perf": {"cpu_util_percent": 90.95376344086019, "ram_util_percent": 33.1}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": -3.00022, "episode_reward_mean": 0.2173893, "episode_len_mean": 1191.95, "episodes_this_iter": 21, "policy_reward_min": {"av": -3.00022}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.2173893}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.027173354564549, "avg_speed_min": 1.4003812435660303, "avg_speed_max": 4.821616951986922, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.614058651197187, "mean_processing_ms": 1.4772542698076578, "mean_inference_ms": 0.3603600063311893}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1974400, "num_steps_sampled": 6773932, "sample_time_ms": 64691.327, "load_time_ms": 2.34, "grad_time_ms": 3786.904, "update_time_ms": 6.126, "learner": {"av": {"cur_kl_coeff": 0.0988602563738823, "cur_lr": 9.999999747378752e-05, "total_loss": 0.0014074351638555527, "policy_loss": -0.00028068534447811544, "vf_loss": 0.0006876235129311681, "vf_explained_var": 0.8401778340339661, "kl": 0.010120303370058537, "entropy": 3.1583352088928223, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25190, "done": false, "timesteps_total": 6773932, "episodes_total": 6322, "training_iteration": 248, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_06-40-42", "timestamp": 1588833642, "time_this_iter_s": 64.27367758750916, "time_total_s": 16719.666161060333, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc724499268>", "on_episode_step": "<function on_episode_step at 0x7fc724499a60>", "on_episode_end": "<function on_episode_end at 0x7fc7246c2a60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7246c2620>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc72456c620>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 16719.666161060333, "timesteps_since_restore": 6773932, "iterations_since_restore": 248, "perf": {"cpu_util_percent": 90.8467391304348, "ram_util_percent": 33.1}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": 0.24924, "episode_reward_mean": 0.24989719999999999, "episode_len_mean": 1200.0, "episodes_this_iter": 24, "policy_reward_min": {"av": 0.24924}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.24989719999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.0114593652676507, "avg_speed_min": 1.602742139933213, "avg_speed_max": 4.61495743832355, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.611443313639153, "mean_processing_ms": 1.4764808670950342, "mean_inference_ms": 0.36032267930472517}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1981312, "num_steps_sampled": 6800906, "sample_time_ms": 63749.727, "load_time_ms": 2.24, "grad_time_ms": 3676.055, "update_time_ms": 5.998, "learner": {"av": {"cur_kl_coeff": 0.0988602563738823, "cur_lr": 9.999999747378752e-05, "total_loss": -0.003346571233123541, "policy_loss": -0.005213385447859764, "vf_loss": 0.0005070987972430885, "vf_explained_var": 0.9621697664260864, "kl": 0.013753924518823624, "entropy": 3.230412006378174, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 26974, "done": false, "timesteps_total": 6800906, "episodes_total": 6346, "training_iteration": 249, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_06-41-45", "timestamp": 1588833705, "time_this_iter_s": 62.5825777053833, "time_total_s": 16782.248738765717, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7245f5d90>", "on_episode_step": "<function on_episode_step at 0x7fc7245749d8>", "on_episode_end": "<function on_episode_end at 0x7fc725972730>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc7245c5488>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724532c80>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 16782.248738765717, "timesteps_since_restore": 6800906, "iterations_since_restore": 249, "perf": {"cpu_util_percent": 90.31797752808988, "ram_util_percent": 33.10000000000001}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
{"episode_reward_max": 0.25, "episode_reward_min": 0.24924, "episode_reward_mean": 0.249901, "episode_len_mean": 1200.0, "episodes_this_iter": 20, "policy_reward_min": {"av": 0.24924}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.249901}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.917552838603853, "avg_speed_min": 1.602742139933213, "avg_speed_max": 4.73655873785462, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 31.621387572814072, "mean_processing_ms": 1.4754333591103859, "mean_inference_ms": 0.3606082036764665}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1989888, "num_steps_sampled": 6826328, "sample_time_ms": 64003.512, "load_time_ms": 2.262, "grad_time_ms": 3761.668, "update_time_ms": 5.955, "learner": {"av": {"cur_kl_coeff": 0.0988602563738823, "cur_lr": 9.999999747378752e-05, "total_loss": -0.00040930131217464805, "policy_loss": -0.0015632194699719548, "vf_loss": 0.0006856205291114748, "vf_explained_var": 0.8749374747276306, "kl": 0.004736986942589283, "entropy": 2.9971954822540283, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 25422, "done": true, "timesteps_total": 6826328, "episodes_total": 6366, "training_iteration": 250, "experiment_id": "b93c4af0c0b147f3b8d500d9dc476dec", "date": "2020-05-07_06-42-52", "timestamp": 1588833772, "time_this_iter_s": 66.91244220733643, "time_total_s": 16849.161180973053, "pid": 27785, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 24000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 1200, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1200,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fc7244cb8c8>", "on_episode_step": "<function on_episode_step at 0x7fc7246c2a60>", "on_episode_end": "<function on_episode_end at 0x7fc724499a60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fc72456c620>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fc724532ea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 16849.161180973053, "timesteps_since_restore": 6826328, "iterations_since_restore": 250, "perf": {"cpu_util_percent": 91.10625, "ram_util_percent": 33.10000000000001}, "num_healthy_workers": 15, "trial_id": "d67e25e0", "experiment_tag": "1_gamma=0.995,lr=0.0001"}
